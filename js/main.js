
//${CONFIG_BEGIN}
CFG_ANDROID_APP_LABEL="Scent Collaborate";
CFG_ANDROID_APP_PACKAGE="com.xteamsoftware.scent_collaborate";
CFG_ANDROID_KEY_ALIAS="beng.keystore";
CFG_ANDROID_KEY_ALIAS_PASSWORD="debora18";
CFG_ANDROID_KEY_STORE="../../beng.keystore";
CFG_ANDROID_KEY_STORE_PASSWORD="debora18";
CFG_ANDROID_NATIVE_GL_ENABLED="0";
CFG_ANDROID_SCREEN_ORIENTATION="landscape";
CFG_ANDROID_SIGN_APP="0";
CFG_ANDROID_VERSION_CODE="1";
CFG_ANDROID_VERSION_NAME="1.1312";
CFG_BINARY_FILES="*.bin|*.dat";
CFG_BRL_DATABUFFER_IMPLEMENTED="1";
CFG_BRL_GAMETARGET_IMPLEMENTED="1";
CFG_BRL_HTTPREQUEST_IMPLEMENTED="1";
CFG_BRL_STREAM_IMPLEMENTED="1";
CFG_BRL_THREAD_IMPLEMENTED="1";
CFG_CD="";
CFG_CONFIG="release";
CFG_DIDDY_FRAMEWORK="1";
CFG_GLFW_COPY_LIBS="openal32";
CFG_GLFW_GCC_LIB_OPTS="-lopenal32;-lcurldll";
CFG_HOST="winnt";
CFG_HTML5_WEBAUDIO_ENABLED="1";
CFG_IMAGE_FILES="*.png|*.jpg";
CFG_LANG="js";
CFG_MODPATH="";
CFG_MOJO_AUTO_SUSPEND_ENABLED="0";
CFG_MOJO_DRIVER_IMPLEMENTED="1";
CFG_MUSIC_FILES="*.wav|*.ogg|*.mp3|*.m4a";
CFG_OPENGL_GLES20_ENABLED="0";
CFG_REFLECTION_FILTER="diddy.exception";
CFG_SAFEMODE="0";
CFG_SOUND_FILES="*.wav|*.ogg|*.mp3|*.m4a";
CFG_TARGET="html5";
CFG_TEXT_FILES="*.txt|*.xml|*.json|*.fnt;*.txt|*.xml|*.json";
//${CONFIG_END}

//${METADATA_BEGIN}
var META_DATA="[mojo_font.png];type=image/png;width=864;height=13;\n[141.jpg];type=image/jpg;width=1280;height=960;\n[arial12_0.png];type=image/png;width=512;height=512;\n[arial16_0.png];type=image/png;width=512;height=512;\n[arial18_0.png];type=image/png;width=512;height=512;\n[arial20_0.png];type=image/png;width=512;height=512;\n[arial20b_0.png];type=image/png;width=512;height=512;\n[arial24_0.png];type=image/png;width=512;height=512;\n[arial32_0.png];type=image/png;width=512;height=512;\n[arial32_1.png];type=image/png;width=256;height=256;\n[arial32_2.png];type=image/png;width=256;height=256;\n[arial48_0.png];type=image/png;width=512;height=512;\n[arial48_1.png];type=image/png;width=512;height=512;\n[arial48_2.png];type=image/png;width=256;height=256;\n[arial48_3.png];type=image/png;width=256;height=256;\n[arial48_4.png];type=image/png;width=256;height=256;\n[arial48_5.png];type=image/png;width=256;height=256;\n[arial48_6.png];type=image/png;width=256;height=256;\n[arial_0.png];type=image/png;width=512;height=512;\n[arial_1.png];type=image/png;width=512;height=512;\n[arialmenu.png];type=image/png;width=512;height=512;\n[arialmenu_0.png];type=image/png;width=512;height=512;\n[badges/CampaignA1.png];type=image/png;width=80;height=80;\n[badges/CampaignA2.png];type=image/png;width=80;height=80;\n[badges/CampaignA3.png];type=image/png;width=80;height=80;\n[badges/MonsterA1.png];type=image/png;width=80;height=80;\n[badges/MonsterA2.png];type=image/png;width=80;height=80;\n[badges/MonsterA3.png];type=image/png;width=80;height=80;\n[badges/PhotoAddedA1.png];type=image/png;width=80;height=80;\n[badges/PhotoAddedA2.png];type=image/png;width=80;height=80;\n[badges/PhotoAddedA3.png];type=image/png;width=80;height=80;\n[badges/PhotoB1.png];type=image/png;width=80;height=80;\n[badges/PhotoB2.png];type=image/png;width=80;height=80;\n[badges/PhotoB3.png];type=image/png;width=80;height=80;\n[badges/PointOfInterestB1.png];type=image/png;width=80;height=80;\n[badges/PointOfInterestB2.png];type=image/png;width=80;height=80;\n[badges/PointOfInterestB3.png];type=image/png;width=80;height=80;\n[badges/ScoreC1.png];type=image/png;width=80;height=80;\n[badges/ScoreC2.png];type=image/png;width=80;height=80;\n[badges/ScoreC3.png];type=image/png;width=80;height=80;\n[badges/Tag1.png];type=image/png;width=80;height=80;\n[badges/Tag2.png];type=image/png;width=80;height=80;\n[badges/Tag3.png];type=image/png;width=80;height=80;\n[badges/collapse.png];type=image/png;width=80;height=80;\n[badges/expand.png];type=image/png;width=80;height=80;\n[examples/01.01.01.jpg];type=image/jpg;width=384;height=512;\n[examples/01.01.02.jpg];type=image/jpg;width=512;height=512;\n[examples/01.01.03.jpg];type=image/jpg;width=512;height=512;\n[examples/01.02.01.01.jpg];type=image/jpg;width=512;height=512;\n[examples/01.02.01.02.jpg];type=image/jpg;width=512;height=512;\n[examples/01.02.01.03.jpg];type=image/jpg;width=512;height=512;\n[examples/01.02.02.jpg];type=image/jpg;width=512;height=512;\n[examples/01.03.01.jpg];type=image/jpg;width=512;height=512;\n[examples/01.03.02.jpg];type=image/jpg;width=512;height=512;\n[examples/01.04.01.jpg];type=image/jpg;width=512;height=512;\n[examples/01.04.02.jpg];type=image/jpg;width=512;height=512;\n[examples/01.04.03.jpg];type=image/jpg;width=512;height=512;\n[examples/01.04.04.jpg];type=image/jpg;width=512;height=512;\n[examples/01.05.01.jpg];type=image/jpg;width=512;height=384;\n[examples/01.05.02.jpg];type=image/jpg;width=512;height=512;\n[examples/01.05.03.jpg];type=image/jpg;width=512;height=512;\n[examples/01.06.01.jpg];type=image/jpg;width=512;height=512;\n[examples/01.06.02.jpg];type=image/jpg;width=512;height=377;\n[examples/01.06.03.jpg];type=image/jpg;width=512;height=512;\n[examples/01.06.04.jpg];type=image/jpg;width=512;height=512;\n[examples/02.00.01.jpg];type=image/jpg;width=512;height=512;\n[examples/02.00.02.jpg];type=image/jpg;width=512;height=512;\n[examples/02.00.03.jpg];type=image/jpg;width=512;height=512;\n[examples/02.00.04.jpg];type=image/jpg;width=512;height=512;\n[examples/02.01.01.jpg];type=image/jpg;width=512;height=512;\n[examples/02.01.02.jpg];type=image/jpg;width=512;height=512;\n[examples/02.02.01.jpg];type=image/jpg;width=512;height=512;\n[examples/02.02.02.jpg];type=image/jpg;width=512;height=512;\n[examples/02.02.03.jpg];type=image/jpg;width=512;height=512;\n[examples/02.03.01.jpg];type=image/jpg;width=512;height=512;\n[examples/02.03.02.jpg];type=image/jpg;width=512;height=512;\n[examples/02.03.03.jpg];type=image/jpg;width=512;height=512;\n[examples/02.04.01.jpg];type=image/jpg;width=512;height=512;\n[examples/02.04.02.jpg];type=image/jpg;width=512;height=512;\n[examples/02.04.03.jpg];type=image/jpg;width=512;height=512;\n[examples/02.04.04.jpg];type=image/jpg;width=512;height=512;\n[examples/03.00.01.jpg];type=image/jpg;width=512;height=512;\n[examples/03.00.02.jpg];type=image/jpg;width=512;height=512;\n[examples/03.00.03.jpg];type=image/jpg;width=512;height=512;\n[examples/03.00.04.jpg];type=image/jpg;width=512;height=512;\n[examples/03.01.01.jpg];type=image/jpg;width=512;height=512;\n[examples/03.01.02.jpg];type=image/jpg;width=512;height=512;\n[examples/03.01.03.jpg];type=image/jpg;width=512;height=512;\n[examples/03.01.04.jpg];type=image/jpg;width=512;height=512;\n[examples/03.01.05.jpg];type=image/jpg;width=512;height=512;\n[examples/03.01.06.jpg];type=image/jpg;width=512;height=512;\n[helper/000.png];type=image/png;width=256;height=256;\n[helper/001.png];type=image/png;width=256;height=256;\n[helper/002.png];type=image/png;width=256;height=256;\n[helper/003.png];type=image/png;width=256;height=256;\n[helper/004.png];type=image/png;width=256;height=256;\n[helper/005.png];type=image/png;width=256;height=256;\n[helper/006.png];type=image/png;width=256;height=256;\n[helper/helper1.png];type=image/png;width=512;height=512;\n[helper/helper1_0.png];type=image/png;width=320;height=320;\n[helper/helper1_1.png];type=image/png;width=320;height=320;\n[icone/Untitled-2.png];type=image/png;width=512;height=128;\n[icone/icon.png];type=image/png;width=640;height=128;\n[icone/icon2.png];type=image/png;width=512;height=128;\n[icone/icon3.png];type=image/png;width=640;height=128;\n[intro/background.jpg];type=image/jpg;width=1280;height=720;\n[menu/audio.png];type=image/png;width=128;height=64;\n[menu/background.jpg];type=image/jpg;width=1280;height=720;\n[menu/background_mobile.jpg];type=image/jpg;width=1280;height=960;\n[menu/check.png];type=image/png;width=32;height=16;\n[menu/check_1.png];type=image/png;width=32;height=16;\n[menu/flags.png];type=image/png;width=240;height=48;\n[menu/home.png];type=image/png;width=256;height=256;\n[menu/info.png];type=image/png;width=32;height=32;\n[menu/loader.png];type=image/png;width=256;height=256;\n[menu/login.png];type=image/png;width=256;height=128;\n[menu/logo.png];type=image/png;width=256;height=128;\n[menu/maschera.png];type=image/png;width=128;height=128;\n[menu/mouse_over.png];type=image/png;width=64;height=64;\n[menu/profile.png];type=image/png;width=128;height=64;\n[menu/refresh.png];type=image/png;width=256;height=256;\n[menu/rotate.png];type=image/png;width=64;height=64;\n[menu/scroll.png];type=image/png;width=128;height=64;\n[menu/star.png];type=image/png;width=128;height=128;\n[menu/verify.png];type=image/png;width=64;height=32;\n";
//${METADATA_END}

//${TRANSCODE_BEGIN}

// Javascript Cerberus runtime.
//
// Placed into the public domain 24/02/2011.
// No warranty implied; use at your own risk.

//***** JavaScript Runtime *****

var D2R=0.017453292519943295;
var R2D=57.29577951308232;

var err_info="";
var err_stack=[];

var dbg_index=0;

function push_err(){
	err_stack.push( err_info );
}

function pop_err(){
	err_info=err_stack.pop();
}

function stackTrace(){
	if( !err_info.length ) return "";
	var str=err_info+"\n";
	for( var i=err_stack.length-1;i>0;--i ){
		str+=err_stack[i]+"\n";
	}
	return str;
}

function print( str ){
	var cons=document.getElementById( "GameConsole" );
	if( cons ){
		cons.value+=str+"\n";
		cons.scrollTop=cons.scrollHeight-cons.clientHeight;
	}else if( window.console!=undefined ){
		window.console.log( str );
	}
	return 0;
}

function alertError( err ){
	if( typeof(err)=="string" && err=="" ) return;
	alert( "Cerberus Runtime Error : "+err.toString()+"\n\n"+stackTrace() );
}

function error( err ){
	throw err;
}

//function debugLog( str ){
//	if( window.console!=undefined ) window.console.log( str );
//}

function debugLog( str ){
	var cons=document.getElementById( "GameConsole" );
	if( cons ){
		cons.value+=str+"\n";
		cons.scrollTop=cons.scrollHeight-cons.clientHeight;
	}else if( window.console!=undefined ){
		window.console.log( str );
	}
	return 0;
}

function debugStop(){
	debugger;	//	error( "STOP" );
}

function dbg_object( obj ){
	if( obj ) return obj;
	error( "Null object access" );
}

function dbg_charCodeAt( str,index ){
	if( index<0 || index>=str.length ) error( "Character index out of range" );
	return str.charCodeAt( index );
}

function dbg_array( arr,index ){
	if( index<0 || index>=arr.length ) error( "Array index out of range" );
	dbg_index=index;
	return arr;
}

function new_bool_array( len ){
	var arr=Array( len );
	for( var i=0;i<len;++i ) arr[i]=false;
	return arr;
}

function new_number_array( len ){
	var arr=Array( len );
	for( var i=0;i<len;++i ) arr[i]=0;
	return arr;
}

function new_string_array( len ){
	var arr=Array( len );
	for( var i=0;i<len;++i ) arr[i]='';
	return arr;
}

function new_array_array( len ){
	var arr=Array( len );
	for( var i=0;i<len;++i ) arr[i]=[];
	return arr;
}

function new_object_array( len ){
	var arr=Array( len );
	for( var i=0;i<len;++i ) arr[i]=null;
	return arr;
}

function resize_bool_array( arr,len ){
	var i=arr.length;
	arr=arr.slice(0,len);
	if( len<=i ) return arr;
	arr.length=len;
	while( i<len ) arr[i++]=false;
	return arr;
}

function resize_number_array( arr,len ){
	var i=arr.length;
	arr=arr.slice(0,len);
	if( len<=i ) return arr;
	arr.length=len;
	while( i<len ) arr[i++]=0;
	return arr;
}

function resize_string_array( arr,len ){
	var i=arr.length;
	arr=arr.slice(0,len);
	if( len<=i ) return arr;
	arr.length=len;
	while( i<len ) arr[i++]="";
	return arr;
}

function resize_array_array( arr,len ){
	var i=arr.length;
	arr=arr.slice(0,len);
	if( len<=i ) return arr;
	arr.length=len;
	while( i<len ) arr[i++]=[];
	return arr;
}

function resize_object_array( arr,len ){
	var i=arr.length;
	arr=arr.slice(0,len);
	if( len<=i ) return arr;
	arr.length=len;
	while( i<len ) arr[i++]=null;
	return arr;
}

function string_compare( lhs,rhs ){
	var n=Math.min( lhs.length,rhs.length ),i,t;
	for( i=0;i<n;++i ){
		t=lhs.charCodeAt(i)-rhs.charCodeAt(i);
		if( t ) return t;
	}
	return lhs.length-rhs.length;
}

function string_replace( str,find,rep ){	//no unregex replace all?!?
	var i=0;
	for(;;){
		i=str.indexOf( find,i );
		if( i==-1 ) return str;
		str=str.substring( 0,i )+rep+str.substring( i+find.length );
		i+=rep.length;
	}
}

function string_trim( str ){
	var i=0,i2=str.length;
	while( i<i2 && str.charCodeAt(i)<=32 ) i+=1;
	while( i2>i && str.charCodeAt(i2-1)<=32 ) i2-=1;
	return str.slice( i,i2 );
}

function string_startswith( str,substr ){
	return substr.length<=str.length && str.slice(0,substr.length)==substr;
}

function string_endswith( str,substr ){
	return substr.length<=str.length && str.slice(str.length-substr.length,str.length)==substr;
}

function string_tochars( str ){
	var arr=new Array( str.length );
	for( var i=0;i<str.length;++i ) arr[i]=str.charCodeAt(i);
	return arr;
}

function string_fromchars( chars ){
	var str="",i;
	for( i=0;i<chars.length;++i ){
		str+=String.fromCharCode( chars[i] );
	}
	return str;
}

function object_downcast( obj,clas ){
	if( obj instanceof clas ) return obj;
	return null;
}

function object_implements( obj,iface ){
	if( obj && obj.implments && obj.implments[iface] ) return obj;
	return null;
}

function extend_class( clas ){
	var tmp=function(){};
	tmp.prototype=clas.prototype;
	return new tmp;
}

function ThrowableObject(){
}

ThrowableObject.prototype.toString=function(){ 
	return "Uncaught Cerberus Exception"; 
}


function BBGameEvent(){}
BBGameEvent.KeyDown=1;
BBGameEvent.KeyUp=2;
BBGameEvent.KeyChar=3;
BBGameEvent.MouseDown=4;
BBGameEvent.MouseUp=5;
BBGameEvent.MouseMove=6;
BBGameEvent.TouchDown=7;
BBGameEvent.TouchUp=8;
BBGameEvent.TouchMove=9;
BBGameEvent.MotionAccel=10;

function BBGameDelegate(){}
BBGameDelegate.prototype.StartGame=function(){}
BBGameDelegate.prototype.SuspendGame=function(){}
BBGameDelegate.prototype.ResumeGame=function(){}
BBGameDelegate.prototype.UpdateGame=function(){}
BBGameDelegate.prototype.RenderGame=function(){}
BBGameDelegate.prototype.KeyEvent=function( ev,data ){}
BBGameDelegate.prototype.MouseEvent=function( ev,data,x,y,z ){}
BBGameDelegate.prototype.TouchEvent=function( ev,data,x,y ){}
BBGameDelegate.prototype.MotionEvent=function( ev,data,x,y,z ){}
BBGameDelegate.prototype.DiscardGraphics=function(){}

function BBDisplayMode( width,height ){
	this.width=width;
	this.height=height;
}

function BBGame(){
	BBGame._game=this;
	this._delegate=null;
	this._keyboardEnabled=false;
	this._updateRate=0;
	this._started=false;
	this._suspended=false;
	this._debugExs=(CFG_CONFIG=="debug");
	this._startms=Date.now();
}

BBGame.Game=function(){
	return BBGame._game;
}

BBGame.prototype.SetDelegate=function( delegate ){
	this._delegate=delegate;
}

BBGame.prototype.Delegate=function(){
	return this._delegate;
}

BBGame.prototype.SetUpdateRate=function( updateRate ){
	this._updateRate=updateRate;
}

BBGame.prototype.SetKeyboardEnabled=function( keyboardEnabled ){
	this._keyboardEnabled=keyboardEnabled;
}

BBGame.prototype.Started=function(){
	return this._started;
}

BBGame.prototype.Suspended=function(){
	return this._suspended;
}

BBGame.prototype.Millisecs=function(){
	return Date.now()-this._startms;
}

BBGame.prototype.GetDate=function( date ){
	var n=date.length;
	if( n>0 ){
		var t=new Date();
		date[0]=t.getFullYear();
		if( n>1 ){
			date[1]=t.getMonth()+1;
			if( n>2 ){
				date[2]=t.getDate();
				if( n>3 ){
					date[3]=t.getHours();
					if( n>4 ){
						date[4]=t.getMinutes();
						if( n>5 ){
							date[5]=t.getSeconds();
							if( n>6 ){
								date[6]=t.getMilliseconds();
							}
						}
					}
				}
			}
		}
	}
}

BBGame.prototype.SaveState=function( state ){
	localStorage.setItem( "cerberusstate@"+document.URL,state );	//key can't start with dot in Chrome!
	return 1;
}

BBGame.prototype.LoadState=function(){
	var state=localStorage.getItem( "cerberusstate@"+document.URL );
	if( state ) return state;
	return "";
}

BBGame.prototype.LoadString=function( path ){

	var xhr=new XMLHttpRequest();
	xhr.open( "GET",this.PathToUrl( path ),false );
	
//	if( navigator.userAgent.indexOf( "Chrome/48." )>0 ){
//		xhr.setRequestHeader( "If-Modified-Since","Sat, 1 Jan 2000 00:00:00 GMT" );
//	}
	
	xhr.send( null );
	
	if( xhr.status==200 || xhr.status==0 ) return xhr.responseText;
	
	return "";
}

BBGame.prototype.CountJoysticks=function( update ){
	return 0;
}

BBGame.prototype.PollJoystick=function( port,joyx,joyy,joyz,buttons ){
	return false;
}

BBGame.prototype.OpenUrl=function( url ){
	window.location=url;
}

BBGame.prototype.SetMouseVisible=function( visible ){
	if( visible ){
		this._canvas.style.cursor='default';	
	}else{
		this._canvas.style.cursor="url('data:image/cur;base64,AAACAAEAICAAAAAAAACoEAAAFgAAACgAAAAgAAAAQAAAAAEAIAAAAAAAgBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA55ZXBgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOeWVxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADnllcGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9////////////////////+////////f/////////8%3D'), auto";
	}
}

BBGame.prototype.GetDeviceWidth=function(){
	return 0;
}

BBGame.prototype.GetDeviceHeight=function(){
	return 0;
}

BBGame.prototype.SetDeviceWindow=function( width,height,flags ){
}

BBGame.prototype.GetDisplayModes=function(){
	return new Array();
}

BBGame.prototype.GetDesktopMode=function(){
	return null;
}

BBGame.prototype.SetSwapInterval=function( interval ){
}

BBGame.prototype.PathToFilePath=function( path ){
	return "";
}

//***** js Game *****

BBGame.prototype.PathToUrl=function( path ){
	return path;
}

BBGame.prototype.LoadData=function( path ){

	var xhr=new XMLHttpRequest();
	xhr.open( "GET",this.PathToUrl( path ),false );

	if( xhr.overrideMimeType ) xhr.overrideMimeType( "text/plain; charset=x-user-defined" );
	
//	if( navigator.userAgent.indexOf( "Chrome/48." )>0 ){
//		xhr.setRequestHeader( "If-Modified-Since","Sat, 1 Jan 2000 00:00:00 GMT" );
//	}

	xhr.send( null );
	if( xhr.status!=200 && xhr.status!=0 ) return null;

	var r=xhr.responseText;
	var buf=new ArrayBuffer( r.length );
	var bytes=new Int8Array( buf );
	for( var i=0;i<r.length;++i ){
		bytes[i]=r.charCodeAt( i );
	}
	return buf;
}

//***** INTERNAL ******

BBGame.prototype.Die=function( ex ){

	this._delegate=new BBGameDelegate();
	
	if( !ex.toString() ){
		return;
	}
	
	if( this._debugExs ){
		print( "Cerberus Runtime Error : "+ex.toString() );
		print( stackTrace() );
	}
	
	throw ex;
}

BBGame.prototype.StartGame=function(){

	if( this._started ) return;
	this._started=true;
	
	if( this._debugExs ){
		try{
			this._delegate.StartGame();
		}catch( ex ){
			this.Die( ex );
		}
	}else{
		this._delegate.StartGame();
	}
}

BBGame.prototype.SuspendGame=function(){

	if( !this._started || this._suspended ) return;
	this._suspended=true;
	
	if( this._debugExs ){
		try{
			this._delegate.SuspendGame();
		}catch( ex ){
			this.Die( ex );
		}
	}else{
		this._delegate.SuspendGame();
	}
}

BBGame.prototype.ResumeGame=function(){

	if( !this._started || !this._suspended ) return;
	this._suspended=false;
	
	if( this._debugExs ){
		try{
			this._delegate.ResumeGame();
		}catch( ex ){
			this.Die( ex );
		}
	}else{
		this._delegate.ResumeGame();
	}
}

BBGame.prototype.UpdateGame=function(){

	if( !this._started || this._suspended ) return;

	if( this._debugExs ){
		try{
			this._delegate.UpdateGame();
		}catch( ex ){
			this.Die( ex );
		}	
	}else{
		this._delegate.UpdateGame();
	}
}

BBGame.prototype.RenderGame=function(){

	if( !this._started ) return;
	
	if( this._debugExs ){
		try{
			this._delegate.RenderGame();
		}catch( ex ){
			this.Die( ex );
		}	
	}else{
		this._delegate.RenderGame();
	}
}

BBGame.prototype.KeyEvent=function( ev,data ){

	if( !this._started ) return;
	
	if( this._debugExs ){
		try{
			this._delegate.KeyEvent( ev,data );
		}catch( ex ){
			this.Die( ex );
		}
	}else{
		this._delegate.KeyEvent( ev,data );
	}
}

BBGame.prototype.MouseEvent=function( ev,data,x,y,z ){

	if( !this._started ) return;
	
	if( this._debugExs ){
		try{
			this._delegate.MouseEvent( ev,data,x,y,z );
		}catch( ex ){
			this.Die( ex );
		}
	}else{
		this._delegate.MouseEvent( ev,data,x,y,z );
	}
}

BBGame.prototype.TouchEvent=function( ev,data,x,y ){

	if( !this._started ) return;
	
	if( this._debugExs ){
		try{
			this._delegate.TouchEvent( ev,data,x,y );
		}catch( ex ){
			this.Die( ex );
		}
	}else{
		this._delegate.TouchEvent( ev,data,x,y );
	}
}

BBGame.prototype.MotionEvent=function( ev,data,x,y,z ){

	if( !this._started ) return;
	
	if( this._debugExs ){
		try{
			this._delegate.MotionEvent( ev,data,x,y,z );
		}catch( ex ){
			this.Die( ex );
		}
	}else{
		this._delegate.MotionEvent( ev,data,x,y,z );
	}
}

BBGame.prototype.DiscardGraphics=function(){

	if( !this._started ) return;
	
	if( this._debugExs ){
		try{
			this._delegate.DiscardGraphics();
		}catch( ex ){
			this.Die( ex );
		}
	}else{
		this._delegate.DiscardGraphics();
	}
}


var webglGraphicsSeq=1;

function BBHtml5Game( canvas ){

	BBGame.call( this );
	BBHtml5Game._game=this;
	this._canvas=canvas;
	this._loading=0;
	this._timerSeq=0;
	this._gl=null;
	
	if( CFG_OPENGL_GLES20_ENABLED=="1" ){

		//can't get these to fire!
		canvas.addEventListener( "webglcontextlost",function( event ){
			event.preventDefault();
//			print( "WebGL context lost!" );
		},false );

		canvas.addEventListener( "webglcontextrestored",function( event ){
			++webglGraphicsSeq;
//			print( "WebGL context restored!" );
		},false );

		var attrs={ alpha:false };
	
		this._gl=this._canvas.getContext( "webgl",attrs );

		if( !this._gl ) this._gl=this._canvas.getContext( "experimental-webgl",attrs );
		
		if( !this._gl ) this.Die( "Can't create WebGL" );
		
		gl=this._gl;
	}
	
	// --- start gamepad api by skn3 ---------
	this._gamepads = null;
	this._gamepadLookup = [-1,-1,-1,-1];//support 4 gamepads
	var that = this;
	window.addEventListener("gamepadconnected", function(e) {
		that.connectGamepad(e.gamepad);
	});
	
	window.addEventListener("gamepaddisconnected", function(e) {
		that.disconnectGamepad(e.gamepad);
	});
	
	//need to process already connected gamepads (before page was loaded)
	var gamepads = this.getGamepads();
	if (gamepads && gamepads.length > 0) {
		for(var index=0;index < gamepads.length;index++) {
			this.connectGamepad(gamepads[index]);
		}
	}
	// --- end gamepad api by skn3 ---------
}

BBHtml5Game.prototype=extend_class( BBGame );

BBHtml5Game.Html5Game=function(){
	return BBHtml5Game._game;
}

// --- start gamepad api by skn3 ---------
BBHtml5Game.prototype.getGamepads = function() {
	return navigator.getGamepads ? navigator.getGamepads() : (navigator.webkitGetGamepads ? navigator.webkitGetGamepads : []);
}

BBHtml5Game.prototype.connectGamepad = function(gamepad) {
	if (!gamepad) {
		return false;
	}
	
	//check if this is a standard gamepad
	if (gamepad.mapping == "standard") {
		//yup so lets add it to an array of valid gamepads
		//find empty controller slot
		var slot = -1;
		for(var index = 0;index < this._gamepadLookup.length;index++) {
			if (this._gamepadLookup[index] == -1) {
				slot = index;
				break;
			}
		}
		
		//can we add this?
		if (slot != -1) {
			this._gamepadLookup[slot] = gamepad.index;
			
			//console.log("gamepad at html5 index "+gamepad.index+" mapped to Cerberus gamepad unit "+slot);
		}
	} else {
		console.log('Cerberus has ignored gamepad at raw port #'+gamepad.index+' with unrecognised mapping scheme \''+gamepad.mapping+'\'.');
	}
}

BBHtml5Game.prototype.disconnectGamepad = function(gamepad) {
	if (!gamepad) {
		return false;
	}
	
	//scan all gamepads for matching index
	for(var index = 0;index < this._gamepadLookup.length;index++) {
		if (this._gamepadLookup[index] == gamepad.index) {
			//remove this gamepad
			this._gamepadLookup[index] = -1
			break;
		}
	}
}

BBHtml5Game.prototype.PollJoystick=function(port, joyx, joyy, joyz, buttons){
	//is this the first gamepad being polled
	if (port == 0) {
		//yes it is so we use the web api to get all gamepad info
		//we can then use this in subsequent calls to PollJoystick
		this._gamepads = this.getGamepads();
	}
	
	//dont bother processing if nothing to process
	if (!this._gamepads) {
	  return false;
	}
	
	//so use the Cerberus port to find the correct raw data
	var index = this._gamepadLookup[port];
	if (index == -1) {
		return false;
	}

	var gamepad = this._gamepads[index];
	if (!gamepad) {
		return false;
	}
	//so now process gamepad axis/buttons according to the standard mappings
	//https://w3c.github.io/gamepad/#remapping
	
	//left stick axis
	joyx[0] = gamepad.axes[0];
	joyy[0] = -gamepad.axes[1];
	
	//right stick axis
	joyx[1] = gamepad.axes[2];
	joyy[1] = -gamepad.axes[3];
	
	//left trigger
	joyz[0] = gamepad.buttons[6] ? gamepad.buttons[6].value : 0.0;
	
	//right trigger
	joyz[1] = gamepad.buttons[7] ? gamepad.buttons[7].value : 0.0;
	
	//clear button states
	for(var index = 0;index <32;index++) {
		buttons[index] = false;
	}
	
	//map html5 "standard" mapping to Cerberuss joy codes
	/*
	Const JOY_A=0
	Const JOY_B=1
	Const JOY_X=2
	Const JOY_Y=3
	Const JOY_LB=4
	Const JOY_RB=5
	Const JOY_BACK=6
	Const JOY_START=7
	Const JOY_LEFT=8
	Const JOY_UP=9
	Const JOY_RIGHT=10
	Const JOY_DOWN=11
	Const JOY_LSB=12
	Const JOY_RSB=13
	Const JOY_MENU=14
	*/
	buttons[0] = gamepad.buttons[0] && gamepad.buttons[0].pressed;
	buttons[1] = gamepad.buttons[1] && gamepad.buttons[1].pressed;
	buttons[2] = gamepad.buttons[2] && gamepad.buttons[2].pressed;
	buttons[3] = gamepad.buttons[3] && gamepad.buttons[3].pressed;
	buttons[4] = gamepad.buttons[4] && gamepad.buttons[4].pressed;
	buttons[5] = gamepad.buttons[5] && gamepad.buttons[5].pressed;
	buttons[6] = gamepad.buttons[8] && gamepad.buttons[8].pressed;
	buttons[7] = gamepad.buttons[9] && gamepad.buttons[9].pressed;
	buttons[8] = gamepad.buttons[14] && gamepad.buttons[14].pressed;
	buttons[9] = gamepad.buttons[12] && gamepad.buttons[12].pressed;
	buttons[10] = gamepad.buttons[15] && gamepad.buttons[15].pressed;
	buttons[11] = gamepad.buttons[13] && gamepad.buttons[13].pressed;
	buttons[12] = gamepad.buttons[10] && gamepad.buttons[10].pressed;
	buttons[13] = gamepad.buttons[11] && gamepad.buttons[11].pressed;
	buttons[14] = gamepad.buttons[16] && gamepad.buttons[16].pressed;
	
	//success
	return true
}
// --- end gamepad api by skn3 ---------


BBHtml5Game.prototype.ValidateUpdateTimer=function(){

	++this._timerSeq;
	if( this._suspended ) return;
	
	var game=this;
	var seq=game._timerSeq;
	
	var maxUpdates=4;
	var updateRate=this._updateRate;
	
	if( !updateRate ){

		var reqAnimFrame=(window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame);
	
		if( reqAnimFrame ){
			function animate(){
				if( seq!=game._timerSeq ) return;
	
				game.UpdateGame();
				if( seq!=game._timerSeq ) return;
	
				reqAnimFrame( animate );
				game.RenderGame();
			}
			reqAnimFrame( animate );
			return;
		}
		
		maxUpdates=1;
		updateRate=60;
	}
	
	var updatePeriod=1000.0/updateRate;
	var nextUpdate=0;

	function timeElapsed(){
		if( seq!=game._timerSeq ) return;
		
		if( !nextUpdate ) nextUpdate=Date.now();
		
		for( var i=0;i<maxUpdates;++i ){
		
			game.UpdateGame();
			if( seq!=game._timerSeq ) return;
			
			nextUpdate+=updatePeriod;
			var delay=nextUpdate-Date.now();
			
			if( delay>0 ){
				setTimeout( timeElapsed,delay );
				game.RenderGame();
				return;
			}
		}
		nextUpdate=0;
		setTimeout( timeElapsed,0 );
		game.RenderGame();
	}

	setTimeout( timeElapsed,0 );
}

//***** BBGame methods *****

BBHtml5Game.prototype.SetUpdateRate=function( updateRate ){

	BBGame.prototype.SetUpdateRate.call( this,updateRate );
	
	this.ValidateUpdateTimer();
}

BBHtml5Game.prototype.GetMetaData=function( path,key ){
	if( path.indexOf( "cerberus://data/" )!=0 ) return "";
	path=path.slice(16);

	var i=META_DATA.indexOf( "["+path+"]" );
	if( i==-1 ) return "";
	i+=path.length+2;

	var e=META_DATA.indexOf( "\n",i );
	if( e==-1 ) e=META_DATA.length;

	i=META_DATA.indexOf( ";"+key+"=",i )
	if( i==-1 || i>=e ) return "";
	i+=key.length+2;

	e=META_DATA.indexOf( ";",i );
	if( e==-1 ) return "";

	return META_DATA.slice( i,e );
}

BBHtml5Game.prototype.PathToUrl=function( path ){
	if( path.indexOf( "cerberus:" )!=0 ){
		return path;
	}else if( path.indexOf( "cerberus://data/" )==0 ) {
		return "data/"+path.slice( 16 );
	}
	return "";
}

BBHtml5Game.prototype.GetLoading=function(){
	return this._loading;
}

BBHtml5Game.prototype.IncLoading=function(){
	++this._loading;
	return this._loading;
}

BBHtml5Game.prototype.DecLoading=function(){
	--this._loading;
	return this._loading;
}

BBHtml5Game.prototype.GetCanvas=function(){
	return this._canvas;
}

BBHtml5Game.prototype.GetWebGL=function(){
	return this._gl;
}

BBHtml5Game.prototype.GetDeviceWidth=function(){
	return this._canvas.width;
}

BBHtml5Game.prototype.GetDeviceHeight=function(){
	return this._canvas.height;
}

//***** INTERNAL *****

BBHtml5Game.prototype.UpdateGame=function(){

	if( !this._loading ) BBGame.prototype.UpdateGame.call( this );
}

BBHtml5Game.prototype.SuspendGame=function(){

	BBGame.prototype.SuspendGame.call( this );
	
	BBGame.prototype.RenderGame.call( this );
	
	this.ValidateUpdateTimer();
}

BBHtml5Game.prototype.ResumeGame=function(){

	BBGame.prototype.ResumeGame.call( this );
	
	this.ValidateUpdateTimer();
}

BBHtml5Game.prototype.Run=function(){

	var game=this;
	var canvas=game._canvas;
	
	var xscale=1;
	var yscale=1;
	
	var touchIds=new Array( 32 );
	for( i=0;i<32;++i ) touchIds[i]=-1;
	
	function eatEvent( e ){
		if( e.stopPropagation ){
			e.stopPropagation();
			e.preventDefault();
		}else{
			e.cancelBubble=true;
			e.returnValue=false;
		}
	}
	
	function keyToChar( key ){
		switch( key ){
		case 8:case 9:case 13:case 27:case 32:return key;
		case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 45:return key|0x10000;
		case 46:return 127;
		}
		return 0;
	}
	
	function mouseX( e ){
		var x=e.clientX+document.body.scrollLeft;
		var c=canvas;
		while( c ){
			x-=c.offsetLeft;
			c=c.offsetParent;
		}
		return x*xscale;
	}
	
	function mouseY( e ){
		var y=e.clientY+document.body.scrollTop;
		var c=canvas;
		while( c ){
			y-=c.offsetTop;
			c=c.offsetParent;
		}
		return y*yscale;
	}

	function touchX( touch ){
		var x=touch.pageX;
		var c=canvas;
		while( c ){
			x-=c.offsetLeft;
			c=c.offsetParent;
		}
		return x*xscale;
	}			
	
	function touchY( touch ){
		var y=touch.pageY;
		var c=canvas;
		while( c ){
			y-=c.offsetTop;
			c=c.offsetParent;
		}
		return y*yscale;
	}
	
	canvas.onkeydown=function( e ){
		game.KeyEvent( BBGameEvent.KeyDown,e.keyCode );
		var chr=keyToChar( e.keyCode );
		if( chr ) game.KeyEvent( BBGameEvent.KeyChar,chr );
		if( e.keyCode<48 || (e.keyCode>111 && e.keyCode<122) ) eatEvent( e );
	}

	canvas.onkeyup=function( e ){
		game.KeyEvent( BBGameEvent.KeyUp,e.keyCode );
	}

	canvas.onkeypress=function( e ){
		if( e.charCode ){
			game.KeyEvent( BBGameEvent.KeyChar,e.charCode );
		}else if( e.which ){
			game.KeyEvent( BBGameEvent.KeyChar,e.which );
		}
	}

	canvas.onmousedown=function( e ){
		switch( e.button ){
		case 0:game.MouseEvent( BBGameEvent.MouseDown,0,mouseX(e),mouseY(e) );break;
		case 1:game.MouseEvent( BBGameEvent.MouseDown,2,mouseX(e),mouseY(e) );break;
		case 2:game.MouseEvent( BBGameEvent.MouseDown,1,mouseX(e),mouseY(e) );break;
		}
		eatEvent( e );
	}
	
	canvas.onmouseup=function( e ){
		switch( e.button ){
		case 0:game.MouseEvent( BBGameEvent.MouseUp,0,mouseX(e),mouseY(e) );break;
		case 1:game.MouseEvent( BBGameEvent.MouseUp,2,mouseX(e),mouseY(e) );break;
		case 2:game.MouseEvent( BBGameEvent.MouseUp,1,mouseX(e),mouseY(e) );break;
		}
		eatEvent( e );
	}
	
	canvas.onmousemove=function( e ){
		game.MouseEvent( BBGameEvent.MouseMove,-1,mouseX(e),mouseY(e),0 );
		eatEvent( e );
	}

	canvas.onmouseout=function( e ){
		game.MouseEvent( BBGameEvent.MouseUp,0,mouseX(e),mouseY(e) );
		game.MouseEvent( BBGameEvent.MouseUp,1,mouseX(e),mouseY(e) );
		game.MouseEvent( BBGameEvent.MouseUp,2,mouseX(e),mouseY(e) );
		eatEvent( e );
	}
	
	canvas.onclick=function( e ){
		if( game.Suspended() ){
			canvas.focus();
		}
		eatEvent( e );
		return;
	}
	
	canvas.oncontextmenu=function( e ){
		return false;
	}
	
	canvas.ontouchstart=function( e ){
		if( game.Suspended() ){
			canvas.focus();
		}
		for( var i=0;i<e.changedTouches.length;++i ){
			var touch=e.changedTouches[i];
			for( var j=0;j<32;++j ){
				if( touchIds[j]!=-1 ) continue;
				touchIds[j]=touch.identifier;
				game.TouchEvent( BBGameEvent.TouchDown,j,touchX(touch),touchY(touch) );
				break;
			}
		}
		eatEvent( e );
	}
	
	canvas.ontouchmove=function( e ){
		for( var i=0;i<e.changedTouches.length;++i ){
			var touch=e.changedTouches[i];
			for( var j=0;j<32;++j ){
				if( touchIds[j]!=touch.identifier ) continue;
				game.TouchEvent( BBGameEvent.TouchMove,j,touchX(touch),touchY(touch) );
				break;
			}
		}
		eatEvent( e );
	}
	
	canvas.ontouchend=function( e ){
		for( var i=0;i<e.changedTouches.length;++i ){
			var touch=e.changedTouches[i];
			for( var j=0;j<32;++j ){
				if( touchIds[j]!=touch.identifier ) continue;
				touchIds[j]=-1;
				game.TouchEvent( BBGameEvent.TouchUp,j,touchX(touch),touchY(touch) );
				break;
			}
		}
		eatEvent( e );
	}
	
	window.ondevicemotion=function( e ){
		var tx=e.accelerationIncludingGravity.x/9.81;
		var ty=e.accelerationIncludingGravity.y/9.81;
		var tz=e.accelerationIncludingGravity.z/9.81;
		var x,y;
		switch( window.orientation ){
		case   0:x=+tx;y=-ty;break;
		case 180:x=-tx;y=+ty;break;
		case  90:x=-ty;y=-tx;break;
		case -90:x=+ty;y=+tx;break;
		}
		game.MotionEvent( BBGameEvent.MotionAccel,0,x,y,tz );
		eatEvent( e );
	}

	canvas.onfocus=function( e ){
		if( CFG_MOJO_AUTO_SUSPEND_ENABLED=="1" ){
			game.ResumeGame();
		}else{
			game.ValidateUpdateTimer();
		}
	}
	
	canvas.onblur=function( e ){
		for( var i=0;i<256;++i ) game.KeyEvent( BBGameEvent.KeyUp,i );
		if( CFG_MOJO_AUTO_SUSPEND_ENABLED=="1" ){
			game.SuspendGame();
		}
	}

	canvas.updateSize=function(){
		xscale=canvas.width/canvas.clientWidth;
		yscale=canvas.height/canvas.clientHeight;
		game.RenderGame();
	}
	
	canvas.updateSize();
	
	canvas.focus();
	
	game.StartGame();
	
	game.RenderGame();
}


function BBCerberusGame( canvas ){
	BBHtml5Game.call( this,canvas );
}

BBCerberusGame.prototype=extend_class( BBHtml5Game );

BBCerberusGame.Main=function( canvas ){

	var game=new BBCerberusGame( canvas );

	try{

		bbInit();
		bbMain();

	}catch( ex ){
	
		game.Die( ex );
		return;
	}

	if( !game.Delegate() ) return;
	
	game.Run();
}


// HTML5 mojo runtime.
//
// Copyright 2011 Mark Sibly, all rights reserved.
// No warranty implied; use at your own risk.

// ***** gxtkGraphics class *****

function gxtkGraphics(){
	this.game=BBHtml5Game.Html5Game();
	this.canvas=this.game.GetCanvas()
	this.width=this.canvas.width;
	this.height=this.canvas.height;
	this.gl=null;
	this.gc=this.canvas.getContext( '2d' );
	this.tmpCanvas=null;
	this.r=255;
	this.b=255;
	this.g=255;
	this.white=true;
	this.color="rgb(255,255,255)"
	this.alpha=1;
	this.blend="source-over";
	this.ix=1;this.iy=0;
	this.jx=0;this.jy=1;
	this.tx=0;this.ty=0;
	this.tformed=false;
	this.scissorX=0;
	this.scissorY=0;
	this.scissorWidth=0;
	this.scissorHeight=0;
	this.clipped=false;
}

gxtkGraphics.prototype.BeginRender=function(){
	this.width=this.canvas.width;
	this.height=this.canvas.height;
	if( !this.gc ) return 0;
	this.gc.save();
	if( this.game.GetLoading() ) return 2;
	return 1;
}

gxtkGraphics.prototype.EndRender=function(){
	if( this.gc ) this.gc.restore();
}

gxtkGraphics.prototype.Width=function(){
	return this.width;
}

gxtkGraphics.prototype.Height=function(){
	return this.height;
}

gxtkGraphics.prototype.LoadSurface=function( path ){
	var game=this.game;

	var ty=game.GetMetaData( path,"type" );
	if( ty.indexOf( "image/" )!=0 ) return null;
	
	game.IncLoading();

	var image=new Image();
	image.onload=function(){ game.DecLoading(); }
	image.onerror=function(){ game.DecLoading(); }
	image.meta_width=parseInt( game.GetMetaData( path,"width" ) );
	image.meta_height=parseInt( game.GetMetaData( path,"height" ) );
	image.src=game.PathToUrl( path );

	return new gxtkSurface( image,this );
}

gxtkGraphics.prototype.CreateSurface=function( width,height ){
	var canvas=document.createElement( 'canvas' );
	
	canvas.width=width;
	canvas.height=height;
	canvas.meta_width=width;
	canvas.meta_height=height;
	canvas.complete=true;
	
	var surface=new gxtkSurface( canvas,this );
	
	surface.gc=canvas.getContext( '2d' );
	
	return surface;
}

gxtkGraphics.prototype.SetAlpha=function( alpha ){
	this.alpha=alpha;
	this.gc.globalAlpha=alpha;
}

gxtkGraphics.prototype.SetColor=function( r,g,b ){
	this.r=r;
	this.g=g;
	this.b=b;
	this.white=(r==255 && g==255 && b==255);
	this.color="rgb("+(r|0)+","+(g|0)+","+(b|0)+")";
	this.gc.fillStyle=this.color;
	this.gc.strokeStyle=this.color;
}

gxtkGraphics.prototype.SetBlend=function( blend ){
	switch( blend ){
	case 1:
		this.blend="lighter";
		break;
	default:
		this.blend="source-over";
	}
	this.gc.globalCompositeOperation=this.blend;
}

gxtkGraphics.prototype.SetScissor=function( x,y,w,h ){
	this.scissorX=x;
	this.scissorY=y;
	this.scissorWidth=w;
	this.scissorHeight=h;
	this.clipped=(x!=0 || y!=0 || w!=this.canvas.width || h!=this.canvas.height);
	this.gc.restore();
	this.gc.save();
	if( this.clipped ){
		this.gc.beginPath();
		this.gc.rect( x,y,w,h );
		this.gc.clip();
		this.gc.closePath();
	}
	this.gc.fillStyle=this.color;
	this.gc.strokeStyle=this.color;	
	this.gc.globalAlpha=this.alpha;	
	this.gc.globalCompositeOperation=this.blend;
	if( this.tformed ) this.gc.setTransform( this.ix,this.iy,this.jx,this.jy,this.tx,this.ty );
}

gxtkGraphics.prototype.SetMatrix=function( ix,iy,jx,jy,tx,ty ){
	this.ix=ix;this.iy=iy;
	this.jx=jx;this.jy=jy;
	this.tx=tx;this.ty=ty;
	this.gc.setTransform( ix,iy,jx,jy,tx,ty );
	this.tformed=(ix!=1 || iy!=0 || jx!=0 || jy!=1 || tx!=0 || ty!=0);
}

gxtkGraphics.prototype.Cls=function( r,g,b ){
	if( this.tformed ) this.gc.setTransform( 1,0,0,1,0,0 );
	this.gc.fillStyle="rgb("+(r|0)+","+(g|0)+","+(b|0)+")";
	this.gc.globalAlpha=1;
	this.gc.globalCompositeOperation="source-over";
	this.gc.fillRect( 0,0,this.canvas.width,this.canvas.height );
	this.gc.fillStyle=this.color;
	this.gc.globalAlpha=this.alpha;
	this.gc.globalCompositeOperation=this.blend;
	if( this.tformed ) this.gc.setTransform( this.ix,this.iy,this.jx,this.jy,this.tx,this.ty );
}

gxtkGraphics.prototype.DrawPoint=function( x,y ){
	if( this.tformed ){
		var px=x;
		x=px * this.ix + y * this.jx + this.tx;
		y=px * this.iy + y * this.jy + this.ty;
		this.gc.setTransform( 1,0,0,1,0,0 );
		this.gc.fillRect( x,y,1,1 );
		this.gc.setTransform( this.ix,this.iy,this.jx,this.jy,this.tx,this.ty );
	}else{
		this.gc.fillRect( x,y,1,1 );
	}
}

gxtkGraphics.prototype.DrawRect=function( x,y,w,h ){
	if( w<0 ){ x+=w;w=-w; }
	if( h<0 ){ y+=h;h=-h; }
	if( w<=0 || h<=0 ) return;
	//
	this.gc.fillRect( x,y,w,h );
}

gxtkGraphics.prototype.DrawLine=function( x1,y1,x2,y2 ){
	if( this.tformed ){
		var x1_t=x1 * this.ix + y1 * this.jx + this.tx;
		var y1_t=x1 * this.iy + y1 * this.jy + this.ty;
		var x2_t=x2 * this.ix + y2 * this.jx + this.tx;
		var y2_t=x2 * this.iy + y2 * this.jy + this.ty;
		this.gc.setTransform( 1,0,0,1,0,0 );
	  	this.gc.beginPath();
	  	this.gc.moveTo( x1_t,y1_t );
	  	this.gc.lineTo( x2_t,y2_t );
	  	this.gc.stroke();
	  	this.gc.closePath();
		this.gc.setTransform( this.ix,this.iy,this.jx,this.jy,this.tx,this.ty );
	}else{
	  	this.gc.beginPath();
	  	this.gc.moveTo( x1,y1 );
	  	this.gc.lineTo( x2,y2 );
	  	this.gc.stroke();
	  	this.gc.closePath();
	}
}

gxtkGraphics.prototype.DrawOval=function( x,y,w,h ){
	if( w<0 ){ x+=w;w=-w; }
	if( h<0 ){ y+=h;h=-h; }
	if( w<=0 || h<=0 ) return;
	//
  	var w2=w/2,h2=h/2;
	this.gc.save();
	this.gc.translate( x+w2,y+h2 );
	this.gc.scale( w2,h2 );
  	this.gc.beginPath();
	this.gc.arc( 0,0,1,0,Math.PI*2,false );
	this.gc.fill();
  	this.gc.closePath();
	this.gc.restore();
}

gxtkGraphics.prototype.DrawPoly=function( verts ){
	if( verts.length<2 ) return;
	this.gc.beginPath();
	this.gc.moveTo( verts[0],verts[1] );
	for( var i=2;i<verts.length;i+=2 ){
		this.gc.lineTo( verts[i],verts[i+1] );
	}
	this.gc.fill();
	this.gc.closePath();
}

gxtkGraphics.prototype.DrawPoly2=function( verts,surface,srx,srcy ){
	if( verts.length<4 ) return;
	this.gc.beginPath();
	this.gc.moveTo( verts[0],verts[1] );
	for( var i=4;i<verts.length;i+=4 ){
		this.gc.lineTo( verts[i],verts[i+1] );
	}
	this.gc.fill();
	this.gc.closePath();
}

gxtkGraphics.prototype.DrawSurface=function( surface,x,y ){
	if( !surface.image.complete ) return;
	
	if( this.white ){
		this.gc.drawImage( surface.image,x,y );
		return;
	}
	
	this.DrawImageTinted( surface.image,x,y,0,0,surface.swidth,surface.sheight );
}

gxtkGraphics.prototype.DrawSurface2=function( surface,x,y,srcx,srcy,srcw,srch ){
	if( !surface.image.complete ) return;

	if( srcw<0 ){ srcx+=srcw;srcw=-srcw; }
	if( srch<0 ){ srcy+=srch;srch=-srch; }
	if( srcw<=0 || srch<=0 ) return;

	if( this.white ){
		this.gc.drawImage( surface.image,srcx,srcy,srcw,srch,x,y,srcw,srch );
		return;
	}
	
	this.DrawImageTinted( surface.image,x,y,srcx,srcy,srcw,srch  );
}

gxtkGraphics.prototype.DrawImageTinted=function( image,dx,dy,sx,sy,sw,sh ){

	if( !this.tmpCanvas ){
		this.tmpCanvas=document.createElement( "canvas" );
	}

	if( sw>this.tmpCanvas.width || sh>this.tmpCanvas.height ){
		this.tmpCanvas.width=Math.max( sw,this.tmpCanvas.width );
		this.tmpCanvas.height=Math.max( sh,this.tmpCanvas.height );
	}
	
	var tmpGC=this.tmpCanvas.getContext( "2d" );
	tmpGC.globalCompositeOperation="copy";
	
	tmpGC.drawImage( image,sx,sy,sw,sh,0,0,sw,sh );
	
	var imgData=tmpGC.getImageData( 0,0,sw,sh );
	
	var p=imgData.data,sz=sw*sh*4,i;
	
	for( i=0;i<sz;i+=4 ){
		p[i]=p[i]*this.r/255;
		p[i+1]=p[i+1]*this.g/255;
		p[i+2]=p[i+2]*this.b/255;
	}
	
	tmpGC.putImageData( imgData,0,0 );
	
	this.gc.drawImage( this.tmpCanvas,0,0,sw,sh,dx,dy,sw,sh );
}

gxtkGraphics.prototype.ReadPixels=function( pixels,x,y,width,height,offset,pitch ){

	var imgData=this.gc.getImageData( x,y,width,height );
	
	var p=imgData.data,i=0,j=offset,px,py;
	
	for( py=0;py<height;++py ){
		for( px=0;px<width;++px ){
			pixels[j++]=(p[i+3]<<24)|(p[i]<<16)|(p[i+1]<<8)|p[i+2];
			i+=4;
		}
		j+=pitch-width;
	}
}

gxtkGraphics.prototype.WritePixels2=function( surface,pixels,x,y,width,height,offset,pitch ){

	if( !surface.gc ){
		if( !surface.image.complete ) return;
		var canvas=document.createElement( "canvas" );
		canvas.width=surface.swidth;
		canvas.height=surface.sheight;
		surface.gc=canvas.getContext( "2d" );
		surface.gc.globalCompositeOperation="copy";
		surface.gc.drawImage( surface.image,0,0 );
		surface.image=canvas;
	}

	var imgData=surface.gc.createImageData( width,height );

	var p=imgData.data,i=0,j=offset,px,py,argb;
	
	for( py=0;py<height;++py ){
		for( px=0;px<width;++px ){
			argb=pixels[j++];
			p[i]=(argb>>16) & 0xff;
			p[i+1]=(argb>>8) & 0xff;
			p[i+2]=argb & 0xff;
			p[i+3]=(argb>>24) & 0xff;
			i+=4;
		}
		j+=pitch-width;
	}
	
	surface.gc.putImageData( imgData,x,y );
}

// ***** gxtkSurface class *****

function gxtkSurface( image,graphics ){
	this.image=image;
	this.graphics=graphics;
	this.swidth=image.meta_width;
	this.sheight=image.meta_height;
}

// ***** GXTK API *****

gxtkSurface.prototype.Discard=function(){
	if( this.image ){
		this.image=null;
	}
}

gxtkSurface.prototype.Width=function(){
	return this.swidth;
}

gxtkSurface.prototype.Height=function(){
	return this.sheight;
}

gxtkSurface.prototype.Loaded=function(){
	return this.image.complete;
}

gxtkSurface.prototype.OnUnsafeLoadComplete=function(){
}

if( CFG_HTML5_WEBAUDIO_ENABLED=="1" && (window.AudioContext || window.webkitAudioContext) ){

//print( "Using WebAudio!" );

// ***** WebAudio *****

var wa=null;

// ***** WebAudio gxtkSample *****

var gxtkSample=function(){
	this.waBuffer=null;
	this.state=0;
}

gxtkSample.prototype.Load=function( path ){
	if( this.state ) return false;

	var req=new XMLHttpRequest();
	
	req.open( "get",BBGame.Game().PathToUrl( path ),true );
	req.responseType="arraybuffer";
	
	var abuf=this;
	
	req.onload=function(){
		wa.decodeAudioData( req.response,function( buffer ){
			//success!
			abuf.waBuffer=buffer;
			abuf.state=1;
		},function(){
			abuf.state=-1;
		} );
	}
	
	req.onerror=function(){
		abuf.state=-1;
	}
	
	req.send();
	
	this.state=2;
			
	return true;
}

gxtkSample.prototype.Discard=function(){
}

// ***** WebAudio gxtkChannel *****

var gxtkChannel=function(){
	this.buffer=null;
	this.flags=0;
	this.volume=1;
	this.pan=0;
	this.rate=1;
	this.waSource=null;
	this.waPan=wa.create
	this.waGain=wa.createGain();
	this.waGain.connect( wa.destination );
	this.waPanner=wa.createPanner();
	this.waPanner.rolloffFactor=0;
	this.waPanner.panningModel="equalpower";
	this.waPanner.connect( this.waGain );
	this.startTime=0;
	this.offset=0;
	this.state=0;
}

// ***** WebAudio gxtkAudio *****

var gxtkAudio=function(){

	if( !wa ){
		window.AudioContext=window.AudioContext || window.webkitAudioContext;
		wa=new AudioContext();
	}
	
	this.okay=true;
	this.music=null;
	this.musicState=0;
	this.musicVolume=1;
	this.channels=new Array();
	for( var i=0;i<32;++i ){
		this.channels[i]=new gxtkChannel();
	}
}

gxtkAudio.prototype.Suspend=function(){
	if( this.MusicState()==1 ) this.music.pause();
	for( var i=0;i<32;++i ){
		var chan=this.channels[i];
		if( chan.state!=1 ) continue;
		this.PauseChannel( i );
		chan.state=5;
	}
}

gxtkAudio.prototype.Resume=function(){
	if( this.MusicState()==1 ) this.music.play();
	for( var i=0;i<32;++i ){
		var chan=this.channels[i];
		if( chan.state!=5 ) continue;
		chan.state=2;
		this.ResumeChannel( i );
	}
}

gxtkAudio.prototype.LoadSample=function( path ){

	var sample=new gxtkSample();
	if( !sample.Load( BBHtml5Game.Html5Game().PathToUrl( path ) ) ) return null;
	
	return sample;
}

gxtkAudio.prototype.PlaySample=function( buffer,channel,flags ){

	if( buffer.state!=1 ) return;

	var chan=this.channels[channel];
	
	if( chan.state ){
		chan.waSource.onended=null
		try {
			chan.waSource.stop( 0 );
			chan.state = 0			
		} catch (err) {			
		}
	}
	
	chan.buffer=buffer;
	chan.flags=flags;

	chan.waSource=wa.createBufferSource();
	chan.waSource.buffer=buffer.waBuffer;
	chan.waSource.playbackRate.value=chan.rate;
	chan.waSource.loop=(flags&1)!=0;
	chan.waSource.connect( chan.waPanner );
	
	chan.waSource.onended=function( e ){
		chan.waSource=null;
		chan.state=0;
	}

	chan.offset=0;	
	chan.startTime=wa.currentTime;
	chan.waSource.start( 0 );

	chan.state=1;
}

gxtkAudio.prototype.StopChannel=function( channel ){

	var chan=this.channels[channel];
	if( !chan.state ) return;
	
	if( chan.state==1 ){
		chan.waSource.onended=null;
		try {
			chan.waSource.stop( 0 );
		} catch (err) {			
		}
		chan.waSource=null;
	}

	chan.state=0;
}

gxtkAudio.prototype.PauseChannel=function( channel ){

	var chan=this.channels[channel];
	if( chan.state!=1 ) return;
	
	chan.offset=(chan.offset+(wa.currentTime-chan.startTime)*chan.rate)%chan.buffer.waBuffer.duration;
	
	chan.waSource.onended=null;
	try {
		chan.waSource.stop( 0 );
	} catch (err) {			
	}
	chan.waSource=null;
	
	chan.state=2;
}

gxtkAudio.prototype.ResumeChannel=function( channel ){

	var chan=this.channels[channel];
	if( chan.state!=2 ) return;
	
	chan.waSource=wa.createBufferSource();
	chan.waSource.buffer=chan.buffer.waBuffer;
	chan.waSource.playbackRate.value=chan.rate;
	chan.waSource.loop=(chan.flags&1)!=0;
	chan.waSource.connect( chan.waPanner );
	
	chan.waSource.onended=function( e ){
		chan.waSource=null;
		chan.state=0;
	}
	
	chan.startTime=wa.currentTime;
	chan.waSource.start( 0,chan.offset );

	chan.state=1;
}

gxtkAudio.prototype.ChannelState=function( channel ){
	return this.channels[channel].state & 3;
}

gxtkAudio.prototype.SetVolume=function( channel,volume ){
	var chan=this.channels[channel];

	chan.volume=volume;
	
	chan.waGain.gain.value=volume;
}

gxtkAudio.prototype.SetPan=function( channel,pan ){
	var chan=this.channels[channel];

	chan.pan=pan;
	
	var sin=Math.sin( pan*3.14159265359/2 );
	var cos=Math.cos( pan*3.14159265359/2 );
	
	chan.waPanner.setPosition( sin,0,-cos );
}

gxtkAudio.prototype.SetRate=function( channel,rate ){

	var chan=this.channels[channel];

	if( chan.state==1 ){
		//update offset for pause/resume
		var time=wa.currentTime;
		chan.offset=(chan.offset+(time-chan.startTime)*chan.rate)%chan.buffer.waBuffer.duration;
		chan.startTime=time;
	}

	chan.rate=rate;
	
	if( chan.waSource ) chan.waSource.playbackRate.value=rate;
}

gxtkAudio.prototype.PlayMusic=function( path,flags ){
	if( this.musicState ) this.music.pause();
	this.music=new Audio( BBGame.Game().PathToUrl( path ) );
	this.music.loop=(flags&1)!=0;
	this.music.play();
	this.musicState=1;
}

gxtkAudio.prototype.StopMusic=function(){
	if( !this.musicState ) return;
	this.music.pause();
	this.music=null;
	this.musicState=0;
}

gxtkAudio.prototype.PauseMusic=function(){
	if( this.musicState!=1 ) return;
	this.music.pause();
	this.musicState=2;
}

gxtkAudio.prototype.ResumeMusic=function(){
	if( this.musicState!=2 ) return;
	this.music.play();
	this.musicState=1;
}

gxtkAudio.prototype.MusicState=function(){
	if( this.musicState==1 && this.music.ended && !this.music.loop ){
		this.music=null;
		this.musicState=0;
	}
	return this.musicState;
}

gxtkAudio.prototype.SetMusicVolume=function( volume ){
	this.musicVolume=volume;
	if( this.musicState ) this.music.volume=volume;
}

}else{

//print( "Using OldAudio!" );

// ***** gxtkChannel class *****

var gxtkChannel=function(){
	this.sample=null;
	this.audio=null;
	this.volume=1;
	this.pan=0;
	this.rate=1;
	this.flags=0;
	this.state=0;
}

// ***** gxtkAudio class *****

var gxtkAudio=function(){
	this.game=BBHtml5Game.Html5Game();
	this.okay=typeof(Audio)!="undefined";
	this.music=null;
	this.channels=new Array(33);
	for( var i=0;i<33;++i ){
		this.channels[i]=new gxtkChannel();
		if( !this.okay ) this.channels[i].state=-1;
	}
}

gxtkAudio.prototype.Suspend=function(){
	var i;
	for( i=0;i<33;++i ){
		var chan=this.channels[i];
		if( chan.state==1 ){
			if( chan.audio.ended && !chan.audio.loop ){
				chan.state=0;
			}else{
				chan.audio.pause();
				chan.state=3;
			}
		}
	}
}

gxtkAudio.prototype.Resume=function(){
	var i;
	for( i=0;i<33;++i ){
		var chan=this.channels[i];
		if( chan.state==3 ){
			chan.audio.play();
			chan.state=1;
		}
	}
}

gxtkAudio.prototype.LoadSample=function( path ){
	if( !this.okay ) return null;

	var audio=new Audio( this.game.PathToUrl( path ) );
	if( !audio ) return null;
	
	return new gxtkSample( audio );
}

gxtkAudio.prototype.PlaySample=function( sample,channel,flags ){
	if( !this.okay ) return;
	
	var chan=this.channels[channel];

	if( chan.state>0 ){
		chan.audio.pause();
		chan.state=0;
	}
	
	for( var i=0;i<33;++i ){
		var chan2=this.channels[i];
		if( chan2.state==1 && chan2.audio.ended && !chan2.audio.loop ) chan.state=0;
		if( chan2.state==0 && chan2.sample ){
			chan2.sample.FreeAudio( chan2.audio );
			chan2.sample=null;
			chan2.audio=null;
		}
	}

	var audio=sample.AllocAudio();
	if( !audio ) return;

	audio.loop=(flags&1)!=0;
	audio.volume=chan.volume;
	audio.play();

	chan.sample=sample;
	chan.audio=audio;
	chan.flags=flags;
	chan.state=1;
}

gxtkAudio.prototype.StopChannel=function( channel ){
	var chan=this.channels[channel];
	
	if( chan.state>0 ){
		chan.audio.pause();
		chan.state=0;
	}
}

gxtkAudio.prototype.PauseChannel=function( channel ){
	var chan=this.channels[channel];
	
	if( chan.state==1 ){
		if( chan.audio.ended && !chan.audio.loop ){
			chan.state=0;
		}else{
			chan.audio.pause();
			chan.state=2;
		}
	}
}

gxtkAudio.prototype.ResumeChannel=function( channel ){
	var chan=this.channels[channel];
	
	if( chan.state==2 ){
		chan.audio.play();
		chan.state=1;
	}
}

gxtkAudio.prototype.ChannelState=function( channel ){
	var chan=this.channels[channel];
	if( chan.state==1 && chan.audio.ended && !chan.audio.loop ) chan.state=0;
	if( chan.state==3 ) return 1;
	return chan.state;
}

gxtkAudio.prototype.SetVolume=function( channel,volume ){
	var chan=this.channels[channel];
	if( chan.state>0 ) chan.audio.volume=volume;
	chan.volume=volume;
}

gxtkAudio.prototype.SetPan=function( channel,pan ){
	var chan=this.channels[channel];
	chan.pan=pan;
}

gxtkAudio.prototype.SetRate=function( channel,rate ){
	var chan=this.channels[channel];
	chan.rate=rate;
}

gxtkAudio.prototype.PlayMusic=function( path,flags ){
	this.StopMusic();
	
	this.music=this.LoadSample( path );
	if( !this.music ) return;
	
	this.PlaySample( this.music,32,flags );
}

gxtkAudio.prototype.StopMusic=function(){
	this.StopChannel( 32 );

	if( this.music ){
		this.music.Discard();
		this.music=null;
	}
}

gxtkAudio.prototype.PauseMusic=function(){
	this.PauseChannel( 32 );
}

gxtkAudio.prototype.ResumeMusic=function(){
	this.ResumeChannel( 32 );
}

gxtkAudio.prototype.MusicState=function(){
	return this.ChannelState( 32 );
}

gxtkAudio.prototype.SetMusicVolume=function( volume ){
	this.SetVolume( 32,volume );
}

// ***** gxtkSample class *****

//function gxtkSample( audio ){
var gxtkSample=function( audio ){
	this.audio=audio;
	this.free=new Array();
	this.insts=new Array();
}

gxtkSample.prototype.FreeAudio=function( audio ){
	this.free.push( audio );
}

gxtkSample.prototype.AllocAudio=function(){
	var audio;
	while( this.free.length ){
		audio=this.free.pop();
		try{
			audio.currentTime=0;
			return audio;
		}catch( ex ){
//			print( "AUDIO ERROR1!" );
		}
	}
	
	//Max out?
	if( this.insts.length==8 ) return null;
	
	audio=new Audio( this.audio.src );
	
	//yucky loop handler for firefox!
	//
	audio.addEventListener( 'ended',function(){
		if( this.loop ){
			try{
				this.currentTime=0;
				this.play();
			}catch( ex ){
//				print( "AUDIO ERROR2!" );
			}
		}
	},false );

	this.insts.push( audio );
	return audio;
}

gxtkSample.prototype.Discard=function(){
}

}


function BBThread(){
	this.result=null;
	this.running=false;
}

BBThread.prototype.Start=function(){
	this.result=null;
	this.running=true;
	this.Run__UNSAFE__();
}

BBThread.prototype.IsRunning=function(){
	return this.running;
}

BBThread.prototype.Result=function(){
	return this.result;
}

BBThread.prototype.Run__UNSAFE__=function(){
	this.running=false;
}


function BBAsyncImageLoaderThread(){
	this._running=false;
}

BBAsyncImageLoaderThread.prototype.Start=function(){

	var thread=this;

	thread._surface=null;
	thread._result=false;
	thread._running=true;

	var image=new Image();

	image.onload=function( e ){
		image.meta_width=image.width;
		image.meta_height=image.height;
		thread._surface=new gxtkSurface( image,thread._device )
		thread._result=true;
		thread._running=false;
	}
	
	image.onerror=function( e ){
		thread._running=false;
	}
	
	image.src=BBGame.Game().PathToUrl( thread._path );
}

BBAsyncImageLoaderThread.prototype.IsRunning=function(){
	return this._running;
}



function BBAsyncSoundLoaderThread(){
	this._running=false;
}
  
if( CFG_HTML5_WEBAUDIO_ENABLED=="1" && (window.AudioContext || window.webkitAudioContext) ){

BBAsyncSoundLoaderThread.prototype.Start=function(){

	this._sample=null;
	if( !this._device.okay ) return;
	
	var thread=this;
	
	thread._sample=null;
	thread._result=false;
	thread._running=true;

	var req=new XMLHttpRequest();
	req.open( "get",BBGame.Game().PathToUrl( this._path ),true );
	req.responseType="arraybuffer";
	
	req.onload=function(){
		//load success!
		wa.decodeAudioData( req.response,function( buffer ){
			//decode success!
			thread._sample=new gxtkSample();
			thread._sample.waBuffer=buffer;
			thread._sample.state=1;
			thread._result=true;
			thread._running=false;
		},function(){	
			//decode fail!
			thread._running=false;
		} );
	}
	
	req.onerror=function(){
		//load fail!
		thread._running=false;
	}
	
	req.send();
}
	
}else{
 
BBAsyncSoundLoaderThread.prototype.Start=function(){

	this._sample=null;
	if( !this._device.okay ) return;
	
	var audio=new Audio();
	if( !audio ) return;
	
	var thread=this;
	
	thread._sample=null;
	thread._result=false;
	thread._running=true;

	audio.src=BBGame.Game().PathToUrl( this._path );
	audio.preload='auto';	
	
	var success=function( e ){
		thread._sample=new gxtkSample( audio );
		thread._result=true;
		thread._running=false;
		audio.removeEventListener( 'canplaythrough',success,false );
		audio.removeEventListener( 'error',error,false );
	}
	
	var error=function( e ){
		thread._running=false;
		audio.removeEventListener( 'canplaythrough',success,false );
		audio.removeEventListener( 'error',error,false );
	}
	
	audio.addEventListener( 'canplaythrough',success,false );
	audio.addEventListener( 'error',error,false );
	
	//voodoo fix for Chrome!
	var timer=setInterval( function(){ if( !thread._running ) clearInterval( timer ); },200 );
	
	audio.load();
}

}
  
BBAsyncSoundLoaderThread.prototype.IsRunning=function(){
	return this._running;
}


function BBDataBuffer(){
	this.arrayBuffer=null;
	this.length=0;
}

BBDataBuffer.tbuf=new ArrayBuffer(4);
BBDataBuffer.tbytes=new Int8Array( BBDataBuffer.tbuf );
BBDataBuffer.tshorts=new Int16Array( BBDataBuffer.tbuf );
BBDataBuffer.tints=new Int32Array( BBDataBuffer.tbuf );
BBDataBuffer.tfloats=new Float32Array( BBDataBuffer.tbuf );

BBDataBuffer.prototype._Init=function( buffer ){
  
  this.length=buffer.byteLength;
  
  if (buffer.byteLength != Math.ceil(buffer.byteLength / 4) * 4)
  {
    var new_buffer = new ArrayBuffer(Math.ceil(buffer.byteLength / 4) * 4);
    var src = new Int8Array(buffer);
    var dst = new Int8Array(new_buffer);
    for (var i = 0; i < this.length; i++) {
      dst[i] = src[i];
    }
    buffer = new_buffer;    
  }

	this.arrayBuffer=buffer;
	this.bytes=new Int8Array( buffer );	
	this.shorts=new Int16Array( buffer,0,this.length/2 );	
	this.ints=new Int32Array( buffer,0,this.length/4 );	
	this.floats=new Float32Array( buffer,0,this.length/4 );
}

BBDataBuffer.prototype._New=function( length ){
	if( this.arrayBuffer ) return false;
	
	var buf=new ArrayBuffer( length );
	if( !buf ) return false;
	
	this._Init( buf );
	return true;
}

BBDataBuffer.prototype._Load=function( path ){
	if( this.arrayBuffer ) return false;
	
	var buf=BBGame.Game().LoadData( path );
	if( !buf ) return false;
	
	this._Init( buf );
	return true;
}

BBDataBuffer.prototype._LoadAsync=function( path,thread ){

	var buf=this;
	
	var xhr=new XMLHttpRequest();
	xhr.open( "GET",BBGame.Game().PathToUrl( path ),true );
	xhr.responseType="arraybuffer";
	
	xhr.onload=function(e){
		if( this.status==200 || this.status==0 ){
			buf._Init( xhr.response );
			thread.result=buf;
		}
		thread.running=false;
	}
	
	xhr.onerror=function(e){
		thread.running=false;
	}
	
	xhr.send();
}


BBDataBuffer.prototype.GetArrayBuffer=function(){
	return this.arrayBuffer;
}

BBDataBuffer.prototype.Length=function(){
	return this.length;
}

BBDataBuffer.prototype.Discard=function(){
	if( this.arrayBuffer ){
		this.arrayBuffer=null;
		this.length=0;
	}
}

BBDataBuffer.prototype.PokeByte=function( addr,value ){
	this.bytes[addr]=value;
}

BBDataBuffer.prototype.PokeShort=function( addr,value ){
	if( addr&1 ){
		BBDataBuffer.tshorts[0]=value;
		this.bytes[addr]=BBDataBuffer.tbytes[0];
		this.bytes[addr+1]=BBDataBuffer.tbytes[1];
		return;
	}
	this.shorts[addr>>1]=value;
}

BBDataBuffer.prototype.PokeInt=function( addr,value ){
	if( addr&3 ){
		BBDataBuffer.tints[0]=value;
		this.bytes[addr]=BBDataBuffer.tbytes[0];
		this.bytes[addr+1]=BBDataBuffer.tbytes[1];
		this.bytes[addr+2]=BBDataBuffer.tbytes[2];
		this.bytes[addr+3]=BBDataBuffer.tbytes[3];
		return;
	}
	this.ints[addr>>2]=value;
}

BBDataBuffer.prototype.PokeFloat=function( addr,value ){
	if( addr&3 ){
		BBDataBuffer.tfloats[0]=value;
		this.bytes[addr]=BBDataBuffer.tbytes[0];
		this.bytes[addr+1]=BBDataBuffer.tbytes[1];
		this.bytes[addr+2]=BBDataBuffer.tbytes[2];
		this.bytes[addr+3]=BBDataBuffer.tbytes[3];
		return;
	}
	this.floats[addr>>2]=value;
}

BBDataBuffer.prototype.PeekByte=function( addr ){
	return this.bytes[addr];
}

BBDataBuffer.prototype.PeekShort=function( addr ){
	if( addr&1 ){
		BBDataBuffer.tbytes[0]=this.bytes[addr];
		BBDataBuffer.tbytes[1]=this.bytes[addr+1];
		return BBDataBuffer.tshorts[0];
	}
	return this.shorts[addr>>1];
}

BBDataBuffer.prototype.PeekInt=function( addr ){
	if( addr&3 ){
		BBDataBuffer.tbytes[0]=this.bytes[addr];
		BBDataBuffer.tbytes[1]=this.bytes[addr+1];
		BBDataBuffer.tbytes[2]=this.bytes[addr+2];
		BBDataBuffer.tbytes[3]=this.bytes[addr+3];
		return BBDataBuffer.tints[0];
	}
	return this.ints[addr>>2];
}

BBDataBuffer.prototype.PeekFloat=function( addr ){
	if( addr&3 ){
		BBDataBuffer.tbytes[0]=this.bytes[addr];
		BBDataBuffer.tbytes[1]=this.bytes[addr+1];
		BBDataBuffer.tbytes[2]=this.bytes[addr+2];
		BBDataBuffer.tbytes[3]=this.bytes[addr+3];
		return BBDataBuffer.tfloats[0];
	}
	return this.floats[addr>>2];
}


function BBStream(){
}

BBStream.prototype.Eof=function(){
	return 0;
}

BBStream.prototype.Close=function(){
}

BBStream.prototype.Length=function(){
	return 0;
}

BBStream.prototype.Position=function(){
	return 0;
}

BBStream.prototype.Seek=function( position ){
	return 0;
}

BBStream.prototype.Read=function( buffer,offset,count ){
	return 0;
}

BBStream.prototype.Write=function( buffer,offset,count ){
	return 0;
}

/*
Copyright (c) 2011 Steve Revill and Shane Woolcock
Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/

var diddy = new Object();

var diddy_mouseWheelDelta = 0.0;

diddy.mouseZ = function() {
	var t = diddy_mouseWheelDelta;
	diddy_mouseWheelDelta = 0.0;
	return t;
}

diddy.mouseZInit = function() {
	var canvas=document.getElementById( "GameCanvas" );
	
	canvas.onmousewheel = function(e) {
		diddy_mouseWheelDelta += e.wheelDelta/120.0;
	}
}

diddy.systemMillisecs=function(){
	return new Date().getTime();
};

diddy.setGraphics=function(w, h)
{
	var canvas=document.getElementById( "GameCanvas" );
	canvas.width  = w;
	canvas.height = h;
	//return window.innerHeight;
}
diddy.setMouse=function(x, y)
{
}
diddy.showKeyboard=function()
{
}
diddy.launchBrowser=function(address, windowName)
{
	window.open(address, windowName);
}
diddy.launchEmail=function(email, subject, text)
{
	location.href="mailto:"+email+"&subject="+subject+"&body="+text+"";
}

diddy.startVibrate=function(millisecs)
{
}
diddy.stopVibrate=function()
{
}

diddy.startGps=function(){
}

diddy.getLatitude=function(){
	return ""
}
diddy.getLongitude=function(){
	return ""
}
diddy.showAlertDialog=function(title, message)
{
	alert(title + "\n\n" + message);
}
diddy.getInputString=function()
{
	return "";
}
// Browser detect from http://www.quirksmode.org/js/detect.html
var BrowserDetect = {
	init: function () {
		this.browser = this.searchString(this.dataBrowser) || "An unknown browser";
		this.version = this.searchVersion(navigator.userAgent)
			|| this.searchVersion(navigator.appVersion)
			|| "an unknown version";
		this.OS = this.searchString(this.dataOS) || "an unknown OS";
	},
	searchString: function (data) {
		for (var i=0;i<data.length;i++)	{
			var dataString = data[i].string;
			var dataProp = data[i].prop;
			this.versionSearchString = data[i].versionSearch || data[i].identity;
			if (dataString) {
				if (dataString.indexOf(data[i].subString) != -1)
					return data[i].identity;
			}
			else if (dataProp)
				return data[i].identity;
		}
	},
	searchVersion: function (dataString) {
		var index = dataString.indexOf(this.versionSearchString);
		if (index == -1) return;
		return parseFloat(dataString.substring(index+this.versionSearchString.length+1));
	},
	dataBrowser: [
		{
			string: navigator.userAgent,
			subString: "Chrome",
			identity: "Chrome"
		},
		{ 	string: navigator.userAgent,
			subString: "OmniWeb",
			versionSearch: "OmniWeb/",
			identity: "OmniWeb"
		},
		{
			string: navigator.vendor,
			subString: "Apple",
			identity: "Safari",
			versionSearch: "Version"
		},
		{
			prop: window.opera,
			identity: "Opera",
			versionSearch: "Version"
		},
		{
			string: navigator.vendor,
			subString: "iCab",
			identity: "iCab"
		},
		{
			string: navigator.vendor,
			subString: "KDE",
			identity: "Konqueror"
		},
		{
			string: navigator.userAgent,
			subString: "Firefox",
			identity: "Firefox"
		},
		{
			string: navigator.vendor,
			subString: "Camino",
			identity: "Camino"
		},
		{		// for newer Netscapes (6+)
			string: navigator.userAgent,
			subString: "Netscape",
			identity: "Netscape"
		},
		{
			string: navigator.userAgent,
			subString: "MSIE",
			identity: "Explorer",
			versionSearch: "MSIE"
		},
		{
			string: navigator.userAgent,
			subString: "Gecko",
			identity: "Mozilla",
			versionSearch: "rv"
		},
		{ 		// for older Netscapes (4-)
			string: navigator.userAgent,
			subString: "Mozilla",
			identity: "Netscape",
			versionSearch: "Mozilla"
		}
	],
	dataOS : [
		{
			string: navigator.platform,
			subString: "Win",
			identity: "Windows"
		},
		{
			string: navigator.platform,
			subString: "Mac",
			identity: "Mac"
		},
		{
			string: navigator.userAgent,
			subString: "iPhone",
			identity: "iPhone/iPod"
	    },
		{
			string: navigator.platform,
			subString: "Linux",
			identity: "Linux"
		}
	]

};
BrowserDetect.init();

diddy.getBrowserName=function(){
	return BrowserDetect.browser;
};

diddy.getBrowserVersion=function(){
	return BrowserDetect.version;
};

diddy.getBrowserOS=function(){
	return BrowserDetect.OS;
};

diddy.seekMusic=function(timeMillis)
{
	if(bb_audio_device &&
		bb_audio_device.channels &&
		bb_audio_device.channels[32] &&
		bb_audio_device.channels[32].audio)
	{
		var audio = bb_audio_device.channels[32].audio;
		try {
			audio.currentTime = timeMillis/1000.0;
			return 1;
		} catch(e) {}
	}
	return 0;
};


function BBHttpRequest(){
	this.response = {
		text: '',
		status: -1,
		length: 0
	}
}

BBHttpRequest.prototype.Open=function( requestMethod, url ){
	if ( !this.xhr ) this.xhr=new XMLHttpRequest();

	//IE9
	if (window.XDomainRequest) {
		var location = document.createElement('a');
		location.href = url;

		if ( location.hostname !== window.location.hostname){
			if ( !('withCredentials' in this.xhr) && !(this.xhr instanceof XDomainRequest) ){
				this.xhr=new XDomainRequest();
			}
		} else if (this.xhr instanceof XDomainRequest) {
			this.xhr=new XMLHttpRequest();
		}
	}

	var request = this;

	if ( !this.xhr.onload ){
		this.xhr.onload=function(e){
			request.response.status=(e.target.status) ? e.target.status : 200;
			request.response.text=e.target.responseText;

			if ( request.response.length===0 ) {
				request.response.length=e.target.responseText.length;
			}
			
			request.running=false;
		}
	}

	if ( !this.xhr.onprogress ){
		this.xhr.onprogress=function(e){
			if (e.lengthComputable) request.response.length = e.loaded;
		}
	}

	if ( !this.xhr.onerror ){
		this.xhr.onerror=function(e){
			request.response.status=(e.target.status) ? e.target.status : 0;
			request.running=false;
		}
	}

	this.response.text='';
	this.response.status=-1;
	this.response.length=0;

	this.xhr.open( requestMethod, url );
}

BBHttpRequest.prototype.Discard=function(){
	if ( this.xhr ) this.xhr.abort();
	this.response=null;
	this.xhr=null;
}

BBHttpRequest.prototype.SetHeader=function( name, value ){
	if ( this.xhr && this.xhr.setRequestHeader ) this.xhr.setRequestHeader( name, value );
}

BBHttpRequest.prototype.Send=function(){
	this.data=this.encoding=null;
	this.Start();
}

BBHttpRequest.prototype.SendText=function( data, encoding ){
	this.data=data;
	this.encoding=encoding;
	this.Start();
}

BBHttpRequest.prototype.Start=function(){
	if ( this.xhr ){
		this.running=true;
		this.xhr.send( this.data );
	}
}

BBHttpRequest.prototype.BytesReceived=function(){
	return this.response.length;
}

BBHttpRequest.prototype.ResponseText=function(){
	return this.response.text;
}

BBHttpRequest.prototype.Status=function(){
	return this.response.status;
}

BBHttpRequest.prototype.IsRunning=function(){
	return this.running;
}

var mousepointer = new Object();

mousepointer.pointer = function() {
	
	var canvas=document.getElementById( "GameCanvas" );
	
	canvas.style= "cursor:pointer";
}

mousepointer.default = function() {
	
	var canvas=document.getElementById( "GameCanvas" );
	
	canvas.style= "cursor:default";
}

mousepointer.crosshair = function() {
	
	var canvas=document.getElementById( "GameCanvas" );
	
	canvas.style= "cursor:crosshair";
}


function c_BoolObject(){
	Object.call(this);
	this.m_value=false;
}
c_BoolObject.m_new=function(t_value){
	this.m_value=t_value;
	return this;
}
c_BoolObject.prototype.p_ToBool=function(){
	return this.m_value;
}
c_BoolObject.prototype.p_Equals=function(t_box){
	return this.m_value==t_box.m_value;
}
c_BoolObject.m_new2=function(){
	return this;
}
function c_IntObject(){
	Object.call(this);
	this.m_value=0;
}
c_IntObject.m_new=function(t_value){
	this.m_value=t_value;
	return this;
}
c_IntObject.m_new2=function(t_value){
	this.m_value=((t_value)|0);
	return this;
}
c_IntObject.prototype.p_ToInt=function(){
	return this.m_value;
}
c_IntObject.prototype.p_ToFloat=function(){
	return (this.m_value);
}
c_IntObject.prototype.p_ToString=function(){
	return String(this.m_value);
}
c_IntObject.prototype.p_Equals2=function(t_box){
	return this.m_value==t_box.m_value;
}
c_IntObject.prototype.p_Compare=function(t_box){
	return this.m_value-t_box.m_value;
}
c_IntObject.m_new3=function(){
	return this;
}
function c_FloatObject(){
	Object.call(this);
	this.m_value=.0;
}
c_FloatObject.m_new=function(t_value){
	this.m_value=(t_value);
	return this;
}
c_FloatObject.m_new2=function(t_value){
	this.m_value=t_value;
	return this;
}
c_FloatObject.prototype.p_ToInt=function(){
	return ((this.m_value)|0);
}
c_FloatObject.prototype.p_ToFloat=function(){
	return this.m_value;
}
c_FloatObject.prototype.p_ToString=function(){
	return String(this.m_value);
}
c_FloatObject.prototype.p_Equals3=function(t_box){
	return this.m_value==t_box.m_value;
}
c_FloatObject.prototype.p_Compare2=function(t_box){
	if(this.m_value<t_box.m_value){
		return -1;
	}
	return ((this.m_value>t_box.m_value)?1:0);
}
c_FloatObject.m_new3=function(){
	return this;
}
function c_StringObject(){
	Object.call(this);
	this.m_value="";
}
c_StringObject.m_new=function(t_value){
	this.m_value=String(t_value);
	return this;
}
c_StringObject.m_new2=function(t_value){
	this.m_value=String(t_value);
	return this;
}
c_StringObject.m_new3=function(t_value){
	this.m_value=t_value;
	return this;
}
c_StringObject.prototype.p_ToString=function(){
	return this.m_value;
}
c_StringObject.prototype.p_Equals4=function(t_box){
	return this.m_value==t_box.m_value;
}
c_StringObject.prototype.p_Compare3=function(t_box){
	return string_compare(this.m_value,t_box.m_value);
}
c_StringObject.m_new4=function(){
	return this;
}
function bb_boxes_BoxBool(t_value){
	return (c_BoolObject.m_new.call(new c_BoolObject,t_value));
}
function bb_boxes_BoxInt(t_value){
	return (c_IntObject.m_new.call(new c_IntObject,t_value));
}
function bb_boxes_BoxFloat(t_value){
	return (c_FloatObject.m_new2.call(new c_FloatObject,t_value));
}
function bb_boxes_BoxString(t_value){
	return (c_StringObject.m_new3.call(new c_StringObject,t_value));
}
function bb_boxes_UnboxBool(t_box){
	return object_downcast((t_box),c_BoolObject).m_value;
}
function bb_boxes_UnboxInt(t_box){
	return object_downcast((t_box),c_IntObject).m_value;
}
function bb_boxes_UnboxFloat(t_box){
	return object_downcast((t_box),c_FloatObject).m_value;
}
function bb_boxes_UnboxString(t_box){
	return object_downcast((t_box),c_StringObject).m_value;
}
function bb_lang_DebugLog(t_message){
	var t_b=0;
	return 0;
}
function bb_lang_DebugStop(){
	return 0;
}
function c_DiddyException(){
	ThrowableObject.call(this);
	this.m_message="";
	this.m_cause=null;
	this.m_type="";
	this.m_fullType="";
}
c_DiddyException.prototype=extend_class(ThrowableObject);
c_DiddyException.prototype.p_Message=function(){
	return this.m_message;
}
c_DiddyException.prototype.p_Message2=function(t_message){
	this.m_message=t_message;
}
c_DiddyException.prototype.p_Cause=function(){
	return this.m_cause;
}
c_DiddyException.prototype.p_Cause2=function(t_cause){
	if(t_cause==(this)){
		t_cause=null;
	}
	this.m_cause=t_cause;
}
c_DiddyException.prototype.p_Type=function(){
	return this.m_type;
}
c_DiddyException.prototype.p_FullType=function(){
	return this.m_fullType;
}
c_DiddyException.prototype.p_ToString2=function(t_recurse){
	var t_rv=this.m_type+": "+this.m_message;
	if(t_recurse){
		var t_depth=10;
		var t_current=this.m_cause;
		while(((t_current)!=null) && t_depth>0){
			if((object_downcast((t_current),c_DiddyException))!=null){
				t_rv=t_rv+("\nCaused by "+this.m_type+": "+object_downcast((t_current),c_DiddyException).m_message);
				t_current=object_downcast((t_current),c_DiddyException).m_cause;
				t_depth-=1;
			}else{
				t_rv=t_rv+"\nCaused by a non-Diddy exception.";
				t_current=null;
			}
		}
	}
	return t_rv;
}
c_DiddyException.m_new=function(t_message,t_cause){
	this.m_message=t_message;
	this.m_cause=t_cause;
	var t_ci=bb_reflection_GetClass2(this);
	if((t_ci)!=null){
		this.m_fullType=t_ci.p_Name();
	}else{
		this.m_fullType="diddy.exception.DiddyException";
	}
	if(this.m_fullType.indexOf(".")!=-1){
		this.m_type=this.m_fullType.slice(this.m_fullType.lastIndexOf(".")+1);
	}else{
		this.m_type=this.m_fullType;
	}
	return this;
}
function c_ClassInfo(){
	Object.call(this);
	this.m__name="";
	this.m__attrs=0;
	this.m__sclass=null;
	this.m__ifaces=[];
	this.m__rconsts=[];
	this.m__consts=[];
	this.m__rfields=[];
	this.m__fields=[];
	this.m__rglobals=[];
	this.m__globals=[];
	this.m__rmethods=[];
	this.m__methods=[];
	this.m__rfunctions=[];
	this.m__functions=[];
	this.m__ctors=[];
}
c_ClassInfo.prototype.p_Name=function(){
	return this.m__name;
}
c_ClassInfo.m_new=function(t_name,t_attrs,t_sclass,t_ifaces){
	this.m__name=t_name;
	this.m__attrs=t_attrs;
	this.m__sclass=t_sclass;
	this.m__ifaces=t_ifaces;
	return this;
}
c_ClassInfo.m_new2=function(){
	return this;
}
c_ClassInfo.prototype.p_Init=function(){
	return 0;
}
c_ClassInfo.prototype.p_InitR=function(){
	if((this.m__sclass)!=null){
		var t_consts=c_Stack.m_new2.call(new c_Stack,this.m__sclass.m__rconsts);
		var t_=this.m__consts;
		var t_2=0;
		while(t_2<t_.length){
			var t_t=t_[t_2];
			t_2=t_2+1;
			t_consts.p_Push(t_t);
		}
		this.m__rconsts=t_consts.p_ToArray();
		var t_fields=c_Stack2.m_new2.call(new c_Stack2,this.m__sclass.m__rfields);
		var t_3=this.m__fields;
		var t_4=0;
		while(t_4<t_3.length){
			var t_t2=t_3[t_4];
			t_4=t_4+1;
			t_fields.p_Push4(t_t2);
		}
		this.m__rfields=t_fields.p_ToArray();
		var t_globals=c_Stack3.m_new2.call(new c_Stack3,this.m__sclass.m__rglobals);
		var t_5=this.m__globals;
		var t_6=0;
		while(t_6<t_5.length){
			var t_t3=t_5[t_6];
			t_6=t_6+1;
			t_globals.p_Push7(t_t3);
		}
		this.m__rglobals=t_globals.p_ToArray();
		var t_methods=c_Stack4.m_new2.call(new c_Stack4,this.m__sclass.m__rmethods);
		var t_7=this.m__methods;
		var t_8=0;
		while(t_8<t_7.length){
			var t_t4=t_7[t_8];
			t_8=t_8+1;
			t_methods.p_Push10(t_t4);
		}
		this.m__rmethods=t_methods.p_ToArray();
		var t_functions=c_Stack5.m_new2.call(new c_Stack5,this.m__sclass.m__rfunctions);
		var t_9=this.m__functions;
		var t_10=0;
		while(t_10<t_9.length){
			var t_t5=t_9[t_10];
			t_10=t_10+1;
			t_functions.p_Push13(t_t5);
		}
		this.m__rfunctions=t_functions.p_ToArray();
	}else{
		this.m__rconsts=this.m__consts;
		this.m__rfields=this.m__fields;
		this.m__rglobals=this.m__globals;
		this.m__rmethods=this.m__methods;
		this.m__rfunctions=this.m__functions;
	}
	return 0;
}
function c_Map(){
	Object.call(this);
	this.m_root=null;
}
c_Map.m_new=function(){
	return this;
}
c_Map.prototype.p_Compare4=function(t_lhs,t_rhs){
}
c_Map.prototype.p_RotateLeft=function(t_node){
	var t_child=t_node.m_right;
	t_node.m_right=t_child.m_left;
	if((t_child.m_left)!=null){
		t_child.m_left.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_left){
			t_node.m_parent.m_left=t_child;
		}else{
			t_node.m_parent.m_right=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_left=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map.prototype.p_RotateRight=function(t_node){
	var t_child=t_node.m_left;
	t_node.m_left=t_child.m_right;
	if((t_child.m_right)!=null){
		t_child.m_right.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_right){
			t_node.m_parent.m_right=t_child;
		}else{
			t_node.m_parent.m_left=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_right=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map.prototype.p_InsertFixup=function(t_node){
	while(((t_node.m_parent)!=null) && t_node.m_parent.m_color==-1 && ((t_node.m_parent.m_parent)!=null)){
		if(t_node.m_parent==t_node.m_parent.m_parent.m_left){
			var t_uncle=t_node.m_parent.m_parent.m_right;
			if(((t_uncle)!=null) && t_uncle.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle.m_color=1;
				t_uncle.m_parent.m_color=-1;
				t_node=t_uncle.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_right){
					t_node=t_node.m_parent;
					this.p_RotateLeft(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateRight(t_node.m_parent.m_parent);
			}
		}else{
			var t_uncle2=t_node.m_parent.m_parent.m_left;
			if(((t_uncle2)!=null) && t_uncle2.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle2.m_color=1;
				t_uncle2.m_parent.m_color=-1;
				t_node=t_uncle2.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_left){
					t_node=t_node.m_parent;
					this.p_RotateRight(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateLeft(t_node.m_parent.m_parent);
			}
		}
	}
	this.m_root.m_color=1;
	return 0;
}
c_Map.prototype.p_Set=function(t_key,t_value){
	var t_node=this.m_root;
	var t_parent=null;
	var t_cmp=0;
	while((t_node)!=null){
		t_parent=t_node;
		t_cmp=this.p_Compare4(t_key,t_node.m_key);
		if(t_cmp>0){
			t_node=t_node.m_right;
		}else{
			if(t_cmp<0){
				t_node=t_node.m_left;
			}else{
				t_node.m_value=t_value;
				return false;
			}
		}
	}
	t_node=c_Node.m_new.call(new c_Node,t_key,t_value,-1,t_parent);
	if((t_parent)!=null){
		if(t_cmp>0){
			t_parent.m_right=t_node;
		}else{
			t_parent.m_left=t_node;
		}
		this.p_InsertFixup(t_node);
	}else{
		this.m_root=t_node;
	}
	return true;
}
c_Map.prototype.p_FindNode=function(t_key){
	var t_node=this.m_root;
	while((t_node)!=null){
		var t_cmp=this.p_Compare4(t_key,t_node.m_key);
		if(t_cmp>0){
			t_node=t_node.m_right;
		}else{
			if(t_cmp<0){
				t_node=t_node.m_left;
			}else{
				return t_node;
			}
		}
	}
	return t_node;
}
c_Map.prototype.p_Contains=function(t_key){
	return this.p_FindNode(t_key)!=null;
}
c_Map.prototype.p_Get=function(t_key){
	var t_node=this.p_FindNode(t_key);
	if((t_node)!=null){
		return t_node.m_value;
	}
	return null;
}
function c_StringMap(){
	c_Map.call(this);
}
c_StringMap.prototype=extend_class(c_Map);
c_StringMap.m_new=function(){
	c_Map.m_new.call(this);
	return this;
}
c_StringMap.prototype.p_Compare4=function(t_lhs,t_rhs){
	return string_compare(t_lhs,t_rhs);
}
var bb_reflection__classesMap=null;
var bb_reflection__classes=[];
function c_Node(){
	Object.call(this);
	this.m_key="";
	this.m_right=null;
	this.m_left=null;
	this.m_value=null;
	this.m_color=0;
	this.m_parent=null;
}
c_Node.m_new=function(t_key,t_value,t_color,t_parent){
	this.m_key=t_key;
	this.m_value=t_value;
	this.m_color=t_color;
	this.m_parent=t_parent;
	return this;
}
c_Node.m_new2=function(){
	return this;
}
function bb_reflection_GetClass(t_name){
	if(!((bb_reflection__classesMap)!=null)){
		bb_reflection__classesMap=c_StringMap.m_new.call(new c_StringMap);
		var t_=bb_reflection__classes;
		var t_2=0;
		while(t_2<t_.length){
			var t_c=t_[t_2];
			t_2=t_2+1;
			var t_name2=t_c.p_Name();
			bb_reflection__classesMap.p_Set(t_name2,t_c);
			var t_i=t_name2.lastIndexOf(".");
			if(t_i==-1){
				continue;
			}
			t_name2=t_name2.slice(t_i+1);
			if(bb_reflection__classesMap.p_Contains(t_name2)){
				bb_reflection__classesMap.p_Set(t_name2,null);
			}else{
				bb_reflection__classesMap.p_Set(t_name2,t_c);
			}
		}
	}
	return bb_reflection__classesMap.p_Get(t_name);
}
function c__GetClass(){
	Object.call(this);
}
c__GetClass.prototype.p_GetClass=function(t_obj){
}
c__GetClass.m_new=function(){
	return this;
}
var bb_reflection__getClass=null;
function bb_reflection_GetClass2(t_obj){
	return bb_reflection__getClass.p_GetClass(t_obj);
}
function c_AssertException(){
	c_DiddyException.call(this);
}
c_AssertException.prototype=extend_class(c_DiddyException);
c_AssertException.m_new=function(t_message,t_cause){
	c_DiddyException.m_new.call(this,t_message,t_cause);
	return this;
}
function c_ConcurrentModificationException(){
	c_DiddyException.call(this);
}
c_ConcurrentModificationException.prototype=extend_class(c_DiddyException);
c_ConcurrentModificationException.m_new=function(t_message,t_cause){
	c_DiddyException.m_new.call(this,t_message,t_cause);
	return this;
}
function c_IndexOutOfBoundsException(){
	c_DiddyException.call(this);
}
c_IndexOutOfBoundsException.prototype=extend_class(c_DiddyException);
c_IndexOutOfBoundsException.m_new=function(t_message,t_cause){
	c_DiddyException.m_new.call(this,t_message,t_cause);
	return this;
}
function c_IllegalArgumentException(){
	c_DiddyException.call(this);
}
c_IllegalArgumentException.prototype=extend_class(c_DiddyException);
c_IllegalArgumentException.m_new=function(t_message,t_cause){
	c_DiddyException.m_new.call(this,t_message,t_cause);
	return this;
}
function c_XMLParseException(){
	c_DiddyException.call(this);
}
c_XMLParseException.prototype=extend_class(c_DiddyException);
c_XMLParseException.m_new=function(t_message,t_cause){
	c_DiddyException.m_new.call(this,t_message,t_cause);
	return this;
}
function c_UnsupportedOperationException(){
	c_DiddyException.call(this);
}
c_UnsupportedOperationException.prototype=extend_class(c_DiddyException);
c_UnsupportedOperationException.m_new=function(t_message,t_cause){
	c_DiddyException.m_new.call(this,t_message,t_cause);
	return this;
}
function c_FormatException(){
	c_DiddyException.call(this);
}
c_FormatException.prototype=extend_class(c_DiddyException);
c_FormatException.m_new=function(t_message,t_cause){
	c_DiddyException.m_new.call(this,t_message,t_cause);
	return this;
}
function c_R16(){
	c_ClassInfo.call(this);
}
c_R16.prototype=extend_class(c_ClassInfo);
c_R16.m_new=function(){
	c_ClassInfo.m_new.call(this,"cerberus.lang.Object",1,null,[]);
	return this;
}
c_R16.prototype.p_Init=function(){
	this.p_InitR();
	return 0;
}
function c_R17(){
	c_ClassInfo.call(this);
}
c_R17.prototype=extend_class(c_ClassInfo);
c_R17.m_new=function(){
	c_ClassInfo.m_new.call(this,"cerberus.boxes.BoolObject",0,bb_reflection__classes[0],[]);
	bb_reflection__boolClass=(this);
	return this;
}
c_R17.prototype.p_Init=function(){
	this.m__fields=new_object_array(1);
	this.m__fields[0]=(c_R18.m_new.call(new c_R18));
	this.m__methods=new_object_array(2);
	this.m__methods[0]=(c_R20.m_new.call(new c_R20));
	this.m__methods[1]=(c_R21.m_new.call(new c_R21));
	this.m__ctors=new_object_array(2);
	this.m__ctors[0]=(c_R19.m_new.call(new c_R19));
	this.m__ctors[1]=(c_R22.m_new.call(new c_R22));
	this.p_InitR();
	return 0;
}
var bb_reflection__boolClass=null;
function c_R23(){
	c_ClassInfo.call(this);
}
c_R23.prototype=extend_class(c_ClassInfo);
c_R23.m_new=function(){
	c_ClassInfo.m_new.call(this,"cerberus.boxes.IntObject",0,bb_reflection__classes[0],[]);
	bb_reflection__intClass=(this);
	return this;
}
c_R23.prototype.p_Init=function(){
	this.m__fields=new_object_array(1);
	this.m__fields[0]=(c_R24.m_new.call(new c_R24));
	this.m__methods=new_object_array(5);
	this.m__methods[0]=(c_R27.m_new.call(new c_R27));
	this.m__methods[1]=(c_R28.m_new.call(new c_R28));
	this.m__methods[2]=(c_R29.m_new.call(new c_R29));
	this.m__methods[3]=(c_R30.m_new.call(new c_R30));
	this.m__methods[4]=(c_R31.m_new.call(new c_R31));
	this.m__ctors=new_object_array(3);
	this.m__ctors[0]=(c_R25.m_new.call(new c_R25));
	this.m__ctors[1]=(c_R26.m_new.call(new c_R26));
	this.m__ctors[2]=(c_R32.m_new.call(new c_R32));
	this.p_InitR();
	return 0;
}
var bb_reflection__intClass=null;
function c_R33(){
	c_ClassInfo.call(this);
}
c_R33.prototype=extend_class(c_ClassInfo);
c_R33.m_new=function(){
	c_ClassInfo.m_new.call(this,"cerberus.boxes.FloatObject",0,bb_reflection__classes[0],[]);
	bb_reflection__floatClass=(this);
	return this;
}
c_R33.prototype.p_Init=function(){
	this.m__fields=new_object_array(1);
	this.m__fields[0]=(c_R34.m_new.call(new c_R34));
	this.m__methods=new_object_array(5);
	this.m__methods[0]=(c_R37.m_new.call(new c_R37));
	this.m__methods[1]=(c_R38.m_new.call(new c_R38));
	this.m__methods[2]=(c_R39.m_new.call(new c_R39));
	this.m__methods[3]=(c_R40.m_new.call(new c_R40));
	this.m__methods[4]=(c_R41.m_new.call(new c_R41));
	this.m__ctors=new_object_array(3);
	this.m__ctors[0]=(c_R35.m_new.call(new c_R35));
	this.m__ctors[1]=(c_R36.m_new.call(new c_R36));
	this.m__ctors[2]=(c_R42.m_new.call(new c_R42));
	this.p_InitR();
	return 0;
}
var bb_reflection__floatClass=null;
function c_R43(){
	c_ClassInfo.call(this);
}
c_R43.prototype=extend_class(c_ClassInfo);
c_R43.m_new=function(){
	c_ClassInfo.m_new.call(this,"cerberus.boxes.StringObject",0,bb_reflection__classes[0],[]);
	bb_reflection__stringClass=(this);
	return this;
}
c_R43.prototype.p_Init=function(){
	this.m__fields=new_object_array(1);
	this.m__fields[0]=(c_R44.m_new.call(new c_R44));
	this.m__methods=new_object_array(3);
	this.m__methods[0]=(c_R48.m_new.call(new c_R48));
	this.m__methods[1]=(c_R49.m_new.call(new c_R49));
	this.m__methods[2]=(c_R50.m_new.call(new c_R50));
	this.m__ctors=new_object_array(4);
	this.m__ctors[0]=(c_R45.m_new.call(new c_R45));
	this.m__ctors[1]=(c_R46.m_new.call(new c_R46));
	this.m__ctors[2]=(c_R47.m_new.call(new c_R47));
	this.m__ctors[3]=(c_R51.m_new.call(new c_R51));
	this.p_InitR();
	return 0;
}
var bb_reflection__stringClass=null;
function c_R52(){
	c_ClassInfo.call(this);
}
c_R52.prototype=extend_class(c_ClassInfo);
c_R52.m_new=function(){
	c_ClassInfo.m_new.call(this,"cerberus.lang.Throwable",33,bb_reflection__classes[0],[]);
	return this;
}
c_R52.prototype.p_Init=function(){
	this.p_InitR();
	return 0;
}
function c_R53(){
	c_ClassInfo.call(this);
}
c_R53.prototype=extend_class(c_ClassInfo);
c_R53.m_new=function(){
	c_ClassInfo.m_new.call(this,"diddy.exception.DiddyException",32,bb_reflection__classes[5],[]);
	return this;
}
c_R53.prototype.p_Init=function(){
	this.m__fields=new_object_array(4);
	this.m__fields[0]=(c_R54.m_new.call(new c_R54));
	this.m__fields[1]=(c_R55.m_new.call(new c_R55));
	this.m__fields[2]=(c_R56.m_new.call(new c_R56));
	this.m__fields[3]=(c_R57.m_new.call(new c_R57));
	this.m__methods=new_object_array(7);
	this.m__methods[0]=(c_R58.m_new.call(new c_R58));
	this.m__methods[1]=(c_R59.m_new.call(new c_R59));
	this.m__methods[2]=(c_R60.m_new.call(new c_R60));
	this.m__methods[3]=(c_R61.m_new.call(new c_R61));
	this.m__methods[4]=(c_R62.m_new.call(new c_R62));
	this.m__methods[5]=(c_R63.m_new.call(new c_R63));
	this.m__methods[6]=(c_R65.m_new.call(new c_R65));
	this.m__ctors=new_object_array(1);
	this.m__ctors[0]=(c_R64.m_new.call(new c_R64));
	this.p_InitR();
	return 0;
}
function c_R66(){
	c_ClassInfo.call(this);
}
c_R66.prototype=extend_class(c_ClassInfo);
c_R66.m_new=function(){
	c_ClassInfo.m_new.call(this,"diddy.exception.AssertException",32,bb_reflection__classes[6],[]);
	return this;
}
c_R66.prototype.p_Init=function(){
	this.m__ctors=new_object_array(1);
	this.m__ctors[0]=(c_R67.m_new.call(new c_R67));
	this.p_InitR();
	return 0;
}
function c_R68(){
	c_ClassInfo.call(this);
}
c_R68.prototype=extend_class(c_ClassInfo);
c_R68.m_new=function(){
	c_ClassInfo.m_new.call(this,"diddy.exception.ConcurrentModificationException",32,bb_reflection__classes[6],[]);
	return this;
}
c_R68.prototype.p_Init=function(){
	this.m__ctors=new_object_array(1);
	this.m__ctors[0]=(c_R69.m_new.call(new c_R69));
	this.p_InitR();
	return 0;
}
function c_R70(){
	c_ClassInfo.call(this);
}
c_R70.prototype=extend_class(c_ClassInfo);
c_R70.m_new=function(){
	c_ClassInfo.m_new.call(this,"diddy.exception.IndexOutOfBoundsException",32,bb_reflection__classes[6],[]);
	return this;
}
c_R70.prototype.p_Init=function(){
	this.m__ctors=new_object_array(1);
	this.m__ctors[0]=(c_R71.m_new.call(new c_R71));
	this.p_InitR();
	return 0;
}
function c_R72(){
	c_ClassInfo.call(this);
}
c_R72.prototype=extend_class(c_ClassInfo);
c_R72.m_new=function(){
	c_ClassInfo.m_new.call(this,"diddy.exception.IllegalArgumentException",32,bb_reflection__classes[6],[]);
	return this;
}
c_R72.prototype.p_Init=function(){
	this.m__ctors=new_object_array(1);
	this.m__ctors[0]=(c_R73.m_new.call(new c_R73));
	this.p_InitR();
	return 0;
}
function c_R74(){
	c_ClassInfo.call(this);
}
c_R74.prototype=extend_class(c_ClassInfo);
c_R74.m_new=function(){
	c_ClassInfo.m_new.call(this,"diddy.exception.XMLParseException",32,bb_reflection__classes[6],[]);
	return this;
}
c_R74.prototype.p_Init=function(){
	this.m__ctors=new_object_array(1);
	this.m__ctors[0]=(c_R75.m_new.call(new c_R75));
	this.p_InitR();
	return 0;
}
function c_R76(){
	c_ClassInfo.call(this);
}
c_R76.prototype=extend_class(c_ClassInfo);
c_R76.m_new=function(){
	c_ClassInfo.m_new.call(this,"diddy.exception.UnsupportedOperationException",32,bb_reflection__classes[6],[]);
	return this;
}
c_R76.prototype.p_Init=function(){
	this.m__ctors=new_object_array(1);
	this.m__ctors[0]=(c_R77.m_new.call(new c_R77));
	this.p_InitR();
	return 0;
}
function c_R78(){
	c_ClassInfo.call(this);
}
c_R78.prototype=extend_class(c_ClassInfo);
c_R78.m_new=function(){
	c_ClassInfo.m_new.call(this,"diddy.exception.FormatException",32,bb_reflection__classes[6],[]);
	return this;
}
c_R78.prototype.p_Init=function(){
	this.m__ctors=new_object_array(1);
	this.m__ctors[0]=(c_R79.m_new.call(new c_R79));
	this.p_InitR();
	return 0;
}
function c_FunctionInfo(){
	Object.call(this);
	this.m__name="";
	this.m__attrs=0;
	this.m__retType=null;
	this.m__argTypes=[];
}
c_FunctionInfo.m_new=function(t_name,t_attrs,t_retType,t_argTypes){
	this.m__name=t_name;
	this.m__attrs=t_attrs;
	this.m__retType=t_retType;
	this.m__argTypes=t_argTypes;
	return this;
}
c_FunctionInfo.m_new2=function(){
	return this;
}
var bb_reflection__functions=[];
function c_R4(){
	c_FunctionInfo.call(this);
}
c_R4.prototype=extend_class(c_FunctionInfo);
c_R4.m_new=function(){
	c_FunctionInfo.m_new.call(this,"cerberus.boxes.BoxBool",0,bb_reflection__classes[0],[bb_reflection__boolClass]);
	return this;
}
function c_R5(){
	c_FunctionInfo.call(this);
}
c_R5.prototype=extend_class(c_FunctionInfo);
c_R5.m_new=function(){
	c_FunctionInfo.m_new.call(this,"cerberus.boxes.BoxInt",0,bb_reflection__classes[0],[bb_reflection__intClass]);
	return this;
}
function c_R6(){
	c_FunctionInfo.call(this);
}
c_R6.prototype=extend_class(c_FunctionInfo);
c_R6.m_new=function(){
	c_FunctionInfo.m_new.call(this,"cerberus.boxes.BoxFloat",0,bb_reflection__classes[0],[bb_reflection__floatClass]);
	return this;
}
function c_R7(){
	c_FunctionInfo.call(this);
}
c_R7.prototype=extend_class(c_FunctionInfo);
c_R7.m_new=function(){
	c_FunctionInfo.m_new.call(this,"cerberus.boxes.BoxString",0,bb_reflection__classes[0],[bb_reflection__stringClass]);
	return this;
}
function c_R8(){
	c_FunctionInfo.call(this);
}
c_R8.prototype=extend_class(c_FunctionInfo);
c_R8.m_new=function(){
	c_FunctionInfo.m_new.call(this,"cerberus.boxes.UnboxBool",0,bb_reflection__boolClass,[bb_reflection__classes[0]]);
	return this;
}
function c_R9(){
	c_FunctionInfo.call(this);
}
c_R9.prototype=extend_class(c_FunctionInfo);
c_R9.m_new=function(){
	c_FunctionInfo.m_new.call(this,"cerberus.boxes.UnboxInt",0,bb_reflection__intClass,[bb_reflection__classes[0]]);
	return this;
}
function c_R10(){
	c_FunctionInfo.call(this);
}
c_R10.prototype=extend_class(c_FunctionInfo);
c_R10.m_new=function(){
	c_FunctionInfo.m_new.call(this,"cerberus.boxes.UnboxFloat",0,bb_reflection__floatClass,[bb_reflection__classes[0]]);
	return this;
}
function c_R11(){
	c_FunctionInfo.call(this);
}
c_R11.prototype=extend_class(c_FunctionInfo);
c_R11.m_new=function(){
	c_FunctionInfo.m_new.call(this,"cerberus.boxes.UnboxString",0,bb_reflection__stringClass,[bb_reflection__classes[0]]);
	return this;
}
function c_R12(){
	c_FunctionInfo.call(this);
}
c_R12.prototype=extend_class(c_FunctionInfo);
c_R12.m_new=function(){
	c_FunctionInfo.m_new.call(this,"cerberus.lang.DebugLog",0,bb_reflection__intClass,[bb_reflection__stringClass]);
	return this;
}
function c_R13(){
	c_FunctionInfo.call(this);
}
c_R13.prototype=extend_class(c_FunctionInfo);
c_R13.m_new=function(){
	c_FunctionInfo.m_new.call(this,"cerberus.lang.DebugStop",0,bb_reflection__intClass,[]);
	return this;
}
function c_R14(){
	c_FunctionInfo.call(this);
}
c_R14.prototype=extend_class(c_FunctionInfo);
c_R14.m_new=function(){
	c_FunctionInfo.m_new.call(this,"cerberus.lang.Print",1,bb_reflection__intClass,[bb_reflection__stringClass]);
	return this;
}
function c_R15(){
	c_FunctionInfo.call(this);
}
c_R15.prototype=extend_class(c_FunctionInfo);
c_R15.m_new=function(){
	c_FunctionInfo.m_new.call(this,"cerberus.lang.Error",1,bb_reflection__intClass,[bb_reflection__stringClass]);
	return this;
}
function c___GetClass(){
	c__GetClass.call(this);
}
c___GetClass.prototype=extend_class(c__GetClass);
c___GetClass.m_new=function(){
	c__GetClass.m_new.call(this);
	return this;
}
c___GetClass.prototype.p_GetClass=function(t_o){
	if(object_downcast((t_o),c_FormatException)!=null){
		return bb_reflection__classes[13];
	}
	if(object_downcast((t_o),c_UnsupportedOperationException)!=null){
		return bb_reflection__classes[12];
	}
	if(object_downcast((t_o),c_XMLParseException)!=null){
		return bb_reflection__classes[11];
	}
	if(object_downcast((t_o),c_IllegalArgumentException)!=null){
		return bb_reflection__classes[10];
	}
	if(object_downcast((t_o),c_IndexOutOfBoundsException)!=null){
		return bb_reflection__classes[9];
	}
	if(object_downcast((t_o),c_ConcurrentModificationException)!=null){
		return bb_reflection__classes[8];
	}
	if(object_downcast((t_o),c_AssertException)!=null){
		return bb_reflection__classes[7];
	}
	if(object_downcast((t_o),c_DiddyException)!=null){
		return bb_reflection__classes[6];
	}
	if(object_downcast((t_o),ThrowableObject)!=null){
		return bb_reflection__classes[5];
	}
	if(object_downcast((t_o),c_StringObject)!=null){
		return bb_reflection__classes[4];
	}
	if(object_downcast((t_o),c_FloatObject)!=null){
		return bb_reflection__classes[3];
	}
	if(object_downcast((t_o),c_IntObject)!=null){
		return bb_reflection__classes[2];
	}
	if(object_downcast((t_o),c_BoolObject)!=null){
		return bb_reflection__classes[1];
	}
	if(t_o!=null){
		return bb_reflection__classes[0];
	}
	return bb_reflection__unknownClass;
}
function bb_reflection___init(){
	bb_reflection__classes=new_object_array(14);
	bb_reflection__classes[0]=(c_R16.m_new.call(new c_R16));
	bb_reflection__classes[1]=(c_R17.m_new.call(new c_R17));
	bb_reflection__classes[2]=(c_R23.m_new.call(new c_R23));
	bb_reflection__classes[3]=(c_R33.m_new.call(new c_R33));
	bb_reflection__classes[4]=(c_R43.m_new.call(new c_R43));
	bb_reflection__classes[5]=(c_R52.m_new.call(new c_R52));
	bb_reflection__classes[6]=(c_R53.m_new.call(new c_R53));
	bb_reflection__classes[7]=(c_R66.m_new.call(new c_R66));
	bb_reflection__classes[8]=(c_R68.m_new.call(new c_R68));
	bb_reflection__classes[9]=(c_R70.m_new.call(new c_R70));
	bb_reflection__classes[10]=(c_R72.m_new.call(new c_R72));
	bb_reflection__classes[11]=(c_R74.m_new.call(new c_R74));
	bb_reflection__classes[12]=(c_R76.m_new.call(new c_R76));
	bb_reflection__classes[13]=(c_R78.m_new.call(new c_R78));
	bb_reflection__classes[0].p_Init();
	bb_reflection__classes[1].p_Init();
	bb_reflection__classes[2].p_Init();
	bb_reflection__classes[3].p_Init();
	bb_reflection__classes[4].p_Init();
	bb_reflection__classes[5].p_Init();
	bb_reflection__classes[6].p_Init();
	bb_reflection__classes[7].p_Init();
	bb_reflection__classes[8].p_Init();
	bb_reflection__classes[9].p_Init();
	bb_reflection__classes[10].p_Init();
	bb_reflection__classes[11].p_Init();
	bb_reflection__classes[12].p_Init();
	bb_reflection__classes[13].p_Init();
	bb_reflection__functions=new_object_array(12);
	bb_reflection__functions[0]=(c_R4.m_new.call(new c_R4));
	bb_reflection__functions[1]=(c_R5.m_new.call(new c_R5));
	bb_reflection__functions[2]=(c_R6.m_new.call(new c_R6));
	bb_reflection__functions[3]=(c_R7.m_new.call(new c_R7));
	bb_reflection__functions[4]=(c_R8.m_new.call(new c_R8));
	bb_reflection__functions[5]=(c_R9.m_new.call(new c_R9));
	bb_reflection__functions[6]=(c_R10.m_new.call(new c_R10));
	bb_reflection__functions[7]=(c_R11.m_new.call(new c_R11));
	bb_reflection__functions[8]=(c_R12.m_new.call(new c_R12));
	bb_reflection__functions[9]=(c_R13.m_new.call(new c_R13));
	bb_reflection__functions[10]=(c_R14.m_new.call(new c_R14));
	bb_reflection__functions[11]=(c_R15.m_new.call(new c_R15));
	bb_reflection__getClass=(c___GetClass.m_new.call(new c___GetClass));
	return 0;
}
var bb_reflection__init=0;
function c_App(){
	Object.call(this);
}
c_App.m_new=function(){
	if((bb_app__app)!=null){
		error("App has already been created");
	}
	bb_app__app=this;
	bb_app__delegate=c_GameDelegate.m_new.call(new c_GameDelegate);
	bb_app__game.SetDelegate(bb_app__delegate);
	return this;
}
c_App.prototype.p_OnResize=function(){
	return 0;
}
c_App.prototype.p_OnCreate=function(){
	return 0;
}
c_App.prototype.p_OnSuspend=function(){
	return 0;
}
c_App.prototype.p_OnResume=function(){
	return 0;
}
c_App.prototype.p_OnUpdate=function(){
	return 0;
}
c_App.prototype.p_OnLoading=function(){
	return 0;
}
c_App.prototype.p_OnRender=function(){
	return 0;
}
c_App.prototype.p_OnClose=function(){
	bb_app_EndApp();
	return 0;
}
c_App.prototype.p_OnBack=function(){
	this.p_OnClose();
	return 0;
}
function c_GameApp(){
	c_App.call(this);
	this.m_GameWidth=0;
	this.m_GameHeight=0;
	this.m_bLoading=false;
	this.m_indexLoading=0;
	this.m_percentLoading=0;
	this.m_mx=0;
	this.m_my=0;
	this.m_mouse=c_sPoint.m_new3.call(new c_sPoint);
	this.m_IncpercentLoading=0;
}
c_GameApp.prototype=extend_class(c_App);
c_GameApp.prototype.p_LoadCfg=function(){
	var t_str="";
	t_str=bb_app_LoadState();
	if(t_str.length<25){
	}
	return 0;
}
c_GameApp.m_new=function(t_width,t_height){
	c_App.m_new.call(this);
	this.m_GameWidth=t_width;
	this.m_GameHeight=t_height;
	bb_collaborate_gScreenWidth=t_width;
	bb_collaborate_gScreenHeight=t_height;
	this.m_bLoading=true;
	this.m_indexLoading=1;
	this.m_percentLoading=0;
	var t_data=[];
	bb_random_Seed=bb_app_Millisecs();
	var t_ratio=(bb_collaborate_gScreenWidth)/(bb_collaborate_gScreenHeight);
	this.m_GameHeight=(((this.m_GameWidth)/t_ratio)|0);
	bb_app_SetDeviceWindow(bb_collaborate_gScreenWidth,bb_collaborate_gScreenHeight,0);
	this.p_LoadCfg();
	return this;
}
c_GameApp.m_new2=function(){
	c_App.m_new.call(this);
	return this;
}
c_GameApp.prototype.p_OnCreate=function(){
	bb_app_SetUpdateRate(bb_game_UPDATE_RATE);
	bb_game_gPercentLoad=1;
	bb_autofit_SetVirtualDisplay(this.m_GameWidth,this.m_GameHeight,1.0);
	bb_session_GameSession=c_Session.m_new.call(new c_Session);
	bb_session_GameSession.p_SetState(1);
	bb_defaultmedia_IMG_MAIN=bb_graphics_LoadImage("menu/background.jpg",1,c_Image.m_DefaultFlags);
	return 0;
}
c_GameApp.prototype.p_OnSuspend=function(){
	bb_game_isSuspend=true;
	bb_audio_PauseMusic();
	return 0;
}
c_GameApp.prototype.p_OnResume=function(){
	bb_game_isSuspend=false;
	return 0;
}
c_GameApp.prototype.p_SaveCfg=function(){
	var t_str="";
	bb_app_SaveState(t_str);
	return 0;
}
c_GameApp.prototype.p_ExitApp=function(){
	this.p_SaveCfg();
	error("");
	return 0;
}
c_GameApp.prototype.p_OnBack=function(){
	if(c_Session.m_GameState==3){
		this.p_ExitApp();
	}else{
		bb_session_GameSession.p_SetState(3);
	}
	return 0;
}
c_GameApp.prototype.p_OnUpdate=function(){
	if(this.m_bLoading==false){
		bb_updategame_UpdateGame();
	}
	bb_asyncevent_UpdateAsyncEvents();
	return 0;
}
c_GameApp.prototype.p_OnLoad=function(){
	var t_1=this.m_indexLoading;
	if(t_1==1){
		bb_game_cLANGUAGE.p_Init4(0);
		bb_defaultmedia_SPRITE_ICON[0]=bb_graphics_LoadImage2("menu/upload.png",256,256,1,1);
		this.m_IncpercentLoading=6;
		this.m_percentLoading=0;
	}else{
		if(t_1==2){
			bb_defaultmedia_SPRITE_ICON[1]=bb_graphics_LoadImage2("menu/gallery.png",256,256,1,1);
			bb_defaultmedia_ICON_CHECK=bb_graphics_LoadImage2("menu/check.png",16,16,2,1);
			bb_defaultmedia_ICON_VERIFY=bb_graphics_LoadImage2("menu/verify.png",32,32,2,1);
			bb_defaultmedia_ICON_INFO=bb_graphics_LoadImage2("menu/info.png",32,32,1,1);
		}else{
			if(t_1==3){
				bb_defaultmedia_SPRITE_LOGO=bb_graphics_LoadImage2("menu/logo.png",256,128,1,1);
				bb_defaultmedia_ICON_SCENT=bb_graphics_LoadImage2("icone/icon.png",128,128,5,1);
			}else{
				if(t_1==4){
					bb_game_cMANAGEITEMS.p_load("taxonomy.xml");
					bb_defaultmedia_ICON_LOGIN=bb_graphics_LoadImage2("menu/login.png",128,128,2,1);
					bb_defaultmedia_ICON_LOADER=bb_graphics_LoadImage2("menu/loader.png",256,256,1,1);
				}else{
					if(t_1==5){
						bb_defaultmedia_ICON_REFRESH=bb_graphics_LoadImage2("menu/refresh.png",256,256,1,1);
						bb_defaultmedia_ICON_FLAGS=bb_graphics_LoadImage2("menu/flags.png",48,48,4,1);
					}else{
						if(t_1==6){
							bb_defaultmedia_SPRITE_HELPER=bb_graphics_LoadImage2("helper/helper1.png",256,256,4,1);
						}else{
							if(t_1==7){
								bb_defaultmedia_ICON_SCROLL=bb_graphics_LoadImage2("menu/scroll.png",64,64,2,1);
								bb_defaultmedia_ICON_ROTATE=bb_graphics_LoadImage2("menu/rotate.png",64,64,1,1);
							}else{
								if(t_1==8){
									bb_game_cRENDER_PROFILE.p_LoadProfile();
								}else{
									if(t_1==9){
										bb_game_cRENDER_PROFILE.p_LoadAudio();
									}else{
										if(t_1==10){
											bb_game_cRENDER_PROFILE.p_LoadBadges(0,3);
										}else{
											if(t_1==11){
												bb_game_cRENDER_PROFILE.p_LoadBadges(3,6);
											}else{
												if(t_1==12){
													bb_game_cRENDER_PROFILE.p_LoadBadges(6,9);
												}else{
													if(t_1==13){
														bb_game_cRENDER_PROFILE.p_LoadBadges(9,12);
													}else{
														if(t_1==14){
															bb_game_cRENDER_PROFILE.p_LoadBadges(12,15);
														}else{
															if(t_1==15){
																bb_game_cRENDER_PROFILE.p_LoadBadges(15,18);
															}else{
																if(t_1==16){
																	bb_game_cRENDER_PROFILE.p_LoadBadges(18,21);
																}else{
																	if(t_1==17){
																		bb_game_fontAngel.p_LoadFontXml("arial");
																		bb_game_fontAngelMini.p_LoadFontXml("arialmenu");
																		bb_game_fontAngelTitle.p_LoadFontXml("arial48");
																	}else{
																		bb_game_gPercentLoad=0;
																		this.m_bLoading=false;
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	if(this.m_bLoading==true){
		this.m_percentLoading=this.m_percentLoading+this.m_IncpercentLoading;
		if(this.m_percentLoading>100){
			this.m_percentLoading=100;
		}
		this.m_indexLoading=this.m_indexLoading+1;
	}
	return 0;
}
c_GameApp.prototype.p_OnProgressBar=function(t_per){
	bb_autofit_UpdateVirtualDisplay(true,true);
	bb_graphics_DrawImage(bb_defaultmedia_IMG_MAIN,0.0,0.0,0);
	bb_graphics_SetColor(180.0,180.0,180.0);
	bb_graphics_SetAlpha(0.5);
	bb_graphics_DrawRect(64.0,(((this.m_GameHeight/2)|0)-32),((this.m_GameWidth-128)*this.m_percentLoading)/100.0,16.0);
	bb_graphics_SetColor(255.0,255.0,255.0);
	bb_graphics_SetAlpha(1.0);
	return 0;
}
c_GameApp.prototype.p_OnRender=function(){
	if(bb_game_isSuspend==false){
		if(this.m_bLoading==false){
			bb_rendergame_RenderStates();
		}else{
			this.p_OnLoad();
			this.p_OnProgressBar(this.m_percentLoading);
		}
	}
	return 0;
}
var bb_collaborate_gScreenWidth=0;
var bb_collaborate_gScreenHeight=0;
var bb_app__app=null;
function c_GameDelegate(){
	BBGameDelegate.call(this);
	this.m__graphics=null;
	this.m__audio=null;
	this.m__input=null;
}
c_GameDelegate.prototype=extend_class(BBGameDelegate);
c_GameDelegate.m_new=function(){
	return this;
}
c_GameDelegate.prototype.StartGame=function(){
	this.m__graphics=(new gxtkGraphics);
	bb_graphics_SetGraphicsDevice(this.m__graphics);
	bb_graphics_SetFont(null);
	this.m__audio=(new gxtkAudio);
	bb_audio_SetAudioDevice(this.m__audio);
	this.m__input=c_InputDevice.m_new.call(new c_InputDevice);
	bb_input_SetInputDevice(this.m__input);
	bb_app_ValidateDeviceWindow(false);
	bb_app_EnumDisplayModes();
	bb_app__app.p_OnCreate();
}
c_GameDelegate.prototype.SuspendGame=function(){
	bb_app__app.p_OnSuspend();
	this.m__audio.Suspend();
}
c_GameDelegate.prototype.ResumeGame=function(){
	this.m__audio.Resume();
	bb_app__app.p_OnResume();
}
c_GameDelegate.prototype.UpdateGame=function(){
	bb_app_ValidateDeviceWindow(true);
	this.m__input.p_BeginUpdate();
	bb_app__app.p_OnUpdate();
	this.m__input.p_EndUpdate();
}
c_GameDelegate.prototype.RenderGame=function(){
	bb_app_ValidateDeviceWindow(true);
	var t_mode=this.m__graphics.BeginRender();
	if((t_mode)!=0){
		bb_graphics_BeginRender();
	}
	if(t_mode==2){
		bb_app__app.p_OnLoading();
	}else{
		bb_app__app.p_OnRender();
	}
	if((t_mode)!=0){
		bb_graphics_EndRender();
	}
	this.m__graphics.EndRender();
}
c_GameDelegate.prototype.KeyEvent=function(t_event,t_data){
	this.m__input.p_KeyEvent(t_event,t_data);
	if(t_event!=1){
		return;
	}
	var t_1=t_data;
	if(t_1==432){
		bb_app__app.p_OnClose();
	}else{
		if(t_1==416){
			bb_app__app.p_OnBack();
		}
	}
}
c_GameDelegate.prototype.MouseEvent=function(t_event,t_data,t_x,t_y,t_z){
	this.m__input.p_MouseEvent(t_event,t_data,t_x,t_y,t_z);
}
c_GameDelegate.prototype.TouchEvent=function(t_event,t_data,t_x,t_y){
	this.m__input.p_TouchEvent(t_event,t_data,t_x,t_y);
}
c_GameDelegate.prototype.MotionEvent=function(t_event,t_data,t_x,t_y,t_z){
	this.m__input.p_MotionEvent(t_event,t_data,t_x,t_y,t_z);
}
c_GameDelegate.prototype.DiscardGraphics=function(){
	this.m__graphics.DiscardGraphics();
}
var bb_app__delegate=null;
var bb_app__game=null;
function bb_app_Millisecs(){
	return bb_app__game.Millisecs();
}
var bb_random_Seed=0;
var bb_app__devWidth=0;
var bb_app__devHeight=0;
function bb_app_ValidateDeviceWindow(t_notifyApp){
	var t_w=bb_app__game.GetDeviceWidth();
	var t_h=bb_app__game.GetDeviceHeight();
	if(t_w==bb_app__devWidth && t_h==bb_app__devHeight){
		return;
	}
	bb_app__devWidth=t_w;
	bb_app__devHeight=t_h;
	if(t_notifyApp){
		bb_app__app.p_OnResize();
	}
}
function bb_app_SetDeviceWindow(t_width,t_height,t_flags){
	bb_app__game.SetDeviceWindow(t_width,t_height,t_flags);
	bb_app_ValidateDeviceWindow(false);
}
function bb_app_LoadState(){
	return bb_app__game.LoadState();
}
var bb_collaborate_Collaborate=null;
function bbMain(){
	bb_collaborate_Collaborate=c_GameApp.m_new.call(new c_GameApp,bb_collaborate_gScreenWidth,bb_collaborate_gScreenHeight);
	return 0;
}
function c_ConstInfo(){
	Object.call(this);
}
function c_Stack(){
	Object.call(this);
	this.m_data=[];
	this.m_length=0;
}
c_Stack.m_new=function(){
	return this;
}
c_Stack.m_new2=function(t_data){
	this.m_data=t_data.slice(0);
	this.m_length=t_data.length;
	return this;
}
c_Stack.prototype.p_Push=function(t_value){
	if(this.m_length==this.m_data.length){
		this.m_data=resize_object_array(this.m_data,this.m_length*2+10);
	}
	this.m_data[this.m_length]=t_value;
	this.m_length+=1;
}
c_Stack.prototype.p_Push2=function(t_values,t_offset,t_count){
	for(var t_i=0;t_i<t_count;t_i=t_i+1){
		this.p_Push(t_values[t_offset+t_i]);
	}
}
c_Stack.prototype.p_Push3=function(t_values,t_offset){
	this.p_Push2(t_values,t_offset,t_values.length-t_offset);
}
c_Stack.prototype.p_ToArray=function(){
	var t_t=new_object_array(this.m_length);
	for(var t_i=0;t_i<this.m_length;t_i=t_i+1){
		t_t[t_i]=this.m_data[t_i];
	}
	return t_t;
}
function c_FieldInfo(){
	Object.call(this);
	this.m__name="";
	this.m__attrs=0;
	this.m__type=null;
}
c_FieldInfo.m_new=function(t_name,t_attrs,t_type){
	this.m__name=t_name;
	this.m__attrs=t_attrs;
	this.m__type=t_type;
	return this;
}
c_FieldInfo.m_new2=function(){
	return this;
}
function c_Stack2(){
	Object.call(this);
	this.m_data=[];
	this.m_length=0;
}
c_Stack2.m_new=function(){
	return this;
}
c_Stack2.m_new2=function(t_data){
	this.m_data=t_data.slice(0);
	this.m_length=t_data.length;
	return this;
}
c_Stack2.prototype.p_Push4=function(t_value){
	if(this.m_length==this.m_data.length){
		this.m_data=resize_object_array(this.m_data,this.m_length*2+10);
	}
	this.m_data[this.m_length]=t_value;
	this.m_length+=1;
}
c_Stack2.prototype.p_Push5=function(t_values,t_offset,t_count){
	for(var t_i=0;t_i<t_count;t_i=t_i+1){
		this.p_Push4(t_values[t_offset+t_i]);
	}
}
c_Stack2.prototype.p_Push6=function(t_values,t_offset){
	this.p_Push5(t_values,t_offset,t_values.length-t_offset);
}
c_Stack2.prototype.p_ToArray=function(){
	var t_t=new_object_array(this.m_length);
	for(var t_i=0;t_i<this.m_length;t_i=t_i+1){
		t_t[t_i]=this.m_data[t_i];
	}
	return t_t;
}
function c_GlobalInfo(){
	Object.call(this);
}
function c_Stack3(){
	Object.call(this);
	this.m_data=[];
	this.m_length=0;
}
c_Stack3.m_new=function(){
	return this;
}
c_Stack3.m_new2=function(t_data){
	this.m_data=t_data.slice(0);
	this.m_length=t_data.length;
	return this;
}
c_Stack3.prototype.p_Push7=function(t_value){
	if(this.m_length==this.m_data.length){
		this.m_data=resize_object_array(this.m_data,this.m_length*2+10);
	}
	this.m_data[this.m_length]=t_value;
	this.m_length+=1;
}
c_Stack3.prototype.p_Push8=function(t_values,t_offset,t_count){
	for(var t_i=0;t_i<t_count;t_i=t_i+1){
		this.p_Push7(t_values[t_offset+t_i]);
	}
}
c_Stack3.prototype.p_Push9=function(t_values,t_offset){
	this.p_Push8(t_values,t_offset,t_values.length-t_offset);
}
c_Stack3.prototype.p_ToArray=function(){
	var t_t=new_object_array(this.m_length);
	for(var t_i=0;t_i<this.m_length;t_i=t_i+1){
		t_t[t_i]=this.m_data[t_i];
	}
	return t_t;
}
function c_MethodInfo(){
	Object.call(this);
	this.m__name="";
	this.m__attrs=0;
	this.m__retType=null;
	this.m__argTypes=[];
}
c_MethodInfo.m_new=function(t_name,t_attrs,t_retType,t_argTypes){
	this.m__name=t_name;
	this.m__attrs=t_attrs;
	this.m__retType=t_retType;
	this.m__argTypes=t_argTypes;
	return this;
}
c_MethodInfo.m_new2=function(){
	return this;
}
function c_Stack4(){
	Object.call(this);
	this.m_data=[];
	this.m_length=0;
}
c_Stack4.m_new=function(){
	return this;
}
c_Stack4.m_new2=function(t_data){
	this.m_data=t_data.slice(0);
	this.m_length=t_data.length;
	return this;
}
c_Stack4.prototype.p_Push10=function(t_value){
	if(this.m_length==this.m_data.length){
		this.m_data=resize_object_array(this.m_data,this.m_length*2+10);
	}
	this.m_data[this.m_length]=t_value;
	this.m_length+=1;
}
c_Stack4.prototype.p_Push11=function(t_values,t_offset,t_count){
	for(var t_i=0;t_i<t_count;t_i=t_i+1){
		this.p_Push10(t_values[t_offset+t_i]);
	}
}
c_Stack4.prototype.p_Push12=function(t_values,t_offset){
	this.p_Push11(t_values,t_offset,t_values.length-t_offset);
}
c_Stack4.prototype.p_ToArray=function(){
	var t_t=new_object_array(this.m_length);
	for(var t_i=0;t_i<this.m_length;t_i=t_i+1){
		t_t[t_i]=this.m_data[t_i];
	}
	return t_t;
}
function c_Stack5(){
	Object.call(this);
	this.m_data=[];
	this.m_length=0;
}
c_Stack5.m_new=function(){
	return this;
}
c_Stack5.m_new2=function(t_data){
	this.m_data=t_data.slice(0);
	this.m_length=t_data.length;
	return this;
}
c_Stack5.prototype.p_Push13=function(t_value){
	if(this.m_length==this.m_data.length){
		this.m_data=resize_object_array(this.m_data,this.m_length*2+10);
	}
	this.m_data[this.m_length]=t_value;
	this.m_length+=1;
}
c_Stack5.prototype.p_Push14=function(t_values,t_offset,t_count){
	for(var t_i=0;t_i<t_count;t_i=t_i+1){
		this.p_Push13(t_values[t_offset+t_i]);
	}
}
c_Stack5.prototype.p_Push15=function(t_values,t_offset){
	this.p_Push14(t_values,t_offset,t_values.length-t_offset);
}
c_Stack5.prototype.p_ToArray=function(){
	var t_t=new_object_array(this.m_length);
	for(var t_i=0;t_i<this.m_length;t_i=t_i+1){
		t_t[t_i]=this.m_data[t_i];
	}
	return t_t;
}
function c_R18(){
	c_FieldInfo.call(this);
}
c_R18.prototype=extend_class(c_FieldInfo);
c_R18.m_new=function(){
	c_FieldInfo.m_new.call(this,"value",0,bb_reflection__boolClass);
	return this;
}
function c_R20(){
	c_MethodInfo.call(this);
}
c_R20.prototype=extend_class(c_MethodInfo);
c_R20.m_new=function(){
	c_MethodInfo.m_new.call(this,"ToBool",0,bb_reflection__boolClass,[]);
	return this;
}
function c_R21(){
	c_MethodInfo.call(this);
}
c_R21.prototype=extend_class(c_MethodInfo);
c_R21.m_new=function(){
	c_MethodInfo.m_new.call(this,"Equals",0,bb_reflection__boolClass,[bb_reflection__classes[1]]);
	return this;
}
function c_R19(){
	c_FunctionInfo.call(this);
}
c_R19.prototype=extend_class(c_FunctionInfo);
c_R19.m_new=function(){
	c_FunctionInfo.m_new.call(this,"new",0,bb_reflection__classes[1],[bb_reflection__boolClass]);
	return this;
}
function c_R22(){
	c_FunctionInfo.call(this);
}
c_R22.prototype=extend_class(c_FunctionInfo);
c_R22.m_new=function(){
	c_FunctionInfo.m_new.call(this,"new",0,bb_reflection__classes[1],[]);
	return this;
}
function c_R24(){
	c_FieldInfo.call(this);
}
c_R24.prototype=extend_class(c_FieldInfo);
c_R24.m_new=function(){
	c_FieldInfo.m_new.call(this,"value",0,bb_reflection__intClass);
	return this;
}
function c_R27(){
	c_MethodInfo.call(this);
}
c_R27.prototype=extend_class(c_MethodInfo);
c_R27.m_new=function(){
	c_MethodInfo.m_new.call(this,"ToInt",0,bb_reflection__intClass,[]);
	return this;
}
function c_R28(){
	c_MethodInfo.call(this);
}
c_R28.prototype=extend_class(c_MethodInfo);
c_R28.m_new=function(){
	c_MethodInfo.m_new.call(this,"ToFloat",0,bb_reflection__floatClass,[]);
	return this;
}
function c_R29(){
	c_MethodInfo.call(this);
}
c_R29.prototype=extend_class(c_MethodInfo);
c_R29.m_new=function(){
	c_MethodInfo.m_new.call(this,"ToString",0,bb_reflection__stringClass,[]);
	return this;
}
function c_R30(){
	c_MethodInfo.call(this);
}
c_R30.prototype=extend_class(c_MethodInfo);
c_R30.m_new=function(){
	c_MethodInfo.m_new.call(this,"Equals",0,bb_reflection__boolClass,[bb_reflection__classes[2]]);
	return this;
}
function c_R31(){
	c_MethodInfo.call(this);
}
c_R31.prototype=extend_class(c_MethodInfo);
c_R31.m_new=function(){
	c_MethodInfo.m_new.call(this,"Compare",0,bb_reflection__intClass,[bb_reflection__classes[2]]);
	return this;
}
function c_R25(){
	c_FunctionInfo.call(this);
}
c_R25.prototype=extend_class(c_FunctionInfo);
c_R25.m_new=function(){
	c_FunctionInfo.m_new.call(this,"new",0,bb_reflection__classes[2],[bb_reflection__intClass]);
	return this;
}
function c_R26(){
	c_FunctionInfo.call(this);
}
c_R26.prototype=extend_class(c_FunctionInfo);
c_R26.m_new=function(){
	c_FunctionInfo.m_new.call(this,"new",0,bb_reflection__classes[2],[bb_reflection__floatClass]);
	return this;
}
function c_R32(){
	c_FunctionInfo.call(this);
}
c_R32.prototype=extend_class(c_FunctionInfo);
c_R32.m_new=function(){
	c_FunctionInfo.m_new.call(this,"new",0,bb_reflection__classes[2],[]);
	return this;
}
function c_R34(){
	c_FieldInfo.call(this);
}
c_R34.prototype=extend_class(c_FieldInfo);
c_R34.m_new=function(){
	c_FieldInfo.m_new.call(this,"value",0,bb_reflection__floatClass);
	return this;
}
function c_R37(){
	c_MethodInfo.call(this);
}
c_R37.prototype=extend_class(c_MethodInfo);
c_R37.m_new=function(){
	c_MethodInfo.m_new.call(this,"ToInt",0,bb_reflection__intClass,[]);
	return this;
}
function c_R38(){
	c_MethodInfo.call(this);
}
c_R38.prototype=extend_class(c_MethodInfo);
c_R38.m_new=function(){
	c_MethodInfo.m_new.call(this,"ToFloat",0,bb_reflection__floatClass,[]);
	return this;
}
function c_R39(){
	c_MethodInfo.call(this);
}
c_R39.prototype=extend_class(c_MethodInfo);
c_R39.m_new=function(){
	c_MethodInfo.m_new.call(this,"ToString",0,bb_reflection__stringClass,[]);
	return this;
}
function c_R40(){
	c_MethodInfo.call(this);
}
c_R40.prototype=extend_class(c_MethodInfo);
c_R40.m_new=function(){
	c_MethodInfo.m_new.call(this,"Equals",0,bb_reflection__boolClass,[bb_reflection__classes[3]]);
	return this;
}
function c_R41(){
	c_MethodInfo.call(this);
}
c_R41.prototype=extend_class(c_MethodInfo);
c_R41.m_new=function(){
	c_MethodInfo.m_new.call(this,"Compare",0,bb_reflection__intClass,[bb_reflection__classes[3]]);
	return this;
}
function c_R35(){
	c_FunctionInfo.call(this);
}
c_R35.prototype=extend_class(c_FunctionInfo);
c_R35.m_new=function(){
	c_FunctionInfo.m_new.call(this,"new",0,bb_reflection__classes[3],[bb_reflection__intClass]);
	return this;
}
function c_R36(){
	c_FunctionInfo.call(this);
}
c_R36.prototype=extend_class(c_FunctionInfo);
c_R36.m_new=function(){
	c_FunctionInfo.m_new.call(this,"new",0,bb_reflection__classes[3],[bb_reflection__floatClass]);
	return this;
}
function c_R42(){
	c_FunctionInfo.call(this);
}
c_R42.prototype=extend_class(c_FunctionInfo);
c_R42.m_new=function(){
	c_FunctionInfo.m_new.call(this,"new",0,bb_reflection__classes[3],[]);
	return this;
}
function c_R44(){
	c_FieldInfo.call(this);
}
c_R44.prototype=extend_class(c_FieldInfo);
c_R44.m_new=function(){
	c_FieldInfo.m_new.call(this,"value",0,bb_reflection__stringClass);
	return this;
}
function c_R48(){
	c_MethodInfo.call(this);
}
c_R48.prototype=extend_class(c_MethodInfo);
c_R48.m_new=function(){
	c_MethodInfo.m_new.call(this,"ToString",0,bb_reflection__stringClass,[]);
	return this;
}
function c_R49(){
	c_MethodInfo.call(this);
}
c_R49.prototype=extend_class(c_MethodInfo);
c_R49.m_new=function(){
	c_MethodInfo.m_new.call(this,"Equals",0,bb_reflection__boolClass,[bb_reflection__classes[4]]);
	return this;
}
function c_R50(){
	c_MethodInfo.call(this);
}
c_R50.prototype=extend_class(c_MethodInfo);
c_R50.m_new=function(){
	c_MethodInfo.m_new.call(this,"Compare",0,bb_reflection__intClass,[bb_reflection__classes[4]]);
	return this;
}
function c_R45(){
	c_FunctionInfo.call(this);
}
c_R45.prototype=extend_class(c_FunctionInfo);
c_R45.m_new=function(){
	c_FunctionInfo.m_new.call(this,"new",0,bb_reflection__classes[4],[bb_reflection__intClass]);
	return this;
}
function c_R46(){
	c_FunctionInfo.call(this);
}
c_R46.prototype=extend_class(c_FunctionInfo);
c_R46.m_new=function(){
	c_FunctionInfo.m_new.call(this,"new",0,bb_reflection__classes[4],[bb_reflection__floatClass]);
	return this;
}
function c_R47(){
	c_FunctionInfo.call(this);
}
c_R47.prototype=extend_class(c_FunctionInfo);
c_R47.m_new=function(){
	c_FunctionInfo.m_new.call(this,"new",0,bb_reflection__classes[4],[bb_reflection__stringClass]);
	return this;
}
function c_R51(){
	c_FunctionInfo.call(this);
}
c_R51.prototype=extend_class(c_FunctionInfo);
c_R51.m_new=function(){
	c_FunctionInfo.m_new.call(this,"new",0,bb_reflection__classes[4],[]);
	return this;
}
function c_R54(){
	c_FieldInfo.call(this);
}
c_R54.prototype=extend_class(c_FieldInfo);
c_R54.m_new=function(){
	c_FieldInfo.m_new.call(this,"message",2,bb_reflection__stringClass);
	return this;
}
function c_R55(){
	c_FieldInfo.call(this);
}
c_R55.prototype=extend_class(c_FieldInfo);
c_R55.m_new=function(){
	c_FieldInfo.m_new.call(this,"cause",2,bb_reflection__classes[5]);
	return this;
}
function c_R56(){
	c_FieldInfo.call(this);
}
c_R56.prototype=extend_class(c_FieldInfo);
c_R56.m_new=function(){
	c_FieldInfo.m_new.call(this,"type",2,bb_reflection__stringClass);
	return this;
}
function c_R57(){
	c_FieldInfo.call(this);
}
c_R57.prototype=extend_class(c_FieldInfo);
c_R57.m_new=function(){
	c_FieldInfo.m_new.call(this,"fullType",2,bb_reflection__stringClass);
	return this;
}
function c_R58(){
	c_MethodInfo.call(this);
}
c_R58.prototype=extend_class(c_MethodInfo);
c_R58.m_new=function(){
	c_MethodInfo.m_new.call(this,"Message",8,bb_reflection__stringClass,[]);
	return this;
}
function c_R59(){
	c_MethodInfo.call(this);
}
c_R59.prototype=extend_class(c_MethodInfo);
c_R59.m_new=function(){
	c_MethodInfo.m_new.call(this,"Message",8,null,[bb_reflection__stringClass]);
	return this;
}
function c_R60(){
	c_MethodInfo.call(this);
}
c_R60.prototype=extend_class(c_MethodInfo);
c_R60.m_new=function(){
	c_MethodInfo.m_new.call(this,"Cause",8,bb_reflection__classes[5],[]);
	return this;
}
function c_R61(){
	c_MethodInfo.call(this);
}
c_R61.prototype=extend_class(c_MethodInfo);
c_R61.m_new=function(){
	c_MethodInfo.m_new.call(this,"Cause",8,null,[bb_reflection__classes[5]]);
	return this;
}
function c_R62(){
	c_MethodInfo.call(this);
}
c_R62.prototype=extend_class(c_MethodInfo);
c_R62.m_new=function(){
	c_MethodInfo.m_new.call(this,"Type",8,bb_reflection__stringClass,[]);
	return this;
}
function c_R63(){
	c_MethodInfo.call(this);
}
c_R63.prototype=extend_class(c_MethodInfo);
c_R63.m_new=function(){
	c_MethodInfo.m_new.call(this,"FullType",8,bb_reflection__stringClass,[]);
	return this;
}
function c_R65(){
	c_MethodInfo.call(this);
}
c_R65.prototype=extend_class(c_MethodInfo);
c_R65.m_new=function(){
	c_MethodInfo.m_new.call(this,"ToString",0,bb_reflection__stringClass,[bb_reflection__boolClass]);
	return this;
}
function c_R64(){
	c_FunctionInfo.call(this);
}
c_R64.prototype=extend_class(c_FunctionInfo);
c_R64.m_new=function(){
	c_FunctionInfo.m_new.call(this,"new",0,bb_reflection__classes[6],[bb_reflection__stringClass,bb_reflection__classes[5]]);
	return this;
}
function c_R67(){
	c_FunctionInfo.call(this);
}
c_R67.prototype=extend_class(c_FunctionInfo);
c_R67.m_new=function(){
	c_FunctionInfo.m_new.call(this,"new",0,bb_reflection__classes[7],[bb_reflection__stringClass,bb_reflection__classes[5]]);
	return this;
}
function c_R69(){
	c_FunctionInfo.call(this);
}
c_R69.prototype=extend_class(c_FunctionInfo);
c_R69.m_new=function(){
	c_FunctionInfo.m_new.call(this,"new",0,bb_reflection__classes[8],[bb_reflection__stringClass,bb_reflection__classes[5]]);
	return this;
}
function c_R71(){
	c_FunctionInfo.call(this);
}
c_R71.prototype=extend_class(c_FunctionInfo);
c_R71.m_new=function(){
	c_FunctionInfo.m_new.call(this,"new",0,bb_reflection__classes[9],[bb_reflection__stringClass,bb_reflection__classes[5]]);
	return this;
}
function c_R73(){
	c_FunctionInfo.call(this);
}
c_R73.prototype=extend_class(c_FunctionInfo);
c_R73.m_new=function(){
	c_FunctionInfo.m_new.call(this,"new",0,bb_reflection__classes[10],[bb_reflection__stringClass,bb_reflection__classes[5]]);
	return this;
}
function c_R75(){
	c_FunctionInfo.call(this);
}
c_R75.prototype=extend_class(c_FunctionInfo);
c_R75.m_new=function(){
	c_FunctionInfo.m_new.call(this,"new",0,bb_reflection__classes[11],[bb_reflection__stringClass,bb_reflection__classes[5]]);
	return this;
}
function c_R77(){
	c_FunctionInfo.call(this);
}
c_R77.prototype=extend_class(c_FunctionInfo);
c_R77.m_new=function(){
	c_FunctionInfo.m_new.call(this,"new",0,bb_reflection__classes[12],[bb_reflection__stringClass,bb_reflection__classes[5]]);
	return this;
}
function c_R79(){
	c_FunctionInfo.call(this);
}
c_R79.prototype=extend_class(c_FunctionInfo);
c_R79.m_new=function(){
	c_FunctionInfo.m_new.call(this,"new",0,bb_reflection__classes[13],[bb_reflection__stringClass,bb_reflection__classes[5]]);
	return this;
}
function c_UnknownClass(){
	c_ClassInfo.call(this);
}
c_UnknownClass.prototype=extend_class(c_ClassInfo);
c_UnknownClass.m_new=function(){
	c_ClassInfo.m_new.call(this,"?",0,null,[]);
	return this;
}
var bb_reflection__unknownClass=null;
var bb_graphics_device=null;
function bb_graphics_SetGraphicsDevice(t_dev){
	bb_graphics_device=t_dev;
	return 0;
}
function c_Font(){
	Object.call(this);
	this.m__pages=[];
	this.m__pageCount=0;
	this.m__firstChar=0;
	this.m__height=.0;
	this.m__charMap=c_IntMap.m_new.call(new c_IntMap);
}
c_Font.m_new=function(t_pages,t_pageCount,t_chars,t_firstChar,t_height){
	this.m__pages=t_pages;
	this.m__pageCount=t_pageCount;
	this.m__firstChar=t_firstChar;
	this.m__height=t_height;
	this.m__charMap=t_chars;
	return this;
}
c_Font.m_new2=function(){
	return this;
}
c_Font.m_Load=function(t_path,t_firstChar,t_numChars,t_padded){
	var t_image=bb_graphics_LoadImage(t_path,1,c_Image.m_DefaultFlags);
	var t__pages=new_object_array(1);
	t__pages[0]=t_image;
	var t__charMap=c_IntMap.m_new.call(new c_IntMap);
	var t__pageCount=1;
	if(!((t_image)!=null)){
		return null;
	}
	var t_cellWidth=((t_image.p_Width()/t_numChars)|0);
	var t_cellHeight=t_image.p_Height();
	var t_glyphX=0;
	var t_glyphY=0;
	var t_glyphWidth=t_cellWidth;
	var t_glyphHeight=t_cellHeight;
	if(t_padded==true){
		t_glyphX+=1;
		t_glyphY+=1;
		t_glyphWidth-=2;
		t_glyphHeight-=2;
	}
	var t_w=((t_image.p_Width()/t_cellWidth)|0);
	var t_h=((t_image.p_Height()/t_cellHeight)|0);
	for(var t_i=0;t_i<t_numChars;t_i=t_i+1){
		var t_y=((t_i/t_w)|0);
		var t_x=t_i % t_w;
		var t_glyph=c_Glyph.m_new.call(new c_Glyph,0,t_firstChar+t_i,t_x*t_cellWidth+t_glyphX,t_y*t_cellHeight+t_glyphY,t_glyphWidth,t_glyphHeight,t_glyphWidth);
		t__charMap.p_Add(t_firstChar+t_i,t_glyph);
	}
	return c_Font.m_new.call(new c_Font,t__pages,t__pageCount,t__charMap,t_firstChar,(t_glyphHeight));
}
c_Font.m_Load2=function(t_path,t_cellWidth,t_cellHeight,t_glyphX,t_glyphY,t_glyphWidth,t_glyphHeight,t_firstChar,t_numChars){
	var t_image=bb_graphics_LoadImage(t_path,1,c_Image.m_DefaultFlags);
	var t__pages=new_object_array(1);
	t__pages[0]=t_image;
	var t__charMap=c_IntMap.m_new.call(new c_IntMap);
	var t__pageCount=1;
	if(!((t_image)!=null)){
		return null;
	}
	var t_w=((t_image.p_Width()/t_cellWidth)|0);
	var t_h=((t_image.p_Height()/t_cellHeight)|0);
	for(var t_i=0;t_i<t_numChars;t_i=t_i+1){
		var t_y=((t_i/t_w)|0);
		var t_x=t_i % t_w;
		var t_glyph=c_Glyph.m_new.call(new c_Glyph,0,t_firstChar+t_i,t_x*t_cellWidth+t_glyphX,t_y*t_cellHeight+t_glyphY,t_glyphWidth,t_glyphHeight,t_glyphWidth);
		t__charMap.p_Add(t_firstChar+t_i,t_glyph);
	}
	return c_Font.m_new.call(new c_Font,t__pages,t__pageCount,t__charMap,t_firstChar,(t_glyphHeight));
}
c_Font.m_Load3=function(t_url){
	var t_iniText="";
	var t_pageNum=0;
	var t_idnum=0;
	var t_tmpChar=null;
	var t_plLen=0;
	var t_lines=[];
	var t_filename="";
	var t_lineHeight=0;
	var t__pages=[];
	var t__charMap=c_IntMap.m_new.call(new c_IntMap);
	var t__pageCount=0;
	var t_path="";
	if(t_url.indexOf("/",0)>-1){
		var t_pl=t_url.split("/");
		t_plLen=t_pl.length;
		for(var t_pi=0;t_pi<=t_plLen-2;t_pi=t_pi+1){
			t_path=t_path+t_pl[t_pi]+"/";
		}
	}
	var t_ts=t_url.toLowerCase();
	if(t_ts.indexOf(".txt",0)>0){
		t_iniText=bb_app_LoadString(t_url);
	}else{
		t_iniText=bb_app_LoadString(t_url+".txt");
	}
	t_lines=t_iniText.split(String.fromCharCode(13)+String.fromCharCode(10));
	if(t_lines.length<2){
		t_lines=t_iniText.split(String.fromCharCode(10));
	}
	var t_=t_lines;
	var t_2=0;
	while(t_2<t_.length){
		var t_line=t_[t_2];
		t_2=t_2+1;
		t_line=string_trim(t_line);
		if(string_startswith(t_line,"info") || t_line==""){
			continue;
		}
		if(string_startswith(t_line,"padding")){
			continue;
		}
		if(string_startswith(t_line,"common")){
			var t_commondata=t_line.split(String.fromCharCode(32));
			var t_3=t_commondata;
			var t_4=0;
			while(t_4<t_3.length){
				var t_common=t_3[t_4];
				t_4=t_4+1;
				if(string_startswith(t_common,"lineHeight=")){
					var t_lnh=t_common.split("=");
					t_lnh[1]=string_trim(t_lnh[1]);
					t_lineHeight=parseInt((t_lnh[1]),10);
				}
				if(string_startswith(t_common,"pages=")){
					var t_lnh2=t_common.split("=");
					t_lnh2[1]=string_trim(t_lnh2[1]);
					t__pageCount=parseInt((t_lnh2[1]),10);
					t__pages=new_object_array(t__pageCount);
				}
			}
		}
		if(string_startswith(t_line,"page")){
			var t_pagedata=t_line.split(String.fromCharCode(32));
			var t_5=t_pagedata;
			var t_6=0;
			while(t_6<t_5.length){
				var t_data=t_5[t_6];
				t_6=t_6+1;
				if(string_startswith(t_data,"file=")){
					var t_fn=t_data.split("=");
					t_fn[1]=string_trim(t_fn[1]);
					t_filename=t_fn[1];
					if(t_filename.charCodeAt(0)==34){
						t_filename=t_filename.slice(1,t_filename.length-1);
					}
					t_filename=t_path+string_trim(t_filename);
					t__pages[t_pageNum]=bb_graphics_LoadImage(t_filename,1,c_Image.m_DefaultFlags);
					t_pageNum=t_pageNum+1;
				}
			}
		}
		if(string_startswith(t_line,"chars")){
			continue;
		}
		if(string_startswith(t_line,"char")){
			t_tmpChar=c_Glyph.m_new2.call(new c_Glyph);
			var t_linedata=t_line.split(String.fromCharCode(32));
			var t_7=t_linedata;
			var t_8=0;
			while(t_8<t_7.length){
				var t_data2=t_7[t_8];
				t_8=t_8+1;
				if(string_startswith(t_data2,"id=")){
					var t_idc=t_data2.split("=");
					t_idc[1]=string_trim(t_idc[1]);
					t_tmpChar.m_id=parseInt((t_idc[1]),10);
				}
				if(string_startswith(t_data2,"x=")){
					var t_xc=t_data2.split("=");
					t_xc[1]=string_trim(t_xc[1]);
					t_tmpChar.m_x=parseInt((t_xc[1]),10);
				}
				if(string_startswith(t_data2,"y=")){
					var t_yc=t_data2.split("=");
					t_yc[1]=string_trim(t_yc[1]);
					t_tmpChar.m_y=parseInt((t_yc[1]),10);
				}
				if(string_startswith(t_data2,"width=")){
					var t_wc=t_data2.split("=");
					t_wc[1]=string_trim(t_wc[1]);
					t_tmpChar.m_width=parseInt((t_wc[1]),10);
				}
				if(string_startswith(t_data2,"height=")){
					var t_hc=t_data2.split("=");
					t_hc[1]=string_trim(t_hc[1]);
					t_tmpChar.m_height=parseInt((t_hc[1]),10);
				}
				if(string_startswith(t_data2,"xoffset=")){
					var t_xoc=t_data2.split("=");
					t_xoc[1]=string_trim(t_xoc[1]);
					t_tmpChar.m_xoff=parseInt((t_xoc[1]),10);
				}
				if(string_startswith(t_data2,"yoffset=")){
					var t_yoc=t_data2.split("=");
					t_yoc[1]=string_trim(t_yoc[1]);
					t_tmpChar.m_yoff=parseInt((t_yoc[1]),10);
				}
				if(string_startswith(t_data2,"xadvance=")){
					var t_advc=t_data2.split("=");
					t_advc[1]=string_trim(t_advc[1]);
					t_tmpChar.m_advance=parseInt((t_advc[1]),10);
				}
				if(string_startswith(t_data2,"page=")){
					var t_advc2=t_data2.split("=");
					t_advc2[1]=string_trim(t_advc2[1]);
					t_tmpChar.m_page=parseInt((t_advc2[1]),10);
				}
			}
			t__charMap.p_Add(t_tmpChar.m_id,t_tmpChar);
		}
		continue;
	}
	return c_Font.m_new.call(new c_Font,t__pages,t__pageCount,t__charMap,-1,(t_lineHeight));
}
function c_GraphicsContext(){
	Object.call(this);
	this.m_defaultFont=null;
	this.m_font=null;
	this.m_matrixSp=0;
	this.m_ix=1.0;
	this.m_iy=.0;
	this.m_jx=.0;
	this.m_jy=1.0;
	this.m_tx=.0;
	this.m_ty=.0;
	this.m_tformed=0;
	this.m_matDirty=0;
	this.m_color_r=.0;
	this.m_color_g=.0;
	this.m_color_b=.0;
	this.m_alpha=.0;
	this.m_blend=0;
	this.m_scissor_x=.0;
	this.m_scissor_y=.0;
	this.m_scissor_width=.0;
	this.m_scissor_height=.0;
	this.m_matrixStack=new_number_array(192);
}
c_GraphicsContext.m_new=function(){
	return this;
}
c_GraphicsContext.prototype.p_Validate=function(){
	if((this.m_matDirty)!=0){
		bb_graphics_renderDevice.SetMatrix(bb_graphics_context.m_ix,bb_graphics_context.m_iy,bb_graphics_context.m_jx,bb_graphics_context.m_jy,bb_graphics_context.m_tx,bb_graphics_context.m_ty);
		this.m_matDirty=0;
	}
	return 0;
}
var bb_graphics_context=null;
function c_Image(){
	Object.call(this);
	this.m_surface=null;
	this.m_width=0;
	this.m_height=0;
	this.m_frames=[];
	this.m_flags=0;
	this.m_tx=.0;
	this.m_ty=.0;
	this.m_source=null;
}
c_Image.m_DefaultFlags=0;
c_Image.m_new=function(){
	return this;
}
c_Image.prototype.p_SetHandle=function(t_tx,t_ty){
	this.m_tx=t_tx;
	this.m_ty=t_ty;
	this.m_flags=this.m_flags&-2;
	return 0;
}
c_Image.prototype.p_ApplyFlags=function(t_iflags){
	this.m_flags=t_iflags;
	if((this.m_flags&2)!=0){
		var t_=this.m_frames;
		var t_2=0;
		while(t_2<t_.length){
			var t_f=t_[t_2];
			t_2=t_2+1;
			t_f.m_x+=1;
		}
		this.m_width-=2;
	}
	if((this.m_flags&4)!=0){
		var t_3=this.m_frames;
		var t_4=0;
		while(t_4<t_3.length){
			var t_f2=t_3[t_4];
			t_4=t_4+1;
			t_f2.m_y+=1;
		}
		this.m_height-=2;
	}
	if((this.m_flags&1)!=0){
		this.p_SetHandle((this.m_width)/2.0,(this.m_height)/2.0);
	}
	if(this.m_frames.length==1 && this.m_frames[0].m_x==0 && this.m_frames[0].m_y==0 && this.m_width==this.m_surface.Width() && this.m_height==this.m_surface.Height()){
		this.m_flags|=65536;
	}
	return 0;
}
c_Image.prototype.p_Init2=function(t_surf,t_nframes,t_iflags){
	if((this.m_surface)!=null){
		error("Image already initialized");
	}
	this.m_surface=t_surf;
	this.m_width=((this.m_surface.Width()/t_nframes)|0);
	this.m_height=this.m_surface.Height();
	this.m_frames=new_object_array(t_nframes);
	for(var t_i=0;t_i<t_nframes;t_i=t_i+1){
		this.m_frames[t_i]=c_Frame.m_new.call(new c_Frame,t_i*this.m_width,0);
	}
	this.p_ApplyFlags(t_iflags);
	return this;
}
c_Image.prototype.p_Init3=function(t_surf,t_x,t_y,t_iwidth,t_iheight,t_nframes,t_iflags,t_src,t_srcx,t_srcy,t_srcw,t_srch){
	if((this.m_surface)!=null){
		error("Image already initialized");
	}
	this.m_surface=t_surf;
	this.m_source=t_src;
	this.m_width=t_iwidth;
	this.m_height=t_iheight;
	this.m_frames=new_object_array(t_nframes);
	var t_ix=t_x;
	var t_iy=t_y;
	for(var t_i=0;t_i<t_nframes;t_i=t_i+1){
		if(t_ix+this.m_width>t_srcw){
			t_ix=0;
			t_iy+=this.m_height;
		}
		if(t_ix+this.m_width>t_srcw || t_iy+this.m_height>t_srch){
			error("Image frame outside surface");
		}
		this.m_frames[t_i]=c_Frame.m_new.call(new c_Frame,t_ix+t_srcx,t_iy+t_srcy);
		t_ix+=this.m_width;
	}
	this.p_ApplyFlags(t_iflags);
	return this;
}
c_Image.prototype.p_Width=function(){
	return this.m_width;
}
c_Image.prototype.p_Height=function(){
	return this.m_height;
}
function bb_data_FixDataPath(t_path){
	var t_i=t_path.indexOf(":/",0);
	if(t_i!=-1 && t_path.indexOf("/",0)==t_i+1){
		return t_path;
	}
	if(string_startswith(t_path,"./") || string_startswith(t_path,"/")){
		return t_path;
	}
	return "cerberus://data/"+t_path;
}
function c_Frame(){
	Object.call(this);
	this.m_x=0;
	this.m_y=0;
}
c_Frame.m_new=function(t_x,t_y){
	this.m_x=t_x;
	this.m_y=t_y;
	return this;
}
c_Frame.m_new2=function(){
	return this;
}
function bb_graphics_LoadImage(t_path,t_frameCount,t_flags){
	var t_surf=bb_graphics_device.LoadSurface(bb_data_FixDataPath(t_path));
	if((t_surf)!=null){
		return (c_Image.m_new.call(new c_Image)).p_Init2(t_surf,t_frameCount,t_flags);
	}else{
		bb_lang_DebugLog("Error - Unable to load image: "+t_path);
	}
	return null;
}
function bb_graphics_LoadImage2(t_path,t_frameWidth,t_frameHeight,t_frameCount,t_flags){
	var t_surf=bb_graphics_device.LoadSurface(bb_data_FixDataPath(t_path));
	if((t_surf)!=null){
		return (c_Image.m_new.call(new c_Image)).p_Init3(t_surf,0,0,t_frameWidth,t_frameHeight,t_frameCount,t_flags,null,0,0,t_surf.Width(),t_surf.Height());
	}else{
		bb_lang_DebugLog("Error - Unable to load image: "+t_path);
	}
	return null;
}
function c_Glyph(){
	Object.call(this);
	this.m_page=0;
	this.m_id=0;
	this.m_x=0;
	this.m_y=0;
	this.m_width=0;
	this.m_height=0;
	this.m_advance=0;
	this.m_xoff=0;
	this.m_yoff=0;
}
c_Glyph.m_new=function(t_page,t_id,t_x,t_y,t_width,t_height,t_advance){
	this.m_page=t_page;
	this.m_id=t_id;
	this.m_x=t_x;
	this.m_y=t_y;
	this.m_width=t_width;
	this.m_height=t_height;
	this.m_advance=t_advance;
	this.m_xoff=0;
	this.m_yoff=0;
	return this;
}
c_Glyph.m_new2=function(){
	return this;
}
function c_Map2(){
	Object.call(this);
	this.m_root=null;
}
c_Map2.m_new=function(){
	return this;
}
c_Map2.prototype.p_Compare5=function(t_lhs,t_rhs){
}
c_Map2.prototype.p_RotateLeft2=function(t_node){
	var t_child=t_node.m_right;
	t_node.m_right=t_child.m_left;
	if((t_child.m_left)!=null){
		t_child.m_left.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_left){
			t_node.m_parent.m_left=t_child;
		}else{
			t_node.m_parent.m_right=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_left=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map2.prototype.p_RotateRight2=function(t_node){
	var t_child=t_node.m_left;
	t_node.m_left=t_child.m_right;
	if((t_child.m_right)!=null){
		t_child.m_right.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_right){
			t_node.m_parent.m_right=t_child;
		}else{
			t_node.m_parent.m_left=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_right=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map2.prototype.p_InsertFixup2=function(t_node){
	while(((t_node.m_parent)!=null) && t_node.m_parent.m_color==-1 && ((t_node.m_parent.m_parent)!=null)){
		if(t_node.m_parent==t_node.m_parent.m_parent.m_left){
			var t_uncle=t_node.m_parent.m_parent.m_right;
			if(((t_uncle)!=null) && t_uncle.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle.m_color=1;
				t_uncle.m_parent.m_color=-1;
				t_node=t_uncle.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_right){
					t_node=t_node.m_parent;
					this.p_RotateLeft2(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateRight2(t_node.m_parent.m_parent);
			}
		}else{
			var t_uncle2=t_node.m_parent.m_parent.m_left;
			if(((t_uncle2)!=null) && t_uncle2.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle2.m_color=1;
				t_uncle2.m_parent.m_color=-1;
				t_node=t_uncle2.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_left){
					t_node=t_node.m_parent;
					this.p_RotateRight2(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateLeft2(t_node.m_parent.m_parent);
			}
		}
	}
	this.m_root.m_color=1;
	return 0;
}
c_Map2.prototype.p_Add=function(t_key,t_value){
	var t_node=this.m_root;
	var t_parent=null;
	var t_cmp=0;
	while((t_node)!=null){
		t_parent=t_node;
		t_cmp=this.p_Compare5(t_key,t_node.m_key);
		if(t_cmp>0){
			t_node=t_node.m_right;
		}else{
			if(t_cmp<0){
				t_node=t_node.m_left;
			}else{
				return false;
			}
		}
	}
	t_node=c_Node2.m_new.call(new c_Node2,t_key,t_value,-1,t_parent);
	if((t_parent)!=null){
		if(t_cmp>0){
			t_parent.m_right=t_node;
		}else{
			t_parent.m_left=t_node;
		}
		this.p_InsertFixup2(t_node);
	}else{
		this.m_root=t_node;
	}
	return true;
}
function c_IntMap(){
	c_Map2.call(this);
}
c_IntMap.prototype=extend_class(c_Map2);
c_IntMap.m_new=function(){
	c_Map2.m_new.call(this);
	return this;
}
c_IntMap.prototype.p_Compare5=function(t_lhs,t_rhs){
	return t_lhs-t_rhs;
}
function c_Node2(){
	Object.call(this);
	this.m_key=0;
	this.m_right=null;
	this.m_left=null;
	this.m_value=null;
	this.m_color=0;
	this.m_parent=null;
}
c_Node2.m_new=function(t_key,t_value,t_color,t_parent){
	this.m_key=t_key;
	this.m_value=t_value;
	this.m_color=t_color;
	this.m_parent=t_parent;
	return this;
}
c_Node2.m_new2=function(){
	return this;
}
function bb_app_LoadString(t_path){
	return bb_app__game.LoadString(bb_data_FixDataPath(t_path));
}
function bb_graphics_SetFont(t_font){
	if(!((t_font)!=null)){
		if(!((bb_graphics_context.m_defaultFont)!=null)){
			bb_graphics_context.m_defaultFont=c_Font.m_Load("mojo_font.png",32,96,true);
		}
		t_font=bb_graphics_context.m_defaultFont;
	}
	bb_graphics_context.m_font=t_font;
}
var bb_audio_device=null;
function bb_audio_SetAudioDevice(t_dev){
	bb_audio_device=t_dev;
	return 0;
}
function c_InputDevice(){
	Object.call(this);
	this.m__joyStates=new_object_array(4);
	this.m__keyDown=new_bool_array(512);
	this.m__keyHitPut=0;
	this.m__keyHitQueue=new_number_array(33);
	this.m__keyHit=new_number_array(512);
	this.m__charGet=0;
	this.m__charPut=0;
	this.m__charQueue=new_number_array(32);
	this.m__mouseX=.0;
	this.m__mouseY=.0;
	this.m__mouseZ=.0;
	this.m__touchX=new_number_array(32);
	this.m__touchY=new_number_array(32);
	this.m__accelX=.0;
	this.m__accelY=.0;
	this.m__accelZ=.0;
}
c_InputDevice.m_new=function(){
	for(var t_i=0;t_i<4;t_i=t_i+1){
		this.m__joyStates[t_i]=c_JoyState.m_new.call(new c_JoyState);
	}
	return this;
}
c_InputDevice.prototype.p_PutKeyHit=function(t_key){
	if(this.m__keyHitPut==this.m__keyHitQueue.length){
		return;
	}
	this.m__keyHit[t_key]+=1;
	this.m__keyHitQueue[this.m__keyHitPut]=t_key;
	this.m__keyHitPut+=1;
}
c_InputDevice.prototype.p_BeginUpdate=function(){
	for(var t_i=0;t_i<4;t_i=t_i+1){
		var t_state=this.m__joyStates[t_i];
		if(!BBGame.Game().PollJoystick(t_i,t_state.m_joyx,t_state.m_joyy,t_state.m_joyz,t_state.m_buttons)){
			break;
		}
		for(var t_j=0;t_j<32;t_j=t_j+1){
			var t_key=256+t_i*32+t_j;
			if(t_state.m_buttons[t_j]){
				if(!this.m__keyDown[t_key]){
					this.m__keyDown[t_key]=true;
					this.p_PutKeyHit(t_key);
				}
			}else{
				this.m__keyDown[t_key]=false;
			}
		}
	}
}
c_InputDevice.prototype.p_EndUpdate=function(){
	for(var t_i=0;t_i<this.m__keyHitPut;t_i=t_i+1){
		this.m__keyHit[this.m__keyHitQueue[t_i]]=0;
	}
	this.m__keyHitPut=0;
	this.m__charGet=0;
	this.m__charPut=0;
}
c_InputDevice.prototype.p_KeyEvent=function(t_event,t_data){
	var t_1=t_event;
	if(t_1==1){
		if(!this.m__keyDown[t_data]){
			this.m__keyDown[t_data]=true;
			this.p_PutKeyHit(t_data);
			if(t_data==1){
				this.m__keyDown[384]=true;
				this.p_PutKeyHit(384);
			}else{
				if(t_data==384){
					this.m__keyDown[1]=true;
					this.p_PutKeyHit(1);
				}
			}
		}
	}else{
		if(t_1==2){
			if(this.m__keyDown[t_data]){
				this.m__keyDown[t_data]=false;
				if(t_data==1){
					this.m__keyDown[384]=false;
				}else{
					if(t_data==384){
						this.m__keyDown[1]=false;
					}
				}
			}
		}else{
			if(t_1==3){
				if(this.m__charPut<this.m__charQueue.length){
					this.m__charQueue[this.m__charPut]=t_data;
					this.m__charPut+=1;
				}
			}
		}
	}
}
c_InputDevice.prototype.p_MouseEvent=function(t_event,t_data,t_x,t_y,t_z){
	var t_2=t_event;
	if(t_2==4){
		this.p_KeyEvent(1,1+t_data);
	}else{
		if(t_2==5){
			this.p_KeyEvent(2,1+t_data);
			return;
		}else{
			if(t_2==6){
			}else{
				return;
			}
		}
	}
	this.m__mouseX=t_x;
	this.m__mouseY=t_y;
	this.m__mouseZ=t_z;
	this.m__touchX[0]=t_x;
	this.m__touchY[0]=t_y;
}
c_InputDevice.prototype.p_TouchEvent=function(t_event,t_data,t_x,t_y){
	var t_3=t_event;
	if(t_3==7){
		this.p_KeyEvent(1,384+t_data);
	}else{
		if(t_3==8){
			this.p_KeyEvent(2,384+t_data);
			return;
		}else{
			if(t_3==9){
			}else{
				return;
			}
		}
	}
	this.m__touchX[t_data]=t_x;
	this.m__touchY[t_data]=t_y;
	if(t_data==0){
		this.m__mouseX=t_x;
		this.m__mouseY=t_y;
	}
}
c_InputDevice.prototype.p_MotionEvent=function(t_event,t_data,t_x,t_y,t_z){
	var t_4=t_event;
	if(t_4==10){
	}else{
		return;
	}
	this.m__accelX=t_x;
	this.m__accelY=t_y;
	this.m__accelZ=t_z;
}
c_InputDevice.prototype.p_MouseX=function(){
	return this.m__mouseX;
}
c_InputDevice.prototype.p_MouseY=function(){
	return this.m__mouseY;
}
c_InputDevice.prototype.p_KeyDown=function(t_key){
	if(t_key>0 && t_key<512){
		return this.m__keyDown[t_key];
	}
	return false;
}
c_InputDevice.prototype.p_KeyHit=function(t_key){
	if(t_key>0 && t_key<512){
		return this.m__keyHit[t_key];
	}
	return 0;
}
c_InputDevice.prototype.p_GetChar=function(){
	if(this.m__charGet==this.m__charPut){
		return 0;
	}
	var t_chr=this.m__charQueue[this.m__charGet];
	this.m__charGet+=1;
	return t_chr;
}
c_InputDevice.prototype.p_TouchX=function(t_index){
	if(t_index>=0 && t_index<32){
		return this.m__touchX[t_index];
	}
	return 0.0;
}
c_InputDevice.prototype.p_TouchY=function(t_index){
	if(t_index>=0 && t_index<32){
		return this.m__touchY[t_index];
	}
	return 0.0;
}
function c_JoyState(){
	Object.call(this);
	this.m_joyx=new_number_array(2);
	this.m_joyy=new_number_array(2);
	this.m_joyz=new_number_array(2);
	this.m_buttons=new_bool_array(32);
}
c_JoyState.m_new=function(){
	return this;
}
var bb_input_device=null;
function bb_input_SetInputDevice(t_dev){
	bb_input_device=t_dev;
	return 0;
}
function c_DisplayMode(){
	Object.call(this);
	this.m__width=0;
	this.m__height=0;
}
c_DisplayMode.m_new=function(t_width,t_height){
	this.m__width=t_width;
	this.m__height=t_height;
	return this;
}
c_DisplayMode.m_new2=function(){
	return this;
}
function c_Map3(){
	Object.call(this);
	this.m_root=null;
}
c_Map3.m_new=function(){
	return this;
}
c_Map3.prototype.p_Compare5=function(t_lhs,t_rhs){
}
c_Map3.prototype.p_FindNode2=function(t_key){
	var t_node=this.m_root;
	while((t_node)!=null){
		var t_cmp=this.p_Compare5(t_key,t_node.m_key);
		if(t_cmp>0){
			t_node=t_node.m_right;
		}else{
			if(t_cmp<0){
				t_node=t_node.m_left;
			}else{
				return t_node;
			}
		}
	}
	return t_node;
}
c_Map3.prototype.p_Contains2=function(t_key){
	return this.p_FindNode2(t_key)!=null;
}
c_Map3.prototype.p_RotateLeft3=function(t_node){
	var t_child=t_node.m_right;
	t_node.m_right=t_child.m_left;
	if((t_child.m_left)!=null){
		t_child.m_left.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_left){
			t_node.m_parent.m_left=t_child;
		}else{
			t_node.m_parent.m_right=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_left=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map3.prototype.p_RotateRight3=function(t_node){
	var t_child=t_node.m_left;
	t_node.m_left=t_child.m_right;
	if((t_child.m_right)!=null){
		t_child.m_right.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_right){
			t_node.m_parent.m_right=t_child;
		}else{
			t_node.m_parent.m_left=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_right=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map3.prototype.p_InsertFixup3=function(t_node){
	while(((t_node.m_parent)!=null) && t_node.m_parent.m_color==-1 && ((t_node.m_parent.m_parent)!=null)){
		if(t_node.m_parent==t_node.m_parent.m_parent.m_left){
			var t_uncle=t_node.m_parent.m_parent.m_right;
			if(((t_uncle)!=null) && t_uncle.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle.m_color=1;
				t_uncle.m_parent.m_color=-1;
				t_node=t_uncle.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_right){
					t_node=t_node.m_parent;
					this.p_RotateLeft3(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateRight3(t_node.m_parent.m_parent);
			}
		}else{
			var t_uncle2=t_node.m_parent.m_parent.m_left;
			if(((t_uncle2)!=null) && t_uncle2.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle2.m_color=1;
				t_uncle2.m_parent.m_color=-1;
				t_node=t_uncle2.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_left){
					t_node=t_node.m_parent;
					this.p_RotateRight3(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateLeft3(t_node.m_parent.m_parent);
			}
		}
	}
	this.m_root.m_color=1;
	return 0;
}
c_Map3.prototype.p_Set2=function(t_key,t_value){
	var t_node=this.m_root;
	var t_parent=null;
	var t_cmp=0;
	while((t_node)!=null){
		t_parent=t_node;
		t_cmp=this.p_Compare5(t_key,t_node.m_key);
		if(t_cmp>0){
			t_node=t_node.m_right;
		}else{
			if(t_cmp<0){
				t_node=t_node.m_left;
			}else{
				t_node.m_value=t_value;
				return false;
			}
		}
	}
	t_node=c_Node3.m_new.call(new c_Node3,t_key,t_value,-1,t_parent);
	if((t_parent)!=null){
		if(t_cmp>0){
			t_parent.m_right=t_node;
		}else{
			t_parent.m_left=t_node;
		}
		this.p_InsertFixup3(t_node);
	}else{
		this.m_root=t_node;
	}
	return true;
}
c_Map3.prototype.p_Insert=function(t_key,t_value){
	return this.p_Set2(t_key,t_value);
}
function c_IntMap2(){
	c_Map3.call(this);
}
c_IntMap2.prototype=extend_class(c_Map3);
c_IntMap2.m_new=function(){
	c_Map3.m_new.call(this);
	return this;
}
c_IntMap2.prototype.p_Compare5=function(t_lhs,t_rhs){
	return t_lhs-t_rhs;
}
function c_Stack6(){
	Object.call(this);
	this.m_data=[];
	this.m_length=0;
}
c_Stack6.m_new=function(){
	return this;
}
c_Stack6.m_new2=function(t_data){
	this.m_data=t_data.slice(0);
	this.m_length=t_data.length;
	return this;
}
c_Stack6.prototype.p_Push16=function(t_value){
	if(this.m_length==this.m_data.length){
		this.m_data=resize_object_array(this.m_data,this.m_length*2+10);
	}
	this.m_data[this.m_length]=t_value;
	this.m_length+=1;
}
c_Stack6.prototype.p_Push17=function(t_values,t_offset,t_count){
	for(var t_i=0;t_i<t_count;t_i=t_i+1){
		this.p_Push16(t_values[t_offset+t_i]);
	}
}
c_Stack6.prototype.p_Push18=function(t_values,t_offset){
	this.p_Push17(t_values,t_offset,t_values.length-t_offset);
}
c_Stack6.prototype.p_ToArray=function(){
	var t_t=new_object_array(this.m_length);
	for(var t_i=0;t_i<this.m_length;t_i=t_i+1){
		t_t[t_i]=this.m_data[t_i];
	}
	return t_t;
}
function c_Node3(){
	Object.call(this);
	this.m_key=0;
	this.m_right=null;
	this.m_left=null;
	this.m_value=null;
	this.m_color=0;
	this.m_parent=null;
}
c_Node3.m_new=function(t_key,t_value,t_color,t_parent){
	this.m_key=t_key;
	this.m_value=t_value;
	this.m_color=t_color;
	this.m_parent=t_parent;
	return this;
}
c_Node3.m_new2=function(){
	return this;
}
var bb_app__displayModes=[];
var bb_app__desktopMode=null;
function bb_app_DeviceWidth(){
	return bb_app__devWidth;
}
function bb_app_DeviceHeight(){
	return bb_app__devHeight;
}
function bb_app_EnumDisplayModes(){
	var t_modes=bb_app__game.GetDisplayModes();
	var t_mmap=c_IntMap2.m_new.call(new c_IntMap2);
	var t_mstack=c_Stack6.m_new.call(new c_Stack6);
	for(var t_i=0;t_i<t_modes.length;t_i=t_i+1){
		var t_w=t_modes[t_i].width;
		var t_h=t_modes[t_i].height;
		var t_size=t_w<<16|t_h;
		if(t_mmap.p_Contains2(t_size)){
		}else{
			var t_mode=c_DisplayMode.m_new.call(new c_DisplayMode,t_modes[t_i].width,t_modes[t_i].height);
			t_mmap.p_Insert(t_size,t_mode);
			t_mstack.p_Push16(t_mode);
		}
	}
	bb_app__displayModes=t_mstack.p_ToArray();
	var t_mode2=bb_app__game.GetDesktopMode();
	if((t_mode2)!=null){
		bb_app__desktopMode=c_DisplayMode.m_new.call(new c_DisplayMode,t_mode2.width,t_mode2.height);
	}else{
		bb_app__desktopMode=c_DisplayMode.m_new.call(new c_DisplayMode,bb_app_DeviceWidth(),bb_app_DeviceHeight());
	}
}
var bb_graphics_renderDevice=null;
function bb_graphics_SetMatrix(t_ix,t_iy,t_jx,t_jy,t_tx,t_ty){
	bb_graphics_context.m_ix=t_ix;
	bb_graphics_context.m_iy=t_iy;
	bb_graphics_context.m_jx=t_jx;
	bb_graphics_context.m_jy=t_jy;
	bb_graphics_context.m_tx=t_tx;
	bb_graphics_context.m_ty=t_ty;
	bb_graphics_context.m_tformed=((t_ix!=1.0 || t_iy!=0.0 || t_jx!=0.0 || t_jy!=1.0 || t_tx!=0.0 || t_ty!=0.0)?1:0);
	bb_graphics_context.m_matDirty=1;
	return 0;
}
function bb_graphics_SetMatrix2(t_m){
	bb_graphics_SetMatrix(t_m[0],t_m[1],t_m[2],t_m[3],t_m[4],t_m[5]);
	return 0;
}
function bb_graphics_SetColor(t_r,t_g,t_b){
	bb_graphics_context.m_color_r=t_r;
	bb_graphics_context.m_color_g=t_g;
	bb_graphics_context.m_color_b=t_b;
	bb_graphics_renderDevice.SetColor(t_r,t_g,t_b);
	return 0;
}
function bb_graphics_SetColor2(t_rgb){
	bb_graphics_context.m_color_r=(((t_rgb)|0)>>16&255);
	bb_graphics_context.m_color_g=(((t_rgb)|0)>>8&255);
	bb_graphics_context.m_color_b=(((t_rgb)|0)&255);
	bb_graphics_renderDevice.SetColor(bb_graphics_context.m_color_r,bb_graphics_context.m_color_g,bb_graphics_context.m_color_b);
	return 0;
}
function bb_graphics_SetAlpha(t_alpha){
	bb_graphics_context.m_alpha=t_alpha;
	bb_graphics_renderDevice.SetAlpha(t_alpha);
	return 0;
}
function bb_graphics_SetBlend(t_blend){
	bb_graphics_context.m_blend=t_blend;
	bb_graphics_renderDevice.SetBlend(t_blend);
	return 0;
}
function bb_graphics_SetScissor(t_x,t_y,t_width,t_height){
	bb_graphics_context.m_scissor_x=t_x;
	bb_graphics_context.m_scissor_y=t_y;
	bb_graphics_context.m_scissor_width=t_width;
	bb_graphics_context.m_scissor_height=t_height;
	bb_graphics_renderDevice.SetScissor(((t_x)|0),((t_y)|0),((t_width)|0),((t_height)|0));
	return 0;
}
function bb_graphics_BeginRender(){
	bb_graphics_renderDevice=bb_graphics_device;
	bb_graphics_context.m_matrixSp=0;
	bb_graphics_SetMatrix(1.0,0.0,0.0,1.0,0.0,0.0);
	bb_graphics_SetColor(255.0,255.0,255.0);
	bb_graphics_SetAlpha(1.0);
	bb_graphics_SetBlend(0);
	bb_graphics_SetScissor(0.0,0.0,(bb_app_DeviceWidth()),(bb_app_DeviceHeight()));
	return 0;
}
function bb_graphics_EndRender(){
	bb_graphics_renderDevice=null;
	return 0;
}
function c_BBGameEvent(){
	Object.call(this);
}
function bb_app_EndApp(){
	error("");
}
var bb_game_UPDATE_RATE=0;
var bb_app__updateRate=0;
function bb_app_SetUpdateRate(t_hertz){
	bb_app__updateRate=t_hertz;
	bb_app__game.SetUpdateRate(t_hertz);
}
var bb_game_gPercentLoad=0;
function c_VirtualDisplay(){
	Object.call(this);
	this.m_vwidth=.0;
	this.m_vheight=.0;
	this.m_vzoom=.0;
	this.m_vratio=.0;
	this.m_multi=.0;
	this.m_fdw=.0;
	this.m_fdh=.0;
	this.m_heightborder=.0;
	this.m_widthborder=.0;
	this.m_scaledw=.0;
	this.m_scaledh=.0;
}
c_VirtualDisplay.m_Display=null;
c_VirtualDisplay.m_new=function(t_width,t_height,t_zoom){
	this.m_vwidth=(t_width);
	this.m_vheight=(t_height);
	this.m_vzoom=t_zoom;
	this.m_vratio=this.m_vheight/this.m_vwidth;
	c_VirtualDisplay.m_Display=this;
	return this;
}
c_VirtualDisplay.m_new2=function(){
	return this;
}
c_VirtualDisplay.prototype.p_VMouseX=function(t__x,t_limit){
	var t_mouseoffset=t__x-(bb_app_DeviceWidth())*0.5;
	var t_x=t_mouseoffset/this.m_multi/this.m_vzoom+bb_autofit_VDeviceWidth()*0.5;
	if(t_limit){
		var t_widthlimit=this.m_vwidth-1.0;
		if(t_x>0.0){
			if(t_x<t_widthlimit){
				return t_x;
			}else{
				return t_widthlimit;
			}
		}else{
			return 0.0;
		}
	}else{
		return t_x;
	}
}
c_VirtualDisplay.prototype.p_VMouseY=function(t__y,t_limit){
	var t_mouseoffset=t__y-(bb_app_DeviceHeight())*0.5;
	var t_y=t_mouseoffset/this.m_multi/this.m_vzoom+bb_autofit_VDeviceHeight()*0.5;
	if(t_limit){
		var t_heightlimit=this.m_vheight-1.0;
		if(t_y>0.0){
			if(t_y<t_heightlimit){
				return t_y;
			}else{
				return t_heightlimit;
			}
		}else{
			return 0.0;
		}
	}else{
		return t_y;
	}
}
c_VirtualDisplay.prototype.p_UpdateVirtualDisplay=function(t_zoomborders,t_keepborders){
	this.m_fdw=(bb_app_DeviceWidth());
	this.m_fdh=(bb_app_DeviceHeight());
	var t_dratio=this.m_fdh/this.m_fdw;
	if(t_dratio>=this.m_vratio){
		this.m_multi=this.m_fdw/this.m_vwidth;
		this.m_heightborder=(this.m_fdh-this.m_vheight*this.m_multi)*0.5;
		this.m_widthborder=0.0;
	}else{
		this.m_multi=this.m_fdh/this.m_vheight;
		this.m_widthborder=(this.m_fdw-this.m_vwidth*this.m_multi)*0.5;
		this.m_heightborder=0.0;
	}
	bb_graphics_SetScissor(0.0,0.0,(bb_app_DeviceWidth()),(bb_app_DeviceHeight()));
	bb_graphics_Cls(210.0,210.0,210.0);
	var t_sx=.0;
	var t_sy=.0;
	var t_sw=.0;
	var t_sh=.0;
	if(t_zoomborders){
		var t_realx=this.m_vwidth*this.m_vzoom*this.m_multi;
		var t_realy=this.m_vheight*this.m_vzoom*this.m_multi;
		var t_offx=(this.m_fdw-t_realx)*0.5;
		var t_offy=(this.m_fdh-t_realy)*0.5;
		if(t_keepborders){
			if(t_offx<this.m_widthborder){
				t_sx=this.m_widthborder;
				t_sw=this.m_fdw-this.m_widthborder*2.0;
			}else{
				t_sx=t_offx;
				t_sw=this.m_fdw-t_offx*2.0;
			}
		}else{
			t_sx=t_offx;
			t_sw=this.m_fdw-t_offx*2.0;
		}
		if(t_keepborders){
			if(t_offy<this.m_heightborder){
				t_sy=this.m_heightborder;
				t_sh=this.m_fdh-this.m_heightborder*2.0;
			}else{
				t_sy=t_offy;
				t_sh=this.m_fdh-t_offy*2.0;
			}
		}else{
			t_sy=t_offy;
			t_sh=this.m_fdh-t_offy*2.0;
		}
		t_sx=bb_math_Max2(0.0,t_sx);
		t_sy=bb_math_Max2(0.0,t_sy);
		t_sw=bb_math_Min2(t_sw,this.m_fdw);
		t_sh=bb_math_Min2(t_sh,this.m_fdw);
		bb_graphics_SetScissor(t_sx,t_sy,t_sw,t_sh);
	}else{
		t_sx=bb_math_Max2(0.0,this.m_widthborder);
		t_sy=bb_math_Max2(0.0,this.m_heightborder);
		t_sw=bb_math_Min2(this.m_fdw-this.m_widthborder*2.0,this.m_fdw);
		t_sh=bb_math_Min2(this.m_fdh-this.m_heightborder*2.0,this.m_fdw);
		bb_graphics_SetScissor(t_sx,t_sy,t_sw,t_sh);
	}
	bb_graphics_Scale(this.m_multi*this.m_vzoom,this.m_multi*this.m_vzoom);
	if((this.m_vzoom)!=0.0){
		this.m_scaledw=this.m_vwidth*this.m_multi*this.m_vzoom;
		this.m_scaledh=this.m_vheight*this.m_multi*this.m_vzoom;
		var t_xoff=(this.m_fdw-this.m_scaledw)*0.5;
		var t_yoff=(this.m_fdh-this.m_scaledh)*0.5;
		t_xoff=t_xoff/this.m_multi/this.m_vzoom;
		t_yoff=t_yoff/this.m_multi/this.m_vzoom;
		bb_graphics_Translate(t_xoff,t_yoff);
	}
	return 0;
}
function bb_autofit_SetVirtualDisplay(t_width,t_height,t_zoom){
	c_VirtualDisplay.m_new.call(new c_VirtualDisplay,t_width,t_height,t_zoom);
	return 0;
}
function c_Session(){
	Object.call(this);
}
c_Session.m_new=function(){
	return this;
}
c_Session.m_GameState=0;
c_Session.prototype.p_AddPictureTagged=function(){
	bb_game_currPictureTagged=bb_game_currPictureTagged+1;
	return 0;
}
c_Session.prototype.p_AddValidation=function(){
	bb_game_currValidation=bb_game_currValidation+1;
	return 0;
}
c_Session.m_bExpertMode=false;
c_Session.prototype.p_SetState=function(t_state){
	c_Session.m_GameState=t_state;
	var t_1=c_Session.m_GameState;
	if(t_1==2){
		bb_defaultmedia_IMG_MAIN=bb_graphics_LoadImage("menu/background.jpg",1,c_Image.m_DefaultFlags);
		bb_game_gStartTimer=bb_app_Millisecs();
		bb_game_selectedTAGS.p_Clear();
		bb_game_originalTAGS.p_Clear();
		bb_game_cSERVER.m_cSERVER_LOGGED.p_Get3();
		bb_game_cRENDER_HELPER.p_Init();
		bb_game_cRENDER_PROFILE.p_Init();
		bb_game_cRENDER_LOGIN.p_Init();
		bb_game_cRENDER_INTRO.p_Init();
		bb_game_cRENDER_LANGUAGE.p_Init();
		bb_game_cTAXONOMYLANG.p_Init4(bb_game_cLANGUAGE.m_indexLanguage);
		bb_game_cTAXONOMYHELP.p_Init4(bb_game_cLANGUAGE.m_indexLanguage);
		bb_game_cRENDER_INFO.p_Init();
		bb_game_cVOICE.p_Init();
	}else{
		if(t_1==10){
			bb_game_cSERVER.m_cSERVER_LOGIN.p_Get2(bb_game_cRENDER_LOGIN.m_strUserName,bb_game_cRENDER_LOGIN.m_strUserPassword);
		}else{
			if(t_1==3){
				bb_game_userPictureUploaded=0;
				bb_game_userPictureTagged=0;
				bb_game_userTag=0;
				bb_game_userValidation=0;
				bb_game_userScore=0;
				bb_game_userLevel=0;
				bb_game_userPois=0;
				bb_game_userCampaign=0;
				bb_game_currPictureUploaded=0;
				bb_game_currPictureTagged=0;
				bb_game_currTag=0;
				bb_game_currValidation=0;
				bb_game_currScore=0;
				bb_game_currLevel=0;
				bb_game_currPois=0;
				bb_game_currCampaign=0;
				bb_game_selectedTAGS.p_Clear();
				bb_game_originalTAGS.p_Clear();
				bb_game_gStartTimer=bb_app_Millisecs();
				if(bb_game_inputImageIDStr==""){
					bb_game_cSERVER.m_cSERVER_GETIMAGE.p_Get(bb_game_defineCampaign);
				}else{
					bb_game_cSERVER.m_cSERVER_GETIMAGE.p_GetID(bb_game_inputImageIDStr);
					bb_game_inputImageIDStr="";
				}
				bb_game_cSERVER.m_cSERVER_GETSTATGLOBAL.p_Get3();
				bb_game_cSERVER.m_cSERVER_GETSTAT.p_Get4(bb_game_userIDSelected,bb_game_userNickName);
				this.p_AddPictureTagged();
				bb_game_angleRotation=0;
			}else{
				if(t_1==100){
					bb_game_gStartTimer=bb_app_Millisecs();
					bb_game_currScore=bb_game_currScore+10;
					bb_game_cRENDER_SCENTVALIDATEEXPERT.p_Init();
					bb_game_cRENDER_SCENTVALIDATE.p_Init();
					this.p_AddValidation();
					bb_game_cRENDER_SCENTVALIDATEEXPERT.p_InitZone();
					if(bb_game_cRENDER_SCENTVALIDATE.p_InitZone()==true){
						this.p_SetState(101);
					}else{
						bb_game_cRENDER_SCENTTAG.p_Init();
						this.p_SetState(121);
					}
					return 0;
				}else{
					if(t_1==101){
						bb_game_gStartTimer=bb_app_Millisecs();
					}else{
						if(t_1==105){
							bb_game_gStartTimer=bb_app_Millisecs();
							bb_game_cMANAGEITEMS.p_StartAnimation(0,0,bb_items_structureTAG);
							bb_game_cMANAGEITEMS.p_SetAllUnSelected(bb_items_structureTAG);
							bb_game_cMANAGEITEMS.p_SetAllVisible(bb_items_structureTAG);
							if(bb_game_cRENDER_SCENTVALIDATE.p_executeNextZone()==false){
								this.p_SetState(102);
								return 0;
							}
							this.p_AddValidation();
							this.p_SetState(106);
						}else{
							if(t_1==104){
								bb_game_gStartTimer=bb_app_Millisecs();
							}else{
								if(t_1==106){
									bb_game_gStartTimer=bb_app_Millisecs();
								}else{
									if(t_1==108){
										bb_game_gStartTimer=bb_app_Millisecs();
										bb_game_cMANAGEITEMS.p_SetAllUnSelected(bb_items_structureTAG);
										bb_game_cMANAGEITEMS.p_StartAnimation(0,0,bb_items_structureTAG);
									}else{
										if(t_1==115){
											c_Session.m_bExpertMode=true;
											this.p_SetState(101);
										}else{
											if(t_1==116){
												c_Session.m_bExpertMode=false;
												this.p_SetState(101);
											}else{
												if(t_1==120){
													bb_game_gStartTimer=bb_app_Millisecs();
													bb_game_currScore=bb_game_currScore+10;
													bb_game_cRENDER_SCENTTAG.p_Init();
												}else{
													if(t_1==121){
														bb_game_gStartTimer=bb_app_Millisecs();
														bb_game_cMANAGEITEMS.p_SetVisibleFrom(false,bb_items_structureTAG,bb_game_selectedTAGS,true);
													}else{
														if(t_1==122){
															bb_game_gStartTimer=bb_app_Millisecs();
															bb_game_cMANAGEITEMS.p_StartAnimation(0,0,bb_items_structureTAG);
															bb_game_cMANAGEITEMS.p_SetAllUnSelected(bb_items_structureTAG);
														}else{
															if(t_1==123){
																bb_game_gStartTimer=bb_app_Millisecs();
															}else{
																if(t_1==124){
																	bb_game_gStartTimer=bb_app_Millisecs();
																}else{
																	if(t_1==125){
																		bb_game_gStartTimer=bb_app_Millisecs();
																	}else{
																		if(t_1==130){
																			bb_game_gStartTimer=bb_app_Millisecs();
																		}else{
																			if(t_1==300){
																				bb_game_cRENDER_SCENTFOCUS.p_Init();
																				bb_game_cRENDER_SCENTFOCUS.p_Clear();
																				bb_game_cMANAGEITEMS.p_SetAllVisible(bb_items_structureTAG);
																				bb_game_gStartTimer=bb_app_Millisecs();
																			}else{
																				if(t_1==301){
																					bb_game_gStartTimer=bb_app_Millisecs();
																				}else{
																					if(t_1==200){
																						bb_game_gStartTimer=bb_app_Millisecs();
																						bb_game_cRENDER_SCENTANNOTATE.p_Init();
																					}else{
																						if(t_1==102 || t_1==103){
																							bb_game_gStartTimer=bb_app_Millisecs();
																						}else{
																							if(t_1==109){
																								bb_game_gStartTimer=bb_app_Millisecs();
																								bb_game_cRENDER_ERROR.p_Init();
																							}else{
																								if(t_1==1000){
																									bb_game_cSERVER.m_cSERVER_SETSTAT.p_Get5(bb_game_userIDSelected,bb_game_currPictureUploaded,bb_game_currPictureTagged,bb_game_currTag,bb_game_currValidation,bb_game_currScore,bb_game_currLevel,bb_game_currPois,bb_game_currCampaign);
																									var t_collaborate=bb_game_cCONVERT.p_Convert(bb_game_userIDSelected,bb_game_selectedTAGS);
																									var t_sendJson=bb_game_cCONVERT.p_Attach2(bb_game_userIDSelected,bb_game_originalTAGS,bb_game_originalJsonString,t_collaborate);
																									bb_game_cSERVER.m_cSERVER_PUTIMAGEINFO.p_Get4(bb_game_imageIDSelected,t_sendJson);
																									bb_game_gStartTimer=bb_app_Millisecs();
																								}
																							}
																						}
																					}
																				}
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	bb_checkkeys_DelayKeys(0);
	return 0;
}
c_Session.prototype.p_AddTag=function(){
	bb_game_currTag=bb_game_currTag+1;
	return 0;
}
var bb_session_GameSession=null;
var bb_defaultmedia_IMG_MAIN=null;
var bb_game_gStartTimer=0;
function c_structItems(){
	Object.call(this);
	this.m_name="";
	this.m_sub_name1="";
	this.m_sub_name2="";
	this.m_subitems=null;
	this.m_parent=null;
	this.m_managed=false;
	this.m_visible=true;
	this.m_selected=false;
	this.m_deleting=true;
	this.m_timerAnimation=-1;
	this.m_sorgPos=c_sPoint.m_new3.call(new c_sPoint);
	this.m_status=0;
	this.m_objects=null;
	this.m_checked=false;
	this.m_invalid=false;
	this.m_zone=null;
	this.m_fromCollaborate=false;
	this.m_id=-1;
	this.m_fromExplore=false;
	this.m_fromSIE=false;
	this.m_voice="";
	this.m_info="";
	this.m_fromNew=false;
	this.m_zoneModify=true;
	this.m_destPos=c_sPoint.m_new3.call(new c_sPoint);
	this.m_currPos=c_sPoint.m_new3.call(new c_sPoint);
	this.m_pinMode=c_structItemsPin.m_new.call(new c_structItemsPin);
}
c_structItems.prototype.p_SubName=function(t__str,t__limit){
	t__str=string_trim(t__str);
	var t_str=t__str.split(" ");
	var t_stringa="";
	var t_new_stringa="";
	this.m_sub_name1="";
	this.m_sub_name2="";
	var t_=t_str;
	var t_2=0;
	while(t_2<t_.length){
		var t_item=t_[t_2];
		t_2=t_2+1;
		t_new_stringa=t_stringa+" "+t_item;
		if(t_new_stringa.length>=t__limit){
			if(this.m_sub_name1==""){
				this.m_sub_name1=string_trim(t_stringa);
				t_stringa="";
			}
		}
		t_stringa=t_stringa+" "+t_item;
		t_stringa=string_trim(t_stringa);
	}
	if(t_stringa.length>0){
		this.m_sub_name2=t_stringa;
	}
	return 0;
}
c_structItems.m_new=function(t__parent,t__name){
	this.m_name=t__name;
	this.m_sub_name1=t__name;
	this.m_sub_name2="";
	this.m_subitems=null;
	this.m_parent=t__parent;
	this.m_managed=false;
	var t_limiter=0;
	var t_str="";
	if(this.m_name.length>24){
		t_limiter=((this.m_name.length/2)|0)+2;
		this.p_SubName(this.m_name,t_limiter);
	}
	return this;
}
c_structItems.m_new2=function(){
	return this;
}
c_structItems.prototype.p_Clear=function(){
	if(this.m_subitems!=null){
		this.m_subitems.p_Clear();
	}
	this.m_subitems=null;
	return 0;
}
c_structItems.prototype.p_SetUnChecked=function(){
	if(this.m_subitems==null){
		return 0;
	}
	var t_=this.m_subitems.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_item=t_.p_NextObject();
		t_item.m_checked=false;
		t_item.m_invalid=false;
	}
	return 0;
}
c_structItems.prototype.p_AddSubItem=function(t__name){
	if(this.m_subitems==null){
		this.m_subitems=c_List.m_new.call(new c_List);
	}
	var t_newTAG=c_structItems.m_new.call(new c_structItems,this,t__name);
	this.m_subitems.p_AddLast(t_newTAG);
	return t_newTAG;
}
c_structItems.prototype.p_AddSubItem2=function(t__name,t__id,t__zone,t__deleting,t__from){
	if(this.m_subitems==null){
		this.m_subitems=c_List.m_new.call(new c_List);
	}
	var t_newTAG=c_structItems.m_new.call(new c_structItems,this,t__name);
	t_newTAG.m_id=t__id;
	t_newTAG.m_zone=c_sRect.m_new.call(new c_sRect);
	t_newTAG.m_zone.m_x=t__zone.m_x;
	t_newTAG.m_zone.m_y=t__zone.m_y;
	t_newTAG.m_zone.m_w=t__zone.m_w;
	t_newTAG.m_zone.m_h=t__zone.m_h;
	t_newTAG.m_deleting=t__deleting;
	t_newTAG.m_fromCollaborate=false;
	t_newTAG.m_fromExplore=false;
	t_newTAG.m_fromSIE=false;
	t_newTAG.m_fromNew=false;
	t_newTAG.m_status=0;
	if(t__from==2){
		t_newTAG.m_fromCollaborate=true;
	}
	if(t__from==4){
		t_newTAG.m_fromExplore=true;
	}
	if(t__from==1){
		t_newTAG.m_fromSIE=true;
	}
	if(t__from==8){
		t_newTAG.m_fromNew=true;
	}
	this.m_subitems.p_AddLast(t_newTAG);
	return t_newTAG;
}
c_structItems.prototype.p_AddSubItem3=function(t__tag){
	if(this.m_subitems==null){
		this.m_subitems=c_List.m_new.call(new c_List);
	}
	t__tag.m_parent=this;
	this.m_subitems.p_AddLast(t__tag);
	return t__tag;
}
c_structItems.prototype.p_AddSubObject=function(t__name,t__from,t__deleting,t__status,t__managed){
	if(this.m_objects==null){
		this.m_objects=c_List.m_new.call(new c_List);
	}
	var t_newTAG=c_structItems.m_new.call(new c_structItems,this,t__name);
	t_newTAG.m_zone=c_sRect.m_new.call(new c_sRect);
	t_newTAG.m_zone.m_x=this.m_zone.m_x;
	t_newTAG.m_zone.m_y=this.m_zone.m_y;
	t_newTAG.m_zone.m_w=this.m_zone.m_w;
	t_newTAG.m_zone.m_h=this.m_zone.m_h;
	t_newTAG.m_deleting=t__deleting;
	t_newTAG.m_status=t__status;
	t_newTAG.m_managed=t__managed;
	t_newTAG.m_fromCollaborate=false;
	t_newTAG.m_fromExplore=false;
	t_newTAG.m_fromSIE=false;
	t_newTAG.m_fromNew=false;
	if(t__from==2){
		t_newTAG.m_fromCollaborate=true;
	}
	if(t__from==4){
		t_newTAG.m_fromExplore=true;
	}
	if(t__from==1){
		t_newTAG.m_fromSIE=true;
	}
	if(t__from==8){
		t_newTAG.m_fromNew=true;
	}
	this.m_objects.p_AddLast(t_newTAG);
	return t_newTAG;
}
c_structItems.prototype.p_FromJson=function(t__json,t__img){
	var t_jsonClassification=null;
	var t_jsonSIE=null;
	var t_jsonSIEItem=null;
	var t_jsonEXPLORE=null;
	var t_jsonEXPLOREObjec=null;
	var t_jsonEXPLOREItem=null;
	var t_jsonCOLLABORATE=null;
	var t_jsonCOLLABORATEItem=null;
	var t_jsonObjects=null;
	var t_jsonObjectsItem=null;
	var t_jsonBoundingBox=null;
	var t_rectBox=c_sRect.m_new.call(new c_sRect);
	var t_newTAG=null;
	var t_status_value=0;
	var t_undecided_status=false;
	if(t__json==null){
		return 0;
	}
	t_jsonClassification=object_downcast((t__json.p_Get7("classification",null)),c_JsonObject);
	if(t_jsonClassification==null){
		return 0;
	}
	t_jsonSIE=object_downcast((t_jsonClassification.p_Get7("SIE",null)),c_JsonArray);
	if(t_jsonSIE!=null){
		for(var t_index=0;t_index<t_jsonSIE.p_Length2();t_index=t_index+1){
			t_jsonSIEItem=object_downcast((t_jsonSIE.p_Get6(t_index)),c_JsonObject);
			t_jsonBoundingBox=object_downcast((t_jsonSIEItem.p_Get7("boundingBox",null)),c_JsonObject);
			t_jsonObjects=object_downcast((t_jsonSIEItem.p_Get7("objects",null)),c_JsonArray);
			if(t_jsonBoundingBox!=null){
				t_rectBox.m_x=t_jsonBoundingBox.p_GetInt2("left",0);
				t_rectBox.m_y=t_jsonBoundingBox.p_GetInt2("top",0);
				t_rectBox.m_w=t_jsonBoundingBox.p_GetInt2("width",0);
				t_rectBox.m_h=t_jsonBoundingBox.p_GetInt2("height",0);
			}else{
				t_rectBox.m_x=0;
				t_rectBox.m_y=0;
				t_rectBox.m_w=t__img.p_Width();
				t_rectBox.m_h=t__img.p_Height();
			}
			t_newTAG=this.p_AddSubItem2("Object_"+String(t_index),t_index,c_sRect.m_new3.call(new c_sRect,t_rectBox),true,1);
			t_undecided_status=false;
			for(var t_id=0;t_id<t_jsonObjects.p_Length2();t_id=t_id+1){
				t_jsonObjectsItem=object_downcast((t_jsonObjects.p_Get6(t_id)),c_JsonObject);
				var t_tag=t_jsonObjectsItem.p_GetString2("tag","");
				var t_status=t_jsonObjectsItem.p_GetString2("status","");
				t_status=string_trim(t_status);
				if(t_status=="undecided"){
					t_status_value=0;
					t_undecided_status=true;
				}
				if(t_status=="valid"){
					t_status_value=1;
				}
				if(t_status=="invalid"){
					t_status_value=2;
				}
				if(bb_game_cTAXONOMYLANG.p_Exist(t_tag)==true){
					t_newTAG.m_managed=true;
				}
				t_newTAG.p_AddSubObject(t_tag,1,false,t_status_value,bb_game_cTAXONOMYLANG.p_Exist(t_tag));
			}
			if(t_undecided_status==false){
				t_newTAG.m_status=1;
			}else{
				print("undecided");
			}
		}
	}
	t_jsonEXPLORE=object_downcast((t_jsonClassification.p_Get7("explore",null)),c_JsonObject);
	if(t_jsonEXPLORE!=null){
		t_jsonObjects=object_downcast((t_jsonEXPLORE.p_Get7("objects",null)),c_JsonArray);
		for(var t_index2=0;t_index2<t_jsonObjects.p_Length2();t_index2=t_index2+1){
			t_jsonEXPLOREItem=object_downcast((t_jsonObjects.p_Get6(t_index2)),c_JsonObject);
			t_rectBox.m_x=0;
			t_rectBox.m_y=0;
			t_rectBox.m_w=t__img.p_Width();
			t_rectBox.m_h=t__img.p_Height();
			t_newTAG=this.p_AddSubItem2("Object_"+String(t_index2),t_index2,c_sRect.m_new3.call(new c_sRect,t_rectBox),true,4);
			t_undecided_status=false;
			var t_tag2=t_jsonEXPLOREItem.p_GetString2("tag","");
			var t_status2=t_jsonEXPLOREItem.p_GetString2("status","");
			t_status2=string_trim(t_status2);
			if(t_status2=="undecided"){
				t_status_value=0;
				t_undecided_status=true;
			}
			if(t_status2=="valid"){
				t_status_value=1;
			}
			if(t_status2=="invalid"){
				t_status_value=2;
			}
			if(bb_game_cTAXONOMYLANG.p_Exist(t_tag2)==true){
				t_newTAG.m_managed=true;
			}
			t_newTAG.p_AddSubObject(t_tag2,4,false,t_status_value,bb_game_cTAXONOMYLANG.p_Exist(t_tag2));
			if(t_undecided_status==false){
				t_newTAG.m_status=1;
			}
		}
	}
	t_jsonCOLLABORATE=object_downcast((t_jsonClassification.p_Get7("collaborate",null)),c_JsonArray);
	if(t_jsonCOLLABORATE!=null){
		for(var t_index3=0;t_index3<t_jsonCOLLABORATE.p_Length2();t_index3=t_index3+1){
			t_jsonCOLLABORATEItem=object_downcast((t_jsonCOLLABORATE.p_Get6(t_index3)),c_JsonObject);
			t_jsonBoundingBox=object_downcast((t_jsonCOLLABORATEItem.p_Get7("boundingBox",null)),c_JsonObject);
			t_jsonObjects=object_downcast((t_jsonCOLLABORATEItem.p_Get7("objects",null)),c_JsonArray);
			if(t_jsonBoundingBox!=null){
				t_rectBox.m_x=t_jsonBoundingBox.p_GetInt2("left",0);
				t_rectBox.m_y=t_jsonBoundingBox.p_GetInt2("top",0);
				t_rectBox.m_w=t_jsonBoundingBox.p_GetInt2("width",0);
				t_rectBox.m_h=t_jsonBoundingBox.p_GetInt2("height",0);
			}else{
				t_rectBox.m_x=0;
				t_rectBox.m_y=0;
				t_rectBox.m_w=t__img.p_Width();
				t_rectBox.m_h=t__img.p_Height();
			}
			t_newTAG=this.p_AddSubItem2("Object_"+String(t_index3),t_index3,c_sRect.m_new3.call(new c_sRect,t_rectBox),true,2);
			t_undecided_status=false;
			for(var t_id2=0;t_id2<t_jsonObjects.p_Length2();t_id2=t_id2+1){
				t_jsonObjectsItem=object_downcast((t_jsonObjects.p_Get6(t_id2)),c_JsonObject);
				var t_tag3=t_jsonObjectsItem.p_GetString2("tag","");
				var t_status3=t_jsonObjectsItem.p_GetString2("status","");
				t_status3=string_trim(t_status3);
				if(t_status3=="undecided"){
					t_status_value=0;
					t_undecided_status=true;
				}
				if(t_status3=="valid"){
					t_status_value=1;
				}
				if(t_status3=="invalid"){
					t_status_value=2;
				}
				if(bb_game_cTAXONOMYLANG.p_Exist(t_tag3)==true){
					t_newTAG.m_managed=true;
				}
				t_newTAG.p_AddSubObject(t_tag3,2,false,t_status_value,bb_game_cTAXONOMYLANG.p_Exist(t_tag3));
			}
			if(t_undecided_status==false){
				t_newTAG.m_status=1;
			}
		}
	}
	return 0;
}
c_structItems.prototype.p_SetName=function(t__name){
	this.m_name=t__name;
	this.m_sub_name1=t__name;
	this.m_sub_name2="";
	var t_limiter=0;
	var t_str="";
	if(this.m_name.length>24){
		t_limiter=((this.m_name.length/2)|0)+2;
		this.p_SubName(this.m_name,t_limiter);
	}
	return 0;
}
c_structItems.prototype.p_CollaborateFromJson=function(t__json,t__img){
	var t_jsonClassification=null;
	var t_jsonCOLLABORATE=null;
	var t_jsonCOLLABORATEItem=null;
	var t_jsonObjects=null;
	var t_jsonObjectsItem=null;
	var t_jsonBoundingBox=null;
	var t_rectBox=c_sRect.m_new.call(new c_sRect);
	var t_newTAG=null;
	var t_status_value=0;
	var t_undecided_status=false;
	if(t__json==null){
		return 0;
	}
	t_jsonClassification=object_downcast((t__json.p_Get7("classification",null)),c_JsonObject);
	if(t_jsonClassification==null){
		return 0;
	}
	t_jsonCOLLABORATE=object_downcast((t_jsonClassification.p_Get7("collaborate",null)),c_JsonArray);
	if(t_jsonCOLLABORATE!=null){
		for(var t_index=0;t_index<t_jsonCOLLABORATE.p_Length2();t_index=t_index+1){
			t_jsonCOLLABORATEItem=object_downcast((t_jsonCOLLABORATE.p_Get6(t_index)),c_JsonObject);
			t_jsonBoundingBox=object_downcast((t_jsonCOLLABORATEItem.p_Get7("boundingBox",null)),c_JsonObject);
			t_jsonObjects=object_downcast((t_jsonCOLLABORATEItem.p_Get7("objects",null)),c_JsonArray);
			if(t_jsonBoundingBox!=null){
				t_rectBox.m_x=t_jsonBoundingBox.p_GetInt2("left",0);
				t_rectBox.m_y=t_jsonBoundingBox.p_GetInt2("top",0);
				t_rectBox.m_w=t_jsonBoundingBox.p_GetInt2("width",0);
				t_rectBox.m_h=t_jsonBoundingBox.p_GetInt2("height",0);
			}else{
				t_rectBox.m_x=0;
				t_rectBox.m_y=0;
				t_rectBox.m_w=t__img.p_Width();
				t_rectBox.m_h=t__img.p_Height();
			}
			t_newTAG=this.p_AddSubItem2("Object_"+String(t_index),t_index,c_sRect.m_new3.call(new c_sRect,t_rectBox),true,2);
			t_newTAG.m_deleting=false;
			t_newTAG.m_zoneModify=false;
			t_newTAG.m_visible=false;
			t_undecided_status=false;
			for(var t_id=0;t_id<t_jsonObjects.p_Length2();t_id=t_id+1){
				t_jsonObjectsItem=object_downcast((t_jsonObjects.p_Get6(t_id)),c_JsonObject);
				var t_tag=t_jsonObjectsItem.p_GetString2("tag","");
				var t_status=t_jsonObjectsItem.p_GetString2("status","");
				t_status=string_trim(t_status);
				if(t_status=="undecided"){
					t_status_value=0;
					t_undecided_status=true;
				}
				if(t_status=="valid"){
					t_status_value=1;
				}
				if(t_status=="invalid"){
					t_status_value=2;
				}
				t_newTAG.p_SetName(t_tag);
			}
			if(t_undecided_status==false){
				t_newTAG.m_status=1;
			}
		}
	}
	return 0;
}
c_structItems.prototype.p_UpdateAnimation=function(t__timer){
	var t_time=bb_math_Abs(t__timer-this.m_timerAnimation);
	if(this.m_timerAnimation<=0){
		this.m_currPos.m_x=this.m_destPos.m_x;
		this.m_currPos.m_y=this.m_destPos.m_y;
		return 0;
	}
	if(t_time>500){
		this.m_timerAnimation=-1;
	}
	this.m_currPos.m_x=(((this.m_sorgPos.m_x)+((this.m_destPos.m_x-this.m_sorgPos.m_x)*t_time)/500.0)|0);
	this.m_currPos.m_y=(((this.m_sorgPos.m_y)+((this.m_destPos.m_y-this.m_sorgPos.m_y)*t_time)/500.0)|0);
	return 0;
}
c_structItems.prototype.p_Count=function(){
	var t_num=0;
	if(this.m_subitems==null){
		return 0;
	}
	if(this.m_subitems.p_Count()==0){
		return 0;
	}
	var t_=this.m_subitems.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_item=t_.p_NextObject();
		if(t_item.m_visible==true){
			t_num=t_num+1;
		}
	}
	return t_num;
}
c_structItems.prototype.p_AttachSubObject=function(t__struct,t__from){
	if(this.m_objects==null){
		this.m_objects=c_List.m_new.call(new c_List);
	}
	var t_newTAG=c_structItems.m_new.call(new c_structItems,this,t__struct.m_name);
	t_newTAG.m_zone=c_sRect.m_new.call(new c_sRect);
	t_newTAG.m_zone.m_x=this.m_zone.m_x;
	t_newTAG.m_zone.m_y=this.m_zone.m_y;
	t_newTAG.m_zone.m_w=this.m_zone.m_w;
	t_newTAG.m_zone.m_h=this.m_zone.m_h;
	t_newTAG.m_deleting=this.m_deleting;
	t_newTAG.m_fromCollaborate=false;
	t_newTAG.m_fromExplore=false;
	t_newTAG.m_fromSIE=false;
	t_newTAG.m_fromNew=false;
	if(t__from==2){
		t_newTAG.m_fromCollaborate=true;
	}
	if(t__from==4){
		t_newTAG.m_fromExplore=true;
	}
	if(t__from==1){
		t_newTAG.m_fromSIE=true;
	}
	if(t__from==8){
		t_newTAG.m_fromNew=true;
	}
	t_newTAG.m_checked=true;
	t_newTAG.m_invalid=false;
	this.m_objects.p_AddLast(t_newTAG);
	return t_newTAG;
}
c_structItems.prototype.p_RemoveSubItem=function(t__tag){
	if(this.m_subitems==null){
		return 0;
	}
	this.m_subitems.p_RemoveFirst2(t__tag);
	return 0;
}
function c_List(){
	Object.call(this);
	this.m__head=(c_HeadNode.m_new.call(new c_HeadNode));
}
c_List.prototype.p_Clear=function(){
	this.m__head.m__succ=this.m__head;
	this.m__head.m__pred=this.m__head;
	return 0;
}
c_List.prototype.p_ObjectEnumerator=function(){
	return c_Enumerator.m_new.call(new c_Enumerator,this);
}
c_List.m_new=function(){
	return this;
}
c_List.prototype.p_AddLast=function(t_data){
	return c_Node4.m_new.call(new c_Node4,this.m__head,this.m__head.m__pred,t_data);
}
c_List.m_new2=function(t_data){
	var t_=t_data;
	var t_2=0;
	while(t_2<t_.length){
		var t_t=t_[t_2];
		t_2=t_2+1;
		this.p_AddLast(t_t);
	}
	return this;
}
c_List.prototype.p_FirstNode=function(){
	if(this.m__head.m__succ!=this.m__head){
		return this.m__head.m__succ;
	}
	return null;
}
c_List.prototype.p_First=function(){
	return this.m__head.m__succ.m__data;
}
c_List.prototype.p_Last=function(){
	return this.m__head.m__pred.m__data;
}
c_List.prototype.p_Count=function(){
	var t_n=0;
	var t_node=this.m__head.m__succ;
	while(t_node!=this.m__head){
		t_node=t_node.m__succ;
		t_n+=1;
	}
	return t_n;
}
c_List.prototype.p_RemoveFirst=function(){
	var t_data=this.m__head.m__succ.m__data;
	this.m__head.m__succ.p_Remove();
	return t_data;
}
c_List.prototype.p_Equals5=function(t_lhs,t_rhs){
	return t_lhs==t_rhs;
}
c_List.prototype.p_Find=function(t_value,t_start){
	while(t_start!=this.m__head){
		if(this.p_Equals5(t_value,t_start.m__data)){
			return t_start;
		}
		t_start=t_start.m__succ;
	}
	return null;
}
c_List.prototype.p_Find2=function(t_value){
	return this.p_Find(t_value,this.m__head.m__succ);
}
c_List.prototype.p_RemoveFirst2=function(t_value){
	var t_node=this.p_Find2(t_value);
	if((t_node)!=null){
		t_node.p_Remove();
	}
}
var bb_game_selectedTAGS=null;
function c_Node4(){
	Object.call(this);
	this.m__succ=null;
	this.m__pred=null;
	this.m__data=null;
}
c_Node4.m_new=function(t_succ,t_pred,t_data){
	this.m__succ=t_succ;
	this.m__pred=t_pred;
	this.m__succ.m__pred=this;
	this.m__pred.m__succ=this;
	this.m__data=t_data;
	return this;
}
c_Node4.m_new2=function(){
	return this;
}
c_Node4.prototype.p_Value=function(){
	return this.m__data;
}
c_Node4.prototype.p_GetNode=function(){
	return this;
}
c_Node4.prototype.p_NextNode=function(){
	return this.m__succ.p_GetNode();
}
c_Node4.prototype.p_Remove=function(){
	this.m__succ.m__pred=this.m__pred;
	this.m__pred.m__succ=this.m__succ;
	return 0;
}
function c_HeadNode(){
	c_Node4.call(this);
}
c_HeadNode.prototype=extend_class(c_Node4);
c_HeadNode.m_new=function(){
	c_Node4.m_new2.call(this);
	this.m__succ=(this);
	this.m__pred=(this);
	return this;
}
c_HeadNode.prototype.p_GetNode=function(){
	return null;
}
var bb_game_originalTAGS=null;
function c_classServer(){
	Object.call(this);
	this.m_cSERVER_LOGIN=null;
	this.m_cSERVER_LOGGED=null;
	this.m_cSERVER_GETIMAGE=null;
	this.m_cSERVER_PUTIMAGEINFO=null;
	this.m_cSERVER_GETSTAT=null;
	this.m_cSERVER_GETSTATGLOBAL=null;
	this.m_cSERVER_SETSTAT=null;
	this.m_streamIMAGE=null;
}
c_classServer.m_new=function(){
	this.m_cSERVER_LOGIN=c_classServerLogin.m_new.call(new c_classServerLogin);
	this.m_cSERVER_LOGGED=c_classServerLogged.m_new.call(new c_classServerLogged);
	this.m_cSERVER_GETIMAGE=c_classServerGetImage.m_new.call(new c_classServerGetImage);
	this.m_cSERVER_PUTIMAGEINFO=c_classServerPutImageInfo.m_new.call(new c_classServerPutImageInfo);
	this.m_cSERVER_GETSTAT=c_classServerGetStat.m_new.call(new c_classServerGetStat);
	this.m_cSERVER_GETSTATGLOBAL=c_classServerGetStatGlobal.m_new.call(new c_classServerGetStatGlobal);
	this.m_cSERVER_SETSTAT=c_classServerSetStat.m_new.call(new c_classServerSetStat);
	this.m_streamIMAGE=null;
	return this;
}
function c_classServerLogin(){
	Object.call(this);
	this.m_bAborted=false;
	this.m_bSended=false;
	this.m_isLog=false;
	this.m_bError=false;
	this.m_userID=0;
	this.m_post_req=null;
	this.m_strError="";
	this.m_jsonResponse=null;
	this.implments={c_IOnHttpRequestComplete:1};
}
c_classServerLogin.m_new=function(){
	this.m_bAborted=false;
	this.m_bSended=false;
	this.m_isLog=false;
	this.m_bError=false;
	this.m_userID=0;
	return this;
}
c_classServerLogin.prototype.p_Get2=function(t__user,t__pass){
	this.m_isLog=false;
	this.m_bError=false;
	this.m_userID=0;
	this.m_bSended=false;
	var t_data="https://www.xteamsoftware.com/scent/api/auth/generate_auth_cookie/?username="+t__user+"&password="+t__pass;
	this.m_post_req=c_HttpRequest.m_new2.call(new c_HttpRequest,"GET",t_data,(this));
	this.m_post_req.p_Send();
	this.m_bSended=true;
	return 0;
}
c_classServerLogin.prototype.p_isError=function(){
	return this.m_bError;
}
c_classServerLogin.prototype.p_getError=function(){
	return this.m_strError;
}
c_classServerLogin.prototype.p_isLogin=function(){
	return this.m_isLog;
}
c_classServerLogin.prototype.p_getUserID=function(){
	return this.m_userID;
}
c_classServerLogin.prototype.p_OnHttpRequestComplete=function(t_req){
	if(t_req.p_ResponseText().length==0){
		return;
	}
	var t_str=t_req.p_ResponseText();
	t_str=string_trim(t_str);
	this.m_jsonResponse=c_JsonObject.m_new3.call(new c_JsonObject,t_str);
	if(this.m_jsonResponse==null){
		this.m_strError="invalid json";
		this.m_bError=true;
		return;
	}
	if(this.m_jsonResponse.p_GetString2("status","")=="ok"){
		var t_jsonUser=object_downcast((this.m_jsonResponse.p_Get7("user",null)),c_JsonObject);
		if(t_jsonUser==null){
			this.m_strError="invalid json";
			this.m_bError=true;
			return;
		}
		this.m_userID=t_jsonUser.p_GetInt2("id",0);
		this.m_isLog=true;
	}else{
		this.m_strError=this.m_jsonResponse.p_GetString2("error","");
		this.m_bError=true;
		return;
	}
	this.m_bAborted=true;
	this.m_bError=false;
	this.m_strError="";
}
function c_classServerLogged(){
	Object.call(this);
	this.m_bAborted=false;
	this.m_bSended=false;
	this.m_isLog=false;
	this.m_post_req=null;
	this.m_userID=0;
	this.implments={c_IOnHttpRequestComplete:1};
}
c_classServerLogged.m_new=function(){
	this.m_bAborted=false;
	this.m_bSended=false;
	this.m_isLog=false;
	return this;
}
c_classServerLogged.prototype.p_Get3=function(){
	this.m_isLog=false;
	this.m_bSended=false;
	var t_data=bb_server_kSERVER_NAME+"logged.php";
	this.m_post_req=c_HttpRequest.m_new2.call(new c_HttpRequest,"GET",t_data,(this));
	this.m_post_req.p_Send();
	this.m_bSended=true;
	return 0;
}
c_classServerLogged.prototype.p_isLogged=function(){
	return this.m_isLog;
}
c_classServerLogged.prototype.p_getUserID=function(){
	return this.m_userID;
}
c_classServerLogged.prototype.p_GetInt=function(t__str){
	var t_ret=0;
	try{
		if(t__str.length>0){
			t_ret=parseInt((t__str),10);
		}
	}catch(_eek_){
		if(t_err=object_downcast(_eek_,c_CustomException)){
		}else{
			throw _eek_;
		}
	}
	return t_ret;
}
c_classServerLogged.prototype.p_OnHttpRequestComplete=function(t_req){
	var t_str="";
	var t_pos=0;
	if(t_req.p_ResponseText().length==0){
		return;
	}
	if(t_req.p_ResponseText().indexOf("error")!=-1){
		return;
	}
	if((t_req.p_ResponseText().indexOf("[ID]:")!=-1)==false){
		return;
	}
	if((t_req.p_ResponseText().indexOf("[ID]:")!=-1)==true){
		t_str=t_req.p_ResponseText();
		t_str=string_trim(t_str);
		t_pos=t_str.indexOf("[ID]:",0);
		t_str=t_str.slice(t_pos+5);
		this.m_userID=this.p_GetInt(t_str);
		this.m_isLog=true;
	}
	this.m_bAborted=true;
}
function c_classServerGetImage(){
	Object.call(this);
	this.m_bAborted=false;
	this.m_bSended=false;
	this.m_bError=false;
	this.m_imageID=0;
	this.m_post_req=null;
	this.m_jsonData="";
	this.m_jsonResponse=null;
	this.m_urlData="";
	this.m_urlCrowd="";
	this.m_getImagedata=null;
	this.implments={c_IOnHttpRequestComplete:1};
}
c_classServerGetImage.m_new=function(){
	this.m_bAborted=false;
	this.m_bSended=false;
	this.m_bError=false;
	this.m_imageID=-1;
	return this;
}
c_classServerGetImage.prototype.p_Reset=function(){
	this.m_bAborted=false;
	this.m_bSended=false;
	this.m_bError=false;
	this.m_imageID=-1;
	return 0;
}
c_classServerGetImage.prototype.p_Get=function(t__pilot){
	this.m_bSended=false;
	var t_data=bb_server_kSERVER_NAME+"get_image.php";
	if(t__pilot!=""){
		t_data=t_data+"?pilot="+t__pilot;
	}
	this.m_post_req=c_HttpRequest.m_new2.call(new c_HttpRequest,"GET",t_data,(this));
	this.m_post_req.p_SetHeader("Content-Type","application/x-www-form-urlencoded");
	this.m_post_req.p_SetHeader("Authorization","Basic c2NlbnQtcmVhZG9ubHk6c2NlbnQ=");
	this.m_post_req.p_Send();
	this.p_Reset();
	this.m_bSended=true;
	return 0;
}
c_classServerGetImage.prototype.p_GetID=function(t__id){
	this.m_bSended=false;
	var t_data=bb_server_kSERVER_NAME+"get_image_info.php?id="+t__id;
	this.m_post_req=c_HttpRequest.m_new2.call(new c_HttpRequest,"GET",t_data,(this));
	this.m_post_req.p_SetHeader("Content-Type","application/x-www-form-urlencoded");
	this.m_post_req.p_SetHeader("Authorization","Basic c2NlbnQtcmVhZG9ubHk6c2NlbnQ=");
	this.m_post_req.p_Send();
	this.p_Reset();
	this.m_bSended=true;
	return 0;
}
c_classServerGetImage.prototype.p_getImageID=function(){
	return this.m_imageID;
}
c_classServerGetImage.prototype.p_getJSON=function(){
	return this.m_jsonData;
}
c_classServerGetImage.prototype.p_isError=function(){
	return this.m_bError;
}
c_classServerGetImage.prototype.p_OnHttpRequestComplete=function(t_req){
	if(t_req.p_ResponseText().length==0){
		return;
	}
	if(t_req.p_ResponseText().indexOf("\"message\":")!=-1){
		this.m_bError=true;
		return;
	}
	var t_pos=t_req.p_ResponseText().indexOf("{",0);
	if(t_pos<0){
		return;
	}
	var t_str=t_req.p_ResponseText().slice(t_pos);
	t_str=string_trim(t_str);
	t_str=t_str.slice(0,t_str.length-1);
	t_str=string_trim(t_str);
	this.m_jsonResponse=c_JsonObject.m_new3.call(new c_JsonObject,t_str);
	if(this.m_jsonResponse==null){
		return;
	}
	var t_data=null;
	var t_source=null;
	t_data=object_downcast((this.m_jsonResponse.p_Get7("data",null)),c_JsonObject);
	this.m_jsonData=t_data.p_ToJson();
	this.m_imageID=t_data.p_GetInt2("imageId",0);
	t_source=object_downcast((t_data.p_Get7("source",null)),c_JsonObject);
	this.m_urlData=t_source.p_GetString2("publicURI","");
	this.m_urlCrowd=t_source.p_GetString2("crowdURI","");
	if(this.m_urlData.lastIndexOf("/")==0){
		return;
	}
	var t_dest="/img"+this.m_urlData.slice(this.m_urlData.lastIndexOf("/"));
	this.m_getImagedata=c_classServerGetImageData.m_new.call(new c_classServerGetImageData);
	this.m_getImagedata.p_Get2(this.m_urlData,t_dest);
	this.m_bAborted=true;
	this.m_bError=false;
}
function c_classServerPutImageInfo(){
	Object.call(this);
	this.m_bAborted=false;
	this.m_bSended=false;
	this.m_post_req=null;
	this.implments={c_IOnHttpRequestComplete:1};
}
c_classServerPutImageInfo.m_new=function(){
	this.m_bAborted=false;
	this.m_bSended=false;
	return this;
}
c_classServerPutImageInfo.prototype.p_Get4=function(t_id,t_send){
	this.m_bSended=false;
	var t_data=bb_server_kSERVER_NAME+"put_image_info.php?id="+String(t_id)+"&jsondata="+t_send+"";
	this.m_post_req=c_HttpRequest.m_new2.call(new c_HttpRequest,"GET",t_data,(this));
	this.m_post_req.p_Send();
	this.m_bSended=true;
	return 0;
}
c_classServerPutImageInfo.prototype.p_OnHttpRequestComplete=function(t_req){
	if(t_req.p_ResponseText().length==0){
		return;
	}
	if(t_req.p_ResponseText().indexOf("error")!=-1){
		return;
	}
	this.m_bAborted=true;
}
function c_classServerGetStat(){
	Object.call(this);
	this.m_bAborted=false;
	this.m_bSended=false;
	this.m_bError=false;
	this.m_post_req=null;
	this.m_uPictureUploaded=0;
	this.m_uPictureTagged=0;
	this.m_uTag=0;
	this.m_uValidation=0;
	this.m_uScore=0;
	this.m_uLevel=0;
	this.m_uPois=0;
	this.m_uCampaign=0;
	this.m_jsonResponse=null;
	this.implments={c_IOnHttpRequestComplete:1};
}
c_classServerGetStat.m_new=function(){
	this.m_bAborted=false;
	this.m_bSended=false;
	this.m_bError=false;
	return this;
}
c_classServerGetStat.prototype.p_Reset=function(){
	this.m_bAborted=false;
	this.m_bSended=false;
	this.m_bError=false;
	this.m_uPictureUploaded=0;
	this.m_uPictureTagged=0;
	this.m_uTag=0;
	this.m_uValidation=0;
	this.m_uScore=0;
	this.m_uLevel=0;
	this.m_uPois=0;
	this.m_uCampaign=0;
	return 0;
}
c_classServerGetStat.prototype.p_Get4=function(t__id,t__nick){
	this.m_bSended=false;
	var t_data=bb_server_kSERVER_NAME+"get_statistic.php?id="+String(t__id)+"&nickname="+t__nick;
	this.m_post_req=c_HttpRequest.m_new2.call(new c_HttpRequest,"GET",t_data,(this));
	this.m_post_req.p_Send();
	this.p_Reset();
	this.m_bSended=true;
	return 0;
}
c_classServerGetStat.prototype.p_OnHttpRequestComplete=function(t_req){
	if(t_req.p_ResponseText().length==0){
		return;
	}
	if(t_req.p_ResponseText().indexOf("\"message\":")!=-1){
		this.m_bError=true;
		return;
	}
	var t_str=t_req.p_ResponseText();
	t_str=string_trim(t_str);
	this.m_jsonResponse=c_JsonObject.m_new3.call(new c_JsonObject,t_str);
	if(this.m_jsonResponse==null){
		return;
	}
	this.m_uPictureUploaded=this.m_jsonResponse.p_GetInt2("picturesUploaded",0);
	this.m_uPictureTagged=this.m_jsonResponse.p_GetInt2("picturesTagged",0);
	this.m_uTag=this.m_jsonResponse.p_GetInt2("tags",0);
	this.m_uValidation=this.m_jsonResponse.p_GetInt2("validations",0);
	this.m_uScore=this.m_jsonResponse.p_GetInt2("score",0);
	this.m_uLevel=this.m_jsonResponse.p_GetInt2("level",0);
	this.m_uPois=this.m_jsonResponse.p_GetInt2("pois",0);
	this.m_uCampaign=this.m_jsonResponse.p_GetInt2("campaigns",0);
	bb_game_userPictureUploaded=this.m_uPictureUploaded;
	bb_game_userPictureTagged=this.m_uPictureTagged;
	bb_game_userTag=this.m_uTag;
	bb_game_userValidation=this.m_uValidation;
	bb_game_userScore=this.m_uScore;
	bb_game_userLevel=this.m_uLevel;
	bb_game_userPois=this.m_uPois;
	bb_game_userCampaign=this.m_uCampaign;
}
function c_classServerGetStatGlobal(){
	Object.call(this);
	this.m_bAborted=false;
	this.m_bSended=false;
	this.m_bError=false;
	this.m_post_req=null;
	this.m_uPictureUploaded=0;
	this.m_uPictureTagged=0;
	this.m_uTag=0;
	this.m_uValidation=0;
	this.m_uScore=0;
	this.m_uLevel=0;
	this.m_uPois=0;
	this.m_uCampaign=0;
	this.m_mPictureUploaded=0;
	this.m_mPictureTagged=0;
	this.m_mTag=0;
	this.m_mValidation=0;
	this.m_mScore=0;
	this.m_mLevel=0;
	this.m_mPois=0;
	this.m_mCampaign=0;
	this.m_jsonResponse=null;
	this.implments={c_IOnHttpRequestComplete:1};
}
c_classServerGetStatGlobal.m_new=function(){
	this.m_bAborted=false;
	this.m_bSended=false;
	this.m_bError=false;
	return this;
}
c_classServerGetStatGlobal.prototype.p_Reset=function(){
	this.m_bAborted=false;
	this.m_bSended=false;
	this.m_bError=false;
	this.m_uPictureUploaded=0;
	this.m_uPictureTagged=0;
	this.m_uTag=0;
	this.m_uValidation=0;
	this.m_uScore=0;
	this.m_uLevel=0;
	this.m_uPois=0;
	this.m_uCampaign=0;
	this.m_mPictureUploaded=0;
	this.m_mPictureTagged=0;
	this.m_mTag=0;
	this.m_mValidation=0;
	this.m_mScore=0;
	this.m_mLevel=0;
	this.m_mPois=0;
	this.m_mCampaign=0;
	return 0;
}
c_classServerGetStatGlobal.prototype.p_Get3=function(){
	this.m_bSended=false;
	var t_data=bb_server_kSERVER_NAME+"get_statistic.php?id=0&nickname=server";
	this.m_post_req=c_HttpRequest.m_new2.call(new c_HttpRequest,"GET",t_data,(this));
	this.m_post_req.p_Send();
	this.p_Reset();
	this.m_bSended=true;
	return 0;
}
c_classServerGetStatGlobal.prototype.p_OnHttpRequestComplete=function(t_req){
	if(t_req.p_ResponseText().length==0){
		return;
	}
	if(t_req.p_ResponseText().indexOf("\"message\":")!=-1){
		this.m_bError=true;
		return;
	}
	var t_str=t_req.p_ResponseText();
	t_str=string_trim(t_str);
	this.m_jsonResponse=c_JsonObject.m_new3.call(new c_JsonObject,t_str);
	if(this.m_jsonResponse==null){
		return;
	}
	this.m_uPictureUploaded=this.m_jsonResponse.p_GetInt2("picturesUploaded",0);
	this.m_uPictureTagged=this.m_jsonResponse.p_GetInt2("picturesTagged",0);
	this.m_uTag=this.m_jsonResponse.p_GetInt2("tags",0);
	this.m_uValidation=this.m_jsonResponse.p_GetInt2("validations",0);
	this.m_uScore=this.m_jsonResponse.p_GetInt2("score",0);
	this.m_uLevel=this.m_jsonResponse.p_GetInt2("level",0);
	this.m_uPois=this.m_jsonResponse.p_GetInt2("pois",0);
	this.m_uCampaign=this.m_jsonResponse.p_GetInt2("campaigns",0);
	this.m_mPictureUploaded=this.m_jsonResponse.p_GetInt2("m_picturesUploaded",0);
	this.m_mPictureTagged=this.m_jsonResponse.p_GetInt2("m_picturesTagged",0);
	this.m_mTag=this.m_jsonResponse.p_GetInt2("m_tags",0);
	this.m_mValidation=this.m_jsonResponse.p_GetInt2("m_validations",0);
	this.m_mScore=this.m_jsonResponse.p_GetInt2("m_score",0);
	this.m_mLevel=this.m_jsonResponse.p_GetInt2("m_level",0);
	this.m_mPois=this.m_jsonResponse.p_GetInt2("m_pois",0);
	this.m_mCampaign=this.m_jsonResponse.p_GetInt2("m_campaigns",0);
	bb_game_userPictureUploaded=this.m_uPictureUploaded;
	bb_game_userPictureTagged=this.m_uPictureTagged;
	bb_game_userTag=this.m_uTag;
	bb_game_userValidation=this.m_uValidation;
	bb_game_userScore=this.m_uScore;
	bb_game_userLevel=this.m_uLevel;
	bb_game_userPois=this.m_uPois;
	bb_game_userCampaign=this.m_uCampaign;
}
function c_classServerSetStat(){
	Object.call(this);
	this.m_bAborted=false;
	this.m_bSended=false;
	this.m_bError=false;
	this.m_post_req=null;
	this.implments={c_IOnHttpRequestComplete:1};
}
c_classServerSetStat.m_new=function(){
	this.m_bAborted=false;
	this.m_bSended=false;
	this.m_bError=false;
	return this;
}
c_classServerSetStat.prototype.p_Reset=function(){
	this.m_bAborted=false;
	this.m_bSended=false;
	this.m_bError=false;
	return 0;
}
c_classServerSetStat.prototype.p_Get5=function(t__id,t__pictureUploaded,t__pictureTagged,t__tag,t__validation,t__score,t__level,t__pois,t__campaign){
	this.m_bSended=false;
	var t_data=bb_server_kSERVER_NAME+"set_statistics.php?id="+String(t__id)+"&picturesUploaded="+String(t__pictureUploaded)+"&picturesTagged="+String(t__pictureTagged)+"&tags="+String(t__tag)+"&validations="+String(t__validation)+"&score="+String(t__score)+"&level="+String(t__level)+"&pois="+String(t__pois)+"&campaigns="+String(t__campaign);
	this.m_post_req=c_HttpRequest.m_new2.call(new c_HttpRequest,"GET",t_data,(this));
	this.m_post_req.p_Send();
	this.p_Reset();
	this.m_bSended=true;
	return 0;
}
c_classServerSetStat.prototype.p_OnHttpRequestComplete=function(t_req){
	if(t_req.p_ResponseText().length==0){
		return;
	}
	if(t_req.p_ResponseText().indexOf("ERROR:")!=-1){
		this.m_bError=true;
		return;
	}
}
function c_classStreamedImage(){
	Object.call(this);
	this.m_bComplete=false;
	this.m_image=null;
	this.implments={c_IOnLoadImageComplete:1};
}
c_classStreamedImage.prototype.p_IsComplete=function(){
	return this.m_bComplete;
}
c_classStreamedImage.prototype.p_getImage=function(){
	this.m_bComplete=false;
	return this.m_image;
}
c_classStreamedImage.prototype.p_OnLoadImageComplete=function(t_image,t_path,t_source){
	if(t_image==null){
		print("OnLoadImageComplete FAILED");
		return;
	}
	this.m_image=t_image;
	this.m_bComplete=true;
}
c_classStreamedImage.m_new=function(t_path,t__save,t__image,t_flags){
	bb_asyncloaders_LoadImageAsync(t_path,1,t_flags,(this));
	this.m_image=t__image;
	this.m_bComplete=false;
	print(t_path);
	return this;
}
c_classStreamedImage.m_new2=function(){
	return this;
}
var bb_game_cSERVER=null;
var bb_server_kSERVER_NAME="";
function c_HttpRequest(){
	Object.call(this);
	this.m__req=null;
	this.m__onComplete=null;
	this.implments={c_IAsyncEventSource:1};
}
c_HttpRequest.m_new=function(){
	return this;
}
c_HttpRequest.prototype.p_Open=function(t_req,t_url,t_onComplete,t_timeout,t_httpsVerifyCertificate,t_httpsVerifyHost){
	if(((this.m__req)!=null) && this.m__req.IsRunning()){
		error("HttpRequest in progress");
	}
	this.m__req=(new BBHttpRequest);
	this.m__onComplete=t_onComplete;
	this.m__req.Open(t_req,t_url,t_timeout,t_httpsVerifyCertificate,t_httpsVerifyHost);
}
c_HttpRequest.m_new2=function(t_req,t_url,t_onComplete){
	this.p_Open(t_req,t_url,t_onComplete,10,false,false);
	return this;
}
c_HttpRequest.prototype.p_Send=function(){
	if(!((this.m__req)!=null)){
		error("HttpRequest not open");
	}
	if(this.m__req.IsRunning()){
		error("HttpRequest in progress");
	}
	bb_asyncevent_AddAsyncEventSource(this);
	this.m__req.Send();
}
c_HttpRequest.prototype.p_Send2=function(t_data,t_mimeType,t_encoding){
	if(!((this.m__req)!=null)){
		error("HttpRequest not open");
	}
	if(this.m__req.IsRunning()){
		error("HttpRequest in progress");
	}
	if((t_mimeType).length!=0){
		this.m__req.SetHeader("Content-Type",t_mimeType);
	}
	bb_asyncevent_AddAsyncEventSource(this);
	this.m__req.SendText(t_data,t_encoding);
}
c_HttpRequest.prototype.p_SetHeader=function(t_name,t_value){
	if(!((this.m__req)!=null)){
		error("HttpRequest not open");
	}
	if(this.m__req.IsRunning()){
		error("HttpRequest in progress");
	}
	this.m__req.SetHeader(t_name,t_value);
}
c_HttpRequest.prototype.p_UpdateAsyncEvents=function(){
	if(this.m__req.IsRunning()){
		return;
	}
	bb_asyncevent_RemoveAsyncEventSource(this);
	this.m__onComplete.p_OnHttpRequestComplete(this);
}
c_HttpRequest.prototype.p_ResponseText=function(){
	if(!((this.m__req)!=null)){
		error("HttpRequest not open");
	}
	return this.m__req.ResponseText();
}
function c_Stack7(){
	Object.call(this);
	this.m_data=[];
	this.m_length=0;
}
c_Stack7.m_new=function(){
	return this;
}
c_Stack7.m_new2=function(t_data){
	this.m_data=t_data.slice(0);
	this.m_length=t_data.length;
	return this;
}
c_Stack7.prototype.p_Equals6=function(t_lhs,t_rhs){
	return t_lhs==t_rhs;
}
c_Stack7.prototype.p_Contains3=function(t_value){
	for(var t_i=0;t_i<this.m_length;t_i=t_i+1){
		if(this.p_Equals6(this.m_data[t_i],t_value)){
			return true;
		}
	}
	return false;
}
c_Stack7.prototype.p_Push19=function(t_value){
	if(this.m_length==this.m_data.length){
		this.m_data=resize_object_array(this.m_data,this.m_length*2+10);
	}
	this.m_data[this.m_length]=t_value;
	this.m_length+=1;
}
c_Stack7.prototype.p_Push20=function(t_values,t_offset,t_count){
	for(var t_i=0;t_i<t_count;t_i=t_i+1){
		this.p_Push19(t_values[t_offset+t_i]);
	}
}
c_Stack7.prototype.p_Push21=function(t_values,t_offset){
	this.p_Push20(t_values,t_offset,t_values.length-t_offset);
}
c_Stack7.m_NIL=null;
c_Stack7.prototype.p_Length=function(t_newlength){
	if(t_newlength<this.m_length){
		for(var t_i=t_newlength;t_i<this.m_length;t_i=t_i+1){
			this.m_data[t_i]=c_Stack7.m_NIL;
		}
	}else{
		if(t_newlength>this.m_data.length){
			this.m_data=resize_object_array(this.m_data,bb_math_Max(this.m_length*2+10,t_newlength));
		}
	}
	this.m_length=t_newlength;
}
c_Stack7.prototype.p_Length2=function(){
	return this.m_length;
}
c_Stack7.prototype.p_Get6=function(t_index){
	return this.m_data[t_index];
}
c_Stack7.prototype.p_RemoveEach=function(t_value){
	var t_i=0;
	var t_j=this.m_length;
	while(t_i<this.m_length){
		if(!this.p_Equals6(this.m_data[t_i],t_value)){
			t_i+=1;
			continue;
		}
		var t_b=t_i;
		var t_e=t_i+1;
		while(t_e<this.m_length && this.p_Equals6(this.m_data[t_e],t_value)){
			t_e+=1;
		}
		while(t_e<this.m_length){
			this.m_data[t_b]=this.m_data[t_e];
			t_b+=1;
			t_e+=1;
		}
		this.m_length-=t_e-t_b;
		t_i+=1;
	}
	t_i=this.m_length;
	while(t_i<t_j){
		this.m_data[t_i]=c_Stack7.m_NIL;
		t_i+=1;
	}
}
var bb_asyncevent__sources=null;
function bb_asyncevent_AddAsyncEventSource(t_source){
	if(bb_asyncevent__sources.p_Contains3(t_source)){
		error("Async event source is already active");
	}
	bb_asyncevent__sources.p_Push19(t_source);
}
function c_classRender_Helper(){
	Object.call(this);
	this.m_tutorial_index=0;
	this.m_SPRITE_HELPER=null;
	this.m_bEnabled=false;
	this.m_timerAnimation=0;
	this.m_timerAppear=0;
	this.m_timerStart=0;
	this.m_bAnimation=false;
}
c_classRender_Helper.m_new=function(){
	this.m_tutorial_index=-1;
	return this;
}
c_classRender_Helper.prototype.p_Init=function(){
	var t_helper=((bb_random_Rnd2(0.0,8.0))|0);
	var t_path="helper/000.png";
	var t_1=t_helper;
	if(t_1==0){
		t_path="helper/000.png";
	}else{
		if(t_1==1){
			t_path="helper/001.png";
		}else{
			if(t_1==2){
				t_path="helper/002.png";
			}else{
				if(t_1==3){
					t_path="helper/003.png";
				}else{
					if(t_1==4){
						t_path="helper/004.png";
					}else{
						if(t_1==5){
							t_path="helper/005.png";
						}else{
							if(t_1==6){
								t_path="helper/006.png";
							}else{
								if(t_1==7){
									t_path="helper/001.png";
								}
							}
						}
					}
				}
			}
		}
	}
	this.m_SPRITE_HELPER=bb_graphics_LoadImage2(t_path,256,256,1,1);
	this.m_bEnabled=false;
	this.m_timerAnimation=0;
	this.m_timerAppear=((bb_random_Rnd2(10.0,25.0)*1000.0)|0);
	this.m_timerStart=bb_app_Millisecs();
	return 0;
}
c_classRender_Helper.prototype.p_InitTutorial=function(t__state){
	var t_2=t__state;
	if(t_2==2){
		if(this.m_tutorial_index<50 || this.m_tutorial_index>53){
			this.m_tutorial_index=50;
		}else{
			this.m_tutorial_index=this.m_tutorial_index+1;
		}
		if(this.m_tutorial_index>53){
			this.m_tutorial_index=50;
		}
	}else{
		if(t_2==101){
			if(this.m_tutorial_index<54 || this.m_tutorial_index>59){
				this.m_tutorial_index=54;
			}else{
				this.m_tutorial_index=this.m_tutorial_index+1;
			}
			if(this.m_tutorial_index>59){
				this.m_tutorial_index=54;
			}
		}else{
			if(t_2==121){
				if(this.m_tutorial_index<60 || this.m_tutorial_index>66){
					this.m_tutorial_index=60;
				}else{
					this.m_tutorial_index=this.m_tutorial_index+1;
				}
				if(this.m_tutorial_index>66){
					this.m_tutorial_index=60;
				}
			}
		}
	}
	return this.m_tutorial_index;
}
c_classRender_Helper.prototype.p_Render=function(t__mouse,t__state){
	var t_start_x=-512;
	var t_x=96;
	var t_y=bb_collaborate_Collaborate.m_GameHeight-80;
	var t_size=0.75;
	var t_alpha=1.0;
	if(c_Session.m_bExpertMode==true){
		return 0;
	}
	if(this.m_timerAppear>-1){
		if(bb_math_Abs(bb_app_Millisecs()-this.m_timerStart)<this.m_timerAppear){
			return 0;
		}else{
			this.m_timerAppear=-1;
			this.m_bEnabled=true;
			this.m_bAnimation=true;
			this.m_timerAnimation=bb_app_Millisecs();
			this.m_timerStart=bb_app_Millisecs();
			this.m_tutorial_index=this.p_InitTutorial(t__state);
		}
	}else{
		if(this.m_timerStart>-1){
			if(bb_math_Abs(bb_app_Millisecs()-this.m_timerStart)>8000){
				this.m_bEnabled=false;
				this.m_bAnimation=true;
				this.m_timerAnimation=bb_app_Millisecs();
				this.m_timerStart=-1;
			}
		}
	}
	if(t__mouse.p_Inside(t_x,t_y,48)){
		t_size=1.0;
		bb_game_MouseOver();
		if(bb_game_inputHit==1){
			bb_checkkeys_DelayKeys(0);
		}
	}
	if(this.m_bAnimation==true){
		t_alpha=(bb_math_Abs(bb_app_Millisecs()-this.m_timerAnimation))/1000.0;
		if(t_alpha>1.0){
			t_alpha=1.0;
			this.m_bAnimation=false;
			if(this.m_bEnabled==false){
				this.p_Init();
			}
		}
		if(this.m_bEnabled==false){
			t_alpha=1.0-t_alpha;
		}
		t_x=(((t_x)*t_alpha+(t_start_x)*(1.0-t_alpha))|0);
	}
	if(t__state==108 || t__state==122){
		return 0;
	}
	bb_graphics_DrawImage2(this.m_SPRITE_HELPER,(t_x),(t_y),0.0,t_size,t_size,0);
	if(this.m_bAnimation==false && t_x>0){
		if(this.m_tutorial_index>0){
			bb_graphics_SetAlpha(0.90);
			bb_graphics_SetColor(0.0,0.0,0.0);
			bb_graphics_DrawRect((t_x+80),(t_y-48),760.0,96.0);
			bb_graphics_SetAlpha(1.0);
			bb_graphics_SetColor(255.0,255.0,255.0);
			if((bb_game_cLANGUAGE.p_GetItem(this.m_tutorial_index).indexOf("\\n")!=-1)==true){
				var t_str=bb_game_cLANGUAGE.p_GetItem(this.m_tutorial_index).split("\\n");
				if(t_str.length>2){
					bb_game_fontAngelMini.p_DrawText2(t_str[0],t_x+80+380,t_y-36,1);
					bb_game_fontAngelMini.p_DrawText2(t_str[1],t_x+80+380,t_y-6,1);
					bb_game_fontAngelMini.p_DrawText2(t_str[2],t_x+80+380,t_y+24,1);
				}else{
					bb_game_fontAngelMini.p_DrawText2(t_str[0],t_x+80+380,t_y-24,1);
					bb_game_fontAngelMini.p_DrawText2(t_str[1],t_x+80+380,t_y+8,1);
				}
			}else{
				bb_game_fontAngelMini.p_DrawText2(bb_game_cLANGUAGE.p_GetItem(this.m_tutorial_index),t_x+80+380,t_y-12,1);
			}
			bb_graphics_SetColor(255.0,255.0,255.0);
		}
	}
	bb_graphics_SetAlpha(1.0);
	return 0;
}
var bb_game_cRENDER_HELPER=null;
function bb_random_Rnd(){
	bb_random_Seed=bb_random_Seed*1664525+1013904223|0;
	return (bb_random_Seed>>8&16777215)/16777216.0;
}
function bb_random_Rnd2(t_low,t_high){
	return bb_random_Rnd3(t_high-t_low)+t_low;
}
function bb_random_Rnd3(t_range){
	return bb_random_Rnd()*t_range;
}
function c_classRender_Profile(){
	Object.call(this);
	this.m_pathBADGES=new_string_array(25);
	this.m_bEnabled=false;
	this.m_timerAnimation=0;
	this.m_bEnabledBB=false;
	this.m_timerAnimationBB=0;
	this.m_bAnimation=false;
	this.m_IMG_BADGES=new_object_array(25);
	this.m_IMG_PROFILE=null;
	this.m_bAnimationBB=false;
	this.m_IMG_AUDIO=null;
}
c_classRender_Profile.m_new=function(){
	var t_strPATH="badges/";
	this.m_pathBADGES[0]=t_strPATH+"CampaignA1.png";
	this.m_pathBADGES[1]=t_strPATH+"CampaignA2.png";
	this.m_pathBADGES[2]=t_strPATH+"CampaignA3.png";
	this.m_pathBADGES[3]=t_strPATH+"MonsterA1.png";
	this.m_pathBADGES[4]=t_strPATH+"MonsterA2.png";
	this.m_pathBADGES[5]=t_strPATH+"MonsterA3.png";
	this.m_pathBADGES[6]=t_strPATH+"PointOfInterestB1.png";
	this.m_pathBADGES[7]=t_strPATH+"PointOfInterestB2.png";
	this.m_pathBADGES[8]=t_strPATH+"PointOfInterestB3.png";
	this.m_pathBADGES[9]=t_strPATH+"PhotoAddedA1.png";
	this.m_pathBADGES[10]=t_strPATH+"PhotoAddedA2.png";
	this.m_pathBADGES[11]=t_strPATH+"PhotoAddedA3.png";
	this.m_pathBADGES[12]=t_strPATH+"PhotoB1.png";
	this.m_pathBADGES[13]=t_strPATH+"PhotoB2.png";
	this.m_pathBADGES[14]=t_strPATH+"PhotoB3.png";
	this.m_pathBADGES[15]=t_strPATH+"ScoreC1.png";
	this.m_pathBADGES[16]=t_strPATH+"ScoreC2.png";
	this.m_pathBADGES[17]=t_strPATH+"ScoreC3.png";
	this.m_pathBADGES[18]=t_strPATH+"Tag1.png";
	this.m_pathBADGES[19]=t_strPATH+"Tag2.png";
	this.m_pathBADGES[20]=t_strPATH+"Tag3.png";
	return this;
}
c_classRender_Profile.prototype.p_Init=function(){
	this.m_bEnabled=false;
	this.m_timerAnimation=0;
	this.m_bEnabledBB=false;
	this.m_timerAnimationBB=0;
	return 0;
}
c_classRender_Profile.prototype.p_ConvertLevel=function(t__score){
	var t_ret="Newbie";
	var t_value=10;
	if(t__score>t_value){
		t_ret="Novice";
	}
	t_value=t_value*2+((t_value/2)|0);
	if(t__score>t_value){
		t_ret="Rookie";
	}
	t_value=t_value*2+((t_value/2)|0);
	if(t__score>t_value){
		t_ret="Beginner";
	}
	t_value=t_value*2+((t_value/2)|0);
	if(t__score>t_value){
		t_ret="Talented";
	}
	t_value=t_value*2+((t_value/2)|0);
	if(t__score>t_value){
		t_ret="Skilled";
	}
	t_value=t_value*2+((t_value/2)|0);
	if(t__score>t_value){
		t_ret="Intermediate";
	}
	t_value=t_value*2+((t_value/2)|0);
	if(t__score>t_value){
		t_ret="Skillful";
	}
	t_value=t_value*2+((t_value/2)|0);
	if(t__score>t_value){
		t_ret="Seasoned";
	}
	t_value=t_value*2+((t_value/2)|0);
	if(t__score>t_value){
		t_ret="Proficient";
	}
	t_value=t_value*2+((t_value/2)|0);
	if(t__score>t_value){
		t_ret="Experienced";
	}
	t_value=t_value*2+((t_value/2)|0);
	if(t__score>t_value){
		t_ret="Advanced";
	}
	t_value=t_value*2+((t_value/2)|0);
	if(t__score>t_value){
		t_ret="Senior";
	}
	t_value=t_value*2+((t_value/2)|0);
	if(t__score>t_value){
		t_ret="Expert";
	}
	return t_ret;
}
c_classRender_Profile.prototype.p_RenderProfile=function(t__mouse){
	var t_start_x=(((bb_collaborate_Collaborate.m_GameWidth)*1.5)|0);
	var t_w=512;
	var t_h=360;
	var t_x=bb_collaborate_Collaborate.m_GameWidth-((t_w/2)|0);
	var t_x2=0;
	var t_y=48+((t_h/2)|0);
	var t_space_x=48;
	var t_space_y=48;
	var t_space_line=40;
	var t_alpha=1.0;
	if(this.m_bAnimation==true){
		t_alpha=(bb_math_Abs(bb_app_Millisecs()-this.m_timerAnimation))/1000.0;
		if(t_alpha>1.0){
			t_alpha=1.0;
			this.m_bAnimation=false;
		}
		if(this.m_bEnabled==false){
			t_alpha=1.0-t_alpha;
		}
		t_x=(((t_x)*t_alpha+(t_start_x)*(1.0-t_alpha))|0);
	}
	bb_graphics_SetColor(0.0,80.0,0.0);
	bb_graphics_SetAlpha(1.0*t_alpha);
	bb_graphics_DrawRect((t_x-((t_w/2)|0)),0.0,(t_w),(bb_collaborate_Collaborate.m_GameHeight));
	bb_graphics_SetAlpha(1.0*t_alpha);
	bb_graphics_SetColor(255.0,255.0,255.0);
	t_x=t_x-((t_w/2)|0);
	t_y=t_y-((t_h/2)|0)+((t_space_y/2)|0);
	bb_game_fontAngelMini.p_DrawText("ID :"+String(bb_game_userIDSelected),t_x+t_space_x,32);
	bb_game_fontAngelMini.p_DrawText("USER REPORT",t_x+t_space_x,t_y);
	t_x=t_x+t_space_x;
	t_x2=t_x+t_space_x*6;
	t_y=t_y+t_space_line;
	bb_game_fontAngelMini.p_DrawText("Score",t_x+t_space_x,t_y);
	bb_game_fontAngelMini.p_DrawText(String(bb_game_userScore),t_x2,t_y);
	t_y=t_y+t_space_line;
	bb_game_fontAngelMini.p_DrawText("Pictures uploaded",t_x+t_space_x,t_y);
	bb_game_fontAngelMini.p_DrawText(String(bb_game_userPictureUploaded),t_x2,t_y);
	t_y=t_y+t_space_line;
	bb_game_fontAngelMini.p_DrawText("Pictures tagged",t_x+t_space_x,t_y);
	bb_game_fontAngelMini.p_DrawText(String(bb_game_userPictureTagged),t_x2,t_y);
	t_y=t_y+t_space_line;
	bb_game_fontAngelMini.p_DrawText("Tags",t_x+t_space_x,t_y);
	bb_game_fontAngelMini.p_DrawText(String(bb_game_userTag),t_x2,t_y);
	t_y=t_y+t_space_line;
	bb_game_fontAngelMini.p_DrawText("Validations",t_x+t_space_x,t_y);
	bb_game_fontAngelMini.p_DrawText(String(bb_game_userValidation),t_x2,t_y);
	t_y=t_y+t_space_line;
	bb_game_fontAngelMini.p_DrawText("Campaigns",t_x+t_space_x,t_y);
	bb_game_fontAngelMini.p_DrawText(String(bb_game_userCampaign),t_x2,t_y);
	t_y=t_y+t_space_line;
	bb_game_fontAngelMini.p_DrawText("POIs",t_x+t_space_x,t_y);
	bb_game_fontAngelMini.p_DrawText(String(bb_game_userPois),t_x2,t_y);
	t_y=t_y+t_space_line;
	bb_game_fontAngelMini.p_DrawText("Level",t_x+t_space_x,t_y);
	bb_game_fontAngelMini.p_DrawText(this.p_ConvertLevel(bb_game_userScore),t_x2,t_y);
	t_y=t_y+t_space_line*2;
	for(var t_t=0;t_t<=2;t_t=t_t+1){
		bb_graphics_DrawImage2(this.m_IMG_BADGES[t_t],(t_x+32+64*(t_t-0)),(t_y),0.0,0.5,0.5,0);
	}
	for(var t_t2=3;t_t2<=5;t_t2=t_t2+1){
		bb_graphics_DrawImage2(this.m_IMG_BADGES[t_t2],(t_x+((t_w/2)|0)+64*(t_t2-3)),(t_y),0.0,0.5,0.5,0);
	}
	t_y=(((t_y)+(t_space_line)*1.5)|0);
	for(var t_t3=6;t_t3<=8;t_t3=t_t3+1){
		bb_graphics_DrawImage2(this.m_IMG_BADGES[t_t3],(t_x+32+64*(t_t3-6)),(t_y),0.0,0.5,0.5,0);
	}
	for(var t_t4=9;t_t4<=11;t_t4=t_t4+1){
		bb_graphics_DrawImage2(this.m_IMG_BADGES[t_t4],(t_x+((t_w/2)|0)+64*(t_t4-9)),(t_y),0.0,0.5,0.5,0);
	}
	t_y=(((t_y)+(t_space_line)*1.5)|0);
	for(var t_t5=12;t_t5<=14;t_t5=t_t5+1){
		bb_graphics_DrawImage2(this.m_IMG_BADGES[t_t5],(t_x+32+64*(t_t5-12)),(t_y),0.0,0.5,0.5,0);
	}
	for(var t_t6=15;t_t6<=17;t_t6=t_t6+1){
		bb_graphics_DrawImage2(this.m_IMG_BADGES[t_t6],(t_x+((t_w/2)|0)+64*(t_t6-15)),(t_y),0.0,0.5,0.5,0);
	}
	t_y=(((t_y)+(t_space_line)*1.5)|0);
	for(var t_t7=18;t_t7<=20;t_t7=t_t7+1){
		bb_graphics_DrawImage2(this.m_IMG_BADGES[t_t7],(t_x+32+64*(t_t7-18)),(t_y),0.0,0.5,0.5,0);
	}
	bb_graphics_SetAlpha(1.0);
	return 0;
}
c_classRender_Profile.prototype.p_Render2=function(t__mouse){
	var t_x=bb_collaborate_Collaborate.m_GameWidth-48;
	var t_y=48;
	var t_size=0.75;
	if(bb_game_userIDSelected<=0){
		this.m_bEnabled=false;
		return 0;
	}
	if(this.m_bEnabled==true || this.m_bAnimation==true){
		this.p_RenderProfile(t__mouse);
	}
	if(t__mouse.p_Inside(t_x,t_y,48)){
		t_size=1.0;
		bb_game_MouseOver();
		if(bb_game_inputHit==1){
			if(this.m_bEnabled==true){
				this.m_bEnabled=false;
			}else{
				this.m_bEnabled=true;
				bb_game_cSERVER.m_cSERVER_GETSTAT.p_Get4(bb_game_userIDSelected,bb_game_userNickName);
			}
			this.m_bAnimation=true;
			this.m_timerAnimation=bb_app_Millisecs();
			bb_checkkeys_DelayKeys(0);
		}
	}
	bb_graphics_DrawImage2(this.m_IMG_PROFILE,(t_x),(t_y),0.0,t_size,t_size,0);
	return 0;
}
c_classRender_Profile.prototype.p_RenderBoundingBox=function(t__mouse,t__originalTAGS,t__selectedTAGS,t__startX,t__startY,t__ratio){
	var t_alpha=1.0;
	if(this.m_bAnimationBB==true){
		t_alpha=(bb_math_Abs(bb_app_Millisecs()-this.m_timerAnimationBB))/1000.0;
		if(t_alpha>1.0){
			t_alpha=1.0;
			this.m_bAnimationBB=false;
		}
		if(this.m_bEnabledBB==false){
			t_alpha=1.0-t_alpha;
		}
	}
	bb_graphics_SetColor(128.0,0.0,0.0);
	bb_graphics_SetAlpha(0.33*t_alpha);
	if(t__selectedTAGS!=null && t__selectedTAGS.m_subitems!=null){
		var t_=t__selectedTAGS.m_subitems.p_ObjectEnumerator();
		while(t_.p_HasNext()){
			var t_item=t_.p_NextObject();
			bb_graphics_DrawRect((t__startX)+(t_item.m_zone.m_x)*t__ratio,(t__startY)+(t_item.m_zone.m_y)*t__ratio,(t_item.m_zone.m_w)*t__ratio,(t_item.m_zone.m_h)*t__ratio);
		}
	}
	if(t__originalTAGS!=null && t__originalTAGS.m_subitems!=null){
		var t_2=t__originalTAGS.m_subitems.p_ObjectEnumerator();
		while(t_2.p_HasNext()){
			var t_item2=t_2.p_NextObject();
			bb_graphics_DrawRect((t__startX)+(t_item2.m_zone.m_x)*t__ratio,(t__startY)+(t_item2.m_zone.m_y)*t__ratio,(t_item2.m_zone.m_w)*t__ratio,(t_item2.m_zone.m_h)*t__ratio);
		}
	}
	bb_graphics_SetAlpha(1.0);
	bb_graphics_SetColor(255.0,255.0,255.0);
	return 0;
}
c_classRender_Profile.prototype.p_RenderBB=function(t__mouse,t__originalTAGS,t__selectedTAGS,t__startX,t__startY,t__ratio){
	var t_x=bb_collaborate_Collaborate.m_GameWidth-160;
	var t_y=48;
	var t_size=0.75;
	if(t__mouse.p_Inside(t_x,t_y,48)){
		t_size=1.0;
		bb_game_MouseOver();
		if(bb_game_inputHit==1){
			if(this.m_bEnabledBB==true){
				this.m_bEnabledBB=false;
			}else{
				this.m_bEnabledBB=true;
			}
			this.m_bAnimationBB=true;
			this.m_timerAnimationBB=bb_app_Millisecs();
			bb_checkkeys_DelayKeys(0);
		}
	}
	bb_graphics_DrawImage2(this.m_IMG_PROFILE,(t_x),(t_y),0.0,t_size,t_size,1);
	if(this.m_bEnabledBB==true || this.m_bAnimationBB==true){
		this.p_RenderBoundingBox(t__mouse,t__originalTAGS,t__selectedTAGS,t__startX,t__startY,t__ratio);
	}
	return 0;
}
c_classRender_Profile.prototype.p_RenderAudio=function(t__mouse){
	var t_x=bb_collaborate_Collaborate.m_GameWidth-256;
	var t_y=48;
	var t_size=0.75;
	if(t__mouse.p_Inside(t_x,t_y,48)){
		t_size=1.0;
		bb_game_MouseOver();
		if(bb_game_inputHit==1){
			if(bb_game_cVOICE.m_bEnabled==true){
				bb_game_cVOICE.m_bEnabled=false;
			}else{
				bb_game_cVOICE.m_bEnabled=true;
			}
			bb_checkkeys_DelayKeys(0);
		}
	}
	if(bb_game_cVOICE.m_bEnabled==true){
		bb_graphics_DrawImage2(this.m_IMG_AUDIO,(t_x),(t_y),0.0,t_size,t_size,0);
	}else{
		bb_graphics_DrawImage2(this.m_IMG_AUDIO,(t_x),(t_y),0.0,t_size,t_size,1);
	}
	return 0;
}
c_classRender_Profile.prototype.p_LoadProfile=function(){
	this.m_IMG_PROFILE=bb_graphics_LoadImage2("menu/profile.png",64,64,2,1);
	this.m_IMG_AUDIO=bb_graphics_LoadImage2("menu/audio.png",64,64,2,1);
	return 0;
}
c_classRender_Profile.prototype.p_LoadAudio=function(){
	bb_defaultmedia_ICON_AUDIO=bb_graphics_LoadImage2("menu/audio.png",64,64,2,1);
	return 0;
}
c_classRender_Profile.prototype.p_LoadBadges=function(t__from,t__to){
	for(var t_i=t__from;t_i<=t__to;t_i=t_i+1){
		this.m_IMG_BADGES[t_i]=bb_graphics_LoadImage2(this.m_pathBADGES[t_i],80,80,1,1);
		print(this.m_pathBADGES[t_i]);
	}
	return 0;
}
var bb_game_cRENDER_PROFILE=null;
function c_classRender_Login(){
	Object.call(this);
	this.m_strError="";
	this.m_strUserName="";
	this.m_strUserPassword="";
	this.m_strUserPasswordCrypt="";
	this.m_bEnabledUserName=false;
	this.m_bEnabledUserPassword=false;
}
c_classRender_Login.m_new=function(){
	this.m_strError="";
	return this;
}
c_classRender_Login.prototype.p_Init=function(){
	this.m_strUserName="";
	this.m_strUserPassword="";
	this.m_strUserPasswordCrypt="";
	this.m_bEnabledUserName=false;
	this.m_bEnabledUserPassword=false;
	return 0;
}
c_classRender_Login.prototype.p_RenderWait=function(t__mouse){
	var t_x=((bb_collaborate_Collaborate.m_GameWidth/2)|0);
	var t_y=((bb_collaborate_Collaborate.m_GameHeight/2)|0);
	var t_size=1.0;
	var t_angle=bb_math_Abs((bb_app_Millisecs()/15)|0) % 360;
	bb_graphics_SetColor(0.0,0.0,0.0);
	bb_game_fontAngelMini.p_DrawText2("Authentication",t_x,t_y-128,1);
	bb_graphics_SetColor(255.0,255.0,255.0);
	bb_graphics_DrawImage2(bb_defaultmedia_ICON_LOADER,(t_x),(t_y+64),(t_angle),1.0,1.0,0);
	if(bb_game_cSERVER.m_cSERVER_LOGIN.p_isError()==true){
		this.m_strError=bb_game_cSERVER.m_cSERVER_LOGIN.p_getError();
		bb_session_GameSession.p_SetState(2);
	}
	if(bb_game_cSERVER.m_cSERVER_LOGIN.p_isLogin()==true){
		bb_game_userIDSelected=bb_game_cSERVER.m_cSERVER_LOGIN.p_getUserID();
		bb_session_GameSession.p_SetState(3);
	}
	return 0;
}
var bb_game_cRENDER_LOGIN=null;
function c_classRender_Intro(){
	Object.call(this);
	this.m_timerLogged=0;
}
c_classRender_Intro.m_new=function(){
	return this;
}
c_classRender_Intro.prototype.p_Init=function(){
	this.m_timerLogged=bb_app_Millisecs();
	return 0;
}
c_classRender_Intro.prototype.p_Render2=function(t__mouse){
	var t_x=(((bb_collaborate_Collaborate.m_GameWidth)*0.5)|0);
	var t_y=(((bb_collaborate_Collaborate.m_GameHeight)*0.75)|0);
	bb_graphics_DrawImage(bb_defaultmedia_IMG_MAIN,0.0,0.0,0);
	bb_game_cRENDER_LANGUAGE.p_Language(t__mouse);
	if(bb_game_cSERVER.m_cSERVER_LOGGED.p_isLogged()==false){
		bb_game_cRENDER_SCENTCOLLABORATE.p_RenderTagLabelDone(true,t__mouse,bb_game_fontAngelMini,bb_game_cLANGUAGE.p_GetItem(6),3,t_x,t_y,1);
	}else{
		bb_game_userIDSelected=bb_game_cSERVER.m_cSERVER_LOGGED.p_getUserID();
		bb_session_GameSession.p_SetState(3);
	}
	if(bb_game_inputHit==1){
		bb_game_gStartTimer=bb_app_Millisecs();
	}
	if(bb_math_Abs(bb_app_Millisecs()-this.m_timerLogged)>5000){
		this.m_timerLogged=bb_app_Millisecs();
		bb_game_cSERVER.m_cSERVER_LOGGED.p_Get3();
	}
	return 0;
}
var bb_game_cRENDER_INTRO=null;
function c_classRender_Language(){
	Object.call(this);
	this.m_posFlag=new_object_array(5);
	this.m_posFlagInside=new_object_array(5);
}
c_classRender_Language.m_new=function(){
	this.m_posFlag[0]=c_sPoint.m_new3.call(new c_sPoint);
	this.m_posFlag[1]=c_sPoint.m_new3.call(new c_sPoint);
	this.m_posFlag[2]=c_sPoint.m_new3.call(new c_sPoint);
	this.m_posFlagInside[0]=c_sPoint.m_new3.call(new c_sPoint);
	this.m_posFlagInside[1]=c_sPoint.m_new3.call(new c_sPoint);
	this.m_posFlagInside[2]=c_sPoint.m_new3.call(new c_sPoint);
	return this;
}
c_classRender_Language.prototype.p_Init=function(){
	this.m_posFlag[0].m_x=bb_collaborate_Collaborate.m_GameWidth-240;
	this.m_posFlag[0].m_y=48;
	this.m_posFlag[1].m_x=bb_collaborate_Collaborate.m_GameWidth-240+80;
	this.m_posFlag[1].m_y=48;
	this.m_posFlag[2].m_x=bb_collaborate_Collaborate.m_GameWidth-240+160;
	this.m_posFlag[2].m_y=48;
	this.m_posFlagInside[0].m_x=bb_collaborate_Collaborate.m_GameWidth-240;
	this.m_posFlagInside[0].m_y=bb_collaborate_Collaborate.m_GameHeight-40;
	this.m_posFlagInside[1].m_x=bb_collaborate_Collaborate.m_GameWidth-240+80;
	this.m_posFlagInside[1].m_y=bb_collaborate_Collaborate.m_GameHeight-40;
	this.m_posFlagInside[2].m_x=bb_collaborate_Collaborate.m_GameWidth-240+160;
	this.m_posFlagInside[2].m_y=bb_collaborate_Collaborate.m_GameHeight-40;
	return 0;
}
c_classRender_Language.prototype.p_Language=function(t__mouse){
	var t_size=1.0;
	var t_alpha=0.75;
	return 0;
}
c_classRender_Language.prototype.p_Render2=function(t__mouse){
	var t_size=1.0;
	var t_alpha=0.75;
	return 0;
}
function c_sPoint(){
	Object.call(this);
	this.m_x=0;
	this.m_y=0;
}
c_sPoint.m_new=function(t__x,t__y){
	this.m_x=t__x;
	this.m_y=t__y;
	return this;
}
c_sPoint.m_new2=function(t__other){
	this.m_x=t__other.m_x;
	this.m_y=t__other.m_y;
	return this;
}
c_sPoint.m_new3=function(){
	return this;
}
c_sPoint.prototype.p_Distance=function(t_other){
	return ((Math.sqrt((this.m_x-t_other.m_x)*(this.m_x-t_other.m_x)+(this.m_y-t_other.m_y)*(this.m_y-t_other.m_y)))|0);
}
c_sPoint.prototype.p_Inside=function(t__x,t__y,t__dist){
	if(Math.sqrt((this.m_x-t__x)*(this.m_x-t__x)+(this.m_y-t__y)*(this.m_y-t__y))<=(t__dist)){
		return true;
	}
	return false;
}
var bb_game_cRENDER_LANGUAGE=null;
function c_classGame_Language(){
	Object.call(this);
	this.m_indexLanguage=0;
	this.m_listLanguage=new_object_array(100);
}
c_classGame_Language.m_new=function(){
	return this;
}
c_classGame_Language.prototype.p_GetString=function(t__ref){
	var t_2=t__ref;
	if(t_2==1){
		return "LANG_YES";
	}else{
		if(t_2==2){
			return "LANG_NO";
		}else{
			if(t_2==5){
				return "LANG_NOTOANNOTATE";
			}else{
				if(t_2==6){
					return "LANG_GUEST";
				}else{
					if(t_2==7){
						return "LANG_DOWNLOADIMAGE";
					}else{
						if(t_2==8){
							return "LANG_TAGPICTURE";
						}else{
							if(t_2==9){
								return "LANG_TAGPICTURE_SUBTITLE";
							}else{
								if(t_2==10){
									return "LANG_VALIDATE_TITLE1";
								}else{
									if(t_2==11){
										return "LANG_VALIDATE_TITLE2";
									}else{
										if(t_2==15){
											return "LANG_ADDTAGS_TITLE";
										}else{
											if(t_2==16){
												return "LANG_ADDTAGS_NEAROBJECTS";
											}else{
												if(t_2==20){
													return "LANG_CONTINUE";
												}else{
													if(t_2==21){
														return "LANG_EXPERTMODE";
													}else{
														if(t_2==22){
															return "LANG_NORMALMODE";
														}else{
															if(t_2==23){
																return "LANG_ADDTAGS";
															}else{
																if(t_2==25){
																	return "LANG_ADDMORETAGS";
																}else{
																	if(t_2==26){
																		return "LANG_GOTONEXT";
																	}else{
																		if(t_2==30){
																			return "LANG_CONGRATULATION";
																		}else{
																			if(t_2==31){
																				return "LANG_CONGRATULATION1";
																			}else{
																				if(t_2==32){
																					return "LANG_CONGRATULATION2";
																				}else{
																					if(t_2==33){
																						return "LANG_AWARDED";
																					}else{
																						if(t_2==40){
																							return "LANG_UPLOADINFORMATION";
																						}else{
																							if(t_2==50){
																								return "LANG_TUTORIAL_1";
																							}else{
																								if(t_2==51){
																									return "LANG_TUTORIAL_2";
																								}else{
																									if(t_2==52){
																										return "LANG_TUTORIAL_3";
																									}else{
																										if(t_2==53){
																											return "LANG_TUTORIAL_4";
																										}else{
																											if(t_2==54){
																												return "LANG_TUTORIAL_5";
																											}else{
																												if(t_2==55){
																													return "LANG_TUTORIAL_6";
																												}else{
																													if(t_2==56){
																														return "LANG_TUTORIAL_7";
																													}else{
																														if(t_2==57){
																															return "LANG_TUTORIAL_8";
																														}else{
																															if(t_2==58){
																																return "LANG_TUTORIAL_9";
																															}else{
																																if(t_2==59){
																																	return "LANG_TUTORIAL_10";
																																}else{
																																	if(t_2==60){
																																		return "LANG_TUTORIAL_11";
																																	}else{
																																		if(t_2==61){
																																			return "LANG_TUTORIAL_12";
																																		}else{
																																			if(t_2==62){
																																				return "LANG_TUTORIAL_13";
																																			}else{
																																				if(t_2==63){
																																					return "LANG_TUTORIAL_14";
																																				}else{
																																					if(t_2==64){
																																						return "LANG_TUTORIAL_15";
																																					}else{
																																						if(t_2==65){
																																							return "LANG_TUTORIAL_16";
																																						}else{
																																							if(t_2==66){
																																								return "LANG_TUTORIAL_17";
																																							}else{
																																								if(t_2==67){
																																									return "LANG_TUTORIAL_18";
																																								}else{
																																									if(t_2==68){
																																										return "LANG_TUTORIAL_19";
																																									}else{
																																										if(t_2==69){
																																											return "LANG_TUTORIAL_20";
																																										}
																																									}
																																								}
																																							}
																																						}
																																					}
																																				}
																																			}
																																		}
																																	}
																																}
																															}
																														}
																													}
																												}
																											}
																										}
																									}
																								}
																							}
																						}
																					}
																				}
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	return "";
}
c_classGame_Language.prototype.p_GetRef=function(t__str){
	if(t__str=="LANG_YES"){
		return 1;
	}else{
		if(t__str=="LANG_NO"){
			return 2;
		}else{
			if(t__str=="LANG_NOTOANNOTATE"){
				return 5;
			}else{
				if(t__str=="LANG_GUEST"){
					return 6;
				}else{
					if(t__str=="LANG_DOWNLOADIMAGE"){
						return 7;
					}else{
						if(t__str=="LANG_TAGPICTURE"){
							return 8;
						}else{
							if(t__str=="LANG_TAGPICTURE_SUBTITLE"){
								return 9;
							}else{
								if(t__str=="LANG_VALIDATE_TITLE1"){
									return 10;
								}else{
									if(t__str=="LANG_VALIDATE_TITLE2"){
										return 11;
									}else{
										if(t__str=="LANG_ADDTAGS_TITLE"){
											return 15;
										}else{
											if(t__str=="LANG_ADDTAGS_NEAROBJECTS"){
												return 16;
											}else{
												if(t__str=="LANG_CONTINUE"){
													return 20;
												}else{
													if(t__str=="LANG_EXPERTMODE"){
														return 21;
													}else{
														if(t__str=="LANG_NORMALMODE"){
															return 22;
														}else{
															if(t__str=="LANG_ADDTAGS"){
																return 23;
															}else{
																if(t__str=="LANG_ADDMORETAGS"){
																	return 25;
																}else{
																	if(t__str=="LANG_GOTONEXT"){
																		return 26;
																	}else{
																		if(t__str=="LANG_CONGRATULATION"){
																			return 30;
																		}else{
																			if(t__str=="LANG_CONGRATULATION1"){
																				return 31;
																			}else{
																				if(t__str=="LANG_CONGRATULATION2"){
																					return 32;
																				}else{
																					if(t__str=="LANG_AWARDED"){
																						return 33;
																					}else{
																						if(t__str=="LANG_UPLOADINFORMATION"){
																							return 40;
																						}else{
																							if(t__str=="LANG_TUTORIAL_1"){
																								return 50;
																							}else{
																								if(t__str=="LANG_TUTORIAL_2"){
																									return 51;
																								}else{
																									if(t__str=="LANG_TUTORIAL_3"){
																										return 52;
																									}else{
																										if(t__str=="LANG_TUTORIAL_4"){
																											return 53;
																										}else{
																											if(t__str=="LANG_TUTORIAL_5"){
																												return 54;
																											}else{
																												if(t__str=="LANG_TUTORIAL_6"){
																													return 55;
																												}else{
																													if(t__str=="LANG_TUTORIAL_7"){
																														return 56;
																													}else{
																														if(t__str=="LANG_TUTORIAL_8"){
																															return 57;
																														}else{
																															if(t__str=="LANG_TUTORIAL_9"){
																																return 58;
																															}else{
																																if(t__str=="LANG_TUTORIAL_10"){
																																	return 59;
																																}else{
																																	if(t__str=="LANG_TUTORIAL_11"){
																																		return 60;
																																	}else{
																																		if(t__str=="LANG_TUTORIAL_12"){
																																			return 61;
																																		}else{
																																			if(t__str=="LANG_TUTORIAL_13"){
																																				return 62;
																																			}else{
																																				if(t__str=="LANG_TUTORIAL_14"){
																																					return 63;
																																				}else{
																																					if(t__str=="LANG_TUTORIAL_15"){
																																						return 64;
																																					}else{
																																						if(t__str=="LANG_TUTORIAL_16"){
																																							return 65;
																																						}else{
																																							if(t__str=="LANG_TUTORIAL_17"){
																																								return 66;
																																							}else{
																																								if(t__str=="LANG_TUTORIAL_18"){
																																									return 67;
																																								}else{
																																									if(t__str=="LANG_TUTORIAL_19"){
																																										return 68;
																																									}else{
																																										if(t__str=="LANG_TUTORIAL_20"){
																																											return 69;
																																										}
																																									}
																																								}
																																							}
																																						}
																																					}
																																				}
																																			}
																																		}
																																	}
																																}
																															}
																														}
																													}
																												}
																											}
																										}
																									}
																								}
																							}
																						}
																					}
																				}
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	print("LANGUAGE ERROR "+t__str);
	return 0;
}
c_classGame_Language.prototype.p_Load=function(t__file){
	var t_lines=bb_app_LoadString(t__file).split("|");
	var t_line=[];
	var t_reference=0;
	var t_testo="";
	var t_=t_lines;
	var t_2=0;
	while(t_2<t_.length){
		var t_str=t_[t_2];
		t_2=t_2+1;
		t_str=string_trim(t_str);
		if(t_str.length>5){
			t_line=t_str.split(":");
			t_reference=this.p_GetRef(t_line[0]);
			if(t_line.length>1){
				if(t_reference>-1){
					this.m_listLanguage[t_reference]=c_classGame_LanguageItem.m_new2.call(new c_classGame_LanguageItem,t_reference,t_line[1]);
				}
			}
		}
	}
	return 0;
}
c_classGame_Language.prototype.p_Init4=function(t__language_id){
	this.m_indexLanguage=t__language_id;
	var t_filename="lang/";
	var t_1=t__language_id;
	if(t_1==0){
		t_filename=t_filename+"en/";
	}else{
		if(t_1==1){
			t_filename=t_filename+"gr/";
		}else{
			if(t_1==2){
				t_filename=t_filename+"ro/";
			}else{
				if(t_1==3){
					t_filename=t_filename+"it/";
				}
			}
		}
	}
	t_filename=t_filename+"language.txt";
	for(var t_t=0;t_t<100;t_t=t_t+1){
		this.m_listLanguage[t_t]=c_classGame_LanguageItem.m_new2.call(new c_classGame_LanguageItem,t_t,this.p_GetString(t_t));
	}
	this.p_Load(t_filename);
	return 0;
}
c_classGame_Language.prototype.p_GetItem=function(t__item){
	if(this.m_listLanguage[t__item]==null){
		return "";
	}
	return this.m_listLanguage[t__item].m_title;
}
var bb_game_cLANGUAGE=null;
function c_classGame_TaxonomyLang(){
	Object.call(this);
	this.m_listLanguage=null;
	this.m_indexLanguage=0;
}
c_classGame_TaxonomyLang.m_new=function(){
	this.m_listLanguage=c_List2.m_new.call(new c_List2);
	return this;
}
c_classGame_TaxonomyLang.prototype.p_Load=function(t__file){
	var t_lines=bb_app_LoadString(t__file).split("|");
	var t_line=[];
	var t_testo="";
	var t_=t_lines;
	var t_2=0;
	while(t_2<t_.length){
		var t_str=t_[t_2];
		t_2=t_2+1;
		t_str=string_trim(t_str);
		if(t_str.length>5){
			t_line=t_str.split("=");
			if(t_line.length>1){
				this.m_listLanguage.p_AddLast2(c_classGame_TaxonomyLangItem.m_new2.call(new c_classGame_TaxonomyLangItem,string_trim(t_line[0]),string_trim(t_line[1])));
			}
		}
	}
	return 0;
}
c_classGame_TaxonomyLang.prototype.p_Init4=function(t__language_id){
	this.m_indexLanguage=t__language_id;
	var t_filename="lang/";
	var t_1=t__language_id;
	if(t_1==0){
		t_filename=t_filename+"en/";
	}else{
		if(t_1==1){
			t_filename=t_filename+"gr/";
		}else{
			if(t_1==2){
				t_filename=t_filename+"ro/";
			}else{
				if(t_1==3){
					t_filename=t_filename+"it/";
				}
			}
		}
	}
	t_filename=t_filename+"taxonomy.txt";
	this.m_listLanguage.p_Clear();
	this.p_Load(t_filename);
	return 0;
}
c_classGame_TaxonomyLang.prototype.p_Exist=function(t__original){
	var t_search=string_trim(t__original);
	var t_=this.m_listLanguage.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_items=t_.p_NextObject();
		if(string_compare(t_items.m_original,t_search)==0){
			return true;
		}
	}
	return false;
}
c_classGame_TaxonomyLang.prototype.p_Exist2=function(t__item){
	if(t__item==null){
		return false;
	}
	var t_=this.m_listLanguage.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_items=t_.p_NextObject();
		if(t_items.m_original==t__item.m_name){
			return true;
		}
	}
	return false;
}
function c_classGame_TaxonomyLangItem(){
	Object.call(this);
	this.m_original="";
	this.m_item="";
}
c_classGame_TaxonomyLangItem.m_new=function(){
	this.m_original="";
	this.m_item="";
	return this;
}
c_classGame_TaxonomyLangItem.m_new2=function(t__original,t__str){
	this.m_original=string_trim(t__original);
	this.m_item=string_trim(t__str);
	return this;
}
function c_List2(){
	Object.call(this);
	this.m__head=(c_HeadNode2.m_new.call(new c_HeadNode2));
}
c_List2.m_new=function(){
	return this;
}
c_List2.prototype.p_AddLast2=function(t_data){
	return c_Node5.m_new.call(new c_Node5,this.m__head,this.m__head.m__pred,t_data);
}
c_List2.m_new2=function(t_data){
	var t_=t_data;
	var t_2=0;
	while(t_2<t_.length){
		var t_t=t_[t_2];
		t_2=t_2+1;
		this.p_AddLast2(t_t);
	}
	return this;
}
c_List2.prototype.p_Clear=function(){
	this.m__head.m__succ=this.m__head;
	this.m__head.m__pred=this.m__head;
	return 0;
}
c_List2.prototype.p_ObjectEnumerator=function(){
	return c_Enumerator5.m_new.call(new c_Enumerator5,this);
}
function c_Node5(){
	Object.call(this);
	this.m__succ=null;
	this.m__pred=null;
	this.m__data=null;
}
c_Node5.m_new=function(t_succ,t_pred,t_data){
	this.m__succ=t_succ;
	this.m__pred=t_pred;
	this.m__succ.m__pred=this;
	this.m__pred.m__succ=this;
	this.m__data=t_data;
	return this;
}
c_Node5.m_new2=function(){
	return this;
}
function c_HeadNode2(){
	c_Node5.call(this);
}
c_HeadNode2.prototype=extend_class(c_Node5);
c_HeadNode2.m_new=function(){
	c_Node5.m_new2.call(this);
	this.m__succ=(this);
	this.m__pred=(this);
	return this;
}
var bb_game_cTAXONOMYLANG=null;
function c_classGame_TaxonomyHelp(){
	Object.call(this);
	this.m_listLanguage=null;
	this.m_indexLanguage=0;
}
c_classGame_TaxonomyHelp.m_new=function(){
	this.m_listLanguage=c_List3.m_new.call(new c_List3);
	return this;
}
c_classGame_TaxonomyHelp.prototype.p_Load=function(t__file){
	var t_lines=bb_app_LoadString(t__file).split("|");
	var t_line=[];
	var t_testo="";
	var t_=t_lines;
	var t_2=0;
	while(t_2<t_.length){
		var t_str=t_[t_2];
		t_2=t_2+1;
		t_str=string_trim(t_str);
		if(t_str.length>5){
			t_line=t_str.split("=");
			if(t_line.length>1){
				this.m_listLanguage.p_AddLast3(c_classGame_TaxonomyHelpItem.m_new2.call(new c_classGame_TaxonomyHelpItem,string_trim(t_line[0]),string_trim(t_line[1])));
			}
		}
	}
	return 0;
}
c_classGame_TaxonomyHelp.prototype.p_Init4=function(t__language_id){
	this.m_indexLanguage=t__language_id;
	var t_filename="lang/";
	var t_1=t__language_id;
	if(t_1==0){
		t_filename=t_filename+"en/";
	}else{
		if(t_1==1){
			t_filename=t_filename+"gr/";
		}else{
			if(t_1==2){
				t_filename=t_filename+"ro/";
			}else{
				if(t_1==3){
					t_filename=t_filename+"it/";
				}
			}
		}
	}
	t_filename=t_filename+"help.txt";
	this.m_listLanguage.p_Clear();
	this.p_Load(t_filename);
	return 0;
}
c_classGame_TaxonomyHelp.prototype.p_GetItem2=function(t__id){
	print(t__id);
	var t_=this.m_listLanguage.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_items=t_.p_NextObject();
		print(t_items.m_id);
		if(t_items.m_id==t__id){
			return t_items.m_value;
		}
	}
	return "";
}
function c_classGame_TaxonomyHelpItem(){
	Object.call(this);
	this.m_id="";
	this.m_value="";
}
c_classGame_TaxonomyHelpItem.m_new=function(){
	this.m_id="";
	this.m_value="";
	return this;
}
c_classGame_TaxonomyHelpItem.m_new2=function(t__id,t__value){
	this.m_id=string_trim(t__id);
	this.m_value=string_trim(t__value);
	return this;
}
function c_List3(){
	Object.call(this);
	this.m__head=(c_HeadNode3.m_new.call(new c_HeadNode3));
}
c_List3.m_new=function(){
	return this;
}
c_List3.prototype.p_AddLast3=function(t_data){
	return c_Node6.m_new.call(new c_Node6,this.m__head,this.m__head.m__pred,t_data);
}
c_List3.m_new2=function(t_data){
	var t_=t_data;
	var t_2=0;
	while(t_2<t_.length){
		var t_t=t_[t_2];
		t_2=t_2+1;
		this.p_AddLast3(t_t);
	}
	return this;
}
c_List3.prototype.p_Clear=function(){
	this.m__head.m__succ=this.m__head;
	this.m__head.m__pred=this.m__head;
	return 0;
}
c_List3.prototype.p_ObjectEnumerator=function(){
	return c_Enumerator6.m_new.call(new c_Enumerator6,this);
}
function c_Node6(){
	Object.call(this);
	this.m__succ=null;
	this.m__pred=null;
	this.m__data=null;
}
c_Node6.m_new=function(t_succ,t_pred,t_data){
	this.m__succ=t_succ;
	this.m__pred=t_pred;
	this.m__succ.m__pred=this;
	this.m__pred.m__succ=this;
	this.m__data=t_data;
	return this;
}
c_Node6.m_new2=function(){
	return this;
}
function c_HeadNode3(){
	c_Node6.call(this);
}
c_HeadNode3.prototype=extend_class(c_Node6);
c_HeadNode3.m_new=function(){
	c_Node6.m_new2.call(this);
	this.m__succ=(this);
	this.m__pred=(this);
	return this;
}
var bb_game_cTAXONOMYHELP=null;
function c_classRender_Info(){
	Object.call(this);
	this.m_bEnabled=false;
	this.m_bAnimation=false;
	this.m_textbox=null;
	this.m_IMG_INFO=null;
	this.m_textHelp="";
	this.m_timerAnimation=0;
	this.implments={c_IOnLoadImageComplete:1};
}
c_classRender_Info.m_new=function(){
	return this;
}
c_classRender_Info.prototype.p_Init=function(){
	this.m_bEnabled=false;
	this.m_bAnimation=false;
	this.m_textbox=c_classSimpleTextBox.m_new.call(new c_classSimpleTextBox,bb_game_fontAngelTitle);
	return 0;
}
c_classRender_Info.prototype.p_LoadInfo=function(t__info){
	print(t__info.m_name);
	var t_file=bb_game_cMANAGEITEMS.p_GetInfoString(t__info,bb_items_structureTAG);
	this.m_IMG_INFO=null;
	if(t_file!=""){
		bb_asyncloaders_LoadImageAsync("examples/"+t_file+".jpg",1,c_Image.m_DefaultFlags,(this));
	}
	this.m_textHelp=bb_game_cTAXONOMYHELP.p_GetItem2("taxonomy_help_"+t_file);
	this.m_bEnabled=true;
	this.m_bAnimation=true;
	this.m_timerAnimation=bb_app_Millisecs();
	return 0;
}
c_classRender_Info.prototype.p_RenderInfo=function(t__mouse){
	var t_start_x=(((bb_collaborate_Collaborate.m_GameWidth)*1.25)|0);
	var t_w=(((bb_collaborate_Collaborate.m_GameWidth)*0.90)|0);
	var t_h=bb_collaborate_Collaborate.m_GameHeight;
	var t_x=(((bb_collaborate_Collaborate.m_GameWidth)*0.10)|0);
	var t_x2=0;
	var t_y=0;
	var t_space_x=48;
	var t_space_y=48;
	var t_space_line=40;
	var t_alpha=1.0;
	if(this.m_bAnimation==true){
		t_alpha=(bb_math_Abs(bb_app_Millisecs()-this.m_timerAnimation))/1000.0;
		if(t_alpha>1.0){
			t_alpha=1.0;
			this.m_bAnimation=false;
		}
		if(this.m_bEnabled==false){
			t_alpha=1.0-t_alpha;
		}
		t_x=(((t_x)*t_alpha+(t_start_x)*(1.0-t_alpha))|0);
	}
	bb_graphics_SetColor(220.0,220.0,220.0);
	bb_graphics_SetAlpha(0.9*t_alpha);
	bb_graphics_DrawRect((t_x),0.0,(t_w),(bb_collaborate_Collaborate.m_GameHeight));
	bb_graphics_SetAlpha(1.0*t_alpha);
	bb_graphics_SetColor(255.0,255.0,255.0);
	if(this.m_IMG_INFO!=null){
		bb_graphics_DrawImage(this.m_IMG_INFO,(t_x+64),(((t_h-this.m_IMG_INFO.p_Height())/2)|0),0);
	}
	bb_graphics_SetColor(0.0,0.0,0.0);
	this.m_textbox.p_Draw(this.m_textHelp,t_x+64+512+32,96,420,0);
	bb_graphics_SetColor(255.0,255.0,255.0);
	t_x=t_x-((t_w/2)|0);
	t_y=t_y-((t_h/2)|0)+((t_space_y/2)|0);
	bb_graphics_SetAlpha(1.0);
	return 0;
}
c_classRender_Info.prototype.p_Render2=function(t__mouse){
	var t_x=bb_collaborate_Collaborate.m_GameWidth-48;
	var t_y=48;
	var t_size=0.75;
	if(this.m_bEnabled==true || this.m_bAnimation==true){
		this.p_RenderInfo(t__mouse);
	}
	if(this.m_bEnabled==true){
		t_size=1.0;
		bb_game_MouseOver();
		if(bb_game_inputHit==1){
			this.m_bEnabled=false;
			this.m_bAnimation=true;
			this.m_timerAnimation=bb_app_Millisecs();
			bb_checkkeys_DelayKeys(0);
		}
	}
	return 0;
}
c_classRender_Info.prototype.p_OnLoadImageComplete=function(t_image,t_path,t_source){
	if(t_image==null){
		return;
	}
	this.m_IMG_INFO=t_image;
}
var bb_game_cRENDER_INFO=null;
function c_classSimpleTextBox(){
	Object.call(this);
	this.m_font=null;
	this.m_align=0;
	this.m_yOffset=0;
	this.m_lineGap=5;
}
c_classSimpleTextBox.m_new=function(t__font){
	this.m_font=t__font;
	return this;
}
c_classSimpleTextBox.m_new2=function(){
	return this;
}
c_classSimpleTextBox.prototype.p_DrawTextLine=function(t_txt,t_x,t_y){
	this.m_font.p_DrawText2(t_txt,t_x,t_y,this.m_align);
	this.m_yOffset+=this.m_lineGap+this.m_font.m_height;
}
c_classSimpleTextBox.prototype.p_Draw=function(t_text,t_x,t_y,t_width,t_alignment){
	var t_thisLine="";
	var t_charOffset=0;
	var t_wordLen=0;
	var t_word="";
	this.m_align=t_alignment;
	this.m_yOffset=0;
	for(var t_i=0;t_i<t_text.length;t_i=t_i+1){
		if((t_y+this.m_yOffset)*bb_graphics_GetMatrix()[3]>(bb_app_DeviceHeight())){
			return;
		}
		var t_asc=t_text.charCodeAt(t_i);
		var t_1=t_asc;
		if(t_1==32){
			t_wordLen=this.m_font.p_TextWidth(t_word);
			if(t_charOffset+t_wordLen>t_width){
				this.p_DrawTextLine(t_thisLine,t_x,t_y+this.m_yOffset);
				t_thisLine="";
				t_charOffset=0;
			}
			t_charOffset+=t_wordLen+this.m_font.p_GetChars()[32].m_xAdvance;
			t_thisLine=t_thisLine+(t_word+" ");
			t_word="";
		}else{
			if(t_1==10){
				t_wordLen=this.m_font.p_TextWidth(t_word);
				if(t_charOffset+t_wordLen>t_width){
					this.p_DrawTextLine(t_thisLine,t_x,t_y+this.m_yOffset);
					t_thisLine="";
				}
				t_thisLine=t_thisLine+t_word;
				this.p_DrawTextLine(t_thisLine,t_x,t_y+this.m_yOffset);
				t_thisLine="";
				t_charOffset=0;
				t_word="";
			}else{
				t_word=t_word+String.fromCharCode(t_asc);
			}
		}
	}
	if(t_word!=""){
		t_wordLen=this.m_font.p_TextWidth(t_word);
		if(t_charOffset+t_wordLen>t_width){
			this.p_DrawTextLine(t_thisLine,t_x,t_y+this.m_yOffset);
			t_thisLine="";
		}
		t_thisLine=t_thisLine+t_word;
	}
	if(t_thisLine!=""){
		this.p_DrawTextLine(t_thisLine,t_x,t_y+this.m_yOffset);
	}
}
c_classSimpleTextBox.prototype.p_SetFont=function(t__font){
	this.m_font=t__font;
}
function c_AngelFont(){
	Object.call(this);
	this.m_iniText="";
	this.m_image=new_object_array(1);
	this.m_chars=new_object_array(2048);
	this.m_height=0;
	this.m_heightOffset=9999;
	this.m_kernPairs=c_IntMap4.m_new.call(new c_IntMap4);
	this.m_name="";
	this.m_useKerning=true;
	this.m_xOffset=0;
}
c_AngelFont.m_current=null;
c_AngelFont.m_firstKp=null;
c_AngelFont.prototype.p_LoadPlain=function(t_url){
	c_AngelFont.m_current=this;
	this.m_iniText=bb_app_LoadString(t_url+".fnt");
	var t_lines=this.m_iniText.split(String.fromCharCode(10));
	var t_attribs=[];
	var t_pageCount=0;
	var t_AttemptFallbackImageLoading=false;
	var t_=t_lines;
	var t_2=0;
	while(t_2<t_.length){
		var t_line=t_[t_2];
		t_2=t_2+1;
		t_line=string_trim(t_line);
		if(string_startswith(t_line,"info")){
			continue;
		}else{
			if(string_startswith(t_line,"common")){
				t_attribs=t_line.split(" ");
				for(var t_i=0;t_i<t_attribs.length;t_i=t_i+1){
					if(t_attribs[t_i]==""){
						continue;
					}else{
						if(string_startswith(t_attribs[t_i],"pages=")){
							t_pageCount=parseInt((t_attribs[t_i].slice(t_attribs[t_i].lastIndexOf("=")+1)),10);
							this.m_image=resize_object_array(this.m_image,t_pageCount);
						}
					}
				}
			}else{
				if(string_startswith(t_line,"page")){
					var t_imgUrl="";
					var t_imgPage=-1;
					t_attribs=t_line.split(" ");
					for(var t_i2=0;t_i2<t_attribs.length;t_i2=t_i2+1){
						if(t_attribs[t_i2]==""){
							continue;
						}else{
							if(string_startswith(t_attribs[t_i2],"id=")){
								t_imgPage=parseInt((t_attribs[t_i2].slice(t_attribs[t_i2].lastIndexOf("=")+1)),10);
							}else{
								if(string_startswith(t_attribs[t_i2],"file=")){
									t_imgUrl=t_attribs[t_i2].slice(t_attribs[t_i2].indexOf("\"",0)+1,t_attribs[t_i2].lastIndexOf("\""));
								}
							}
						}
					}
					if(t_imgUrl!="" && t_imgPage>=0){
						this.m_image[t_imgPage]=bb_graphics_LoadImage(t_imgUrl,1,c_Image.m_DefaultFlags);
					}else{
						t_AttemptFallbackImageLoading=true;
					}
				}else{
					if(string_startswith(t_line,"chars")){
						continue;
					}else{
						if(string_startswith(t_line,"char ")){
							var t_id=0;
							var t_x=0;
							var t_y=0;
							var t_w=0;
							var t_h=0;
							var t_xOffset=0;
							var t_yOffset=0;
							var t_xAdvance=0;
							var t_page=0;
							t_attribs=t_line.split(" ");
							for(var t_i3=0;t_i3<t_attribs.length;t_i3=t_i3+1){
								string_trim(t_attribs[t_i3]);
								if(t_attribs[t_i3]==""){
									continue;
								}else{
									if(string_startswith(t_attribs[t_i3],"id=")){
										t_id=parseInt((t_attribs[t_i3].slice(t_attribs[t_i3].lastIndexOf("=")+1)),10);
									}else{
										if(string_startswith(t_attribs[t_i3],"x=")){
											t_x=parseInt((t_attribs[t_i3].slice(t_attribs[t_i3].lastIndexOf("=")+1)),10);
										}else{
											if(string_startswith(t_attribs[t_i3],"y=")){
												t_y=parseInt((t_attribs[t_i3].slice(t_attribs[t_i3].lastIndexOf("=")+1)),10);
											}else{
												if(string_startswith(t_attribs[t_i3],"width=")){
													t_w=parseInt((t_attribs[t_i3].slice(t_attribs[t_i3].lastIndexOf("=")+1)),10);
												}else{
													if(string_startswith(t_attribs[t_i3],"height=")){
														t_h=parseInt((t_attribs[t_i3].slice(t_attribs[t_i3].lastIndexOf("=")+1)),10);
													}else{
														if(string_startswith(t_attribs[t_i3],"xoffset=")){
															t_xOffset=parseInt((t_attribs[t_i3].slice(t_attribs[t_i3].lastIndexOf("=")+1)),10);
														}else{
															if(string_startswith(t_attribs[t_i3],"yoffset=")){
																t_yOffset=parseInt((t_attribs[t_i3].slice(t_attribs[t_i3].lastIndexOf("=")+1)),10);
															}else{
																if(string_startswith(t_attribs[t_i3],"xadvance=")){
																	t_xAdvance=parseInt((t_attribs[t_i3].slice(t_attribs[t_i3].lastIndexOf("=")+1)),10);
																}else{
																	if(string_startswith(t_attribs[t_i3],"page=")){
																		t_page=parseInt((t_attribs[t_i3].slice(t_attribs[t_i3].lastIndexOf("=")+1)),10);
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
							this.m_chars[t_id]=c_Char.m_new.call(new c_Char,t_x,t_y,t_w,t_h,t_xOffset,t_yOffset,t_xAdvance,t_page);
							var t_ch=this.m_chars[t_id];
							if(t_ch.m_height>this.m_height){
								this.m_height=t_ch.m_height;
							}
							if(t_ch.m_yOffset<this.m_heightOffset){
								this.m_heightOffset=t_ch.m_yOffset;
							}
						}else{
							if(string_startswith(t_line,"kernings")){
								continue;
							}else{
								if(string_startswith(t_line,"kerning ")){
									var t_first=0;
									var t_second=0;
									var t_amount=0;
									t_attribs=t_line.split(" ");
									for(var t_i4=0;t_i4<t_attribs.length;t_i4=t_i4+1){
										string_trim(t_attribs[t_i4]);
										if(t_attribs[t_i4]==""){
											continue;
										}else{
											if(string_startswith(t_attribs[t_i4],"first=")){
												t_first=parseInt((t_attribs[t_i4].slice(t_attribs[t_i4].lastIndexOf("=")+1)),10);
											}else{
												if(string_startswith(t_attribs[t_i4],"second=")){
													t_second=parseInt((t_attribs[t_i4].slice(t_attribs[t_i4].lastIndexOf("=")+1)),10);
												}else{
													if(string_startswith(t_attribs[t_i4],"amount=")){
														t_amount=parseInt((t_attribs[t_i4].slice(t_attribs[t_i4].lastIndexOf("=")+1)),10);
													}
												}
											}
										}
									}
									c_AngelFont.m_firstKp=this.m_kernPairs.p_Get6(t_first);
									if(c_AngelFont.m_firstKp==null){
										this.m_kernPairs.p_Add3(t_first,c_IntMap3.m_new.call(new c_IntMap3));
										c_AngelFont.m_firstKp=this.m_kernPairs.p_Get6(t_first);
									}
									c_AngelFont.m_firstKp.p_Add2(t_second,c_KernPair.m_new.call(new c_KernPair,t_first,t_second,t_amount));
								}
							}
						}
					}
				}
			}
		}
	}
	if(t_AttemptFallbackImageLoading){
		for(var t_page2=0;t_page2<t_pageCount;t_page2=t_page2+1){
			if(this.m_image.length<t_page2+1){
				this.m_image=resize_object_array(this.m_image,t_page2+1);
			}
			this.m_image[t_page2]=bb_graphics_LoadImage(t_url+"_"+String(t_page2)+".png",1,c_Image.m_DefaultFlags);
		}
	}
}
c_AngelFont.m__list=null;
c_AngelFont.m_new=function(t_url){
	if(t_url!=""){
		this.p_LoadPlain(t_url);
		this.m_name=t_url;
		c_AngelFont.m__list.p_Insert2(t_url,this);
	}
	return this;
}
c_AngelFont.prototype.p_TextWidth=function(t_txt){
	var t_prevChar=0;
	var t_width=0;
	for(var t_i=0;t_i<t_txt.length;t_i=t_i+1){
		var t_asc=t_txt.charCodeAt(t_i);
		var t_ac=this.m_chars[t_asc];
		var t_thisChar=t_asc;
		if(t_ac!=null){
			if(this.m_useKerning){
				var t_firstKp=this.m_kernPairs.p_Get6(t_prevChar);
				if(t_firstKp!=null){
					var t_secondKp=t_firstKp.p_Get6(t_thisChar);
					if(t_secondKp!=null){
						this.m_xOffset+=t_secondKp.m_amount;
					}
				}
			}
			t_width+=t_ac.m_xAdvance;
			t_prevChar=t_thisChar;
		}
	}
	return t_width;
}
c_AngelFont.prototype.p_TextHeight=function(t_txt){
	var t_h=0;
	for(var t_i=0;t_i<t_txt.length;t_i=t_i+1){
		var t_asc=t_txt.charCodeAt(t_i);
		var t_ac=this.m_chars[t_asc];
		if(t_asc!=32){
			if(t_ac.m_height+t_ac.m_yOffset>t_h){
				t_h=t_ac.m_height+t_ac.m_yOffset;
			}
		}
	}
	return t_h-this.m_chars[60].m_yOffset;
}
c_AngelFont.prototype.p_TextHeightOffset=function(t_txt){
	return this.m_chars[60].m_yOffset;
}
c_AngelFont.m_secondKp=null;
c_AngelFont.prototype.p_DrawText=function(t_txt,t_x,t_y){
	var t_prevChar=0;
	this.m_xOffset=0;
	for(var t_i=0;t_i<t_txt.length;t_i=t_i+1){
		var t_asc=t_txt.charCodeAt(t_i);
		var t_ac=this.m_chars[t_asc];
		var t_thisChar=t_asc;
		if(t_ac!=null){
			if(this.m_useKerning){
				c_AngelFont.m_firstKp=this.m_kernPairs.p_Get6(t_prevChar);
				if(c_AngelFont.m_firstKp!=null){
					c_AngelFont.m_secondKp=c_AngelFont.m_firstKp.p_Get6(t_thisChar);
					if(c_AngelFont.m_secondKp!=null){
						this.m_xOffset+=c_AngelFont.m_secondKp.m_amount;
					}
				}
			}
			t_ac.p_Draw2(this.m_image[t_ac.m_page],t_x+this.m_xOffset,t_y);
			this.m_xOffset+=t_ac.m_xAdvance;
			t_prevChar=t_thisChar;
		}
	}
}
c_AngelFont.prototype.p_DrawText2=function(t_txt,t_x,t_y,t_align){
	this.m_xOffset=0;
	var t_1=t_align;
	if(t_1==1){
		this.p_DrawText(t_txt,t_x-((this.p_TextWidth(t_txt)/2)|0),t_y);
	}else{
		if(t_1==2){
			this.p_DrawText(t_txt,t_x-this.p_TextWidth(t_txt),t_y);
		}else{
			if(t_1==0){
				this.p_DrawText(t_txt,t_x,t_y);
			}
		}
	}
}
c_AngelFont.prototype.p_GetChars=function(){
	return this.m_chars;
}
c_AngelFont.prototype.p_LoadFontXml=function(t_url){
	c_AngelFont.m_current=this;
	this.m_iniText=bb_app_LoadString(t_url+".fnt");
	var t_error=c_XMLError.m_new.call(new c_XMLError);
	var t_pageCount=0;
	var t_config=bb_xml2_ParseXML(this.m_iniText,null,1);
	if(t_config==null && t_error.m_error){
		print(t_error.p_ToString());
	}else{
		var t_nodes=t_config.p_GetChildrenAtPath("chars/char");
		var t_=t_nodes.p_ObjectEnumerator();
		while(t_.p_HasNext()){
			var t_node=t_.p_NextObject();
			var t_id=parseInt((t_node.p_GetAttribute2("id")),10);
			var t_page=parseInt((t_node.p_GetAttribute2("page")),10);
			if(t_pageCount<t_page){
				t_pageCount=t_page;
			}
			this.m_chars[t_id]=c_Char.m_new.call(new c_Char,parseInt((t_node.p_GetAttribute2("x")),10),parseInt((t_node.p_GetAttribute2("y")),10),parseInt((t_node.p_GetAttribute2("width")),10),parseInt((t_node.p_GetAttribute2("height")),10),parseInt((t_node.p_GetAttribute2("xoffset")),10),parseInt((t_node.p_GetAttribute2("yoffset")),10),parseInt((t_node.p_GetAttribute2("xadvance")),10),t_page);
			var t_ch=this.m_chars[t_id];
			if(t_ch.m_height>this.m_height){
				this.m_height=t_ch.m_height;
			}
			if(t_ch.m_yOffset<this.m_heightOffset){
				this.m_heightOffset=t_ch.m_yOffset;
			}
		}
		t_nodes=t_config.p_GetChildrenAtPath("kernings/kerning");
		var t_2=t_nodes.p_ObjectEnumerator();
		while(t_2.p_HasNext()){
			var t_node2=t_2.p_NextObject();
			var t_first=parseInt((t_node2.p_GetAttribute2("first")),10);
			c_AngelFont.m_firstKp=this.m_kernPairs.p_Get6(t_first);
			if(c_AngelFont.m_firstKp==null){
				this.m_kernPairs.p_Add3(t_first,c_IntMap3.m_new.call(new c_IntMap3));
				c_AngelFont.m_firstKp=this.m_kernPairs.p_Get6(t_first);
			}
			var t_second=parseInt((t_node2.p_GetAttribute2("second")),10);
			c_AngelFont.m_firstKp.p_Add2(t_second,c_KernPair.m_new.call(new c_KernPair,t_first,t_second,parseInt((t_node2.p_GetAttribute2("amount")),10)));
		}
		if(t_pageCount==0){
			this.m_image[0]=bb_graphics_LoadImage(t_url+".png",1,c_Image.m_DefaultFlags);
			if(this.m_image[0]==null){
				this.m_image[0]=bb_graphics_LoadImage(t_url+"_0.png",1,c_Image.m_DefaultFlags);
			}
		}else{
			for(var t_page2=0;t_page2<=t_pageCount;t_page2=t_page2+1){
				if(this.m_image.length<t_page2+1){
					this.m_image=resize_object_array(this.m_image,t_page2+1);
				}
				this.m_image[t_page2]=bb_graphics_LoadImage(t_url+"_"+String(t_page2)+".png",1,c_Image.m_DefaultFlags);
			}
		}
	}
}
function c_Char(){
	Object.call(this);
	this.m_x=0;
	this.m_y=0;
	this.m_width=0;
	this.m_height=0;
	this.m_xOffset=0;
	this.m_yOffset=0;
	this.m_xAdvance=0;
	this.m_page=0;
}
c_Char.m_new=function(t_x,t_y,t_w,t_h,t_xoff,t_yoff,t_xadv,t_page){
	this.m_x=t_x;
	this.m_y=t_y;
	this.m_width=t_w;
	this.m_height=t_h;
	this.m_xOffset=t_xoff;
	this.m_yOffset=t_yoff;
	this.m_xAdvance=t_xadv;
	this.m_page=t_page;
	return this;
}
c_Char.m_new2=function(){
	return this;
}
c_Char.prototype.p_Draw2=function(t_fontImage,t_linex,t_liney){
	bb_graphics_DrawImageRect(t_fontImage,(t_linex+this.m_xOffset),(t_liney+this.m_yOffset),this.m_x,this.m_y,this.m_width,this.m_height,0);
	return 0;
}
function c_KernPair(){
	Object.call(this);
	this.m_first="";
	this.m_second="";
	this.m_amount=0;
}
c_KernPair.m_new=function(t_first,t_second,t_amount){
	this.m_first=String(t_first);
	this.m_second=String(t_second);
	this.m_amount=t_amount;
	return this;
}
c_KernPair.m_new2=function(){
	return this;
}
function c_Map4(){
	Object.call(this);
	this.m_root=null;
}
c_Map4.m_new=function(){
	return this;
}
c_Map4.prototype.p_Compare5=function(t_lhs,t_rhs){
}
c_Map4.prototype.p_RotateLeft4=function(t_node){
	var t_child=t_node.m_right;
	t_node.m_right=t_child.m_left;
	if((t_child.m_left)!=null){
		t_child.m_left.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_left){
			t_node.m_parent.m_left=t_child;
		}else{
			t_node.m_parent.m_right=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_left=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map4.prototype.p_RotateRight4=function(t_node){
	var t_child=t_node.m_left;
	t_node.m_left=t_child.m_right;
	if((t_child.m_right)!=null){
		t_child.m_right.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_right){
			t_node.m_parent.m_right=t_child;
		}else{
			t_node.m_parent.m_left=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_right=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map4.prototype.p_InsertFixup4=function(t_node){
	while(((t_node.m_parent)!=null) && t_node.m_parent.m_color==-1 && ((t_node.m_parent.m_parent)!=null)){
		if(t_node.m_parent==t_node.m_parent.m_parent.m_left){
			var t_uncle=t_node.m_parent.m_parent.m_right;
			if(((t_uncle)!=null) && t_uncle.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle.m_color=1;
				t_uncle.m_parent.m_color=-1;
				t_node=t_uncle.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_right){
					t_node=t_node.m_parent;
					this.p_RotateLeft4(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateRight4(t_node.m_parent.m_parent);
			}
		}else{
			var t_uncle2=t_node.m_parent.m_parent.m_left;
			if(((t_uncle2)!=null) && t_uncle2.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle2.m_color=1;
				t_uncle2.m_parent.m_color=-1;
				t_node=t_uncle2.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_left){
					t_node=t_node.m_parent;
					this.p_RotateRight4(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateLeft4(t_node.m_parent.m_parent);
			}
		}
	}
	this.m_root.m_color=1;
	return 0;
}
c_Map4.prototype.p_Add2=function(t_key,t_value){
	var t_node=this.m_root;
	var t_parent=null;
	var t_cmp=0;
	while((t_node)!=null){
		t_parent=t_node;
		t_cmp=this.p_Compare5(t_key,t_node.m_key);
		if(t_cmp>0){
			t_node=t_node.m_right;
		}else{
			if(t_cmp<0){
				t_node=t_node.m_left;
			}else{
				return false;
			}
		}
	}
	t_node=c_Node8.m_new.call(new c_Node8,t_key,t_value,-1,t_parent);
	if((t_parent)!=null){
		if(t_cmp>0){
			t_parent.m_right=t_node;
		}else{
			t_parent.m_left=t_node;
		}
		this.p_InsertFixup4(t_node);
	}else{
		this.m_root=t_node;
	}
	return true;
}
c_Map4.prototype.p_FindNode2=function(t_key){
	var t_node=this.m_root;
	while((t_node)!=null){
		var t_cmp=this.p_Compare5(t_key,t_node.m_key);
		if(t_cmp>0){
			t_node=t_node.m_right;
		}else{
			if(t_cmp<0){
				t_node=t_node.m_left;
			}else{
				return t_node;
			}
		}
	}
	return t_node;
}
c_Map4.prototype.p_Get6=function(t_key){
	var t_node=this.p_FindNode2(t_key);
	if((t_node)!=null){
		return t_node.m_value;
	}
	return null;
}
function c_IntMap3(){
	c_Map4.call(this);
}
c_IntMap3.prototype=extend_class(c_Map4);
c_IntMap3.m_new=function(){
	c_Map4.m_new.call(this);
	return this;
}
c_IntMap3.prototype.p_Compare5=function(t_lhs,t_rhs){
	return t_lhs-t_rhs;
}
function c_Map5(){
	Object.call(this);
	this.m_root=null;
}
c_Map5.m_new=function(){
	return this;
}
c_Map5.prototype.p_Compare5=function(t_lhs,t_rhs){
}
c_Map5.prototype.p_FindNode2=function(t_key){
	var t_node=this.m_root;
	while((t_node)!=null){
		var t_cmp=this.p_Compare5(t_key,t_node.m_key);
		if(t_cmp>0){
			t_node=t_node.m_right;
		}else{
			if(t_cmp<0){
				t_node=t_node.m_left;
			}else{
				return t_node;
			}
		}
	}
	return t_node;
}
c_Map5.prototype.p_Get6=function(t_key){
	var t_node=this.p_FindNode2(t_key);
	if((t_node)!=null){
		return t_node.m_value;
	}
	return null;
}
c_Map5.prototype.p_RotateLeft5=function(t_node){
	var t_child=t_node.m_right;
	t_node.m_right=t_child.m_left;
	if((t_child.m_left)!=null){
		t_child.m_left.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_left){
			t_node.m_parent.m_left=t_child;
		}else{
			t_node.m_parent.m_right=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_left=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map5.prototype.p_RotateRight5=function(t_node){
	var t_child=t_node.m_left;
	t_node.m_left=t_child.m_right;
	if((t_child.m_right)!=null){
		t_child.m_right.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_right){
			t_node.m_parent.m_right=t_child;
		}else{
			t_node.m_parent.m_left=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_right=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map5.prototype.p_InsertFixup5=function(t_node){
	while(((t_node.m_parent)!=null) && t_node.m_parent.m_color==-1 && ((t_node.m_parent.m_parent)!=null)){
		if(t_node.m_parent==t_node.m_parent.m_parent.m_left){
			var t_uncle=t_node.m_parent.m_parent.m_right;
			if(((t_uncle)!=null) && t_uncle.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle.m_color=1;
				t_uncle.m_parent.m_color=-1;
				t_node=t_uncle.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_right){
					t_node=t_node.m_parent;
					this.p_RotateLeft5(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateRight5(t_node.m_parent.m_parent);
			}
		}else{
			var t_uncle2=t_node.m_parent.m_parent.m_left;
			if(((t_uncle2)!=null) && t_uncle2.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle2.m_color=1;
				t_uncle2.m_parent.m_color=-1;
				t_node=t_uncle2.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_left){
					t_node=t_node.m_parent;
					this.p_RotateRight5(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateLeft5(t_node.m_parent.m_parent);
			}
		}
	}
	this.m_root.m_color=1;
	return 0;
}
c_Map5.prototype.p_Add3=function(t_key,t_value){
	var t_node=this.m_root;
	var t_parent=null;
	var t_cmp=0;
	while((t_node)!=null){
		t_parent=t_node;
		t_cmp=this.p_Compare5(t_key,t_node.m_key);
		if(t_cmp>0){
			t_node=t_node.m_right;
		}else{
			if(t_cmp<0){
				t_node=t_node.m_left;
			}else{
				return false;
			}
		}
	}
	t_node=c_Node7.m_new.call(new c_Node7,t_key,t_value,-1,t_parent);
	if((t_parent)!=null){
		if(t_cmp>0){
			t_parent.m_right=t_node;
		}else{
			t_parent.m_left=t_node;
		}
		this.p_InsertFixup5(t_node);
	}else{
		this.m_root=t_node;
	}
	return true;
}
function c_IntMap4(){
	c_Map5.call(this);
}
c_IntMap4.prototype=extend_class(c_Map5);
c_IntMap4.m_new=function(){
	c_Map5.m_new.call(this);
	return this;
}
c_IntMap4.prototype.p_Compare5=function(t_lhs,t_rhs){
	return t_lhs-t_rhs;
}
function c_Node7(){
	Object.call(this);
	this.m_key=0;
	this.m_right=null;
	this.m_left=null;
	this.m_value=null;
	this.m_color=0;
	this.m_parent=null;
}
c_Node7.m_new=function(t_key,t_value,t_color,t_parent){
	this.m_key=t_key;
	this.m_value=t_value;
	this.m_color=t_color;
	this.m_parent=t_parent;
	return this;
}
c_Node7.m_new2=function(){
	return this;
}
function c_Node8(){
	Object.call(this);
	this.m_key=0;
	this.m_right=null;
	this.m_left=null;
	this.m_value=null;
	this.m_color=0;
	this.m_parent=null;
}
c_Node8.m_new=function(t_key,t_value,t_color,t_parent){
	this.m_key=t_key;
	this.m_value=t_value;
	this.m_color=t_color;
	this.m_parent=t_parent;
	return this;
}
c_Node8.m_new2=function(){
	return this;
}
function c_Map6(){
	Object.call(this);
	this.m_root=null;
}
c_Map6.m_new=function(){
	return this;
}
c_Map6.prototype.p_Compare4=function(t_lhs,t_rhs){
}
c_Map6.prototype.p_RotateLeft6=function(t_node){
	var t_child=t_node.m_right;
	t_node.m_right=t_child.m_left;
	if((t_child.m_left)!=null){
		t_child.m_left.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_left){
			t_node.m_parent.m_left=t_child;
		}else{
			t_node.m_parent.m_right=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_left=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map6.prototype.p_RotateRight6=function(t_node){
	var t_child=t_node.m_left;
	t_node.m_left=t_child.m_right;
	if((t_child.m_right)!=null){
		t_child.m_right.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_right){
			t_node.m_parent.m_right=t_child;
		}else{
			t_node.m_parent.m_left=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_right=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map6.prototype.p_InsertFixup6=function(t_node){
	while(((t_node.m_parent)!=null) && t_node.m_parent.m_color==-1 && ((t_node.m_parent.m_parent)!=null)){
		if(t_node.m_parent==t_node.m_parent.m_parent.m_left){
			var t_uncle=t_node.m_parent.m_parent.m_right;
			if(((t_uncle)!=null) && t_uncle.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle.m_color=1;
				t_uncle.m_parent.m_color=-1;
				t_node=t_uncle.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_right){
					t_node=t_node.m_parent;
					this.p_RotateLeft6(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateRight6(t_node.m_parent.m_parent);
			}
		}else{
			var t_uncle2=t_node.m_parent.m_parent.m_left;
			if(((t_uncle2)!=null) && t_uncle2.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle2.m_color=1;
				t_uncle2.m_parent.m_color=-1;
				t_node=t_uncle2.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_left){
					t_node=t_node.m_parent;
					this.p_RotateRight6(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateLeft6(t_node.m_parent.m_parent);
			}
		}
	}
	this.m_root.m_color=1;
	return 0;
}
c_Map6.prototype.p_Set3=function(t_key,t_value){
	var t_node=this.m_root;
	var t_parent=null;
	var t_cmp=0;
	while((t_node)!=null){
		t_parent=t_node;
		t_cmp=this.p_Compare4(t_key,t_node.m_key);
		if(t_cmp>0){
			t_node=t_node.m_right;
		}else{
			if(t_cmp<0){
				t_node=t_node.m_left;
			}else{
				t_node.m_value=t_value;
				return false;
			}
		}
	}
	t_node=c_Node9.m_new.call(new c_Node9,t_key,t_value,-1,t_parent);
	if((t_parent)!=null){
		if(t_cmp>0){
			t_parent.m_right=t_node;
		}else{
			t_parent.m_left=t_node;
		}
		this.p_InsertFixup6(t_node);
	}else{
		this.m_root=t_node;
	}
	return true;
}
c_Map6.prototype.p_Insert2=function(t_key,t_value){
	return this.p_Set3(t_key,t_value);
}
function c_StringMap2(){
	c_Map6.call(this);
}
c_StringMap2.prototype=extend_class(c_Map6);
c_StringMap2.m_new=function(){
	c_Map6.m_new.call(this);
	return this;
}
c_StringMap2.prototype.p_Compare4=function(t_lhs,t_rhs){
	return string_compare(t_lhs,t_rhs);
}
function c_Node9(){
	Object.call(this);
	this.m_key="";
	this.m_right=null;
	this.m_left=null;
	this.m_value=null;
	this.m_color=0;
	this.m_parent=null;
}
c_Node9.m_new=function(t_key,t_value,t_color,t_parent){
	this.m_key=t_key;
	this.m_value=t_value;
	this.m_color=t_color;
	this.m_parent=t_parent;
	return this;
}
c_Node9.m_new2=function(){
	return this;
}
var bb_game_fontAngelTitle=null;
function c_classVoice(){
	Object.call(this);
	this.m_sndFile=new_string_array(47);
	this.m_strName=new_string_array(47);
	this.m_sndVoice=new_object_array(47);
	this.m_oldName="";
	this.m_bEnabled=true;
}
c_classVoice.m_new=function(){
	this.m_sndFile[0]="Building";
	this.m_sndFile[1]="Paved Area";
	this.m_sndFile[2]="Building_Damaged";
	this.m_sndFile[3]="Road";
	this.m_sndFile[4]="Road_Damaged";
	this.m_sndFile[5]="Parking Lot";
	this.m_sndFile[6]="Railway Lines";
	this.m_sndFile[7]="Excavation Site";
	this.m_sndFile[8]="Dump Site";
	this.m_sndFile[9]="Parks_Tall Vegetation";
	this.m_sndFile[10]="Parks_Shrubs";
	this.m_sndFile[11]="Cemetery";
	this.m_sndFile[12]="";
	this.m_sndFile[13]="Vehicle";
	this.m_sndFile[14]="Tree Branches";
	this.m_sndFile[15]="Dustbin";
	this.m_sndFile[16]="Storm Drains_Clean";
	this.m_sndFile[17]="Storm Drains_Debris";
	this.m_sndFile[18]="Storm Drains_Leaves";
	this.m_sndFile[19]="Storm Drains_Discharge";
	this.m_sndFile[20]="Pasture Grassland";
	this.m_sndFile[21]="Heathland";
	this.m_sndFile[22]="Fallow_Bare Soil";
	this.m_sndFile[23]="Fallow_Residue Cover";
	this.m_sndFile[24]="Tree";
	this.m_sndFile[25]="Fruit Tree";
	this.m_sndFile[26]="Furrows";
	this.m_sndFile[27]="Rice Field";
	this.m_sndFile[28]="Vineyard";
	this.m_sndFile[29]="Forest_Broad-leaved";
	this.m_sndFile[30]="Forest_Coniferous";
	this.m_sndFile[31]="Forest_Mixed";
	this.m_sndFile[32]="Burnt Area";
	this.m_sndFile[33]="Sand";
	this.m_sndFile[34]="Bare Rock";
	this.m_sndFile[35]="Sparsely Vegetated Area";
	this.m_sndFile[36]="Burnt Area";
	this.m_sndFile[37]="Inland Marsh";
	this.m_sndFile[38]="Salt Marsh";
	this.m_sndFile[39]="Reeds";
	this.m_sndFile[40]="Riverbank_Bare Soil";
	this.m_sndFile[41]="Riverbank_Concrete";
	this.m_sndFile[42]="Riverbank_Low Grass";
	this.m_sndFile[43]="Riverbank_Shrubs";
	this.m_sndFile[44]="Riverbank_Stone";
	this.m_sndFile[45]="Riverbank_Dry";
	this.m_sndFile[46]="Water Level Indicator";
	this.m_strName[0]="Building";
	this.m_strName[1]="Paved Area";
	this.m_strName[2]="Building_Damaged";
	this.m_strName[3]="Road";
	this.m_strName[4]="Road_Damaged";
	this.m_strName[5]="Parking Lot";
	this.m_strName[6]="Railway Lines";
	this.m_strName[7]="Excavation Site";
	this.m_strName[8]="Dump Site";
	this.m_strName[9]="Parks_Tall Vegetation";
	this.m_strName[10]="Parks_Shrubs";
	this.m_strName[11]="Cemetery";
	this.m_strName[12]="Playing_Field";
	this.m_strName[13]="Vehicle";
	this.m_strName[14]="Tree Branches";
	this.m_strName[15]="Dustbins";
	this.m_strName[16]="Storm Drains_Clean";
	this.m_strName[17]="Storm Drains_Debris";
	this.m_strName[18]="Storm Drains_Leaves";
	this.m_strName[19]="Storm Drains_Discharge";
	this.m_strName[20]="Pasture Grassland";
	this.m_strName[21]="Heathland";
	this.m_strName[22]="Fallow_Bare Soil";
	this.m_strName[23]="Fallow_Residue Cover";
	this.m_strName[24]="Tree";
	this.m_strName[25]="Fruit tree";
	this.m_strName[26]="Furrows";
	this.m_strName[27]="Rice Field";
	this.m_strName[28]="Vineyard";
	this.m_strName[29]="Forest_Broad-leaved";
	this.m_strName[30]="Forest_Coniferous";
	this.m_strName[31]="Forest_Mixed";
	this.m_strName[32]="Burnt Area";
	this.m_strName[33]="Sand";
	this.m_strName[34]="Bare Rock";
	this.m_strName[35]="Sparsely Vegetated Area";
	this.m_strName[36]="Burnt Area";
	this.m_strName[37]="Inland Marsh";
	this.m_strName[38]="Salt Marsh";
	this.m_strName[39]="Reeds";
	this.m_strName[40]="Riverbank_Bare Soil";
	this.m_strName[41]="Riverbank_Concrete";
	this.m_strName[42]="Riverbank_Low Grass";
	this.m_strName[43]="Riverbank_Shrubs";
	this.m_strName[44]="Riverbank_Stone";
	this.m_strName[45]="Riverbank_Dry";
	this.m_strName[46]="Water Level Indicator";
	return this;
}
c_classVoice.prototype.p_Init=function(){
	for(var t_t=0;t_t<47;t_t=t_t+1){
		this.m_sndVoice[t_t]=bb_audio_LoadSound(bb_game_GetAudioString("voice/"+this.m_sndFile[t_t]));
	}
	this.m_oldName="";
	return 0;
}
c_classVoice.prototype.p_Sound=function(t__name){
	if(this.m_bEnabled==false){
		this.m_oldName="";
		return 0;
	}
	if(this.m_oldName==t__name){
		return 0;
	}
	this.m_oldName=t__name;
	if(t__name==""){
		return 0;
	}
	bb_audio_StopChannel(0);
	for(var t_t=0;t_t<47;t_t=t_t+1){
		if(t__name==this.m_strName[t_t]){
			bb_audio_PlaySound(this.m_sndVoice[t_t],0,0);
		}
	}
	return 0;
}
var bb_game_cVOICE=null;
function bb_game_GetAudioString(t_str){
	var t_ext="";
	t_ext=".ogg";
	if(diddy.getBrowserName()=="Safari" || diddy.getBrowserName()=="MSIE"){
		t_ext=".mp3";
	}
	return t_str+t_ext;
}
function c_Sound(){
	Object.call(this);
	this.m_sample=null;
}
c_Sound.m_new=function(t_sample){
	this.m_sample=t_sample;
	return this;
}
c_Sound.m_new2=function(){
	return this;
}
function bb_audio_LoadSound(t_path){
	var t_sample=bb_audio_device.LoadSample(bb_data_FixDataPath(t_path));
	if((t_sample)!=null){
		return c_Sound.m_new.call(new c_Sound,t_sample);
	}
	return null;
}
var bb_game_userPictureUploaded=0;
var bb_game_userPictureTagged=0;
var bb_game_userTag=0;
var bb_game_userValidation=0;
var bb_game_userScore=0;
var bb_game_userLevel=0;
var bb_game_userPois=0;
var bb_game_userCampaign=0;
var bb_game_currPictureUploaded=0;
var bb_game_currPictureTagged=0;
var bb_game_currTag=0;
var bb_game_currValidation=0;
var bb_game_currScore=0;
var bb_game_currLevel=0;
var bb_game_currPois=0;
var bb_game_currCampaign=0;
var bb_game_inputImageIDStr="";
var bb_game_defineCampaign="";
var bb_game_userIDSelected=0;
var bb_game_userNickName="";
var bb_game_angleRotation=0;
function c_classRender_Collaborate(){
	Object.call(this);
	this.m_currentTAGNode=null;
	this.m_stateHelper=0;
	this.m_Cursor=c_ScaledTouchPointer.m_new.call(new c_ScaledTouchPointer);
	this.m_inputBox=null;
	this.m_widgets=null;
	this.m_strDistance=new_string_array(3);
	this.m_scrollStartNumber=0;
	this.m_scrollUp=false;
	this.m_scrollDown=false;
	this.m_startY=144;
	this.m_ratioPhoto=1.0;
	this.m_startX=64;
	this.m_zonePhoto=c_sRect.m_new.call(new c_sRect);
	this.m_selectedTAGNode=null;
	this.m_RenderTagLabelOptionGroupList_Item=null;
	this.m_currentSelectedZone=null;
}
c_classRender_Collaborate.m_new=function(){
	return this;
}
c_classRender_Collaborate.prototype.p_SetHelperState=function(t__state){
	this.m_stateHelper=t__state;
	return 0;
}
c_classRender_Collaborate.prototype.p_Init=function(){
	this.m_currentTAGNode=bb_items_structureTAG;
	bb_game_cMANAGEITEMS.p_SetAllVisible(bb_items_structureTAG);
	bb_game_cMANAGEITEMS.p_SetAllUnSelected(bb_items_structureTAG);
	bb_game_cMANAGEITEMS.p_SetAllDeleting(bb_items_structureTAG);
	bb_game_cMANAGEITEMS.p_StartAnimation(0,0,bb_items_structureTAG);
	this.p_SetHelperState(0);
	this.m_inputBox=c_TextBox.m_new.call(new c_TextBox,256.0,96.0,320.0,40.0,(this.m_Cursor));
	this.m_widgets=c_WidgetManager.m_new.call(new c_WidgetManager,(this.m_Cursor));
	this.m_widgets.p_Attach((this.m_inputBox),-1,true);
	this.m_inputBox.m_skin.p_SetFont(bb_game_fontAngelMini);
	this.m_strDistance[0]="< 10m";
	this.m_strDistance[1]=">10m - 100m<";
	this.m_strDistance[2]="100m >";
	this.m_scrollStartNumber=0;
	this.m_scrollUp=false;
	this.m_scrollDown=false;
	return 0;
}
c_classRender_Collaborate.prototype.p_Update=function(){
	if(this.m_widgets!=null){
		this.m_Cursor.p_Poll2();
		this.m_widgets.p_PollAll(0.0,0.0);
	}
	return 0;
}
c_classRender_Collaborate.prototype.p_RenderLabel=function(t__font,t__label1,t__label2,t__x,t__y,t__type,t__close,t__layout,t__align){
	var t__stepx=32;
	var t__stepy=16;
	var t_w=t__font.p_TextWidth(t__label1)+t__stepx;
	var t_h=48;
	var t_text_h=t__font.p_TextHeight(t__label1);
	var t_align=2;
	var t_multiline=false;
	if(t__label2!=""){
		t_multiline=true;
		if(t_w<t__font.p_TextWidth(t__label2)+t__stepx){
			t_w=t__font.p_TextWidth(t__label2)+t__stepx;
		}
	}
	if(t__layout==3){
		t_h=t_h-t__stepy;
		t_w=t_w-t__stepx-t__stepy;
		t__stepx=0;
		t__stepy=0;
		t_align=1;
	}else{
		if(t__layout==1){
			t_h=t_h-t__stepy;
			t_w=t_w-t__stepx;
			t_align=1;
		}else{
			if(t__layout==2){
				t_w=t_w-t__stepx;
				t__stepx=0;
			}
		}
	}
	if(t__align!=2){
		t_align=t__align;
	}
	var t_3=t__type;
	if(t_3==0){
		bb_graphics_SetColor(0.0,116.0,200.0);
	}else{
		if(t_3==1){
			bb_graphics_SetColor(0.0,180.0,200.0);
		}else{
			if(t_3==2){
				bb_graphics_SetColor(165.0,202.0,96.0);
			}else{
				if(t_3==3){
					bb_graphics_SetColor(120.0,120.0,120.0);
				}else{
					if(t_3==10){
						bb_graphics_SetColor(165.0,202.0,96.0);
					}else{
						if(t_3==11){
							bb_graphics_SetColor(0.0,150.0,62.0);
						}else{
							if(t_3==12){
								bb_graphics_SetColor(200.0,60.0,0.0);
							}else{
								if(t_3==13){
									bb_graphics_SetColor(120.0,120.0,120.0);
								}
							}
						}
					}
				}
			}
		}
	}
	if(t__layout!=1){
		bb_graphics_DrawCircle((t__x),(t__y),((t_h/2)|0));
		bb_graphics_DrawCircle((t__x-t_w),(t__y),((t_h/2)|0));
		bb_graphics_DrawRect((t__x-t_w),(t__y-((t_h/2)|0)),(t_w),(t_h));
	}else{
		bb_graphics_DrawCircle((t__x+((t_w/2)|0)),(t__y),((t_h/2)|0));
		bb_graphics_DrawCircle((t__x-((t_w/2)|0)),(t__y),((t_h/2)|0));
		bb_graphics_DrawRect((t__x-((t_w/2)|0)),(t__y-((t_h/2)|0)),(t_w),(t_h));
	}
	var t_4=t__type;
	if(t_4==11 || t_4==0){
		bb_graphics_SetColor(255.0,255.0,255.0);
	}else{
		if(t_4==10 || t_4==12){
			bb_graphics_SetColor(40.0,40.0,40.0);
		}else{
			if(t_4==2 || t_4==1){
				bb_graphics_SetColor(40.0,40.0,40.0);
			}else{
				if(t_4==3 || t_4==13){
					bb_graphics_SetColor(250.0,250.0,250.0);
				}
			}
		}
	}
	if(t__close){
		bb_graphics_DrawImage2(bb_defaultmedia_ICON_SCENT,(t__x),(t__y),0.0,0.5,0.5,2);
	}
	t__y=t__y-t__font.p_TextHeightOffset(t__label1);
	if(t__layout==1){
		t__font.p_DrawText2(t__label1,t__x,t__y-((t__font.p_TextHeight(t__label1)/2)|0),1);
	}else{
		if(t_align==1){
			t__font.p_DrawText2(t__label1,t__x-((t_w/2)|0),t__y-((t__font.p_TextHeight(t__label1)/2)|0),t_align);
		}else{
			if(t_multiline==true){
				t__font.p_DrawText2(t__label1,t__x-t__stepx,t__y-t_text_h-2,t_align);
				t__font.p_DrawText2(t__label2,t__x-t__stepx,t__y+2,t_align);
			}else{
				t__font.p_DrawText2(t__label1,t__x-t__stepx,t__y-((t_text_h/2)|0),t_align);
			}
		}
	}
	bb_graphics_SetColor(255.0,255.0,255.0);
	return c_sPoint.m_new.call(new c_sPoint,t_w+t_h,t_h);
}
c_classRender_Collaborate.prototype.p_RenderTagLabelDone=function(t__enabled,t__mouse,t__font,t__label,t__nextstate,t__x,t__y,t__align){
	var t_x=t__x;
	var t_y=t__y;
	var t_type=0;
	var t_value=null;
	if(t__enabled==false){
		t_type=3;
	}
	t_value=this.p_RenderLabel(t__font,t__label,"",t_x,t_y,t_type,false,1,t__align);
	if(t__enabled==true){
		if(bb_game_PointInRect((t__mouse.m_x),(t__mouse.m_y),(t_x-((t_value.m_x/2)|0)),(t_y-((t_value.m_y/2)|0)),(t_x+((t_value.m_x/2)|0)),(t_y+((t_value.m_y/2)|0)))==1){
			bb_game_MouseOver();
			t_type=1;
			this.p_RenderLabel(t__font,t__label,"",t_x,t_y,t_type,false,1,t__align);
			if(bb_game_inputHit==1){
				bb_session_GameSession.p_SetState(t__nextstate);
				bb_checkkeys_DelayKeys(0);
			}
		}
	}
	return t_y+t_value.m_y;
}
c_classRender_Collaborate.prototype.p_Render=function(t__mouse,t__state){
	return 0;
}
c_classRender_Collaborate.prototype.p_IsInsidePhoto=function(t__x,t__y,t__w,t__h){
	if(t__x<this.m_zonePhoto.m_x-t__w){
		return 0;
	}
	if(t__x>this.m_zonePhoto.m_w+t__w){
		return 0;
	}
	if(t__y<this.m_zonePhoto.m_y-t__h){
		return 0;
	}
	if(t__y>this.m_zonePhoto.m_h+t__h){
		return 0;
	}
	return 1;
}
c_classRender_Collaborate.prototype.p_IsInsidePhoto2=function(t__x,t__y){
	if(t__x<this.m_zonePhoto.m_x){
		return 0;
	}
	if(t__x>this.m_zonePhoto.m_w){
		return 0;
	}
	if(t__y<this.m_zonePhoto.m_y){
		return 0;
	}
	if(t__y>this.m_zonePhoto.m_h){
		return 0;
	}
	return 1;
}
c_classRender_Collaborate.prototype.p_RenderMainImage=function(t__mouse,t__zoom){
	var t_x=0;
	var t_y=0;
	var t_w=(((bb_collaborate_Collaborate.m_GameWidth)*0.66)|0);
	var t_h=(((bb_collaborate_Collaborate.m_GameHeight)*0.66)|0);
	var t_iwidth=0;
	var t_iheight=0;
	var t_shiftX=0;
	var t_shiftY=0;
	var t_ratio=1.0;
	var t_ratio_x=1.0;
	var t_ratio_y=1.0;
	var t_scale=0.5;
	t_w=(((bb_collaborate_Collaborate.m_GameWidth)*0.50)|0);
	t_h=(((bb_collaborate_Collaborate.m_GameHeight)*0.66)|0);
	if(bb_defaultmedia_IMG_MAIN!=null){
		if(bb_game_angleRotation==90 || bb_game_angleRotation==270){
			t_iwidth=bb_defaultmedia_IMG_MAIN.p_Height();
			t_iheight=bb_defaultmedia_IMG_MAIN.p_Width();
		}else{
			t_iwidth=bb_defaultmedia_IMG_MAIN.p_Width();
			t_iheight=bb_defaultmedia_IMG_MAIN.p_Height();
		}
		t_ratio_x=(t_w)/(t_iwidth);
		t_ratio_y=(t_h)/(t_iheight);
		t_ratio=t_ratio_x;
		if(t_ratio>t_ratio_y){
			if((t_iwidth)*t_ratio_y<=(t_w)){
				t_ratio=t_ratio_y;
			}
		}
		t_w=(((t_iwidth)*t_ratio)|0);
		t_h=(((t_iheight)*t_ratio)|0);
		this.m_ratioPhoto=t_ratio;
		this.m_zonePhoto.m_x=this.m_startX;
		this.m_zonePhoto.m_y=this.m_startY;
		this.m_zonePhoto.m_w=(((this.m_startX)+(t_iwidth)*t_ratio)|0);
		this.m_zonePhoto.m_h=(((this.m_startY)+(t_iheight)*t_ratio)|0);
		if(bb_game_angleRotation==90){
			t_shiftX=0;
			t_shiftY=(((t_iheight)*t_ratio)|0);
		}else{
			if(bb_game_angleRotation==180){
				t_shiftX=(((t_iwidth)*t_ratio)|0);
				t_shiftY=(((t_iheight)*t_ratio)|0);
			}else{
				if(bb_game_angleRotation==270){
					t_shiftX=(((t_iwidth)*t_ratio)|0);
					t_shiftY=0;
				}
			}
		}
		bb_graphics_DrawRect((this.m_startX-24),(this.m_startY-24),(t_iwidth)*t_ratio+48.0,(t_iheight)*t_ratio+48.0);
		bb_graphics_DrawImage2(bb_defaultmedia_IMG_MAIN,(this.m_startX+t_shiftX),(this.m_startY+t_shiftY),(bb_game_angleRotation),t_ratio,t_ratio,0);
		if(this.p_IsInsidePhoto2(t__mouse.m_x,t__mouse.m_y)==1 && t__zoom==true){
			var t_ix=t__mouse.m_x-this.m_startX;
			var t_iy=t__mouse.m_y-this.m_startY;
			t_x=t__mouse.m_x-this.m_startX;
			t_y=t__mouse.m_y-this.m_startY;
			if(bb_game_angleRotation==90){
			}else{
				if(bb_game_angleRotation==180){
					t_ix=t__mouse.m_x-this.m_startX;
					t_iy=t__mouse.m_y-this.m_startY;
				}else{
					if(bb_game_angleRotation==270){
						t_shiftX=(((t_iwidth)*t_ratio)|0);
						t_shiftY=0;
					}
				}
			}
			var t_left=(((t_x)/t_ratio-80.0)|0);
			var t_top=(((t_y)/t_ratio-80.0)|0);
			var t_right=(((t_x)/t_ratio+80.0)|0);
			var t_bottom=(((t_y)/t_ratio+80.0)|0);
			if(t_left<0){
				t_left=0;
			}
			if(t_top<0){
				t_top=0;
			}
			if(t_right>=t_iwidth-1){
				t_right=t_iwidth-1;
			}
			if(t_bottom>=t_iheight-1){
				t_bottom=t_iheight-1;
			}
			t_x=t_x+this.m_startX-(t_right-t_left);
			t_y=t_y+this.m_startY-(t_bottom-t_top);
			bb_graphics_DrawRect((t_x-8),(t_y-8),((t_right-t_left)*2+16),((t_bottom-t_top)*2+16));
			t_x=t_ix;
			t_y=t_iy;
			var t_ileft=t_left;
			var t_itop=t_top;
			var t_iright=t_right;
			var t_ibottom=t_bottom;
			t_shiftX=this.m_startX-(t_right-t_left);
			t_shiftY=this.m_startY-(t_bottom-t_top);
			if(bb_game_angleRotation==90){
				t_left=t_iheight-t_itop;
				t_top=t_ileft;
				t_right=t_iheight-t_ibottom;
				t_bottom=t_iright;
				t_shiftX=this.m_startX-(t_bottom-t_top);
				t_shiftY=this.m_startY-(t_right-t_left);
			}else{
				if(bb_game_angleRotation==180){
					t_left=t_iwidth-t_ileft;
					t_top=t_iheight-t_itop;
					t_right=t_iwidth-t_iright;
					t_bottom=t_iheight-t_ibottom;
					t_shiftX=this.m_startX+bb_math_Abs(t_right-t_left);
					t_shiftY=this.m_startY+bb_math_Abs(t_bottom-t_top);
				}else{
					if(bb_game_angleRotation==270){
						t_left=t_itop;
						t_top=t_iwidth-t_ileft;
						t_right=t_ibottom;
						t_bottom=t_iwidth-t_iright;
						t_shiftX=this.m_startX+bb_math_Abs(t_bottom-t_top);
						t_shiftY=this.m_startY-bb_math_Abs(t_right-t_left);
					}
				}
			}
			bb_graphics_DrawImageRect2(bb_defaultmedia_IMG_MAIN,(t_x+t_shiftX),(t_y+t_shiftY),t_left,t_top,t_right-t_left,t_bottom-t_top,(bb_game_angleRotation),2.0,2.0,0);
		}
		t_x=(((this.m_zonePhoto.m_x)+(this.m_zonePhoto.m_w-this.m_startX)*0.25)|0);
		t_y=bb_collaborate_Collaborate.m_GameHeight-80;
		t_scale=0.75;
		if(t__mouse.p_Inside(t_x,t_y,48)){
			t_scale=1.0;
			if(bb_game_inputHit==1){
				bb_game_angleRotation=(bb_game_angleRotation+90) % 360;
			}
		}
		bb_graphics_DrawImage2(bb_defaultmedia_ICON_ROTATE,(t_x),(t_y),0.0,-t_scale,t_scale,0);
		t_x=(((this.m_zonePhoto.m_x)+(this.m_zonePhoto.m_w-this.m_startX)*0.75)|0);
		t_y=bb_collaborate_Collaborate.m_GameHeight-80;
		t_scale=0.75;
		if(t__mouse.p_Inside(t_x,t_y,48)){
			t_scale=1.0;
			if(bb_game_inputHit==1){
				bb_game_angleRotation=(bb_game_angleRotation-90) % 360;
				if(bb_game_angleRotation<0){
					bb_game_angleRotation=bb_game_angleRotation+360;
				}
			}
		}
		bb_graphics_DrawImage2(bb_defaultmedia_ICON_ROTATE,(t_x),(t_y),0.0,t_scale,t_scale,0);
	}
	return 0;
}
c_classRender_Collaborate.prototype.p_DrawRectangle=function(t__rect,t__fadeOut,t__fadeIn){
	var t_points=new_number_array(8);
	var t_alpha=1.0;
	var t_left=.0;
	var t_top=.0;
	var t_right=.0;
	var t_bottom=.0;
	var t_ileft=.0;
	var t_itop=.0;
	var t_iright=.0;
	var t_ibottom=.0;
	if(t__rect==null){
		return 0;
	}
	if(t__fadeOut==true){
		t_alpha=1.0-(bb_math_Abs(bb_app_Millisecs()-bb_game_gStartTimer))/500.0;
		if(t_alpha<0.0){
			t_alpha=0.0;
		}
	}
	if(t__fadeIn==true){
		t_alpha=(bb_math_Abs(bb_app_Millisecs()-bb_game_gStartTimer))/500.0;
		if(t_alpha>1.0){
			t_alpha=1.0;
		}
	}
	bb_graphics_SetAlpha(t_alpha);
	bb_graphics_SetColor(255.0,0.0,0.0);
	t_ileft=(t__rect.m_x)*this.m_ratioPhoto;
	t_itop=(t__rect.m_y)*this.m_ratioPhoto;
	t_iright=(t__rect.m_x+t__rect.m_w)*this.m_ratioPhoto;
	t_ibottom=(t__rect.m_y+t__rect.m_h)*this.m_ratioPhoto;
	t_left=(this.m_startX)+t_ileft;
	t_top=(this.m_startY)+t_itop;
	t_right=(this.m_startX)+t_iright;
	t_bottom=(this.m_startY)+t_ibottom;
	if(bb_game_angleRotation==90){
		t_left=(this.m_startX)+t_itop;
		t_top=(this.m_zonePhoto.m_h)-t_ileft;
		t_right=(this.m_startX)+t_ibottom;
		t_bottom=(this.m_zonePhoto.m_h)-t_iright;
	}else{
		if(bb_game_angleRotation==180){
			t_left=(this.m_zonePhoto.m_w)-t_ileft;
			t_top=(this.m_zonePhoto.m_h)-t_itop;
			t_right=(this.m_zonePhoto.m_w)-t_iright;
			t_bottom=(this.m_zonePhoto.m_h)-t_ibottom;
		}else{
			if(bb_game_angleRotation==270){
				t_left=(this.m_zonePhoto.m_w)-t_itop;
				t_top=(this.m_startY)+t_ileft;
				t_right=(this.m_zonePhoto.m_w)-t_ibottom;
				t_bottom=(this.m_startY)+t_iright;
			}
		}
	}
	t_points[0]=t_left;
	t_points[1]=t_top;
	t_points[2]=t_right;
	t_points[3]=t_top;
	t_points[4]=t_right;
	t_points[5]=t_bottom;
	t_points[6]=t_left;
	t_points[7]=t_bottom;
	bb_graphics_DrawLine(t_points[0],t_points[1],t_points[2],t_points[3]);
	bb_graphics_DrawLine(t_points[2],t_points[3],t_points[4],t_points[5]);
	bb_graphics_DrawLine(t_points[4],t_points[5],t_points[6],t_points[7]);
	bb_graphics_DrawLine(t_points[6],t_points[7],t_points[0],t_points[1]);
	t_points[0]=t_left+1.0;
	t_points[1]=t_top+1.0;
	t_points[2]=t_right-1.0;
	t_points[3]=t_top+1.0;
	t_points[4]=t_right-1.0;
	t_points[5]=t_bottom-1.0;
	t_points[6]=t_left+1.0;
	t_points[7]=t_bottom-1.0;
	bb_graphics_DrawLine(t_points[0],t_points[1],t_points[2],t_points[3]);
	bb_graphics_DrawLine(t_points[2],t_points[3],t_points[4],t_points[5]);
	bb_graphics_DrawLine(t_points[4],t_points[5],t_points[6],t_points[7]);
	bb_graphics_DrawLine(t_points[6],t_points[7],t_points[0],t_points[1]);
	bb_graphics_SetColor(255.0,255.0,255.0);
	bb_graphics_SetAlpha(1.0);
	return 0;
}
c_classRender_Collaborate.prototype.p_RenderTagLabelOptionGroup=function(t__mouse,t__font,t__tag,t__x,t__y){
	var t_step_x=8;
	var t_step_y=40;
	var t_size=1.0;
	var t_sizeinfo=1.0;
	var t_x=t__x;
	var t_y=t__y;
	var t_x2=t_x;
	var t_posX=0;
	var t_posY=0;
	var t_indice=0;
	if(t__tag==null || t__tag.m_objects==null || t__tag.m_objects.p_Count()==0){
		return t__y;
	}
	t_x=t__x+16+6;
	t_x2=t__x+420;
	t_x=t__x+((bb_defaultmedia_ICON_CHECK.p_Width()/2)|0);
	t_x2=t__x+420;
	var t_=t__tag.m_objects.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_tag=t_.p_NextObject();
		t_posX=t_x+24;
		t_posY=t_y;
		t_size=1.0;
		t_sizeinfo=1.0;
		if(t_tag.m_status==0 && t_tag.m_managed==true || t_tag.m_fromNew==true){
			if(bb_game_PointInRect((t__mouse.m_x),(t__mouse.m_y),(t_x-24),(t_y-16),(t_x+256),(t_y+16))==1){
				bb_game_MouseOver();
				t_size=1.5;
				if(bb_game_inputHit==1){
					if(t_tag.m_checked==false){
						t_tag.m_checked=true;
					}else{
						t_tag.m_checked=false;
					}
					bb_checkkeys_DelayKeys(0);
				}
			}
			if(bb_game_PointInRect((t__mouse.m_x),(t__mouse.m_y),(t_x+400),(t_y-16),(t_x+400+32),(t_y+16))==1){
				bb_game_MouseOver();
				t_sizeinfo=1.5;
				if(bb_game_inputHit==1){
					bb_game_cRENDER_INFO.p_LoadInfo(t_tag);
					bb_checkkeys_DelayKeys(0);
				}
			}
		}
		t_indice=0;
		if(t_tag.m_checked==true){
			t_indice=1;
		}
		if(t_tag.m_status==0 && t_tag.m_managed==true){
			if(t_tag.m_status==0){
				bb_graphics_DrawImage2(bb_defaultmedia_ICON_CHECK,(t_x),(t_y),0.0,t_size,t_size,t_indice);
			}else{
				if(t_tag.m_status==1){
					bb_graphics_DrawImage2(bb_defaultmedia_ICON_VERIFY,(t_x),(t_y),0.0,0.75,0.75,0);
				}else{
					bb_graphics_DrawImage2(bb_defaultmedia_ICON_VERIFY,(t_x),(t_y),0.0,0.75,0.75,1);
				}
			}
			bb_graphics_DrawImage2(bb_defaultmedia_ICON_INFO,(t_x2),(t_y),0.0,t_sizeinfo,t_sizeinfo,0);
			bb_graphics_SetColor(0.0,0.0,0.0);
			t__font.p_DrawText2(t_tag.m_sub_name1,t_posX,t_y-12,0);
			bb_graphics_SetColor(255.0,255.0,255.0);
			t_y=t_y+t_step_y;
		}else{
			if(t_tag.m_fromNew==true){
				bb_graphics_DrawImage2(bb_defaultmedia_ICON_INFO,(t_x2),(t_y),0.0,t_sizeinfo,t_sizeinfo,0);
				bb_graphics_SetColor(0.0,0.0,0.0);
				t__font.p_DrawText2(t_tag.m_sub_name1,t_posX,t_y-12,0);
				bb_graphics_SetColor(255.0,255.0,255.0);
				t_y=t_y+t_step_y;
			}
		}
	}
	return t_y+t_step_y;
}
c_classRender_Collaborate.prototype.p_RenderButton=function(t__font,t__label1,t__label2,t__x,t__y,t__type,t__next){
	var t_w=t__font.p_TextWidth(t__label1)+-16;
	var t_h=48;
	var t_text_h=t__font.p_TextHeight(t__label1);
	var t_multiline=false;
	if(t__label2!=""){
		t_multiline=true;
		if(t_w<t__font.p_TextWidth(t__label2)){
			t_w=t__font.p_TextWidth(t__label2);
		}
	}
	var t_1=t__type;
	if(t_1==0){
		bb_graphics_SetColor(0.0,116.0,200.0);
	}else{
		if(t_1==1){
			bb_graphics_SetColor(0.0,180.0,200.0);
		}else{
			if(t_1==2){
				bb_graphics_SetColor(165.0,202.0,96.0);
			}
		}
	}
	if(t__next==true){
		t_w=t_w+24;
	}
	bb_graphics_DrawCircle((t__x),(t__y),((t_h/2)|0));
	bb_graphics_DrawCircle((t__x+t_w),(t__y),((t_h/2)|0));
	bb_graphics_DrawRect((t__x),(t__y-((t_h/2)|0)),(t_w),(t_h));
	if(t__next==true){
		bb_graphics_SetColor(255.0,255.0,255.0);
		bb_graphics_DrawImage2(bb_defaultmedia_ICON_SCENT,(t__x+t_w+4),(t__y),0.0,0.25,0.25,3);
	}
	var t_2=t__type;
	if(t_2==0){
		bb_graphics_SetColor(255.0,255.0,255.0);
	}else{
		if(t_2==2 || t_2==1){
			bb_graphics_SetColor(0.0,0.0,0.0);
		}
	}
	t__y=t__y-t__font.p_TextHeightOffset(t__label1);
	if(t_multiline==true){
		t__font.p_DrawText2(t__label1,t__x+-8,t__y-t_text_h-2,0);
		t__font.p_DrawText2(t__label2,t__x+-8,t__y+2,0);
	}else{
		t__font.p_DrawText2(t__label1,t__x+-8,t__y-((t_text_h/2)|0),0);
	}
	bb_graphics_SetColor(255.0,255.0,255.0);
	return c_sPoint.m_new.call(new c_sPoint,t_w+t_h,t_h);
}
c_classRender_Collaborate.prototype.p_RenderMenu=function(t__tag,t__mouse,t__font,t__prev_tag,t__x,t__y){
	var t_x=t__x;
	var t_y=t__y;
	var t_type=0;
	var t__next=false;
	var t_ret=0;
	var t_value=null;
	var t_posX=0;
	var t_posY=0;
	var t__selected=null;
	var t_drawItem=0;
	var t_=t__tag.m_subitems.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_tag=t_.p_NextObject();
		t_tag.p_UpdateAnimation(bb_app_Millisecs());
		t_posX=t_tag.m_currPos.m_x;
		t_posY=t_tag.m_currPos.m_y;
		if(t_tag.m_visible==false){
			if(t_tag.m_subitems!=null){
				if(t_tag.p_Count()>0){
				}
			}
		}
		if(t_tag.m_visible==true){
			t_drawItem=t_drawItem+1;
			t_type=0;
			t__next=true;
			if(t_tag.m_subitems==null || t_tag.m_subitems.p_Count()==0){
				t__next=false;
			}
			if(t_tag.m_subitems!=null){
				if(t_tag.p_Count()==0){
					t_tag.m_visible=false;
				}
			}
			if(t_tag.m_selected==true){
				t_type=2;
				t__selected=t_tag;
			}
			t_value=this.p_RenderButton(t__font,t_tag.m_sub_name1,t_tag.m_sub_name2,t_posX,t_posY,t_type,t__next);
			if(t_value.m_x>t_ret){
				t_ret=t_value.m_x;
			}
			if(bb_game_PointInRect((t__mouse.m_x),(t__mouse.m_y),(t_x),(t_y-((t_value.m_y/2)|0)),(t_x+t_value.m_x),(t_y+((t_value.m_y/2)|0)))==1){
				bb_game_MouseOver();
				bb_game_cVOICE.p_Sound(t_tag.m_voice);
				if(t_tag.m_selected==false){
					t_type=1;
				}
				t_value=this.p_RenderButton(t__font,t_tag.m_sub_name1,t_tag.m_sub_name2,t_posX,t_posY,t_type,t__next);
				if(t_tag.m_timerAnimation<0 && t_tag.m_selected==false){
					if(t__next==true){
						this.m_currentTAGNode=t_tag;
						this.m_selectedTAGNode=null;
						bb_game_cMANAGEITEMS.p_SetUnSelected(t__tag,false);
						bb_game_cMANAGEITEMS.p_SetUnSelected(t_tag,false);
						bb_game_cMANAGEITEMS.p_StartAnimation(t_x,t_y,t_tag);
						t_tag.m_selected=true;
						t__selected=t_tag;
						this.p_SetHelperState(1);
					}else{
						bb_game_cMANAGEITEMS.p_SetUnSelected(t__tag,false);
						if(bb_game_inputHit==1){
							this.m_selectedTAGNode=t_tag;
							t_tag.m_visible=false;
							bb_checkkeys_DelayKeys(0);
						}
					}
				}
				bb_game_inputHit=0;
			}
			t_tag.m_destPos.m_x=t_x;
			t_tag.m_destPos.m_y=t_y;
			t_y=t_y-(t_value.m_y+8);
		}
	}
	if(t_drawItem==0){
		this.m_selectedTAGNode=null;
	}else{
		if(t__selected!=null){
			t_y=t__selected.m_currPos.m_y;
			if(t__selected.m_subitems!=null){
				t_y=(((t_y)+((t__selected.m_subitems.p_Count()-1)*(t_value.m_y+8))/2.0)|0);
			}
			if(t_y>bb_render_collaborate_MENU_START_Y){
				t_y=bb_render_collaborate_MENU_START_Y;
			}
			return t_ret+4+this.p_RenderMenu(t__selected,t__mouse,t__font,t__tag,t__x+t_ret+4,t_y);
		}
	}
	return t_ret;
}
c_classRender_Collaborate.prototype.p_RenderImageID=function(t__mouse){
	var t_w=400;
	var t_h=64;
	var t_x=(((bb_collaborate_Collaborate.m_GameWidth-t_w)/2)|0);
	var t_y=(((bb_collaborate_Collaborate.m_GameHeight-t_h)/2)|0);
	bb_graphics_SetColor(40.0,40.0,40.0);
	bb_graphics_DrawRect((t_x),(t_y),(t_w),(t_h));
	bb_graphics_SetColor(255.0,255.0,255.0);
	bb_game_fontAngelMini.p_DrawText2(bb_game_inputImageIDStr,t_x+((t_w/2)|0),t_y+((t_h/2)|0)-8,1);
	if(bb_game_charKeyboardMini>0){
		if(bb_game_charKeyboardMini==13){
			bb_game_inputImageID=false;
			bb_session_GameSession.p_SetState(3);
		}
		if(bb_game_charKeyboardMini==8){
			bb_game_inputImageIDStr=bb_game_inputImageIDStr.slice(0,-1);
		}
		if(bb_game_charKeyboardMini>=48 && bb_game_charKeyboardMini<=57){
			bb_game_inputImageIDStr=bb_game_inputImageIDStr+String.fromCharCode(bb_game_charKeyboardMini);
		}
	}
	return 0;
}
c_classRender_Collaborate.prototype.p_RenderHelper=function(t__x,t__y){
	bb_graphics_DrawImage(bb_defaultmedia_SPRITE_HELPER,(t__x),(t__y),this.m_stateHelper);
	return 0;
}
c_classRender_Collaborate.prototype.p_RenderHelper2=function(t__mouse){
	return 0;
}
c_classRender_Collaborate.prototype.p_RenderTagLabelOptionGroupList=function(t__mouse,t__font,t__list,t__x,t__y){
	var t_step_x=8;
	var t_step_y=40;
	var t_size=1.0;
	var t_size_invalid=1.0;
	var t_sizeinfo=1.0;
	var t_x=t__x;
	var t_x2=t__x+360;
	var t_x3=t__x+420;
	var t_y=t__y;
	var t_posX=0;
	var t_posY=0;
	var t_indice=0;
	var t_view_index=0;
	var t_view_number=0;
	this.m_RenderTagLabelOptionGroupList_Item=null;
	if(t__list==null || t__list.p_Count()==0){
		return t__y;
	}
	t_x=t__x+16+6;
	this.m_scrollUp=false;
	t_x=t__x+((bb_defaultmedia_ICON_CHECK.p_Width()/2)|0);
	var t_=t__list.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_list=t_.p_NextObject();
		var t_2=t_list.m_objects.p_ObjectEnumerator();
		while(t_2.p_HasNext()){
			var t_tag=t_2.p_NextObject();
			t_posX=t_x+24;
			t_posY=t_y;
			t_size=1.0;
			t_size_invalid=0.75;
			t_sizeinfo=1.0;
			if(t_tag.m_status==0 && t_tag.m_managed==true){
				if(t_view_index>=this.m_scrollStartNumber){
					if(bb_game_PointInRect((t__mouse.m_x),(t__mouse.m_y),(t_x-24),(t_y-16),(t_x+256),(t_y+16))==1){
						bb_game_MouseOver();
						t_size=1.5;
						this.m_RenderTagLabelOptionGroupList_Item=t_tag;
						if(bb_game_inputHit==1){
							if(t_tag.m_checked==false){
								t_tag.m_checked=true;
								t_tag.m_invalid=false;
							}else{
								t_tag.m_checked=false;
							}
							bb_checkkeys_DelayKeys(0);
						}
					}
					if(bb_game_PointInRect((t__mouse.m_x),(t__mouse.m_y),(t_x2-24),(t_y-16),(t_x2+24),(t_y+16))==1){
						bb_game_MouseOver();
						t_size_invalid=1.0;
						this.m_RenderTagLabelOptionGroupList_Item=t_tag;
						if(bb_game_inputHit==1){
							if(t_tag.m_invalid==false){
								t_tag.m_invalid=true;
								t_tag.m_checked=false;
							}else{
								t_tag.m_invalid=false;
							}
							bb_checkkeys_DelayKeys(0);
						}
					}
					if(bb_game_PointInRect((t__mouse.m_x),(t__mouse.m_y),(t_x3-16),(t_y-16),(t_x3+16),(t_y+16))==1){
						bb_game_MouseOver();
						t_sizeinfo=1.5;
						if(bb_game_inputHit==1){
							bb_game_cRENDER_INFO.p_LoadInfo(t_tag);
							bb_checkkeys_DelayKeys(0);
						}
					}
					t_indice=0;
					if(t_tag.m_checked==true){
						t_indice=1;
					}
					bb_graphics_DrawImage2(bb_defaultmedia_ICON_CHECK,(t_x),(t_y),0.0,t_size,t_size,t_indice);
					bb_graphics_DrawImage2(bb_defaultmedia_ICON_VERIFY,(t_x2),(t_y),0.0,t_size_invalid,t_size_invalid,1);
					bb_graphics_DrawImage2(bb_defaultmedia_ICON_INFO,(t_x3),(t_y),0.0,t_sizeinfo,t_sizeinfo,0);
					bb_graphics_SetColor(0.0,0.0,0.0);
					if(t_tag.m_checked==true){
						bb_graphics_SetColor(0.0,128.0,0.0);
					}
					if(t_tag.m_invalid==true){
						bb_graphics_SetColor(128.0,0.0,0.0);
					}
					t__font.p_DrawText2(t_tag.m_sub_name1,t_posX,t_y-12,0);
					if(t_tag.m_invalid==true){
						bb_graphics_DrawLine((t_posX),(t_y),(t_posX+t__font.p_TextWidth(t_tag.m_sub_name1)),(t_y));
					}
					bb_graphics_SetColor(255.0,255.0,255.0);
					t_y=t_y+t_step_y;
					this.m_scrollDown=true;
					t_view_number=t_view_number+1;
					if(t_view_number>7){
						return t_y+t_step_y;
					}
				}
				t_view_index=t_view_index+1;
			}
		}
	}
	this.m_scrollDown=false;
	return t_y+t_step_y;
}
c_classRender_Collaborate.prototype.p_RenderScroll=function(t__mouse,t__y){
	var t_x=0;
	var t_y=0;
	var t_scale=.0;
	var t_index=0;
	if(this.m_scrollStartNumber>0){
		this.m_scrollUp=true;
	}
	t_x=bb_collaborate_Collaborate.m_GameWidth-80;
	t_y=t__y;
	t_scale=0.5;
	t_index=0;
	if(this.m_scrollUp==true){
		if(bb_game_PointInRect((t__mouse.m_x),(t__mouse.m_y),(t_x-24),(t_y-24),(t_x+24),(t_y+24))==1){
			bb_game_MouseOver();
			t_scale=0.75;
			t_index=1;
			if(bb_game_inputHit==1){
				this.m_scrollStartNumber=this.m_scrollStartNumber-1;
				if(this.m_scrollStartNumber<0){
					this.m_scrollStartNumber=0;
				}
			}
		}
		bb_graphics_DrawImage2(bb_defaultmedia_ICON_SCROLL,(t_x),(t_y),90.0,t_scale,t_scale,t_index);
	}
	t_x=bb_collaborate_Collaborate.m_GameWidth-96;
	t_y=t__y+324;
	t_scale=0.5;
	t_index=0;
	if(this.m_scrollDown==true){
		if(bb_game_PointInRect((t__mouse.m_x),(t__mouse.m_y),(t_x-24),(t_y-24),(t_x+24),(t_y+24))==1){
			bb_game_MouseOver();
			t_scale=0.75;
			t_index=1;
			if(bb_game_inputHit==1){
				this.m_scrollStartNumber=this.m_scrollStartNumber+1;
			}
		}
		bb_graphics_DrawImage2(bb_defaultmedia_ICON_SCROLL,(t_x),(t_y),270.0,t_scale,t_scale,t_index);
	}
	return 0;
}
c_classRender_Collaborate.prototype.p_RenderTagLabel=function(t__mouse,t__font,t__tag,t__x,t__y){
	var t_step_x=8;
	var t_step_y=8;
	var t_x=t__x;
	var t_x_distance=0;
	var t_y=t__y;
	var t_type=13;
	var t_ret=0;
	var t_str="";
	var t_value=null;
	var t_posX=0;
	var t_posY=0;
	if(t__tag==null || t__tag.m_subitems==null || t__tag.m_subitems.p_Count()==0){
		return t__y;
	}
	t_x=t__x+16+6;
	t_x=t__x;
	var t_=t__tag.m_subitems.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_tag=t_.p_NextObject();
		t_posX=t_x;
		t_posY=t_y;
		t_type=13;
		if(t_tag.m_selected==true){
			t_type=2;
		}
		t_value=this.p_RenderLabel(t__font,t_tag.m_sub_name1,t_tag.m_sub_name2,t_posX,t_posY,t_type,t_tag.m_deleting,0,2);
		if(t_value.m_x>t_ret){
			t_ret=t_value.m_x;
		}
		t_tag.m_pinMode.m_drag=false;
		if(bb_game_inputPress==0 || bb_game_inputHit==1){
			if(t_tag.m_deleting==true){
				if(bb_game_PointInRect((t__mouse.m_x),(t__mouse.m_y),(t_posX-((t_value.m_y/2)|0)),(t_posY-((t_value.m_y/2)|0)),(t_posX+((t_value.m_y/2)|0)),(t_posY+((t_value.m_y/2)|0)))==1){
					bb_game_MouseOver();
					t_type=12;
					t_value=this.p_RenderLabel(t__font,t_tag.m_sub_name1,t_tag.m_sub_name2,t_posX,t_posY,t_type,t_tag.m_deleting,0,2);
					if(bb_game_inputHit==1){
						t__tag.p_RemoveSubItem(t_tag);
						t_tag.m_visible=true;
						this.p_SetHelperState(2);
						if(t__tag.p_Count()==0){
							this.p_SetHelperState(3);
						}
						bb_checkkeys_DelayKeys(0);
					}
				}
			}
			if(bb_game_PointInRect((t__mouse.m_x),(t__mouse.m_y),(t_posX-t_value.m_x+((t_value.m_y/2)|0)),(t_posY-((t_value.m_y/2)|0)),(t_posX-((t_value.m_y/2)|0)),(t_posY+((t_value.m_y/2)|0)))==1){
				bb_game_MouseOver();
				t_type=2;
				t_value=this.p_RenderLabel(t__font,t_tag.m_sub_name1,t_tag.m_sub_name2,t_posX,t_posY,t_type,t_tag.m_deleting,0,2);
				if(bb_game_inputHit==1){
					if(this.m_currentSelectedZone!=t_tag){
						bb_game_cMANAGEITEMS.p_SetAllUnSelected(t__tag);
						this.m_currentSelectedZone=t_tag;
						this.m_currentSelectedZone.m_selected=true;
						bb_session_GameSession.p_SetState(123);
					}else{
						this.m_currentSelectedZone.m_selected=false;
						this.m_currentSelectedZone=null;
						bb_session_GameSession.p_SetState(121);
					}
					bb_checkkeys_DelayKeys(0);
				}
			}
		}
		t_x=t_x-t_value.m_x;
		if(t_x<t__x-400){
			t_x=t__x;
			t_y=t_y+(t_value.m_y+t_step_y);
		}
	}
	t_y=t_y+(t_value.m_y+t_step_y);
	return t_y+t_step_y;
}
c_classRender_Collaborate.prototype.p_RenderTagUsed=function(t__mouse,t__font,t__origin,t__user,t__x,t__y){
	var t_step_x=40;
	var t_step_y=8;
	var t_x=t__x;
	var t_y=t__y;
	var t_posX=0;
	var t_posY=0;
	var t_last_row=false;
	t_x=t__x+16+6;
	t_x=t__x;
	if(t__origin!=null && t__origin.m_subitems!=null && t__origin.m_subitems.p_Count()>0){
		var t_=t__origin.m_subitems.p_ObjectEnumerator();
		while(t_.p_HasNext()){
			var t_objects=t_.p_NextObject();
			if(t_objects!=null && t_objects.m_objects!=null && t_objects.m_objects.p_Count()>0){
				var t_2=t_objects.m_objects.p_ObjectEnumerator();
				while(t_2.p_HasNext()){
					var t_tag=t_2.p_NextObject();
					if(t_tag!=null){
						if(t_x+t__font.p_TextWidth(t_tag.m_name)>=bb_collaborate_gScreenWidth-t_step_x){
							t_x=t__x;
							t_y=t_y+t__font.p_TextWidth("Ap")+t_step_y;
						}
						t_posX=t_x;
						t_posY=t_y;
						bb_graphics_SetColor(0.0,0.0,0.0);
						t__font.p_DrawText2(t_tag.m_name+" |",t_posX,t_posY,0);
						t_x=t_x+t__font.p_TextWidth(t_tag.m_name)+t_step_x;
					}
				}
			}
		}
	}
	if(t__user!=null && t__user.m_subitems!=null && t__user.m_subitems.p_Count()>0){
		var t_3=t__user.m_subitems.p_ObjectEnumerator();
		while(t_3.p_HasNext()){
			var t_objects2=t_3.p_NextObject();
			if(t_objects2!=null && t_objects2.m_objects!=null && t_objects2.m_objects.p_Count()>0){
				var t_4=t_objects2.m_objects.p_ObjectEnumerator();
				while(t_4.p_HasNext()){
					var t_tag2=t_4.p_NextObject();
					if(t_tag2!=null){
						if(t_x+t__font.p_TextWidth(t_tag2.m_name)>=bb_collaborate_gScreenWidth-t_step_x){
							t_x=t__x;
							t_y=t_y+t__font.p_TextWidth("Ap")+t_step_y;
						}
						t_posX=t_x;
						t_posY=t_y;
						bb_graphics_SetColor(0.0,0.0,0.0);
						t__font.p_DrawText2(t_tag2.m_name+" |",t_posX,t_posY,0);
						t_x=t_x+t__font.p_TextWidth(t_tag2.m_name)+t_step_x;
					}
				}
			}
		}
	}
	bb_graphics_SetColor(255.0,255.0,255.0);
	return t_y+t_step_y;
}
c_classRender_Collaborate.prototype.p_Inside2=function(t__x,t__y,t_x,t_y,t__dist){
	if(Math.sqrt((t_x-t__x)*(t_x-t__x)+(t_y-t__y)*(t_y-t__y))<=(t__dist)){
		return true;
	}
	return false;
}
c_classRender_Collaborate.prototype.p_Render2=function(t__mouse){
	var t_w=(((bb_collaborate_Collaborate.m_GameWidth)*0.5)|0);
	var t_h=(((bb_collaborate_Collaborate.m_GameHeight)*0.5)|0);
	var t_x=28;
	var t_y=bb_collaborate_Collaborate.m_GameHeight-48;
	var t_ratio=1.0;
	var t_ratio_x=1.0;
	var t_ratio_y=1.0;
	var t_scale=0.5;
	if(bb_defaultmedia_IMG_MAIN!=null){
		this.p_RenderMainImage(t__mouse,true);
		bb_render_collaborate_MENU_START_Y=t_y;
		t_x=t_x+24+this.p_RenderMenu(bb_items_structureTAG,t__mouse,bb_game_fontAngelMini,this.m_currentTAGNode,t_x,t_y);
		if(this.m_selectedTAGNode!=null){
			this.m_selectedTAGNode.m_visible=false;
			this.p_SetHelperState(1);
			bb_game_selectedTAGS.p_AddSubItem3(this.m_selectedTAGNode);
			if(this.m_currentTAGNode.m_parent!=null){
				if(this.m_currentTAGNode.p_Count()==0){
					this.m_currentTAGNode=this.m_currentTAGNode.m_parent;
				}
			}
			this.m_selectedTAGNode=null;
		}
		bb_graphics_DrawImage2(bb_defaultmedia_ICON_SCENT,(t_x),(t_y),0.0,t_scale,t_scale,1);
		if(this.p_Inside2(t__mouse.m_x,t__mouse.m_y,t_x,t_y,32)==true){
			bb_game_MouseOver();
			if(bb_game_inputHit==1){
				this.m_currentTAGNode=bb_items_structureTAG;
				this.p_SetHelperState(0);
			}
		}
		t_x=bb_collaborate_Collaborate.m_GameWidth-32;
		t_y=32;
		t_y=this.p_RenderTagLabel(t__mouse,bb_game_fontAngelMini,bb_game_selectedTAGS,t_x,t_y);
		if(t_y>0){
			t_y=t_y+48;
			t_y=this.p_RenderTagLabelDone(true,t__mouse,bb_game_fontAngelMini,"DONE",130,t_x,t_y,1);
		}
	}
	if(bb_game_inputImageID==true){
		this.p_RenderImageID(t__mouse);
	}
	this.p_RenderHelper2(t__mouse);
	return 0;
}
function c_classRender_ValidateExpert(){
	c_classRender_Collaborate.call(this);
	this.m_currentTagZone=null;
	this.m_currentTagZoneList=c_List.m_new.call(new c_List);
	this.m_currentIteratorZone=null;
	this.m_localMouse=c_sPoint.m_new3.call(new c_sPoint);
}
c_classRender_ValidateExpert.prototype=extend_class(c_classRender_Collaborate);
c_classRender_ValidateExpert.m_new=function(){
	c_classRender_Collaborate.m_new.call(this);
	return this;
}
c_classRender_ValidateExpert.prototype.p_InitZone=function(){
	this.m_currentTagZone=null;
	this.m_currentTagZoneList.p_Clear();
	if(bb_game_originalTAGS.m_subitems==null){
		return false;
	}
	this.m_currentIteratorZone=bb_game_originalTAGS.m_subitems.p_FirstNode();
	if(this.m_currentIteratorZone==null){
		return false;
	}
	if(this.m_currentIteratorZone.p_Value().m_status==0){
		this.m_currentTagZoneList.p_AddLast(this.m_currentIteratorZone.p_Value());
		this.m_currentTagZone=bb_game_originalTAGS.m_subitems.p_First();
	}
	do{
		this.m_currentIteratorZone=this.m_currentIteratorZone.p_NextNode();
		if(this.m_currentIteratorZone==null){
			return true;
		}
		if(this.m_currentIteratorZone.p_Value().m_status==0){
			this.m_currentTagZoneList.p_AddLast(this.m_currentIteratorZone.p_Value());
			if(this.m_currentTagZone==null){
				this.m_currentTagZone=bb_game_originalTAGS.m_subitems.p_First();
			}
		}
	}while(!(this.m_currentIteratorZone==null));
	return true;
}
c_classRender_ValidateExpert.prototype.p_RenderContinue=function(t__enabled,t__mouse,t__font,t__label,t__nextstate,t__nextzone,t__x,t__y,t__align){
	var t_x=t__x;
	var t_y=t__y;
	var t_type=0;
	var t_value=null;
	if(t__enabled==false){
		t_type=3;
	}
	t_value=this.p_RenderLabel(t__font,t__label,"",t_x,t_y,t_type,false,1,t__align);
	if(t__enabled==true){
		if(bb_game_PointInRect((t__mouse.m_x),(t__mouse.m_y),(t_x-((t_value.m_x/2)|0)),(t_y-((t_value.m_y/2)|0)),(t_x+((t_value.m_x/2)|0)),(t_y+((t_value.m_y/2)|0)))==1){
			bb_game_MouseOver();
			t_type=1;
			this.p_RenderLabel(t__font,t__label,"",t_x,t_y,t_type,false,1,t__align);
			if(bb_game_inputHit==1){
				if(t__nextzone==true){
				}else{
					bb_session_GameSession.p_SetState(t__nextstate);
				}
				bb_checkkeys_DelayKeys(0);
			}
		}
	}
	return t_y+t_value.m_y;
}
c_classRender_ValidateExpert.prototype.p_Render=function(t__mouse,t__state){
	var t_x=16;
	var t_y=bb_collaborate_Collaborate.m_GameHeight-48;
	var t_zoom=true;
	var t_y_scroll=0;
	this.m_localMouse.m_x=t__mouse.m_x;
	this.m_localMouse.m_y=t__mouse.m_y;
	if(t__state==108){
		t_zoom=false;
	}
	if(bb_defaultmedia_IMG_MAIN!=null){
		t_x=40;
		t_y=this.m_startY-128;
		bb_graphics_SetColor(0.0,0.0,0.0);
		bb_game_fontAngelMini.p_DrawText2(bb_game_cLANGUAGE.p_GetItem(8)+" ( ID: "+String(bb_game_imageIDSelected)+" )",t_x,t_y,0);
		t_y=t_y+32;
		bb_game_fontAngelMini.p_DrawText2(bb_game_cLANGUAGE.p_GetItem(9),t_x,t_y,0);
		bb_graphics_SetColor(255.0,255.0,255.0);
		this.p_RenderMainImage(t__mouse,t_zoom);
		t_x=bb_collaborate_Collaborate.m_GameWidth-32;
		t_y=bb_collaborate_Collaborate.m_GameHeight-128;
		if(t__state==108){
			t__mouse.m_x=-1000;
			t__mouse.m_y=-1000;
		}
		if(t__state==101 || t__state==108 || t__state==104 || t__state==106){
			if(this.m_currentTagZone!=null){
				if(t__state==104){
					this.p_DrawRectangle(this.m_currentTagZone.m_zone,true,false);
				}else{
					if(t__state==106){
						this.p_DrawRectangle(this.m_currentTagZone.m_zone,false,true);
					}else{
						this.p_DrawRectangle(this.m_currentTagZone.m_zone,false,false);
					}
				}
			}
			t_x=(((bb_collaborate_Collaborate.m_GameWidth)*0.60)|0);
			t_y=this.m_startY-24-4;
			bb_graphics_SetColor(0.0,0.0,0.0);
			bb_game_fontAngelMini.p_DrawText2(bb_game_cLANGUAGE.p_GetItem(10),t_x,t_y,0);
			bb_game_fontAngelMini.p_DrawText2(bb_game_cLANGUAGE.p_GetItem(11),t_x,t_y+28,0);
			bb_graphics_SetColor(255.0,255.0,255.0);
			t_x=(((bb_collaborate_Collaborate.m_GameWidth)*0.60)|0);
			t_y=t_y+80;
			t_y_scroll=t_y;
			t_y=this.p_RenderTagLabelOptionGroupList(t__mouse,bb_game_fontAngelMini,this.m_currentTagZoneList,t_x,t_y);
			this.p_RenderScroll(t__mouse,t_y_scroll);
			this.m_currentTagZone=this.m_RenderTagLabelOptionGroupList_Item;
			if(t__state==101 || t__state==108){
				t_x=(((bb_collaborate_Collaborate.m_GameWidth)*0.80)|0);
				t_y=this.p_RenderContinue(true,t__mouse,bb_game_fontAngelMini,bb_game_cLANGUAGE.p_GetItem(20),102,false,t_x,t_y,1);
				t_x=(((bb_collaborate_Collaborate.m_GameWidth)*0.80)|0);
				t_y=t_y+32;
				t_y=this.p_RenderContinue(true,t__mouse,bb_game_fontAngelMini,bb_game_cLANGUAGE.p_GetItem(22),116,false,t_x,t_y,1);
			}
		}
		if(t__state==108){
			t__mouse.m_x=this.m_localMouse.m_x;
			t__mouse.m_y=this.m_localMouse.m_y;
			bb_graphics_SetColor(0.0,0.0,0.0);
			bb_graphics_SetAlpha(0.5);
			bb_graphics_DrawRect(0.0,0.0,(bb_collaborate_Collaborate.m_GameWidth),(bb_collaborate_Collaborate.m_GameHeight));
			bb_graphics_SetAlpha(1.0);
			bb_graphics_SetColor(255.0,255.0,255.0);
			t_x=32;
			t_y=this.m_zonePhoto.m_h;
			bb_render_collaborate_MENU_START_Y=t_y;
			t_x=t_x+24+this.p_RenderMenu(bb_items_structureTAG,t__mouse,bb_game_fontAngelMini,this.m_currentTagZone,t_x,t_y);
			if(this.m_selectedTAGNode!=null){
				this.m_selectedTAGNode.m_visible=false;
				this.p_SetHelperState(1);
				this.m_selectedTAGNode.m_checked=true;
				this.m_currentTagZone.p_AttachSubObject(this.m_selectedTAGNode,8);
				this.m_selectedTAGNode=null;
				bb_session_GameSession.p_AddValidation();
				bb_session_GameSession.p_AddTag();
				bb_session_GameSession.p_SetState(101);
				bb_checkkeys_DelayKeys(0);
			}
		}
		if(t__state==108){
			if(bb_game_inputHit==1){
				this.m_currentTAGNode=bb_items_structureTAG;
				bb_game_cMANAGEITEMS.p_SetAllUnSelected(bb_items_structureTAG);
				bb_session_GameSession.p_SetState(101);
			}
		}
	}
	if(bb_game_inputImageID==true){
		this.p_RenderImageID(t__mouse);
	}
	this.p_RenderHelper2(t__mouse);
	bb_graphics_SetAlpha(1.0);
	return 0;
}
var bb_game_cRENDER_SCENTVALIDATEEXPERT=null;
var bb_items_structureTAG=null;
function c_manageItems(){
	Object.call(this);
	this.m_parser=null;
	this.m_doc=null;
	this.m_rootElement=null;
}
c_manageItems.m_new=function(){
	return this;
}
c_manageItems.prototype.p_SetVisible=function(t_nodeTAG,t_recursive){
	if(t_nodeTAG==null){
		return false;
	}
	if(t_nodeTAG.m_subitems==null){
		return false;
	}
	var t_=t_nodeTAG.m_subitems.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_item=t_.p_NextObject();
		t_item.m_visible=true;
		if(t_recursive==true){
			this.p_SetVisible(t_item,true);
		}
	}
	return false;
}
c_manageItems.prototype.p_SetAllVisible=function(t_nodeTAG){
	var t_=t_nodeTAG.m_subitems.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_item=t_.p_NextObject();
		t_item.m_visible=true;
		this.p_SetVisible(t_item,true);
	}
	return false;
}
c_manageItems.prototype.p_SetUnSelected=function(t_nodeTAG,t_recursive){
	if(t_nodeTAG==null){
		return false;
	}
	if(t_nodeTAG.m_subitems==null){
		return false;
	}
	var t_=t_nodeTAG.m_subitems.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_item=t_.p_NextObject();
		t_item.m_selected=false;
		if(t_recursive==true){
			this.p_SetUnSelected(t_item,true);
		}
	}
	return false;
}
c_manageItems.prototype.p_SetAllUnSelected=function(t_nodeTAG){
	var t_=t_nodeTAG.m_subitems.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_item=t_.p_NextObject();
		t_item.m_selected=false;
		this.p_SetUnSelected(t_item,true);
	}
	return false;
}
c_manageItems.prototype.p_SetDeleting=function(t_nodeTAG,t_recursive){
	if(t_nodeTAG==null){
		return false;
	}
	if(t_nodeTAG.m_subitems==null){
		return false;
	}
	var t_=t_nodeTAG.m_subitems.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_item=t_.p_NextObject();
		t_item.m_deleting=true;
		if(t_recursive==true){
			this.p_SetDeleting(t_item,true);
		}
	}
	return false;
}
c_manageItems.prototype.p_SetAllDeleting=function(t_nodeTAG){
	var t_=t_nodeTAG.m_subitems.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_item=t_.p_NextObject();
		t_item.m_deleting=true;
		this.p_SetDeleting(t_item,true);
	}
	return false;
}
c_manageItems.prototype.p_StartAnimation=function(t__x,t__y,t_nodeTAG){
	if(t_nodeTAG==null){
		return 0;
	}
	if(t_nodeTAG.m_subitems==null){
		return 0;
	}
	var t_=t_nodeTAG.m_subitems.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_item=t_.p_NextObject();
		t_item.m_timerAnimation=bb_app_Millisecs();
		t_item.m_sorgPos.m_x=t__x;
		t_item.m_sorgPos.m_y=t__y;
	}
	return 0;
}
c_manageItems.prototype.p_SetVisibleFromObjects=function(t__visible,t_nodeTAG,t_refTAG,t_recursive){
	if(t_nodeTAG==null){
		return false;
	}
	if(t_nodeTAG.m_subitems==null){
		return false;
	}
	if(t_refTAG==null){
		return false;
	}
	if(t_refTAG.m_objects==null){
		return false;
	}
	var t_=t_nodeTAG.m_subitems.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_item=t_.p_NextObject();
		var t_2=t_refTAG.m_objects.p_ObjectEnumerator();
		while(t_2.p_HasNext()){
			var t_ref=t_2.p_NextObject();
			if(t_item.m_name==t_ref.m_name && t_item.m_subitems==null){
				t_item.m_visible=t__visible;
			}
		}
		if(t_recursive==true){
			this.p_SetVisibleFromObjects(t__visible,t_item,t_refTAG,true);
		}
	}
	return false;
}
c_manageItems.prototype.p_SetVisibleFrom=function(t__visible,t_nodeTAG,t_refTAG,t_recursive){
	if(t_nodeTAG==null){
		return false;
	}
	if(t_nodeTAG.m_subitems==null){
		return false;
	}
	if(t_refTAG==null){
		return false;
	}
	if(t_refTAG.m_subitems==null){
		return false;
	}
	var t_=t_nodeTAG.m_subitems.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_item=t_.p_NextObject();
		var t_2=t_refTAG.m_subitems.p_ObjectEnumerator();
		while(t_2.p_HasNext()){
			var t_ref=t_2.p_NextObject();
			if(t_item.m_name==t_ref.m_name && t_item.m_subitems==null){
				t_item.m_visible=t__visible;
			}
		}
		if(t_recursive==true){
			this.p_SetVisibleFrom(t__visible,t_item,t_refTAG,true);
		}
	}
	return false;
}
c_manageItems.prototype.p_PrintItem=function(t__name,t__value,t__voice,t__category,t__info){
	return 0;
}
c_manageItems.prototype.p_loadSub=function(t_nodeElement,t_nodeTAG){
	var t_node=null;
	if(t_nodeElement!=null){
		var t_=t_nodeElement.p_GetChildrenByName("item","","","","","","","","","","").p_ObjectEnumerator();
		while(t_.p_HasNext()){
			t_node=t_.p_NextObject();
			var t_name=string_trim(t_node.p_GetAttribute("name",""));
			var t_value=string_trim(t_node.p_GetAttribute("value",""));
			var t_voice=string_trim(t_node.p_GetAttribute("voice",""));
			var t_category=string_trim(t_node.p_GetAttribute("category",""));
			var t_info=string_trim(t_node.p_GetAttribute("info",""));
			this.p_PrintItem(t_name,t_value,t_voice,t_category,t_info);
			var t_newTAG=t_nodeTAG.p_AddSubItem(t_name);
			if(t_voice!=""){
				t_newTAG.m_voice=t_voice;
			}
			if(t_info!=""){
				t_newTAG.m_info=t_info;
			}
			this.p_loadSub(t_node,t_newTAG);
		}
	}
	return false;
}
c_manageItems.prototype.p_load=function(t__file){
	this.m_parser=c_XMLParser.m_new.call(new c_XMLParser);
	this.m_doc=this.m_parser.p_ParseString2(bb_app_LoadString(t__file));
	this.m_rootElement=this.m_doc.p_Root();
	var t_node=null;
	var t_itemElement=this.m_rootElement.p_GetFirstChildByName("taxonomy","","","","","","","","","","");
	if(t_itemElement!=null){
		var t_=t_itemElement.p_GetChildrenByName("item","","","","","","","","","","").p_ObjectEnumerator();
		while(t_.p_HasNext()){
			t_node=t_.p_NextObject();
			var t_name=string_trim(t_node.p_GetAttribute("name",""));
			var t_voice=string_trim(t_node.p_GetAttribute("voice",""));
			var t_value=string_trim(t_node.p_GetAttribute("value",""));
			var t_category=string_trim(t_node.p_GetAttribute("category",""));
			var t_info=string_trim(t_node.p_GetAttribute("info",""));
			this.p_PrintItem(t_name,t_value,t_voice,t_category,t_info);
			var t_newTAG=c_structItems.m_new.call(new c_structItems,null,t_name);
			if(t_voice!=""){
				t_newTAG.m_voice=t_voice;
			}
			if(t_info!=""){
				t_newTAG.m_info=t_info;
			}
			bb_items_structureTAG.p_AddSubItem3(t_newTAG);
			this.p_loadSub(t_node,t_newTAG);
		}
	}
	return false;
}
c_manageItems.prototype.p_GetInfoStringSub=function(t__ref,t_nodeTAG){
	var t_ret="";
	if(t_nodeTAG==null){
		return "";
	}
	if(t_nodeTAG.m_subitems==null){
		return "";
	}
	var t_=t_nodeTAG.m_subitems.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_item=t_.p_NextObject();
		print(t__ref.m_name+" , "+t_item.m_name+" => "+t_item.m_info);
		if(t__ref.m_name==t_item.m_name){
			return t_item.m_info;
		}else{
			t_ret=this.p_GetInfoStringSub(t__ref,t_item);
			if(t_ret!=""){
				return t_ret;
			}
		}
	}
	return "";
}
c_manageItems.prototype.p_GetInfoString=function(t__ref,t_nodeTAG){
	var t_ret="";
	if(t_nodeTAG==null){
		return "";
	}
	var t_=t_nodeTAG.m_subitems.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_item=t_.p_NextObject();
		print(t__ref.m_name+" , "+t_item.m_name+" => "+t_item.m_info);
		if(t__ref.m_name==t_item.m_name){
			return t_item.m_info;
		}else{
			t_ret=this.p_GetInfoStringSub(t__ref,t_item);
			if(t_ret!=""){
				return t_ret;
			}
		}
	}
	return "";
}
var bb_game_cMANAGEITEMS=null;
function c_Enumerator(){
	Object.call(this);
	this.m__list=null;
	this.m__curr=null;
}
c_Enumerator.m_new=function(t_list){
	this.m__list=t_list;
	this.m__curr=t_list.m__head.m__succ;
	return this;
}
c_Enumerator.m_new2=function(){
	return this;
}
c_Enumerator.prototype.p_HasNext=function(){
	while(this.m__curr.m__succ.m__pred!=this.m__curr){
		this.m__curr=this.m__curr.m__succ;
	}
	return this.m__curr!=this.m__list.m__head;
}
c_Enumerator.prototype.p_NextObject=function(){
	var t_data=this.m__curr.m__data;
	this.m__curr=this.m__curr.m__succ;
	return t_data;
}
function c_Widget(){
	Object.call(this);
	this.m_x=.0;
	this.m_y=.0;
	this.m_w=32.0;
	this.m_h=32.0;
	this.m_Input=null;
	this.m_id=-1;
	this.m_name="";
	this.m_Holding=false;
	this.m_Text="";
}
c_Widget.m_new=function(t_x,t_y,t_w,t_h){
	this.m_x=t_x;
	this.m_y=t_y;
	this.m_w=t_w;
	this.m_h=t_h;
	this.m_Input=(c_MousePointer.m_new.call(new c_MousePointer));
	return this;
}
c_Widget.m_new2=function(t_x,t_y,t_w,t_h,t_input){
	this.m_x=t_x;
	this.m_y=t_y;
	this.m_w=t_w;
	this.m_h=t_h;
	this.m_Input=t_input;
	return this;
}
c_Widget.m_new3=function(){
	return this;
}
c_Widget.prototype.p_MouseOver=function(){
}
c_Widget.prototype.p_MouseHit=function(){
}
c_Widget.prototype.p_MouseDown=function(){
}
c_Widget.prototype.p_MouseUp=function(){
}
c_Widget.prototype.p_MouseClick=function(){
}
c_Widget.prototype.p_Poll=function(t_xOffset,t_yOffset){
	var t_inWidget=c_UI.m_WithinRect(this.m_Input.p_x(),this.m_Input.p_y(),this.m_x+t_xOffset,this.m_y+t_yOffset,this.m_w,this.m_h);
	if(t_inWidget){
		this.p_MouseOver();
		if(this.m_Input.p_Hit()){
			this.m_Holding=true;
			this.p_MouseHit();
		}
		if(this.m_Input.p_Down()){
			this.p_MouseDown();
		}
		if(this.m_Input.p_Up()){
			this.p_MouseUp();
			if(this.m_Holding==true){
				this.p_MouseClick();
				this.m_Holding=false;
			}
		}
	}
	if(!this.m_Input.p_Down()){
		this.m_Holding=false;
	}
}
c_Widget.prototype.p_Render3=function(t_xOffset,t_yOffset){
}
function c_TextBox(){
	c_Widget.call(this);
	this.m_skin=(c_DefaultTextboxSkin.m_new.call(new c_DefaultTextboxSkin));
	this.m_hit=false;
	this.m_HasFocus=false;
	this.m_hasReturn=0;
	this.m_chars=c_Stack13.m_new.call(new c_Stack13);
}
c_TextBox.prototype=extend_class(c_Widget);
c_TextBox.m_new=function(t_x,t_y,t_w,t_h,t_Input){
	c_Widget.m_new2.call(this,t_x,t_y,t_w,t_h,t_Input);
	return this;
}
c_TextBox.m_new2=function(t_x,t_y,t_w,t_h,t_skin,t_Input){
	c_Widget.m_new2.call(this,t_x,t_y,t_w,t_h,t_Input);
	this.m_skin=t_skin;
	return this;
}
c_TextBox.m_new3=function(){
	c_Widget.m_new3.call(this);
	return this;
}
c_TextBox.prototype.p_GotFocus=function(){
	this.m_hit=true;
}
c_TextBox.prototype.p_LostFocus=function(){
	this.m_hasReturn=0;
}
c_TextBox.prototype.p_KeyPress=function(t_char){
}
c_TextBox.prototype.p_Poll=function(t_xOffset,t_yOffset){
	c_Widget.prototype.p_Poll.call(this,t_xOffset,t_yOffset);
	this.m_hit=false;
	var t_inWidget=c_UI.m_WithinRect(this.m_Input.p_x(),this.m_Input.p_y(),this.m_x+t_xOffset,this.m_y+t_yOffset,this.m_w,this.m_h);
	if(this.m_Input.p_Hit() && t_inWidget){
		if(this.m_HasFocus==false){
			this.p_GotFocus();
		}
		this.m_HasFocus=true;
	}else{
		if(this.m_Input.p_Hit() && t_inWidget==false){
			if(this.m_HasFocus==true){
				this.p_LostFocus();
			}
			this.m_HasFocus=false;
		}else{
			if(((bb_input_KeyHit(416))!=0) && this.m_HasFocus){
				this.p_LostFocus();
				this.m_HasFocus=false;
			}
		}
	}
	if(this.m_HasFocus){
		this.m_chars.p_Clear();
		var t_char=0;
		do{
			t_char=bb_input_GetChar();
			this.m_chars.p_Push37(t_char);
		}while(!(t_char==0));
		var t_=this.m_chars.p_ObjectEnumerator();
		while(t_.p_HasNext()){
			var t_c=t_.p_NextObject();
			if(t_c>16 && t_c<256 && t_c!=8){
				this.m_Text=this.m_Text+String.fromCharCode(t_c);
			}else{
				if(t_c==13){
					this.m_Text=this.m_Text+(String.fromCharCode(10)+String.fromCharCode(13));
					this.m_hasReturn=1;
				}else{
					if(t_c==8){
						this.m_Text=this.m_Text.slice(0,-1);
					}
				}
			}
			if(t_c>0){
				this.p_KeyPress(t_c);
			}
		}
	}
}
c_TextBox.prototype.p_Render3=function(t_xOffset,t_yOffset){
	this.m_skin.p_Render4(this,t_xOffset,t_yOffset);
}
function c_MousePointer(){
	Object.call(this);
	this.m__hit=false;
	this.m_Holding=false;
	this.m__down=false;
	this.m__up=false;
	this.implments={c_InputPointer:1};
}
c_MousePointer.m_new=function(){
	return this;
}
c_MousePointer.prototype.p_Poll2=function(){
	if(bb_input_MouseHit(0)>0){
		this.m__hit=true;
	}else{
		this.m__hit=false;
	}
	if((bb_input_MouseDown(0))!=0){
		this.m_Holding=true;
		this.m__down=true;
	}else{
		this.m__down=false;
		if(this.m_Holding==true){
			this.m_Holding=false;
			this.m__up=true;
		}else{
			this.m__up=false;
		}
	}
}
c_MousePointer.prototype.p_x=function(){
	return bb_input_MouseX();
}
c_MousePointer.prototype.p_y=function(){
	return bb_input_MouseY();
}
c_MousePointer.prototype.p_Hit=function(){
	return this.m__hit;
}
c_MousePointer.prototype.p_Down=function(){
	return this.m__down;
}
c_MousePointer.prototype.p_Up=function(){
	return this.m__up;
}
function c_ScaledTouchPointer(){
	c_MousePointer.call(this);
	this.implments={c_InputPointer:1};
}
c_ScaledTouchPointer.prototype=extend_class(c_MousePointer);
c_ScaledTouchPointer.m_new=function(){
	c_MousePointer.m_new.call(this);
	return this;
}
c_ScaledTouchPointer.m_dTouchX=function(t_index){
	var t_m=bb_graphics_GetMatrix();
	return ((bb_input_TouchX(t_index)/t_m[0]-t_m[4]/t_m[0])|0);
}
c_ScaledTouchPointer.prototype.p_x=function(){
	return (c_ScaledTouchPointer.m_dTouchX(0));
}
c_ScaledTouchPointer.m_dTouchY=function(t_index){
	var t_m=bb_graphics_GetMatrix();
	return ((bb_input_TouchY(t_index)/t_m[3]-t_m[5]/t_m[3])|0);
}
c_ScaledTouchPointer.prototype.p_y=function(){
	return (c_ScaledTouchPointer.m_dTouchY(0));
}
function c_DefaultTextboxSkin(){
	Object.call(this);
	this.m_textboxfont=c_classSimpleTextBox.m_new.call(new c_classSimpleTextBox,bb_game_fontAngelMini);
	this.implments={c_TextBoxSkin:1};
}
c_DefaultTextboxSkin.m_new=function(){
	return this;
}
c_DefaultTextboxSkin.prototype.p_SetFont=function(t__font){
	this.m_textboxfont.p_SetFont(t__font);
}
c_DefaultTextboxSkin.prototype.p_Render4=function(t_caller,t_x,t_y){
	if(t_caller.m_HasFocus){
		bb_graphics_SetColor(0.0,116.0,200.0);
		bb_graphics_SetAlpha(0.25);
		bb_graphics_DrawRect(t_caller.m_x+t_x,t_caller.m_y+t_y,t_caller.m_w,t_caller.m_h);
	}
	bb_graphics_SetAlpha(0.1);
	bb_graphics_DrawRect(t_caller.m_x+t_x,t_caller.m_y+t_y,t_caller.m_w,t_caller.m_h);
	bb_graphics_SetAlpha(1.0);
	bb_graphics_SetColor(0.0,0.0,0.0);
	this.m_textboxfont.p_Draw(t_caller.m_Text,((t_caller.m_x+t_x+2.0)|0),((t_caller.m_y+t_y+2.0)|0),((t_caller.m_w)|0),0);
	bb_graphics_SetColor(0.0,116.0,200.0);
	bb_graphics_DrawLine(t_caller.m_x+t_x,t_caller.m_y+t_y,t_caller.m_x+t_x,t_caller.m_y+t_y+t_caller.m_h);
	bb_graphics_DrawLine(t_caller.m_x+t_x,t_caller.m_y+t_y,t_caller.m_x+t_x+t_caller.m_w,t_caller.m_y+t_y);
	bb_graphics_DrawLine(t_caller.m_x+t_x+t_caller.m_w+t_y,t_caller.m_y+t_caller.m_h,t_caller.m_x+t_x,t_caller.m_y+t_y+t_caller.m_h);
	bb_graphics_DrawLine(t_caller.m_x+t_x+t_caller.m_w+t_y,t_caller.m_y+t_caller.m_h,t_caller.m_x+t_x+t_caller.m_w,t_caller.m_y+t_y);
}
function c_WidgetManager(){
	Object.call(this);
	this.m_Input=null;
	this.m_Widgets=c_Stack8.m_new.call(new c_Stack8);
	this.m_WidgetsByID=c_IntMap5.m_new.call(new c_IntMap5);
	this.m_WidgetsByName=c_StringMap3.m_new.call(new c_StringMap3);
	this.m_Enabled=true;
}
c_WidgetManager.m_new=function(t_input){
	this.m_Input=t_input;
	return this;
}
c_WidgetManager.prototype.p_Attach=function(t_widget,t_id,t_overrideInput){
	if(t_overrideInput && this.m_Input!=null){
		t_widget.m_Input=this.m_Input;
	}
	if(t_id==-1){
		t_id=t_widget.m_id;
	}
	if(t_id==-1){
		t_id=c_UI.m_GenerateID(this.m_Widgets.p_Length2());
		t_widget.m_id=t_id;
	}
	this.m_Widgets.p_Push22(t_widget);
	this.m_WidgetsByID.p_Add4(t_id,t_widget);
	if(t_widget.m_name!=""){
		var t_ok=this.m_WidgetsByName.p_Add5(t_widget.m_name,t_widget);
		if(!t_ok){
			print("WidgetManager:  Warning, widget '"+t_widget.m_name+"' already exists.");
			print("WidgetManager:  The previous reference has been overwritten.");
		}
	}
	return t_id;
}
c_WidgetManager.m_new2=function(t_widgets,t_input){
	this.m_Input=t_input;
	for(var t_i=0;t_i<t_widgets.length;t_i=t_i+1){
		this.p_Attach(t_widgets[t_i],-1,true);
	}
	return this;
}
c_WidgetManager.m_new3=function(){
	return this;
}
c_WidgetManager.prototype.p_PollAll=function(t_xOffset,t_yOffset){
	if(this.m_Enabled==false){
		return;
	}
	var t_=this.m_Widgets.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_o=t_.p_NextObject();
		t_o.p_Poll(t_xOffset,t_yOffset);
	}
}
c_WidgetManager.prototype.p_RenderAll=function(t_xOffset,t_yOffset){
	if(this.m_Enabled==false){
		return;
	}
	var t_=this.m_Widgets.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_o=t_.p_NextObject();
		t_o.p_Render3(t_xOffset,t_yOffset);
	}
}
function c_Stack8(){
	Object.call(this);
	this.m_data=[];
	this.m_length=0;
}
c_Stack8.m_new=function(){
	return this;
}
c_Stack8.m_new2=function(t_data){
	this.m_data=t_data.slice(0);
	this.m_length=t_data.length;
	return this;
}
c_Stack8.m_NIL=null;
c_Stack8.prototype.p_Length=function(t_newlength){
	if(t_newlength<this.m_length){
		for(var t_i=t_newlength;t_i<this.m_length;t_i=t_i+1){
			this.m_data[t_i]=c_Stack8.m_NIL;
		}
	}else{
		if(t_newlength>this.m_data.length){
			this.m_data=resize_object_array(this.m_data,bb_math_Max(this.m_length*2+10,t_newlength));
		}
	}
	this.m_length=t_newlength;
}
c_Stack8.prototype.p_Length2=function(){
	return this.m_length;
}
c_Stack8.prototype.p_Push22=function(t_value){
	if(this.m_length==this.m_data.length){
		this.m_data=resize_object_array(this.m_data,this.m_length*2+10);
	}
	this.m_data[this.m_length]=t_value;
	this.m_length+=1;
}
c_Stack8.prototype.p_Push23=function(t_values,t_offset,t_count){
	for(var t_i=0;t_i<t_count;t_i=t_i+1){
		this.p_Push22(t_values[t_offset+t_i]);
	}
}
c_Stack8.prototype.p_Push24=function(t_values,t_offset){
	this.p_Push23(t_values,t_offset,t_values.length-t_offset);
}
c_Stack8.prototype.p_ObjectEnumerator=function(){
	return c_Enumerator2.m_new.call(new c_Enumerator2,this);
}
function bb_math_Max(t_x,t_y){
	if(t_x>t_y){
		return t_x;
	}
	return t_y;
}
function bb_math_Max2(t_x,t_y){
	if(t_x>t_y){
		return t_x;
	}
	return t_y;
}
function c_UI(){
	Object.call(this);
}
c_UI.m_GenerateID=function(t_salt){
	return ((bb_random_Rnd2(1.0,16383.0))|0)<<17|t_salt;
}
c_UI.m_WithinRect=function(t_px,t_py,t_x,t_y,t_w,t_h){
	if(t_px>=t_x && t_px<=t_x+t_w && t_py>=t_y && t_py<t_y+t_h){
		return true;
	}else{
		return false;
	}
}
function c_Map7(){
	Object.call(this);
	this.m_root=null;
}
c_Map7.m_new=function(){
	return this;
}
c_Map7.prototype.p_Compare5=function(t_lhs,t_rhs){
}
c_Map7.prototype.p_RotateLeft7=function(t_node){
	var t_child=t_node.m_right;
	t_node.m_right=t_child.m_left;
	if((t_child.m_left)!=null){
		t_child.m_left.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_left){
			t_node.m_parent.m_left=t_child;
		}else{
			t_node.m_parent.m_right=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_left=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map7.prototype.p_RotateRight7=function(t_node){
	var t_child=t_node.m_left;
	t_node.m_left=t_child.m_right;
	if((t_child.m_right)!=null){
		t_child.m_right.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_right){
			t_node.m_parent.m_right=t_child;
		}else{
			t_node.m_parent.m_left=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_right=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map7.prototype.p_InsertFixup7=function(t_node){
	while(((t_node.m_parent)!=null) && t_node.m_parent.m_color==-1 && ((t_node.m_parent.m_parent)!=null)){
		if(t_node.m_parent==t_node.m_parent.m_parent.m_left){
			var t_uncle=t_node.m_parent.m_parent.m_right;
			if(((t_uncle)!=null) && t_uncle.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle.m_color=1;
				t_uncle.m_parent.m_color=-1;
				t_node=t_uncle.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_right){
					t_node=t_node.m_parent;
					this.p_RotateLeft7(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateRight7(t_node.m_parent.m_parent);
			}
		}else{
			var t_uncle2=t_node.m_parent.m_parent.m_left;
			if(((t_uncle2)!=null) && t_uncle2.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle2.m_color=1;
				t_uncle2.m_parent.m_color=-1;
				t_node=t_uncle2.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_left){
					t_node=t_node.m_parent;
					this.p_RotateRight7(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateLeft7(t_node.m_parent.m_parent);
			}
		}
	}
	this.m_root.m_color=1;
	return 0;
}
c_Map7.prototype.p_Add4=function(t_key,t_value){
	var t_node=this.m_root;
	var t_parent=null;
	var t_cmp=0;
	while((t_node)!=null){
		t_parent=t_node;
		t_cmp=this.p_Compare5(t_key,t_node.m_key);
		if(t_cmp>0){
			t_node=t_node.m_right;
		}else{
			if(t_cmp<0){
				t_node=t_node.m_left;
			}else{
				return false;
			}
		}
	}
	t_node=c_Node10.m_new.call(new c_Node10,t_key,t_value,-1,t_parent);
	if((t_parent)!=null){
		if(t_cmp>0){
			t_parent.m_right=t_node;
		}else{
			t_parent.m_left=t_node;
		}
		this.p_InsertFixup7(t_node);
	}else{
		this.m_root=t_node;
	}
	return true;
}
function c_IntMap5(){
	c_Map7.call(this);
}
c_IntMap5.prototype=extend_class(c_Map7);
c_IntMap5.m_new=function(){
	c_Map7.m_new.call(this);
	return this;
}
c_IntMap5.prototype.p_Compare5=function(t_lhs,t_rhs){
	return t_lhs-t_rhs;
}
function c_Node10(){
	Object.call(this);
	this.m_key=0;
	this.m_right=null;
	this.m_left=null;
	this.m_value=null;
	this.m_color=0;
	this.m_parent=null;
}
c_Node10.m_new=function(t_key,t_value,t_color,t_parent){
	this.m_key=t_key;
	this.m_value=t_value;
	this.m_color=t_color;
	this.m_parent=t_parent;
	return this;
}
c_Node10.m_new2=function(){
	return this;
}
function c_Map8(){
	Object.call(this);
	this.m_root=null;
}
c_Map8.m_new=function(){
	return this;
}
c_Map8.prototype.p_Compare4=function(t_lhs,t_rhs){
}
c_Map8.prototype.p_RotateLeft8=function(t_node){
	var t_child=t_node.m_right;
	t_node.m_right=t_child.m_left;
	if((t_child.m_left)!=null){
		t_child.m_left.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_left){
			t_node.m_parent.m_left=t_child;
		}else{
			t_node.m_parent.m_right=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_left=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map8.prototype.p_RotateRight8=function(t_node){
	var t_child=t_node.m_left;
	t_node.m_left=t_child.m_right;
	if((t_child.m_right)!=null){
		t_child.m_right.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_right){
			t_node.m_parent.m_right=t_child;
		}else{
			t_node.m_parent.m_left=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_right=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map8.prototype.p_InsertFixup8=function(t_node){
	while(((t_node.m_parent)!=null) && t_node.m_parent.m_color==-1 && ((t_node.m_parent.m_parent)!=null)){
		if(t_node.m_parent==t_node.m_parent.m_parent.m_left){
			var t_uncle=t_node.m_parent.m_parent.m_right;
			if(((t_uncle)!=null) && t_uncle.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle.m_color=1;
				t_uncle.m_parent.m_color=-1;
				t_node=t_uncle.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_right){
					t_node=t_node.m_parent;
					this.p_RotateLeft8(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateRight8(t_node.m_parent.m_parent);
			}
		}else{
			var t_uncle2=t_node.m_parent.m_parent.m_left;
			if(((t_uncle2)!=null) && t_uncle2.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle2.m_color=1;
				t_uncle2.m_parent.m_color=-1;
				t_node=t_uncle2.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_left){
					t_node=t_node.m_parent;
					this.p_RotateRight8(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateLeft8(t_node.m_parent.m_parent);
			}
		}
	}
	this.m_root.m_color=1;
	return 0;
}
c_Map8.prototype.p_Add5=function(t_key,t_value){
	var t_node=this.m_root;
	var t_parent=null;
	var t_cmp=0;
	while((t_node)!=null){
		t_parent=t_node;
		t_cmp=this.p_Compare4(t_key,t_node.m_key);
		if(t_cmp>0){
			t_node=t_node.m_right;
		}else{
			if(t_cmp<0){
				t_node=t_node.m_left;
			}else{
				return false;
			}
		}
	}
	t_node=c_Node11.m_new.call(new c_Node11,t_key,t_value,-1,t_parent);
	if((t_parent)!=null){
		if(t_cmp>0){
			t_parent.m_right=t_node;
		}else{
			t_parent.m_left=t_node;
		}
		this.p_InsertFixup8(t_node);
	}else{
		this.m_root=t_node;
	}
	return true;
}
function c_StringMap3(){
	c_Map8.call(this);
}
c_StringMap3.prototype=extend_class(c_Map8);
c_StringMap3.m_new=function(){
	c_Map8.m_new.call(this);
	return this;
}
c_StringMap3.prototype.p_Compare4=function(t_lhs,t_rhs){
	return string_compare(t_lhs,t_rhs);
}
function c_Node11(){
	Object.call(this);
	this.m_key="";
	this.m_right=null;
	this.m_left=null;
	this.m_value=null;
	this.m_color=0;
	this.m_parent=null;
}
c_Node11.m_new=function(t_key,t_value,t_color,t_parent){
	this.m_key=t_key;
	this.m_value=t_value;
	this.m_color=t_color;
	this.m_parent=t_parent;
	return this;
}
c_Node11.m_new2=function(){
	return this;
}
var bb_game_fontAngelMini=null;
function c_classRender_Validate(){
	c_classRender_Collaborate.call(this);
	this.m_currentIteratorZone=null;
	this.m_currentTagZone=null;
	this.m_localMouse=c_sPoint.m_new3.call(new c_sPoint);
}
c_classRender_Validate.prototype=extend_class(c_classRender_Collaborate);
c_classRender_Validate.m_new=function(){
	c_classRender_Collaborate.m_new.call(this);
	return this;
}
c_classRender_Validate.prototype.p_InitZone=function(){
	if(bb_game_originalTAGS.m_subitems==null){
		return false;
	}
	this.m_currentIteratorZone=bb_game_originalTAGS.m_subitems.p_FirstNode();
	if(this.m_currentIteratorZone==null){
		return false;
	}
	if(this.m_currentIteratorZone.p_Value().m_status!=0 || this.m_currentIteratorZone.p_Value().m_managed!=true){
		do{
			this.m_currentIteratorZone=this.m_currentIteratorZone.p_NextNode();
			if(this.m_currentIteratorZone==null){
				return false;
			}
		}while(!(this.m_currentIteratorZone.p_Value().m_status==0 && this.m_currentIteratorZone.p_Value().m_managed==true));
	}
	this.m_currentTagZone=this.m_currentIteratorZone.p_Value();
	bb_game_cMANAGEITEMS.p_SetVisibleFromObjects(false,bb_items_structureTAG,this.m_currentTagZone,true);
	return true;
}
c_classRender_Validate.prototype.p_executeNextZone=function(){
	if(this.m_currentIteratorZone.p_NextNode()==null){
		return false;
	}
	bb_game_originalTAGS.p_SetUnChecked();
	this.m_currentIteratorZone=this.m_currentIteratorZone.p_NextNode();
	if(this.m_currentIteratorZone.p_Value().m_status!=0){
		do{
			this.m_currentIteratorZone=this.m_currentIteratorZone.p_NextNode();
			if(this.m_currentIteratorZone==null){
				return false;
			}
			if(this.m_currentIteratorZone.p_NextNode()==null){
				return false;
			}
		}while(!(this.m_currentIteratorZone.p_Value().m_status==0));
	}
	this.m_currentTagZone=this.m_currentIteratorZone.p_Value();
	bb_game_cMANAGEITEMS.p_SetVisibleFromObjects(false,bb_items_structureTAG,this.m_currentTagZone,true);
	return true;
}
c_classRender_Validate.prototype.p_NextZone=function(){
	if(this.m_currentIteratorZone.p_NextNode()==null){
		return false;
	}
	return true;
}
c_classRender_Validate.prototype.p_RenderContinue=function(t__enabled,t__mouse,t__font,t__label,t__nextstate,t__nextzone,t__x,t__y,t__align){
	var t_x=t__x;
	var t_y=t__y;
	var t_type=0;
	var t_value=null;
	if(t__enabled==false){
		t_type=3;
	}
	t_value=this.p_RenderLabel(t__font,t__label,"",t_x,t_y,t_type,false,1,t__align);
	if(t__enabled==true){
		if(bb_game_PointInRect((t__mouse.m_x),(t__mouse.m_y),(t_x-((t_value.m_x/2)|0)),(t_y-((t_value.m_y/2)|0)),(t_x+((t_value.m_x/2)|0)),(t_y+((t_value.m_y/2)|0)))==1){
			bb_game_MouseOver();
			t_type=1;
			this.p_RenderLabel(t__font,t__label,"",t_x,t_y,t_type,false,1,t__align);
			if(bb_game_inputHit==1){
				if(t__nextzone==true){
					if(this.p_NextZone()==false){
						bb_session_GameSession.p_SetState(t__nextstate);
					}else{
						bb_session_GameSession.p_SetState(104);
					}
				}else{
					bb_session_GameSession.p_SetState(t__nextstate);
				}
				bb_checkkeys_DelayKeys(0);
			}
		}
	}
	return t_y+t_value.m_y;
}
c_classRender_Validate.prototype.p_Render=function(t__mouse,t__state){
	var t_x=16;
	var t_y=bb_collaborate_Collaborate.m_GameHeight-48;
	var t_zoom=true;
	this.m_localMouse.m_x=t__mouse.m_x;
	this.m_localMouse.m_y=t__mouse.m_y;
	if(t__state==108){
		t_zoom=false;
	}
	if(bb_defaultmedia_IMG_MAIN!=null){
		t_x=40;
		t_y=this.m_startY-128;
		bb_graphics_SetColor(0.0,0.0,0.0);
		bb_game_fontAngelMini.p_DrawText2(bb_game_cLANGUAGE.p_GetItem(8)+" ( ID: "+String(bb_game_imageIDSelected)+" )",t_x,t_y,0);
		t_y=t_y+32;
		bb_game_fontAngelMini.p_DrawText2(bb_game_cLANGUAGE.p_GetItem(9),t_x,t_y,0);
		bb_graphics_SetColor(255.0,255.0,255.0);
		this.p_RenderMainImage(t__mouse,t_zoom);
		t_x=bb_collaborate_Collaborate.m_GameWidth-32;
		t_y=bb_collaborate_Collaborate.m_GameHeight-128;
		if(t__state==108){
			t__mouse.m_x=-1000;
			t__mouse.m_y=-1000;
		}
		if(t__state==101 || t__state==108 || t__state==104 || t__state==106){
			if(t__state==104){
				this.p_DrawRectangle(this.m_currentTagZone.m_zone,true,false);
			}else{
				if(t__state==106){
					this.p_DrawRectangle(this.m_currentTagZone.m_zone,false,true);
				}else{
					this.p_DrawRectangle(this.m_currentTagZone.m_zone,false,false);
				}
			}
			t_x=(((bb_collaborate_Collaborate.m_GameWidth)*0.60)|0);
			t_y=this.m_startY-24-4;
			bb_graphics_SetColor(0.0,0.0,0.0);
			bb_game_fontAngelMini.p_DrawText2(bb_game_cLANGUAGE.p_GetItem(10),t_x,t_y,0);
			bb_game_fontAngelMini.p_DrawText2(bb_game_cLANGUAGE.p_GetItem(11),t_x,t_y+28,0);
			bb_graphics_SetColor(255.0,255.0,255.0);
			t_x=(((bb_collaborate_Collaborate.m_GameWidth)*0.60)|0);
			t_y=t_y+80;
			t_y=this.p_RenderTagLabelOptionGroup(t__mouse,bb_game_fontAngelMini,this.m_currentTagZone,t_x,t_y);
			if(t__state==101 || t__state==108){
				t_x=(((bb_collaborate_Collaborate.m_GameWidth)*0.80)|0);
				t_y=this.p_RenderContinue(true,t__mouse,bb_game_fontAngelMini,bb_game_cLANGUAGE.p_GetItem(20),102,true,t_x,t_y,1);
				t_y=t_y+32;
				if(this.m_currentTagZone.m_objects==null || this.m_currentTagZone.m_objects.p_Count()<3){
					t_y=this.p_RenderContinue(true,t__mouse,bb_game_fontAngelMini,bb_game_cLANGUAGE.p_GetItem(23),108,false,t_x,t_y,1);
				}else{
					t_y=this.p_RenderContinue(false,t__mouse,bb_game_fontAngelMini,bb_game_cLANGUAGE.p_GetItem(23),108,false,t_x,t_y,1);
				}
				t_x=(((bb_collaborate_Collaborate.m_GameWidth)*0.80)|0);
				t_y=t_y+32;
				t_y=this.p_RenderContinue(true,t__mouse,bb_game_fontAngelMini,bb_game_cLANGUAGE.p_GetItem(21),115,false,t_x,t_y,1);
			}
		}
		if(t__state==108){
			t__mouse.m_x=this.m_localMouse.m_x;
			t__mouse.m_y=this.m_localMouse.m_y;
			bb_graphics_SetColor(0.0,0.0,0.0);
			bb_graphics_SetAlpha(0.5);
			bb_graphics_DrawRect(0.0,0.0,(bb_collaborate_Collaborate.m_GameWidth),(bb_collaborate_Collaborate.m_GameHeight));
			bb_graphics_SetAlpha(1.0);
			bb_graphics_SetColor(255.0,255.0,255.0);
			t_x=32;
			t_y=this.m_zonePhoto.m_h;
			bb_render_collaborate_MENU_START_Y=t_y;
			t_x=t_x+24+this.p_RenderMenu(bb_items_structureTAG,t__mouse,bb_game_fontAngelMini,this.m_currentTagZone,t_x,t_y);
			if(this.m_selectedTAGNode!=null){
				this.m_selectedTAGNode.m_visible=false;
				this.p_SetHelperState(1);
				this.m_selectedTAGNode.m_checked=true;
				this.m_currentTagZone.p_AttachSubObject(this.m_selectedTAGNode,8);
				this.m_selectedTAGNode=null;
				bb_session_GameSession.p_AddValidation();
				bb_session_GameSession.p_AddTag();
				bb_session_GameSession.p_SetState(101);
				bb_checkkeys_DelayKeys(0);
			}
		}
		if(t__state==108){
			if(bb_game_inputHit==1){
				this.m_currentTAGNode=bb_items_structureTAG;
				bb_game_cMANAGEITEMS.p_SetAllUnSelected(bb_items_structureTAG);
				bb_session_GameSession.p_SetState(101);
			}
		}
	}
	if(bb_game_inputImageID==true){
		this.p_RenderImageID(t__mouse);
	}
	this.p_RenderHelper2(t__mouse);
	bb_graphics_SetAlpha(1.0);
	return 0;
}
c_classRender_Validate.prototype.p_RenderOk=function(t__mouse){
	var t_w=800;
	var t_h=300;
	var t_x=(((bb_collaborate_Collaborate.m_GameWidth-t_w)/2)|0);
	var t_y=(((bb_collaborate_Collaborate.m_GameHeight-t_h)/2)|0);
	var t_lim_x=t_x;
	var t_lim_y=t_y;
	bb_graphics_SetColor(40.0,40.0,40.0);
	bb_graphics_DrawRect((t_x),(t_y),(t_w),(t_h));
	bb_graphics_SetColor(255.0,255.0,255.0);
	t_x=((bb_collaborate_Collaborate.m_GameWidth/2)|0);
	t_y=((bb_collaborate_Collaborate.m_GameHeight/2)|0);
	bb_game_fontAngelMini.p_DrawText2(bb_game_cLANGUAGE.p_GetItem(31)+" "+String(bb_game_cSERVER.m_cSERVER_GETSTATGLOBAL.m_mPictureTagged)+" / "+String(bb_game_cSERVER.m_cSERVER_GETSTATGLOBAL.m_uPictureTagged)+" "+bb_game_cLANGUAGE.p_GetItem(32),t_x,t_y-80,1);
	if(bb_game_userIDSelected>0){
		bb_game_fontAngelMini.p_DrawText2(bb_game_cLANGUAGE.p_GetItem(33),t_x,t_y-40,1);
	}
	t_x=((bb_collaborate_Collaborate.m_GameWidth/2)|0)-200;
	t_y=t_y+80;
	this.p_RenderTagLabelDone(true,t__mouse,bb_game_fontAngelMini,bb_game_cLANGUAGE.p_GetItem(25),120,t_x,t_y,1);
	t_x=((bb_collaborate_Collaborate.m_GameWidth/2)|0)+200;
	this.p_RenderTagLabelDone(true,t__mouse,bb_game_fontAngelMini,bb_game_cLANGUAGE.p_GetItem(26),1000,t_x,t_y,1);
	if(bb_game_inputHit==1){
		if(t__mouse.m_x<t_lim_x || t__mouse.m_x>t_lim_x+t_w || t__mouse.m_y<t_lim_y || t__mouse.m_y>t_lim_y+t_h){
			bb_session_GameSession.p_SetState(101);
		}
	}
	return 0;
}
c_classRender_Validate.prototype.p_RenderWIP=function(t__mouse){
	var t_w=800;
	var t_h=300;
	var t_x=(((bb_collaborate_Collaborate.m_GameWidth-t_w)/2)|0);
	var t_y=(((bb_collaborate_Collaborate.m_GameHeight-t_h)/2)|0);
	bb_graphics_SetColor(250.0,250.0,200.0);
	bb_graphics_DrawRect((t_x),(t_y),(t_w),(t_h));
	bb_graphics_SetColor(0.0,0.0,0.0);
	t_x=((bb_collaborate_Collaborate.m_GameWidth/2)|0);
	t_y=((bb_collaborate_Collaborate.m_GameHeight/2)|0);
	bb_game_fontAngelMini.p_DrawText2("Work In Progress",t_x,t_y-80,1);
	bb_graphics_SetColor(255.0,255.0,255.0);
	return 0;
}
var bb_game_cRENDER_SCENTVALIDATE=null;
function c_classRender_Tag(){
	c_classRender_Collaborate.call(this);
	this.m_zone=c_sRect.m_new.call(new c_sRect);
}
c_classRender_Tag.prototype=extend_class(c_classRender_Collaborate);
c_classRender_Tag.m_new=function(){
	c_classRender_Collaborate.m_new.call(this);
	return this;
}
c_classRender_Tag.prototype.p_RenderZone=function(t__mouse,t__x,t__y){
	if(this.m_zone.m_w==0 && this.m_zone.m_h==0){
		return 0;
	}
	bb_graphics_SetAlpha(0.5);
	bb_graphics_SetColor(235.0,235.0,0.0);
	bb_graphics_DrawRect((t__x+this.m_zone.m_x),(t__y+this.m_zone.m_y),(this.m_zone.m_w),(this.m_zone.m_h));
	bb_graphics_SetColor(255.0,255.0,255.0);
	bb_graphics_SetAlpha(1.0);
	return 0;
}
c_classRender_Tag.prototype.p_Render=function(t__mouse,t__state){
	var t_w=(((bb_collaborate_Collaborate.m_GameWidth)*0.5)|0);
	var t_h=(((bb_collaborate_Collaborate.m_GameHeight)*0.5)|0);
	var t_x=16;
	var t_y=bb_collaborate_Collaborate.m_GameHeight-48;
	var t_ratio=1.0;
	var t_ratio_x=1.0;
	var t_ratio_y=1.0;
	var t_scale=0.5;
	var t_zoom=true;
	if(t__state==122){
		t_zoom=false;
	}
	if(bb_defaultmedia_IMG_MAIN!=null){
		t_x=40;
		t_y=this.m_startY-128;
		bb_graphics_SetColor(0.0,0.0,0.0);
		bb_game_fontAngelMini.p_DrawText2(bb_game_cLANGUAGE.p_GetItem(8)+" ( ID: "+String(bb_game_imageIDSelected)+" )",t_x,t_y,0);
		t_y=t_y+32;
		bb_game_fontAngelMini.p_DrawText2(bb_game_cLANGUAGE.p_GetItem(9),t_x,t_y,0);
		bb_graphics_SetColor(255.0,255.0,255.0);
		this.p_RenderMainImage(t__mouse,t_zoom);
		t_x=bb_collaborate_Collaborate.m_GameWidth-32;
		t_y=bb_collaborate_Collaborate.m_GameHeight-128;
		if(t__state==121 || t__state==122 || t__state==123){
			t_x=(((bb_collaborate_Collaborate.m_GameWidth)*0.60)|0);
			t_y=this.m_startY-24-4;
			bb_graphics_SetColor(0.0,0.0,0.0);
			bb_game_fontAngelMini.p_DrawText2(bb_game_cLANGUAGE.p_GetItem(15)+": ",t_x,t_y,0);
			t_y=t_y+32;
			bb_graphics_SetColor(255.0,0.0,0.0);
			bb_game_fontAngelMini.p_DrawText2(bb_game_cLANGUAGE.p_GetItem(16),t_x,t_y,0);
			bb_graphics_SetColor(255.0,255.0,255.0);
			t_x=(((bb_collaborate_Collaborate.m_GameWidth)*0.80)|0);
			t_y=t_y+48+16;
			if(bb_game_selectedTAGS.m_subitems==null || bb_game_selectedTAGS.m_subitems.p_Count()<3){
				t_y=this.p_RenderTagLabelDone(true,t__mouse,bb_game_fontAngelMini,bb_game_cLANGUAGE.p_GetItem(23),122,t_x,t_y,1);
			}else{
				t_y=this.p_RenderTagLabelDone(false,t__mouse,bb_game_fontAngelMini,bb_game_cLANGUAGE.p_GetItem(23),122,t_x,t_y,1);
			}
			bb_graphics_SetColor(255.0,255.0,255.0);
			t_x=bb_collaborate_Collaborate.m_GameWidth-48;
			t_y=t_y+32;
			t_y=this.p_RenderTagLabel(t__mouse,bb_game_fontAngelMini,bb_game_selectedTAGS,t_x,t_y);
			if(t_y>0){
				t_y=t_y+8;
				t_y=t_y+16;
			}
			t_x=(((bb_collaborate_Collaborate.m_GameWidth)*0.80)|0);
			t_y=this.p_RenderTagLabelDone(true,t__mouse,bb_game_fontAngelMini,bb_game_cLANGUAGE.p_GetItem(20),130,t_x,t_y,1);
			this.p_RenderTagUsed(t__mouse,bb_game_fontAngelMini,bb_game_originalTAGS,bb_game_selectedTAGS,(((bb_collaborate_Collaborate.m_GameWidth)*0.60)|0),t_y);
			if(t__state==122){
				bb_graphics_SetColor(0.0,0.0,0.0);
				bb_graphics_SetAlpha(0.5);
				bb_graphics_DrawRect(0.0,0.0,(bb_collaborate_Collaborate.m_GameWidth),(bb_collaborate_Collaborate.m_GameHeight));
				bb_graphics_SetAlpha(1.0);
				bb_graphics_SetColor(255.0,255.0,255.0);
				t_x=32;
				t_y=this.m_zonePhoto.m_h;
				bb_render_collaborate_MENU_START_Y=t_y;
				t_x=t_x+24+this.p_RenderMenu(bb_items_structureTAG,t__mouse,bb_game_fontAngelMini,this.m_currentTAGNode,t_x,t_y);
				if(this.m_selectedTAGNode!=null){
					this.m_selectedTAGNode.m_visible=false;
					this.p_SetHelperState(1);
					this.m_selectedTAGNode.m_zone=c_sRect.m_new2.call(new c_sRect,0,0,bb_defaultmedia_IMG_MAIN.p_Width(),bb_defaultmedia_IMG_MAIN.p_Height());
					bb_game_selectedTAGS.p_AddSubItem3(this.m_selectedTAGNode);
					if(this.m_currentTAGNode.m_parent!=null){
						if(this.m_currentTAGNode.p_Count()==0){
							this.m_currentTAGNode=this.m_currentTAGNode.m_parent;
						}
					}
					this.m_selectedTAGNode=null;
					bb_session_GameSession.p_SetState(121);
					bb_checkkeys_DelayKeys(0);
				}
			}
			if(t__state==122){
				if(bb_game_inputHit==1){
					this.m_currentTAGNode=bb_items_structureTAG;
					bb_game_cMANAGEITEMS.p_SetAllUnSelected(bb_items_structureTAG);
					bb_session_GameSession.p_SetState(121);
				}
			}
			if(t__state==123){
				if(this.m_currentSelectedZone.m_zoneModify==true){
					if(bb_game_inputPress==1){
						this.m_zone.m_x=bb_game_startTouchHit.m_x-this.m_startX;
						this.m_zone.m_y=bb_game_startTouchHit.m_y-this.m_startY;
						this.m_zone.m_w=t__mouse.m_x-bb_game_startTouchHit.m_x;
						this.m_zone.m_h=t__mouse.m_y-bb_game_startTouchHit.m_y;
					}
					if(bb_game_inputRelease==1 && bb_game_inputPress==0){
						if(this.m_zone.m_w!=0 && this.m_zone.m_h!=0){
							this.m_zone.p_repair();
							this.m_zone.p_limit(t_w,t_h);
							this.m_currentSelectedZone.m_zone.m_x=(((this.m_zone.m_x)/this.m_ratioPhoto)|0);
							this.m_currentSelectedZone.m_zone.m_y=(((this.m_zone.m_y)/this.m_ratioPhoto)|0);
							this.m_currentSelectedZone.m_zone.m_w=(((this.m_zone.m_w)/this.m_ratioPhoto)|0);
							this.m_currentSelectedZone.m_zone.m_h=(((this.m_zone.m_h)/this.m_ratioPhoto)|0);
							if(this.m_currentSelectedZone.m_zone.m_x<0){
								this.m_currentSelectedZone.m_zone.m_x=0;
							}
							if(this.m_currentSelectedZone.m_zone.m_y<0){
								this.m_currentSelectedZone.m_zone.m_y=0;
							}
							if(this.m_currentSelectedZone.m_zone.m_x+this.m_currentSelectedZone.m_zone.m_w>=bb_defaultmedia_IMG_MAIN.p_Width()){
								this.m_currentSelectedZone.m_zone.m_w=bb_defaultmedia_IMG_MAIN.p_Width()-this.m_currentSelectedZone.m_zone.m_x;
							}
							if(this.m_currentSelectedZone.m_zone.m_y+this.m_currentSelectedZone.m_zone.m_h>=bb_defaultmedia_IMG_MAIN.p_Height()){
								this.m_currentSelectedZone.m_zone.m_h=bb_defaultmedia_IMG_MAIN.p_Height()-this.m_currentSelectedZone.m_zone.m_y;
							}
							this.m_zone.p_clear();
						}
					}
				}
				this.p_RenderZone(t__mouse,this.m_startX,this.m_startY);
				if(this.m_currentSelectedZone!=null){
					this.p_DrawRectangle(this.m_currentSelectedZone.m_zone,false,false);
				}
			}
		}
	}
	this.p_RenderHelper2(t__mouse);
	bb_graphics_SetAlpha(1.0);
	return 0;
}
c_classRender_Tag.prototype.p_RenderOk=function(t__mouse){
	var t_w=800;
	var t_h=300;
	var t_x=(((bb_collaborate_Collaborate.m_GameWidth-t_w)/2)|0);
	var t_y=(((bb_collaborate_Collaborate.m_GameHeight-t_h)/2)|0);
	var t_lim_x=t_x;
	var t_lim_y=t_y;
	bb_graphics_SetColor(40.0,40.0,40.0);
	bb_graphics_DrawRect((t_x),(t_y),(t_w),(t_h));
	bb_graphics_SetColor(255.0,255.0,255.0);
	t_x=((bb_collaborate_Collaborate.m_GameWidth/2)|0);
	t_y=((bb_collaborate_Collaborate.m_GameHeight/2)|0);
	bb_game_fontAngelMini.p_DrawText2(bb_game_cLANGUAGE.p_GetItem(30),t_x,t_y-80,1);
	if(bb_game_selectedTAGS.m_subitems!=null){
		if(bb_game_selectedTAGS.m_subitems.p_Count()>0){
			bb_game_fontAngelMini.p_DrawText2(bb_game_cLANGUAGE.p_GetItem(33),t_x,t_y-40,1);
		}
	}
	t_x=((bb_collaborate_Collaborate.m_GameWidth/2)|0);
	t_y=t_y+80;
	this.p_RenderTagLabelDone(true,t__mouse,bb_game_fontAngelMini,bb_game_cLANGUAGE.p_GetItem(26),1000,t_x,t_y,1);
	if(bb_game_inputHit==1){
		if(t__mouse.m_x<t_lim_x || t__mouse.m_x>t_lim_x+t_w || t__mouse.m_y<t_lim_y || t__mouse.m_y>t_lim_y+t_h){
			bb_session_GameSession.p_SetState(121);
		}
	}
	return 0;
}
c_classRender_Tag.prototype.p_RenderWIP=function(t__mouse){
	var t_w=800;
	var t_h=300;
	var t_x=(((bb_collaborate_Collaborate.m_GameWidth-t_w)/2)|0);
	var t_y=(((bb_collaborate_Collaborate.m_GameHeight-t_h)/2)|0);
	bb_graphics_SetColor(250.0,250.0,200.0);
	bb_graphics_DrawRect((t_x),(t_y),(t_w),(t_h));
	bb_graphics_SetColor(0.0,0.0,0.0);
	t_x=((bb_collaborate_Collaborate.m_GameWidth/2)|0);
	t_y=((bb_collaborate_Collaborate.m_GameHeight/2)|0);
	bb_game_fontAngelMini.p_DrawText2("Work In Progress",t_x,t_y-80,1);
	bb_graphics_SetColor(255.0,255.0,255.0);
	return 0;
}
var bb_game_cRENDER_SCENTTAG=null;
function c_classRender_Focus(){
	c_classRender_Collaborate.call(this);
	this.m_zone=c_sRect.m_new.call(new c_sRect);
}
c_classRender_Focus.prototype=extend_class(c_classRender_Collaborate);
c_classRender_Focus.m_new=function(){
	c_classRender_Collaborate.m_new.call(this);
	return this;
}
c_classRender_Focus.prototype.p_Clear=function(){
	this.m_zone=c_sRect.m_new.call(new c_sRect);
	bb_game_selectedTAGS.p_Clear();
	return 0;
}
c_classRender_Focus.prototype.p_RenderZone=function(t__mouse,t__x,t__y){
	if(this.m_zone.m_w==0 && this.m_zone.m_h==0){
		return 0;
	}
	bb_graphics_SetAlpha(0.5);
	bb_graphics_SetColor(255.0,0.0,0.0);
	bb_graphics_DrawRect((t__x+this.m_zone.m_x),(t__y+this.m_zone.m_y),(this.m_zone.m_w),(this.m_zone.m_h));
	bb_graphics_SetColor(255.0,255.0,255.0);
	bb_graphics_SetAlpha(1.0);
	return 0;
}
c_classRender_Focus.prototype.p_RenderTag=function(t__mouse){
	var t_ret=0;
	var t_x=48;
	var t_y=bb_collaborate_Collaborate.m_GameHeight-48;
	t_x=t_x+16+this.p_RenderMenu(bb_items_structureTAG,t__mouse,bb_game_fontAngelMini,this.m_currentTAGNode,t_x,t_y);
	t_ret=t_x;
	t_x=bb_collaborate_Collaborate.m_GameWidth-32;
	t_y=48;
	t_y=this.p_RenderTagLabel(t__mouse,bb_game_fontAngelMini,bb_game_selectedTAGS,t_x,t_y);
	if(t_y>0){
		t_y=this.p_RenderTagLabelDone(true,t__mouse,bb_game_fontAngelMini,"NEXT OBJECT",300,t_x,t_y,1);
		t_y=t_y+24;
		t_y=this.p_RenderTagLabelDone(true,t__mouse,bb_game_fontAngelMini,"DONE",130,t_x,t_y,1);
	}
	return t_ret;
}
c_classRender_Focus.prototype.p_Render=function(t__mouse,t__state){
	var t_w=(((bb_collaborate_Collaborate.m_GameWidth)*0.5)|0);
	var t_h=(((bb_collaborate_Collaborate.m_GameHeight)*0.5)|0);
	var t_x=48;
	var t_y=bb_collaborate_Collaborate.m_GameHeight-48;
	var t_ratio=1.0;
	var t_ratio_x=1.0;
	var t_ratio_y=1.0;
	var t_scale=0.5;
	t_w=(((bb_collaborate_Collaborate.m_GameWidth)*0.75)|0);
	t_h=(((bb_collaborate_Collaborate.m_GameHeight)*0.75)|0);
	if(bb_defaultmedia_IMG_MAIN!=null){
		t_ratio_x=(t_w)/(bb_defaultmedia_IMG_MAIN.p_Width());
		t_ratio_y=(t_h)/(bb_defaultmedia_IMG_MAIN.p_Height());
		t_ratio=t_ratio_x;
		if(t_ratio>t_ratio_y){
			t_ratio=t_ratio_y;
		}
		t_w=(((bb_defaultmedia_IMG_MAIN.p_Width())*t_ratio)|0);
		t_h=(((bb_defaultmedia_IMG_MAIN.p_Height())*t_ratio)|0);
		bb_graphics_DrawImage2(bb_defaultmedia_IMG_MAIN,(this.m_startX),(this.m_startY),0.0,t_ratio,t_ratio,0);
		if(t__state==300){
			if(bb_game_inputPress==1){
				this.m_zone.m_x=bb_game_startTouchHit.m_x-this.m_startX;
				this.m_zone.m_y=bb_game_startTouchHit.m_y-this.m_startY;
				this.m_zone.m_w=t__mouse.m_x-bb_game_startTouchHit.m_x;
				this.m_zone.m_h=t__mouse.m_y-bb_game_startTouchHit.m_y;
			}
			t_x=bb_collaborate_Collaborate.m_GameWidth-32;
			t_y=bb_collaborate_Collaborate.m_GameHeight-128;
			bb_graphics_SetColor(0.0,0.0,0.0);
			bb_game_fontAngelTitle.p_DrawText2("Identify a specific part of the picture",t_x,t_y,2);
			t_y=t_y+bb_game_fontAngelTitle.p_TextHeight("Identify a specific part of the picture");
			bb_game_fontAngelMini.p_DrawText2("Use your mouse to identify the part in photo",t_x,t_y,2);
			bb_graphics_SetColor(255.0,255.0,255.0);
		}
		this.p_RenderZone(t__mouse,16,16);
		t_x=48;
		t_y=bb_collaborate_Collaborate.m_GameHeight-48;
		if(t__state==301){
			t_x=t_x+this.p_RenderTag(t__mouse);
		}else{
			t_x=t_x+this.m_startX;
		}
		if(this.m_selectedTAGNode!=null){
			this.m_selectedTAGNode.m_visible=false;
			this.p_SetHelperState(1);
			bb_game_selectedTAGS.p_AddSubItem3(this.m_selectedTAGNode);
			if(this.m_currentTAGNode.m_parent!=null){
				if(this.m_currentTAGNode.p_Count()==0){
					this.m_currentTAGNode=this.m_currentTAGNode.m_parent;
				}
			}
			this.m_selectedTAGNode=null;
		}
		if(t__state==301){
			bb_graphics_DrawImage2(bb_defaultmedia_ICON_SCENT,(t_x),(t_y),0.0,t_scale,t_scale,1);
			if(this.p_Inside2(t__mouse.m_x,t__mouse.m_y,t_x,t_y,32)==true){
				bb_game_MouseOver();
				if(bb_game_inputHit==1){
					bb_session_GameSession.p_SetState(300);
					this.m_currentTAGNode=bb_items_structureTAG;
					this.m_selectedTAGNode=null;
					this.p_SetHelperState(0);
				}
			}
		}
		if(this.m_currentTAGNode.m_parent!=null){
			t_x=t_x+16+64;
			bb_graphics_DrawImage2(bb_defaultmedia_ICON_SCENT,(t_x),(t_y),0.0,t_scale,t_scale,4);
			if(this.p_Inside2(t__mouse.m_x,t__mouse.m_y,t_x,t_y,32)==true){
				bb_game_MouseOver();
				if(bb_game_inputHit==1){
					if(this.m_currentTAGNode.m_parent!=null){
						this.m_currentTAGNode=this.m_currentTAGNode.m_parent;
					}
					this.p_SetHelperState(0);
				}
			}
		}
	}
	this.p_RenderHelper2(t__mouse);
	if(t__state==300){
		if(bb_game_inputRelease==1 && bb_game_inputPress==0){
			if(this.m_zone.m_w!=0 && this.m_zone.m_h!=0){
				this.m_zone.p_repair();
				this.m_zone.p_limit(t_w,t_h);
				bb_session_GameSession.p_SetState(301);
			}
		}
	}
	bb_graphics_SetAlpha(1.0);
	return 0;
}
var bb_game_cRENDER_SCENTFOCUS=null;
function c_sRect(){
	Object.call(this);
	this.m_x=0;
	this.m_y=0;
	this.m_w=0;
	this.m_h=0;
}
c_sRect.m_new=function(){
	this.m_x=0;
	this.m_y=0;
	this.m_w=0;
	this.m_h=0;
	return this;
}
c_sRect.m_new2=function(t__x,t__y,t__w,t__h){
	this.m_x=t__x;
	this.m_y=t__y;
	this.m_w=t__w;
	this.m_h=t__h;
	return this;
}
c_sRect.m_new3=function(t__other){
	this.m_x=t__other.m_x;
	this.m_y=t__other.m_y;
	this.m_w=t__other.m_w;
	this.m_h=t__other.m_h;
	return this;
}
c_sRect.prototype.p_repair=function(){
	if(this.m_w<0){
		this.m_x=this.m_x+this.m_w;
		this.m_w=-this.m_w;
	}
	if(this.m_h<0){
		this.m_y=this.m_y+this.m_h;
		this.m_h=-this.m_h;
	}
	return 0;
}
c_sRect.prototype.p_limit=function(t__w,t__h){
	if(this.m_x<0){
		this.m_x=0;
	}
	if(this.m_y<0){
		this.m_y=0;
	}
	if(this.m_x+this.m_w>t__w){
		this.m_w=t__w-this.m_x;
	}
	if(this.m_y+this.m_h>t__h){
		this.m_h=t__h-this.m_y;
	}
	return 0;
}
c_sRect.prototype.p_clear=function(){
	this.m_x=0;
	this.m_y=0;
	this.m_w=0;
	this.m_h=0;
	return 0;
}
function c_classRender_Annotate(){
	c_classRender_Collaborate.call(this);
	this.m_annotation="";
	this.m_textBox=null;
}
c_classRender_Annotate.prototype=extend_class(c_classRender_Collaborate);
c_classRender_Annotate.m_new=function(){
	c_classRender_Collaborate.m_new.call(this);
	return this;
}
c_classRender_Annotate.prototype.p_Init=function(){
	this.m_annotation="";
	this.m_textBox=c_TextBox.m_new.call(new c_TextBox,(bb_collaborate_Collaborate.m_GameWidth)*0.60,96.0,(bb_collaborate_Collaborate.m_GameWidth)*0.30,(bb_collaborate_Collaborate.m_GameHeight)*0.50,(this.m_Cursor));
	this.m_widgets=c_WidgetManager.m_new.call(new c_WidgetManager,(this.m_Cursor));
	this.m_widgets.p_Attach((this.m_textBox),-1,true);
	this.m_textBox.m_skin.p_SetFont(bb_game_fontAngelMini);
	return 0;
}
c_classRender_Annotate.prototype.p_Update=function(){
	this.m_Cursor.p_Poll2();
	this.m_widgets.p_PollAll(0.0,0.0);
	return 0;
}
c_classRender_Annotate.prototype.p_Render2=function(t__mouse){
	var t_w=(((bb_collaborate_Collaborate.m_GameWidth)*0.5)|0);
	var t_h=(((bb_collaborate_Collaborate.m_GameHeight)*0.5)|0);
	var t_x=48;
	var t_y=bb_collaborate_Collaborate.m_GameHeight-48;
	var t_ratio=1.0;
	var t_ratio_x=1.0;
	var t_ratio_y=1.0;
	var t_scale=0.5;
	t_w=(((bb_collaborate_Collaborate.m_GameWidth)*0.75)|0);
	t_h=(((bb_collaborate_Collaborate.m_GameHeight)*0.75)|0);
	if(bb_defaultmedia_IMG_MAIN!=null){
		t_ratio_x=(t_w)/(bb_defaultmedia_IMG_MAIN.p_Width());
		t_ratio_y=(t_h)/(bb_defaultmedia_IMG_MAIN.p_Height());
		t_ratio=t_ratio_x;
		if(t_ratio>t_ratio_y){
			t_ratio=t_ratio_y;
		}
		bb_graphics_DrawImage2(bb_defaultmedia_IMG_MAIN,16.0,16.0,0.0,t_ratio,t_ratio,0);
		this.m_widgets.p_RenderAll(0.0,0.0);
		t_x=bb_collaborate_Collaborate.m_GameWidth-128;
		t_y=64;
		this.p_RenderTagLabelDone(true,t__mouse,bb_game_fontAngelMini,"DONE",130,t_x,t_y,1);
	}
	this.p_RenderHelper2(t__mouse);
	return 0;
}
var bb_game_cRENDER_SCENTANNOTATE=null;
function c_classRender_Error(){
	Object.call(this);
	this.m_timerReloadImage=0;
}
c_classRender_Error.m_new=function(){
	return this;
}
c_classRender_Error.prototype.p_Init=function(){
	this.m_timerReloadImage=bb_app_Millisecs();
	return 0;
}
c_classRender_Error.prototype.p_Render=function(t__mouse,t__state){
	var t_x=((bb_collaborate_Collaborate.m_GameWidth/2)|0);
	var t_y=((bb_collaborate_Collaborate.m_GameHeight/2)|0);
	var t_size=0.8;
	var t_angle=bb_math_Abs((bb_app_Millisecs()/15)|0) % 360;
	if(t__state==109){
		bb_graphics_SetColor(0.0,0.0,0.0);
		bb_game_fontAngelMini.p_DrawText2(bb_game_cLANGUAGE.p_GetItem(5),t_x,t_y-128,1);
		bb_graphics_SetColor(255.0,255.0,255.0);
		t_size=0.75;
		if(t__mouse.p_Inside(t_x,t_y+64,80)){
			t_size=1.0;
			bb_game_MouseOver();
			if(bb_game_inputHit==1){
				this.m_timerReloadImage=bb_app_Millisecs();
				bb_session_GameSession.p_SetState(3);
				return 0;
			}
			if(bb_math_Abs(bb_app_Millisecs()-this.m_timerReloadImage)>7000){
				this.m_timerReloadImage=bb_app_Millisecs();
				bb_session_GameSession.p_SetState(3);
				return 0;
			}
		}
		bb_graphics_DrawImage2(bb_defaultmedia_ICON_REFRESH,(t_x),(t_y+64),0.0,t_size,t_size,0);
	}
	return 0;
}
var bb_game_cRENDER_ERROR=null;
function c_classConvert(){
	Object.call(this);
}
c_classConvert.m_new=function(){
	return this;
}
c_classConvert.prototype.p_Convert=function(t__userID,t__newtag){
	var t_convert="";
	if(t__newtag!=null && t__newtag.m_subitems!=null){
		var t_=t__newtag.m_subitems.p_ObjectEnumerator();
		while(t_.p_HasNext()){
			var t_item=t_.p_NextObject();
			if(t_item.m_deleting==true){
				t_convert=t_convert+"{\"userId\":"+String(t__userID)+",";
				t_convert=t_convert+"\"boundingBox\":{";
				t_convert=t_convert+"\"left\":"+String(t_item.m_zone.m_x)+",";
				t_convert=t_convert+"\"top\":"+String(t_item.m_zone.m_y)+",";
				t_convert=t_convert+"\"width\":"+String(t_item.m_zone.m_w)+",";
				t_convert=t_convert+"\"height\":"+String(t_item.m_zone.m_h);
				t_convert=t_convert+"}";
				t_convert=t_convert+",";
				t_convert=t_convert+"\"objects\":[";
				t_convert=t_convert+"{";
				t_convert=t_convert+"\"tag\":\""+t_item.m_name+"\",";
				t_convert=t_convert+"\"status\":"+"\"undecided\"";
				t_convert=t_convert+"}";
				t_convert=t_convert+"]}";
				if(t_item!=t__newtag.m_subitems.p_Last()){
					t_convert=t_convert+",";
				}
			}
		}
	}
	if(string_endswith(t_convert,",")==true){
		t_convert=t_convert.slice(0,t_convert.length-1);
	}
	return t_convert;
}
c_classConvert.prototype.p_Attach2=function(t__userID,t__original,t__originalString,t__collaborateString){
	var t_originalString="";
	var t_returnString="";
	var t_findString="\"classification\":";
	var t_endString="";
	var t_json=null;
	var t_jsonImageID=-1;
	var t_jsonID=-1;
	var t_jsonStatus="";
	var t_jsonStatusDesc="";
	var t_jsonTakenAt=-1;
	var t_jsonSource=null;
	var t_jsonClassification=null;
	var t_jsonClassificationCollaborate=null;
	var t_jsonClassificationCollaborateboundingBox=null;
	var t_jsonClassificationCollaborateobjects=null;
	var t_jsonClassificationCollaboratevalidation=null;
	var t_jsonClassificationSIE=null;
	var t_jsonClassificationSIEboundingBox=null;
	var t_jsonClassificationSIEobjects=null;
	var t_jsonClassificationSIEvalidation=null;
	var t_jsonClassificationOP=null;
	var t_jsonClassificationExplore=null;
	var t_jsonClassificationExploreObjects=null;
	var t_jsonClassificationExploreValidation=null;
	var t_jsonGeoCamCoor=null;
	var t_jsonAngCamOrient=null;
	var t_jsonWaterLevel=null;
	var t_jsonObjects=null;
	var t_jsonObjectsItem=null;
	var t_jsonValidations=null;
	var t_jsonValidationItem=null;
	var t_jsonBoundingBox=null;
	var t_validazione="";
	if(t__originalString==""){
		return "";
	}
	t_originalString=t__originalString;
	t_json=(c_JsonObject.m_new3.call(new c_JsonObject,t__originalString));
	if(t_json==null){
		return "";
	}
	if(t_json.p_Contains("imageId")==true){
		t_jsonImageID=t_json.p_GetInt2("imageId",0);
		bb_game_imageIDSelected=t_jsonImageID;
	}
	if(t_json.p_Contains("id")==true){
		t_jsonID=t_json.p_GetInt2("id",0);
		bb_game_imageIDSelected=t_jsonID;
	}
	if(t_json.p_Contains("status")==true){
		t_jsonStatus="annotated";
	}
	if(t_json.p_Contains("statusDesc")==true){
		t_jsonStatusDesc=t_json.p_GetString2("statusDesc","");
	}
	if(t_json.p_Contains("takenAt")==true){
		t_jsonTakenAt=t_json.p_GetInt2("takenAt",0);
	}
	t_jsonSource=object_downcast((t_json.p_Get7("source",null)),c_JsonObject);
	t_jsonClassification=object_downcast((t_json.p_Get7("classification",null)),c_JsonObject);
	if(t_jsonClassification!=null){
		t_jsonClassificationOP=object_downcast((t_jsonClassification.p_Get7("OP",null)),c_JsonArray);
		t_jsonClassificationSIE=object_downcast((t_jsonClassification.p_Get7("SIE",null)),c_JsonArray);
		t_jsonClassificationCollaborate=object_downcast((t_jsonClassification.p_Get7("collaborate",null)),c_JsonArray);
		t_jsonClassificationExplore=object_downcast((t_jsonClassification.p_Get7("explore",null)),c_JsonObject);
	}
	t_jsonGeoCamCoor=object_downcast((t_json.p_Get7("geoCamCoor",null)),c_JsonObject);
	t_jsonAngCamOrient=object_downcast((t_json.p_Get7("angCamOrient",null)),c_JsonObject);
	t_jsonWaterLevel=object_downcast((t_json.p_Get7("waterLevel",null)),c_JsonObject);
	t_returnString="{";
	if(t_jsonImageID!=-1){
		t_returnString=t_returnString+"\"imageId\":"+String(t_jsonImageID)+",";
	}
	if(t_jsonID!=-1){
		t_returnString=t_returnString+"\"id\":"+String(t_jsonID)+",";
	}
	t_returnString=t_returnString+"\"status\":\""+t_jsonStatus+"\",";
	t_returnString=t_returnString+"\"statusDesc\":\""+t_jsonStatusDesc+"\",";
	t_returnString=t_returnString+"\"takenAt\":"+String(t_jsonTakenAt)+",";
	if(t_jsonSource!=null){
		t_returnString=t_returnString+"\"source\":"+t_jsonSource.p_ToJson()+",";
	}
	t_returnString=t_returnString+"\"classification\":{";
	if(t_jsonClassificationCollaborate!=null){
		t_returnString=t_returnString+"\"collaborate\":[";
		for(var t_index=0;t_index<t_jsonClassificationCollaborate.p_Length2();t_index=t_index+1){
			var t_jsonClassificationCollaborateItem=object_downcast((t_jsonClassificationCollaborate.p_Get6(t_index)),c_JsonObject);
			t_jsonBoundingBox=object_downcast((t_jsonClassificationCollaborateItem.p_Get7("boundingBox",null)),c_JsonObject);
			t_jsonObjects=object_downcast((t_jsonClassificationCollaborateItem.p_Get7("objects",null)),c_JsonArray);
			t_jsonValidations=object_downcast((t_jsonClassificationCollaborateItem.p_Get7("validation",null)),c_JsonArray);
			t_validazione="";
			if(t__original!=null && t__original.m_subitems!=null){
				var t_=t__original.m_subitems.p_ObjectEnumerator();
				while(t_.p_HasNext()){
					var t_item=t_.p_NextObject();
					if(t_item.m_fromCollaborate==true && t_item.m_objects!=null){
						if(t_index==t_item.m_id){
							var t_2=t_item.m_objects.p_ObjectEnumerator();
							while(t_2.p_HasNext()){
								var t_objectItem=t_2.p_NextObject();
								if(t_objectItem.m_checked==true){
									if(t_validazione!=""){
										t_validazione=t_validazione+",";
									}
									t_validazione=t_validazione+"{";
									t_validazione=t_validazione+"\"userId\":"+String(t__userID)+",";
									t_validazione=t_validazione+"\"tag\":\""+t_objectItem.m_name+"\"";
									t_validazione=t_validazione+"}";
								}else{
									if(t_objectItem.m_invalid==true){
										if(t_validazione!=""){
											t_validazione=t_validazione+",";
										}
										t_validazione=t_validazione+"{";
										t_validazione=t_validazione+"\"userId\":"+String(t__userID)+",";
										t_validazione=t_validazione+"\"tag\":null";
										t_validazione=t_validazione+"}";
									}
								}
							}
						}
					}
				}
			}
			t_returnString=t_returnString+"{";
			if(t_jsonBoundingBox!=null){
				t_returnString=t_returnString+"\"boundingBox\":";
				t_returnString=t_returnString+t_jsonBoundingBox.p_ToJson();
				t_returnString=t_returnString+",";
			}
			if(t_jsonObjects!=null){
				t_returnString=t_returnString+"\"objects\":";
				t_returnString=t_returnString+t_jsonObjects.p_ToJson();
				t_returnString=t_returnString+",";
			}
			if(t_jsonValidations!=null){
				t_returnString=t_returnString+"\"validation\":";
				t_returnString=t_returnString+t_jsonValidations.p_ToJson();
				t_returnString=string_trim(t_returnString);
				t_returnString=t_returnString.slice(0,t_returnString.length-1);
				t_returnString=t_returnString+",";
				t_returnString=t_returnString+t_validazione;
				if(string_endswith(t_returnString,",")==true){
					t_returnString=t_returnString.slice(0,t_returnString.length-1);
				}
				t_returnString=t_returnString+"]";
			}else{
				if(t_validazione!=""){
					t_returnString=t_returnString+"\"validation\":["+t_validazione+"]";
				}
			}
			if(string_endswith(t_returnString,",")==true){
				t_returnString=t_returnString.slice(0,t_returnString.length-1);
			}
			t_returnString=t_returnString+"},";
		}
		if(t__collaborateString!=""){
			t_returnString=t_returnString+t__collaborateString;
		}
		if(string_endswith(t_returnString,",")==true){
			t_returnString=t_returnString.slice(0,t_returnString.length-1);
		}
		t_returnString=t_returnString+"],";
	}else{
		t_returnString=t_returnString+"\"collaborate\":["+t__collaborateString+"],";
	}
	if(t_jsonClassificationExplore!=null){
		t_returnString=t_returnString+"\"explore\":{";
		t_returnString=t_returnString+"\"userId\":";
		t_returnString=t_returnString+String(t_jsonClassificationExplore.p_GetInt2("userId",0));
		t_returnString=t_returnString+",";
		var t_jsonClassificationExploreObjects2=object_downcast((t_jsonClassificationExplore.p_Get7("objects",null)),c_JsonArray);
		if(t_jsonClassificationExploreObjects2!=null){
			t_returnString=t_returnString+"\"objects\":";
			t_returnString=t_returnString+t_jsonClassificationExploreObjects2.p_ToJson();
			t_returnString=t_returnString+",";
		}
		t_jsonValidations=object_downcast((t_jsonClassificationExplore.p_Get7("validation",null)),c_JsonArray);
		t_validazione="";
		for(var t_index2=0;t_index2<t_jsonClassificationExploreObjects2.p_Length2();t_index2=t_index2+1){
			if(t__original!=null && t__original.m_subitems!=null){
				var t_3=t__original.m_subitems.p_ObjectEnumerator();
				while(t_3.p_HasNext()){
					var t_item2=t_3.p_NextObject();
					if(t_item2.m_fromExplore==true && t_item2.m_objects!=null){
						if(t_index2==t_item2.m_id){
							var t_4=t_item2.m_objects.p_ObjectEnumerator();
							while(t_4.p_HasNext()){
								var t_objectItem2=t_4.p_NextObject();
								if(t_objectItem2.m_checked==true){
									if(t_validazione!=""){
										t_validazione=t_validazione+",";
									}
									t_validazione=t_validazione+"{";
									t_validazione=t_validazione+"\"userId\":"+String(t__userID)+",";
									t_validazione=t_validazione+"\"tag\":\""+t_objectItem2.m_name+"\"";
									t_validazione=t_validazione+"}";
								}else{
									if(t_objectItem2.m_invalid==true){
										if(t_validazione!=""){
											t_validazione=t_validazione+",";
										}
										t_validazione=t_validazione+"{";
										t_validazione=t_validazione+"\"userId\":"+String(t__userID)+",";
										t_validazione=t_validazione+"\"tag\":null";
										t_validazione=t_validazione+"}";
									}
								}
							}
						}
					}
				}
			}
		}
		if(t_jsonValidations!=null){
			t_returnString=t_returnString+"\"validation\":";
			t_returnString=t_returnString+t_jsonValidations.p_ToJson();
			t_returnString=string_trim(t_returnString);
			t_returnString=t_returnString.slice(0,t_returnString.length-1);
			t_returnString=t_returnString+",";
			t_returnString=t_returnString+t_validazione;
			if(string_endswith(t_returnString,",")==true){
				t_returnString=t_returnString.slice(0,t_returnString.length-1);
			}
			t_returnString=t_returnString+"]";
		}else{
			if(t_validazione!=""){
				t_returnString=t_returnString+"\"validation\":["+t_validazione+"]";
			}
		}
		if(string_endswith(t_returnString,",")==true){
			t_returnString=t_returnString.slice(0,t_returnString.length-1);
		}
		t_returnString=t_returnString+"},";
	}
	if(t_jsonClassificationOP!=null){
		t_returnString=t_returnString+"\"OP\":"+t_jsonClassificationOP.p_ToJson()+",";
	}
	if(t_jsonClassificationSIE!=null){
		t_returnString=t_returnString+"\"SIE\":[";
		for(var t_index3=0;t_index3<t_jsonClassificationSIE.p_Length2();t_index3=t_index3+1){
			var t_jsonClassificationSIEItem=object_downcast((t_jsonClassificationSIE.p_Get6(t_index3)),c_JsonObject);
			t_jsonBoundingBox=object_downcast((t_jsonClassificationSIEItem.p_Get7("boundingBox",null)),c_JsonObject);
			t_jsonObjects=object_downcast((t_jsonClassificationSIEItem.p_Get7("objects",null)),c_JsonArray);
			t_jsonValidations=object_downcast((t_jsonClassificationSIEItem.p_Get7("validation",null)),c_JsonArray);
			t_validazione="";
			if(t__original!=null && t__original.m_subitems!=null){
				var t_5=t__original.m_subitems.p_ObjectEnumerator();
				while(t_5.p_HasNext()){
					var t_item3=t_5.p_NextObject();
					if(t_item3.m_fromSIE==true && t_item3.m_objects!=null){
						if(t_index3==t_item3.m_id){
							var t_6=t_item3.m_objects.p_ObjectEnumerator();
							while(t_6.p_HasNext()){
								var t_objectItem3=t_6.p_NextObject();
								if(t_objectItem3.m_checked==true){
									if(t_validazione!=""){
										t_validazione=t_validazione+",";
									}
									t_validazione=t_validazione+"{";
									t_validazione=t_validazione+"\"userId\":"+String(t__userID)+",";
									t_validazione=t_validazione+"\"tag\":\""+t_objectItem3.m_name+"\"";
									t_validazione=t_validazione+"}";
								}else{
									if(t_objectItem3.m_invalid==true){
										if(t_validazione!=""){
											t_validazione=t_validazione+",";
										}
										t_validazione=t_validazione+"{";
										t_validazione=t_validazione+"\"userId\":"+String(t__userID)+",";
										t_validazione=t_validazione+"\"tag\":null";
										t_validazione=t_validazione+"}";
									}
								}
							}
						}
					}
				}
			}
			t_returnString=t_returnString+"{";
			if(t_jsonBoundingBox!=null){
				t_returnString=t_returnString+"\"boundingBox\":";
				t_returnString=t_returnString+t_jsonBoundingBox.p_ToJson();
				t_returnString=t_returnString+",";
			}
			if(t_jsonObjects!=null){
				t_returnString=t_returnString+"\"objects\":";
				t_returnString=t_returnString+t_jsonObjects.p_ToJson();
				t_returnString=t_returnString+",";
			}
			if(t_jsonValidations!=null){
				t_returnString=t_returnString+"\"validation\":";
				t_returnString=t_returnString+t_jsonValidations.p_ToJson();
				t_returnString=t_returnString.slice(0,t_returnString.length-1);
				t_returnString=t_returnString+",";
				t_returnString=t_returnString+t_validazione;
				if(string_endswith(t_returnString,",")==true){
					t_returnString=t_returnString.slice(0,t_returnString.length-1);
				}
				t_returnString=t_returnString+"]";
			}else{
				if(t_validazione!=""){
					t_returnString=t_returnString+"\"validation\":["+t_validazione;
					if(string_endswith(t_returnString,",")==true){
						t_returnString=t_returnString.slice(0,t_returnString.length-1);
					}
					t_returnString=t_returnString+"]";
				}
			}
			if(string_endswith(t_returnString,",")==true){
				t_returnString=t_returnString.slice(0,t_returnString.length-1);
			}
			t_returnString=t_returnString+"},";
		}
		if(string_endswith(t_returnString,",")==true){
			t_returnString=t_returnString.slice(0,t_returnString.length-1);
		}
		t_returnString=t_returnString+"],";
	}
	if(string_endswith(t_returnString,",")==true){
		t_returnString=t_returnString.slice(0,t_returnString.length-1);
	}
	t_returnString=t_returnString+"},";
	if(t_jsonGeoCamCoor!=null){
		t_returnString=t_returnString+"\"geoCamCoor\":"+t_jsonGeoCamCoor.p_ToJson()+",";
	}
	if(t_jsonAngCamOrient!=null){
		t_returnString=t_returnString+"\"angCamOrient\":"+t_jsonAngCamOrient.p_ToJson()+",";
	}
	if(t_jsonWaterLevel!=null){
		t_returnString=t_returnString+"\"waterLevel\":"+t_jsonWaterLevel.p_ToJson()+",";
	}
	if(string_endswith(t_returnString,",")==true){
		t_returnString=t_returnString.slice(0,t_returnString.length-1);
	}
	t_returnString=t_returnString+"}";
	return t_returnString;
}
var bb_game_cCONVERT=null;
var bb_game_originalJsonString="";
function c_JsonValue(){
	Object.call(this);
}
c_JsonValue.m_new=function(){
	return this;
}
c_JsonValue.prototype.p_IntValue=function(){
	bb_json_ThrowError();
	return 0;
}
c_JsonValue.prototype.p_StringValue=function(){
	bb_json_ThrowError();
	return "";
}
c_JsonValue.prototype.p_PushJson=function(t_buf){
	t_buf.p_Push25(this.p_ToJson());
}
c_JsonValue.prototype.p_ToJson=function(){
	var t_buf=c_StringStack.m_new2.call(new c_StringStack);
	this.p_PushJson(t_buf);
	return t_buf.p_Join("");
}
function c_JsonObject(){
	c_JsonValue.call(this);
	this.m__data=null;
}
c_JsonObject.prototype=extend_class(c_JsonValue);
c_JsonObject.m_new=function(){
	c_JsonValue.m_new.call(this);
	this.m__data=c_StringMap4.m_new.call(new c_StringMap4);
	return this;
}
c_JsonObject.m_new2=function(t_data){
	c_JsonValue.m_new.call(this);
	this.m__data=t_data;
	return this;
}
c_JsonObject.m_new3=function(t_json){
	c_JsonValue.m_new.call(this);
	this.m__data=(c_JsonParser.m_new.call(new c_JsonParser,t_json)).p_ParseObject();
	return this;
}
c_JsonObject.prototype.p_Contains=function(t_key){
	return this.m__data.p_Contains(t_key);
}
c_JsonObject.prototype.p_Get7=function(t_key,t_defval){
	if(!this.m__data.p_Contains(t_key)){
		return t_defval;
	}
	var t_val=this.m__data.p_Get(t_key);
	if((t_val)!=null){
		return t_val;
	}
	return (c_JsonNull.m_Instance());
}
c_JsonObject.prototype.p_GetInt2=function(t_key,t_defval){
	if(!this.m__data.p_Contains(t_key)){
		return t_defval;
	}
	return this.p_Get7(t_key,null).p_IntValue();
}
c_JsonObject.prototype.p_GetString2=function(t_key,t_defval){
	if(!this.m__data.p_Contains(t_key)){
		return t_defval;
	}
	return this.p_Get7(t_key,null).p_StringValue();
}
c_JsonObject.prototype.p_PushJson=function(t_buf){
	t_buf.p_Push25("{");
	var t_t=false;
	var t_=this.m__data.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_it=t_.p_NextObject();
		if(t_t){
			t_buf.p_Push25(",");
		}
		t_buf.p_Push25("\""+string_replace(t_it.p_Key(),"\"","\\\"")+"\":");
		if(t_it.p_Value()!=null){
			t_it.p_Value().p_PushJson(t_buf);
		}else{
			t_buf.p_Push25("null");
		}
		t_t=true;
	}
	t_buf.p_Push25("}");
}
function c_JsonArray(){
	c_JsonValue.call(this);
	this.m__data=[];
}
c_JsonArray.prototype=extend_class(c_JsonValue);
c_JsonArray.m_new=function(t_length){
	c_JsonValue.m_new.call(this);
	this.m__data=new_object_array(t_length);
	return this;
}
c_JsonArray.m_new2=function(t_data){
	c_JsonValue.m_new.call(this);
	this.m__data=t_data;
	return this;
}
c_JsonArray.m_new3=function(){
	c_JsonValue.m_new.call(this);
	return this;
}
c_JsonArray.prototype.p_Length2=function(){
	return this.m__data.length;
}
c_JsonArray.prototype.p_Get6=function(t_index){
	if(t_index<0 || t_index>=this.m__data.length){
		bb_json_ThrowError();
	}
	var t_val=this.m__data[t_index];
	if((t_val)!=null){
		return t_val;
	}
	return (c_JsonNull.m_Instance());
}
c_JsonArray.prototype.p_PushJson=function(t_buf){
	t_buf.p_Push25("[");
	var t_t=false;
	var t_=this.m__data;
	var t_2=0;
	while(t_2<t_.length){
		var t_value=t_[t_2];
		t_2=t_2+1;
		if(t_t){
			t_buf.p_Push25(",");
		}
		if(t_value!=null){
			t_value.p_PushJson(t_buf);
		}else{
			t_buf.p_Push25("null");
		}
		t_t=true;
	}
	t_buf.p_Push25("]");
}
function c_Map9(){
	Object.call(this);
	this.m_root=null;
}
c_Map9.m_new=function(){
	return this;
}
c_Map9.prototype.p_Compare4=function(t_lhs,t_rhs){
}
c_Map9.prototype.p_RotateLeft9=function(t_node){
	var t_child=t_node.m_right;
	t_node.m_right=t_child.m_left;
	if((t_child.m_left)!=null){
		t_child.m_left.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_left){
			t_node.m_parent.m_left=t_child;
		}else{
			t_node.m_parent.m_right=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_left=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map9.prototype.p_RotateRight9=function(t_node){
	var t_child=t_node.m_left;
	t_node.m_left=t_child.m_right;
	if((t_child.m_right)!=null){
		t_child.m_right.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_right){
			t_node.m_parent.m_right=t_child;
		}else{
			t_node.m_parent.m_left=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_right=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map9.prototype.p_InsertFixup9=function(t_node){
	while(((t_node.m_parent)!=null) && t_node.m_parent.m_color==-1 && ((t_node.m_parent.m_parent)!=null)){
		if(t_node.m_parent==t_node.m_parent.m_parent.m_left){
			var t_uncle=t_node.m_parent.m_parent.m_right;
			if(((t_uncle)!=null) && t_uncle.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle.m_color=1;
				t_uncle.m_parent.m_color=-1;
				t_node=t_uncle.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_right){
					t_node=t_node.m_parent;
					this.p_RotateLeft9(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateRight9(t_node.m_parent.m_parent);
			}
		}else{
			var t_uncle2=t_node.m_parent.m_parent.m_left;
			if(((t_uncle2)!=null) && t_uncle2.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle2.m_color=1;
				t_uncle2.m_parent.m_color=-1;
				t_node=t_uncle2.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_left){
					t_node=t_node.m_parent;
					this.p_RotateRight9(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateLeft9(t_node.m_parent.m_parent);
			}
		}
	}
	this.m_root.m_color=1;
	return 0;
}
c_Map9.prototype.p_Set4=function(t_key,t_value){
	var t_node=this.m_root;
	var t_parent=null;
	var t_cmp=0;
	while((t_node)!=null){
		t_parent=t_node;
		t_cmp=this.p_Compare4(t_key,t_node.m_key);
		if(t_cmp>0){
			t_node=t_node.m_right;
		}else{
			if(t_cmp<0){
				t_node=t_node.m_left;
			}else{
				t_node.m_value=t_value;
				return false;
			}
		}
	}
	t_node=c_Node12.m_new.call(new c_Node12,t_key,t_value,-1,t_parent);
	if((t_parent)!=null){
		if(t_cmp>0){
			t_parent.m_right=t_node;
		}else{
			t_parent.m_left=t_node;
		}
		this.p_InsertFixup9(t_node);
	}else{
		this.m_root=t_node;
	}
	return true;
}
c_Map9.prototype.p_FindNode=function(t_key){
	var t_node=this.m_root;
	while((t_node)!=null){
		var t_cmp=this.p_Compare4(t_key,t_node.m_key);
		if(t_cmp>0){
			t_node=t_node.m_right;
		}else{
			if(t_cmp<0){
				t_node=t_node.m_left;
			}else{
				return t_node;
			}
		}
	}
	return t_node;
}
c_Map9.prototype.p_Contains=function(t_key){
	return this.p_FindNode(t_key)!=null;
}
c_Map9.prototype.p_Get=function(t_key){
	var t_node=this.p_FindNode(t_key);
	if((t_node)!=null){
		return t_node.m_value;
	}
	return null;
}
c_Map9.prototype.p_FirstNode=function(){
	if(!((this.m_root)!=null)){
		return null;
	}
	var t_node=this.m_root;
	while((t_node.m_left)!=null){
		t_node=t_node.m_left;
	}
	return t_node;
}
c_Map9.prototype.p_ObjectEnumerator=function(){
	return c_NodeEnumerator.m_new.call(new c_NodeEnumerator,this.p_FirstNode());
}
function c_StringMap4(){
	c_Map9.call(this);
}
c_StringMap4.prototype=extend_class(c_Map9);
c_StringMap4.m_new=function(){
	c_Map9.m_new.call(this);
	return this;
}
c_StringMap4.prototype.p_Compare4=function(t_lhs,t_rhs){
	return string_compare(t_lhs,t_rhs);
}
function c_JsonParser(){
	Object.call(this);
	this.m__text="";
	this.m__pos=0;
	this.m__toke="";
	this.m__type=0;
}
c_JsonParser.prototype.p_GetChar=function(){
	if(this.m__pos==this.m__text.length){
		bb_json_ThrowError();
	}
	this.m__pos+=1;
	return this.m__text.charCodeAt(this.m__pos-1);
}
c_JsonParser.prototype.p_CParseDigits=function(){
	var t_p=this.m__pos;
	while(this.m__pos<this.m__text.length && this.m__text.charCodeAt(this.m__pos)>=48 && this.m__text.charCodeAt(this.m__pos)<=57){
		this.m__pos+=1;
	}
	return this.m__pos>t_p;
}
c_JsonParser.prototype.p_CParseChar=function(t_chr){
	if(this.m__pos>=this.m__text.length || this.m__text.charCodeAt(this.m__pos)!=t_chr){
		return false;
	}
	this.m__pos+=1;
	return true;
}
c_JsonParser.prototype.p_PeekChar=function(){
	if(this.m__pos==this.m__text.length){
		return 0;
	}
	return this.m__text.charCodeAt(this.m__pos);
}
c_JsonParser.prototype.p_Bump=function(){
	while(this.m__pos<this.m__text.length && this.m__text.charCodeAt(this.m__pos)<=32){
		this.m__pos+=1;
	}
	if(this.m__pos==this.m__text.length){
		this.m__toke="";
		this.m__type=0;
		return this.m__toke;
	}
	var t_pos=this.m__pos;
	var t_chr=this.p_GetChar();
	if(t_chr==34){
		do{
			var t_chr2=this.p_GetChar();
			if(t_chr2==34){
				break;
			}
			if(t_chr2==92){
				this.p_GetChar();
			}
		}while(!(false));
		this.m__type=1;
	}else{
		if(t_chr==45 || t_chr>=48 && t_chr<=57){
			if(t_chr==45){
				t_chr=this.p_GetChar();
				if(t_chr<48 || t_chr>57){
					bb_json_ThrowError();
				}
			}
			if(t_chr!=48){
				this.p_CParseDigits();
			}
			if(this.p_CParseChar(46)){
				this.p_CParseDigits();
			}
			if(this.p_CParseChar(69) || this.p_CParseChar(101)){
				if(this.p_PeekChar()==43 || this.p_PeekChar()==45){
					this.p_GetChar();
				}
				if(!this.p_CParseDigits()){
					bb_json_ThrowError();
				}
			}
			this.m__type=2;
		}else{
			if(t_chr>=65 && t_chr<91 || t_chr>=97 && t_chr<123){
				t_chr=this.p_PeekChar();
				while(t_chr>=65 && t_chr<91 || t_chr>=97 && t_chr<123){
					this.p_GetChar();
					t_chr=this.p_PeekChar();
				}
				this.m__type=4;
			}else{
				this.m__type=3;
			}
		}
	}
	this.m__toke=this.m__text.slice(t_pos,this.m__pos);
	return this.m__toke;
}
c_JsonParser.m_new=function(t_json){
	this.m__text=t_json;
	this.p_Bump();
	return this;
}
c_JsonParser.m_new2=function(){
	return this;
}
c_JsonParser.prototype.p_CParse=function(t_toke){
	if(t_toke!=this.m__toke){
		return false;
	}
	this.p_Bump();
	return true;
}
c_JsonParser.prototype.p_Parse=function(t_toke){
	if(!this.p_CParse(t_toke)){
		bb_json_ThrowError();
	}
}
c_JsonParser.prototype.p_TokeType=function(){
	return this.m__type;
}
c_JsonParser.prototype.p_Toke=function(){
	return this.m__toke;
}
c_JsonParser.prototype.p_ParseString=function(){
	if(this.p_TokeType()!=1){
		bb_json_ThrowError();
	}
	var t_toke=this.p_Toke().slice(1,-1);
	var t_i=t_toke.indexOf("\\",0);
	if(t_i!=-1){
		var t_frags=c_StringStack.m_new2.call(new c_StringStack);
		var t_p=0;
		var t_esc="";
		do{
			if(t_i+1>=t_toke.length){
				bb_json_ThrowError();
			}
			t_frags.p_Push25(t_toke.slice(t_p,t_i));
			var t_1=t_toke.charCodeAt(t_i+1);
			if(t_1==34){
				t_esc="\"";
			}else{
				if(t_1==92){
					t_esc="\\";
				}else{
					if(t_1==47){
						t_esc="/";
					}else{
						if(t_1==98){
							t_esc=String.fromCharCode(8);
						}else{
							if(t_1==102){
								t_esc=String.fromCharCode(12);
							}else{
								if(t_1==114){
									t_esc=String.fromCharCode(13);
								}else{
									if(t_1==110){
										t_esc=String.fromCharCode(10);
									}else{
										if(t_1==117){
											if(t_i+6>t_toke.length){
												bb_json_ThrowError();
											}
											var t_val=0;
											for(var t_j=2;t_j<6;t_j=t_j+1){
												var t_chr=t_toke.charCodeAt(t_i+t_j);
												if(t_chr>=48 && t_chr<58){
													t_val=t_val<<4|t_chr-48;
												}else{
													if(t_chr>=65 && t_chr<123){
														t_chr&=31;
														if(t_chr<1 || t_chr>6){
															bb_json_ThrowError();
														}
														t_val=t_val<<4|t_chr+9;
													}else{
														bb_json_ThrowError();
													}
												}
											}
											t_esc=String.fromCharCode(t_val);
											t_i+=4;
										}else{
											bb_json_ThrowError();
										}
									}
								}
							}
						}
					}
				}
			}
			t_frags.p_Push25(t_esc);
			t_p=t_i+2;
			t_i=t_toke.indexOf("\\",t_p);
			if(t_i!=-1){
				continue;
			}
			t_frags.p_Push25(t_toke.slice(t_p));
			break;
		}while(!(false));
		t_toke=t_frags.p_Join("");
	}
	this.p_Bump();
	return t_toke;
}
c_JsonParser.prototype.p_ParseNumber=function(){
	if(this.p_TokeType()!=2){
		bb_json_ThrowError();
	}
	var t_toke=this.p_Toke();
	this.p_Bump();
	return t_toke;
}
c_JsonParser.prototype.p_ParseArray=function(){
	this.p_Parse("[");
	if(this.p_CParse("]")){
		return [];
	}
	var t_stack=c_Stack10.m_new.call(new c_Stack10);
	do{
		var t_value=this.p_ParseValue();
		t_stack.p_Push28(t_value);
	}while(!(!this.p_CParse(",")));
	this.p_Parse("]");
	return t_stack.p_ToArray();
}
c_JsonParser.prototype.p_ParseValue=function(){
	if(this.p_TokeType()==1){
		return (c_JsonString.m_Instance(this.p_ParseString()));
	}
	if(this.p_TokeType()==2){
		return (c_JsonNumber.m_Instance(this.p_ParseNumber()));
	}
	if(this.p_Toke()=="{"){
		return (c_JsonObject.m_new2.call(new c_JsonObject,this.p_ParseObject()));
	}
	if(this.p_Toke()=="["){
		return (c_JsonArray.m_new2.call(new c_JsonArray,this.p_ParseArray()));
	}
	if(this.p_CParse("true")){
		return (c_JsonBool.m_Instance(true));
	}
	if(this.p_CParse("false")){
		return (c_JsonBool.m_Instance(false));
	}
	if(this.p_CParse("null")){
		return (c_JsonNull.m_Instance());
	}
	bb_json_ThrowError();
	return (c_JsonNull.m_Instance());
}
c_JsonParser.prototype.p_ParseObject=function(){
	this.p_Parse("{");
	var t_map=c_StringMap4.m_new.call(new c_StringMap4);
	if(this.p_CParse("}")){
		return t_map;
	}
	do{
		var t_name=this.p_ParseString();
		this.p_Parse(":");
		var t_value=this.p_ParseValue();
		t_map.p_Set4(t_name,t_value);
	}while(!(!this.p_CParse(",")));
	this.p_Parse("}");
	return t_map;
}
function c_JsonError(){
	ThrowableObject.call(this);
}
c_JsonError.prototype=extend_class(ThrowableObject);
c_JsonError.m_new=function(){
	return this;
}
function bb_json_ThrowError(){
	throw c_JsonError.m_new.call(new c_JsonError);
}
function c_Stack9(){
	Object.call(this);
	this.m_data=[];
	this.m_length=0;
}
c_Stack9.m_new=function(){
	return this;
}
c_Stack9.m_new2=function(t_data){
	this.m_data=t_data.slice(0);
	this.m_length=t_data.length;
	return this;
}
c_Stack9.prototype.p_Push25=function(t_value){
	if(this.m_length==this.m_data.length){
		this.m_data=resize_string_array(this.m_data,this.m_length*2+10);
	}
	this.m_data[this.m_length]=t_value;
	this.m_length+=1;
}
c_Stack9.prototype.p_Push26=function(t_values,t_offset,t_count){
	for(var t_i=0;t_i<t_count;t_i=t_i+1){
		this.p_Push25(t_values[t_offset+t_i]);
	}
}
c_Stack9.prototype.p_Push27=function(t_values,t_offset){
	this.p_Push26(t_values,t_offset,t_values.length-t_offset);
}
c_Stack9.prototype.p_ToArray=function(){
	var t_t=new_string_array(this.m_length);
	for(var t_i=0;t_i<this.m_length;t_i=t_i+1){
		t_t[t_i]=this.m_data[t_i];
	}
	return t_t;
}
function c_StringStack(){
	c_Stack9.call(this);
}
c_StringStack.prototype=extend_class(c_Stack9);
c_StringStack.m_new=function(t_data){
	c_Stack9.m_new2.call(this,t_data);
	return this;
}
c_StringStack.m_new2=function(){
	c_Stack9.m_new.call(this);
	return this;
}
c_StringStack.prototype.p_Join=function(t_separator){
	return this.p_ToArray().join(t_separator);
}
function c_JsonString(){
	c_JsonValue.call(this);
	this.m__value="";
}
c_JsonString.prototype=extend_class(c_JsonValue);
c_JsonString.m_new=function(t_value){
	c_JsonValue.m_new.call(this);
	this.m__value=t_value;
	return this;
}
c_JsonString.m_new2=function(){
	c_JsonValue.m_new.call(this);
	return this;
}
c_JsonString.m__null=null;
c_JsonString.m_Instance=function(t_value){
	if((t_value).length!=0){
		return c_JsonString.m_new.call(new c_JsonString,t_value);
	}
	return c_JsonString.m__null;
}
c_JsonString.prototype.p_StringValue=function(){
	return this.m__value;
}
c_JsonString.prototype.p_ToJson=function(){
	return "\""+string_replace(this.m__value,"\"","\\\"")+"\"";
}
function c_JsonNumber(){
	c_JsonValue.call(this);
	this.m__value="";
}
c_JsonNumber.prototype=extend_class(c_JsonValue);
c_JsonNumber.m_new=function(t_value){
	c_JsonValue.m_new.call(this);
	this.m__value=t_value;
	return this;
}
c_JsonNumber.m_new2=function(){
	c_JsonValue.m_new.call(this);
	return this;
}
c_JsonNumber.m__zero=null;
c_JsonNumber.m_Instance=function(t_value){
	if(t_value!="0"){
		return c_JsonNumber.m_new.call(new c_JsonNumber,t_value);
	}
	return c_JsonNumber.m__zero;
}
c_JsonNumber.prototype.p_IntValue=function(){
	return parseInt((this.m__value),10);
}
c_JsonNumber.prototype.p_ToJson=function(){
	return this.m__value;
}
function c_Stack10(){
	Object.call(this);
	this.m_data=[];
	this.m_length=0;
}
c_Stack10.m_new=function(){
	return this;
}
c_Stack10.m_new2=function(t_data){
	this.m_data=t_data.slice(0);
	this.m_length=t_data.length;
	return this;
}
c_Stack10.prototype.p_Push28=function(t_value){
	if(this.m_length==this.m_data.length){
		this.m_data=resize_object_array(this.m_data,this.m_length*2+10);
	}
	this.m_data[this.m_length]=t_value;
	this.m_length+=1;
}
c_Stack10.prototype.p_Push29=function(t_values,t_offset,t_count){
	for(var t_i=0;t_i<t_count;t_i=t_i+1){
		this.p_Push28(t_values[t_offset+t_i]);
	}
}
c_Stack10.prototype.p_Push30=function(t_values,t_offset){
	this.p_Push29(t_values,t_offset,t_values.length-t_offset);
}
c_Stack10.prototype.p_ToArray=function(){
	var t_t=new_object_array(this.m_length);
	for(var t_i=0;t_i<this.m_length;t_i=t_i+1){
		t_t[t_i]=this.m_data[t_i];
	}
	return t_t;
}
function c_JsonBool(){
	c_JsonValue.call(this);
	this.m__value=false;
}
c_JsonBool.prototype=extend_class(c_JsonValue);
c_JsonBool.m_new=function(t_value){
	c_JsonValue.m_new.call(this);
	this.m__value=t_value;
	return this;
}
c_JsonBool.m_new2=function(){
	c_JsonValue.m_new.call(this);
	return this;
}
c_JsonBool.m__true=null;
c_JsonBool.m__false=null;
c_JsonBool.m_Instance=function(t_value){
	if(t_value){
		return c_JsonBool.m__true;
	}
	return c_JsonBool.m__false;
}
c_JsonBool.prototype.p_ToJson=function(){
	if(this.m__value){
		return "true";
	}
	return "false";
}
function c_JsonNull(){
	c_JsonValue.call(this);
}
c_JsonNull.prototype=extend_class(c_JsonValue);
c_JsonNull.m_new=function(){
	c_JsonValue.m_new.call(this);
	return this;
}
c_JsonNull.m__instance=null;
c_JsonNull.m_Instance=function(){
	return c_JsonNull.m__instance;
}
c_JsonNull.prototype.p_ToJson=function(){
	return "null";
}
function c_Node12(){
	Object.call(this);
	this.m_key="";
	this.m_right=null;
	this.m_left=null;
	this.m_value=null;
	this.m_color=0;
	this.m_parent=null;
}
c_Node12.m_new=function(t_key,t_value,t_color,t_parent){
	this.m_key=t_key;
	this.m_value=t_value;
	this.m_color=t_color;
	this.m_parent=t_parent;
	return this;
}
c_Node12.m_new2=function(){
	return this;
}
c_Node12.prototype.p_NextNode=function(){
	var t_node=null;
	if((this.m_right)!=null){
		t_node=this.m_right;
		while((t_node.m_left)!=null){
			t_node=t_node.m_left;
		}
		return t_node;
	}
	t_node=this;
	var t_parent=this.m_parent;
	while(((t_parent)!=null) && t_node==t_parent.m_right){
		t_node=t_parent;
		t_parent=t_parent.m_parent;
	}
	return t_parent;
}
c_Node12.prototype.p_Key=function(){
	return this.m_key;
}
c_Node12.prototype.p_Value=function(){
	return this.m_value;
}
var bb_game_imageIDSelected=0;
var bb_game_inputHit=0;
var bb_game_canLongPress=0;
var bb_game_inputLongPress=0;
var bb_game_inputPress=0;
var bb_game_timeHit=0;
var bb_game_timePress=0;
function bb_checkkeys_DelayKeys(t__delay){
	bb_game_inputHit=0;
	bb_game_canLongPress=0;
	bb_game_inputLongPress=0;
	bb_game_inputPress=0;
	bb_game_timeHit=bb_app_Millisecs()+t__delay;
	bb_game_timePress=bb_app_Millisecs()+60000;
	return 0;
}
var bb_game_isSuspend=false;
function bb_audio_PauseMusic(){
	bb_audio_device.PauseMusic();
	return 0;
}
function bb_app_SaveState(t_state){
	bb_app__game.SaveState(t_state);
}
function bb_input_MouseX(){
	return bb_input_device.p_MouseX();
}
function bb_autofit_VDeviceWidth(){
	return c_VirtualDisplay.m_Display.m_vwidth;
}
function bb_autofit_VMouseX(t__x,t_limit){
	return c_VirtualDisplay.m_Display.p_VMouseX(t__x,t_limit);
}
function bb_input_MouseY(){
	return bb_input_device.p_MouseY();
}
function bb_autofit_VDeviceHeight(){
	return c_VirtualDisplay.m_Display.m_vheight;
}
function bb_autofit_VMouseY(t__y,t_limit){
	return c_VirtualDisplay.m_Display.p_VMouseY(t__y,t_limit);
}
function bb_input_TouchDown(t_index){
	return ((bb_input_device.p_KeyDown(384+t_index))?1:0);
}
function bb_math_Abs(t_x){
	if(t_x>=0){
		return t_x;
	}
	return -t_x;
}
function bb_math_Abs2(t_x){
	if(t_x>=0.0){
		return t_x;
	}
	return -t_x;
}
var bb_game_inputRelease=0;
function bb_input_TouchHit(t_index){
	return bb_input_device.p_KeyHit(384+t_index);
}
function bb_input_KeyHit(t_key){
	return bb_input_device.p_KeyHit(t_key);
}
var bb_game_startTouchHit=null;
var bb_game_charKeyboard=0;
function bb_input_GetChar(){
	return bb_input_device.p_GetChar();
}
var bb_game_charKeyboardMini=0;
function bb_input_KeyDown(t_key){
	return ((bb_input_device.p_KeyDown(t_key))?1:0);
}
var bb_game_inputImageID=false;
function bb_checkkeys_CheckKeys(){
	if(bb_input_TouchDown(0)==1){
		bb_game_inputPress=1;
		bb_game_inputLongPress=0;
		if(bb_math_Abs(bb_app_Millisecs()-bb_game_timePress)>150){
			bb_game_inputLongPress=1;
		}
	}else{
		if(bb_game_inputPress==1){
			bb_game_inputRelease=1;
		}
		bb_game_inputPress=0;
		bb_game_inputLongPress=0;
	}
	if(bb_game_canLongPress==0){
		bb_game_inputLongPress=0;
	}
	if(bb_app_Millisecs()-bb_game_timeHit<250){
		bb_game_inputHit=0;
		return 0;
	}
	if(bb_game_inputHit==1){
		return 0;
	}
	bb_game_inputHit=bb_input_TouchHit(0);
	if((bb_input_KeyHit(27))!=0){
		bb_session_GameSession.p_SetState(3);
	}
	if((bb_game_inputHit)!=0){
		bb_game_startTouchHit.m_x=bb_collaborate_Collaborate.m_mx;
		bb_game_startTouchHit.m_y=bb_collaborate_Collaborate.m_my;
		bb_game_canLongPress=1;
		bb_game_timePress=bb_app_Millisecs();
		bb_game_inputLongPress=0;
	}
	if(bb_game_charKeyboard==0){
		bb_game_charKeyboard=bb_input_GetChar();
		bb_game_charKeyboardMini=bb_game_charKeyboard;
		if(bb_game_charKeyboard>0){
			print(String(bb_game_charKeyboard));
		}
	}
	if((bb_input_KeyDown(17))!=0){
		if((bb_input_KeyDown(116))!=0){
			bb_game_defineCampaign="";
			bb_session_GameSession.p_SetState(3);
		}
		if((bb_input_KeyDown(117))!=0){
			bb_game_defineCampaign="test";
			bb_session_GameSession.p_SetState(3);
		}
		if((bb_input_KeyDown(118))!=0){
			bb_game_defineCampaign="danube";
			bb_session_GameSession.p_SetState(3);
		}
		if((bb_input_KeyDown(119))!=0){
			bb_game_defineCampaign="kifisos";
			bb_session_GameSession.p_SetState(3);
		}
		if((bb_input_KeyDown(121))!=0){
			if(bb_app_Millisecs()-bb_game_timePress>250){
				if(bb_game_inputImageID==true){
					bb_game_inputImageID=false;
				}else{
					bb_game_inputImageID=true;
					bb_game_inputImageIDStr="";
				}
			}
			bb_game_timePress=bb_app_Millisecs();
		}
	}
	return 0;
}
var bb_game_cRENDER_SCENTCOLLABORATE=null;
function bb_input_MouseHit(t_button){
	return bb_input_device.p_KeyHit(1+t_button);
}
function bb_input_MouseDown(t_button){
	return ((bb_input_device.p_KeyDown(1+t_button))?1:0);
}
function c_Enumerator2(){
	Object.call(this);
	this.m_stack=null;
	this.m_index=0;
}
c_Enumerator2.m_new=function(t_stack){
	this.m_stack=t_stack;
	return this;
}
c_Enumerator2.m_new2=function(){
	return this;
}
c_Enumerator2.prototype.p_HasNext=function(){
	return this.m_index<this.m_stack.p_Length2();
}
c_Enumerator2.prototype.p_NextObject=function(){
	this.m_index+=1;
	return this.m_stack.m_data[this.m_index-1];
}
function bb_input_TouchX(t_index){
	return bb_input_device.p_TouchX(t_index);
}
function bb_input_TouchY(t_index){
	return bb_input_device.p_TouchY(t_index);
}
function bb_updategame_UpdateGame(){
	bb_collaborate_Collaborate.m_mx=((bb_autofit_VMouseX(bb_input_MouseX(),true))|0);
	bb_collaborate_Collaborate.m_my=((bb_autofit_VMouseY(bb_input_MouseY(),true))|0);
	bb_collaborate_Collaborate.m_mouse.m_x=bb_collaborate_Collaborate.m_mx;
	bb_collaborate_Collaborate.m_mouse.m_y=bb_collaborate_Collaborate.m_my;
	var t_1=c_Session.m_GameState;
	if(t_1==1){
		bb_session_GameSession.p_SetState(2);
	}else{
		if(t_1==2){
			bb_checkkeys_CheckKeys();
		}else{
			if(t_1==3){
				bb_checkkeys_CheckKeys();
				if((bb_game_inputHit)!=0){
				}
			}else{
				if(t_1==101){
					bb_checkkeys_CheckKeys();
				}else{
					if(t_1==102){
						bb_checkkeys_CheckKeys();
					}else{
						if(t_1==108){
							bb_checkkeys_CheckKeys();
						}else{
							if(t_1==104){
								if(bb_math_Abs(bb_app_Millisecs()-bb_game_gStartTimer)>500){
									bb_session_GameSession.p_SetState(105);
								}
							}else{
								if(t_1==106){
									if(bb_math_Abs(bb_app_Millisecs()-bb_game_gStartTimer)>500){
										bb_session_GameSession.p_SetState(101);
									}
								}else{
									if(t_1==103){
										if(bb_math_Abs(bb_app_Millisecs()-bb_game_gStartTimer)>3000){
											bb_session_GameSession.p_SetState(101);
										}
									}else{
										if(t_1==120){
											if(bb_math_Abs(bb_app_Millisecs()-bb_game_gStartTimer)>100){
												bb_session_GameSession.p_SetState(121);
											}
										}else{
											if(t_1==121){
												bb_checkkeys_CheckKeys();
											}else{
												if(t_1==122 || t_1==123){
													bb_game_cRENDER_SCENTCOLLABORATE.p_Update();
													bb_checkkeys_CheckKeys();
												}else{
													if(t_1==124){
														bb_checkkeys_CheckKeys();
													}else{
														if(t_1==130){
															bb_checkkeys_CheckKeys();
														}else{
															if(t_1==125){
																if(bb_math_Abs(bb_app_Millisecs()-bb_game_gStartTimer)>3000){
																	bb_session_GameSession.p_SetState(101);
																}
															}else{
																if(t_1==300 || t_1==301){
																	bb_game_cRENDER_SCENTFOCUS.p_Update();
																	bb_checkkeys_CheckKeys();
																}else{
																	if(t_1==200){
																		bb_game_cRENDER_SCENTANNOTATE.p_Update();
																		bb_checkkeys_CheckKeys();
																	}else{
																		if(t_1==109){
																			bb_checkkeys_CheckKeys();
																		}else{
																			if(t_1==1000){
																				bb_checkkeys_CheckKeys();
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	if(bb_game_inputHit==1 || bb_game_inputPress==1){
		bb_collaborate_Collaborate.m_mx=((bb_autofit_VMouseX(bb_input_TouchX(0),true))|0);
		bb_collaborate_Collaborate.m_my=((bb_autofit_VMouseY(bb_input_TouchY(0),true))|0);
		bb_collaborate_Collaborate.m_mouse.m_x=bb_collaborate_Collaborate.m_mx;
		bb_collaborate_Collaborate.m_mouse.m_y=bb_collaborate_Collaborate.m_my;
	}
	return 0;
}
var bb_asyncevent__current=null;
function bb_asyncevent_UpdateAsyncEvents(){
	if((bb_asyncevent__current)!=null){
		return 0;
	}
	var t_i=0;
	while(t_i<bb_asyncevent__sources.p_Length2()){
		bb_asyncevent__current=bb_asyncevent__sources.p_Get6(t_i);
		bb_asyncevent__current.p_UpdateAsyncEvents();
		if((bb_asyncevent__current)!=null){
			t_i+=1;
		}
	}
	bb_asyncevent__current=null;
	return 0;
}
function bb_graphics_Cls(t_r,t_g,t_b){
	bb_graphics_renderDevice.Cls(t_r,t_g,t_b);
	return 0;
}
function bb_math_Min(t_x,t_y){
	if(t_x<t_y){
		return t_x;
	}
	return t_y;
}
function bb_math_Min2(t_x,t_y){
	if(t_x<t_y){
		return t_x;
	}
	return t_y;
}
function bb_graphics_Transform(t_ix,t_iy,t_jx,t_jy,t_tx,t_ty){
	var t_ix2=t_ix*bb_graphics_context.m_ix+t_iy*bb_graphics_context.m_jx;
	var t_iy2=t_ix*bb_graphics_context.m_iy+t_iy*bb_graphics_context.m_jy;
	var t_jx2=t_jx*bb_graphics_context.m_ix+t_jy*bb_graphics_context.m_jx;
	var t_jy2=t_jx*bb_graphics_context.m_iy+t_jy*bb_graphics_context.m_jy;
	var t_tx2=t_tx*bb_graphics_context.m_ix+t_ty*bb_graphics_context.m_jx+bb_graphics_context.m_tx;
	var t_ty2=t_tx*bb_graphics_context.m_iy+t_ty*bb_graphics_context.m_jy+bb_graphics_context.m_ty;
	bb_graphics_SetMatrix(t_ix2,t_iy2,t_jx2,t_jy2,t_tx2,t_ty2);
	return 0;
}
function bb_graphics_Transform2(t_m){
	bb_graphics_Transform(t_m[0],t_m[1],t_m[2],t_m[3],t_m[4],t_m[5]);
	return 0;
}
function bb_graphics_Scale(t_x,t_y){
	bb_graphics_Transform(t_x,0.0,0.0,t_y,0.0,0.0);
	return 0;
}
function bb_graphics_Translate(t_x,t_y){
	bb_graphics_Transform(1.0,0.0,0.0,1.0,t_x,t_y);
	return 0;
}
function bb_autofit_UpdateVirtualDisplay(t_zoomborders,t_keepborders){
	c_VirtualDisplay.m_Display.p_UpdateVirtualDisplay(t_zoomborders,t_keepborders);
	return 0;
}
function bb_graphics_DrawImage(t_image,t_x,t_y,t_frame){
	var t_f=t_image.m_frames[t_frame];
	bb_graphics_context.p_Validate();
	if((t_image.m_flags&65536)!=0){
		bb_graphics_renderDevice.DrawSurface(t_image.m_surface,t_x-t_image.m_tx,t_y-t_image.m_ty);
	}else{
		bb_graphics_renderDevice.DrawSurface2(t_image.m_surface,t_x-t_image.m_tx,t_y-t_image.m_ty,t_f.m_x,t_f.m_y,t_image.m_width,t_image.m_height);
	}
	return 0;
}
function bb_graphics_PushMatrix(){
	var t_sp=bb_graphics_context.m_matrixSp;
	if(t_sp==bb_graphics_context.m_matrixStack.length){
		bb_graphics_context.m_matrixStack=resize_number_array(bb_graphics_context.m_matrixStack,t_sp*2);
	}
	bb_graphics_context.m_matrixStack[t_sp+0]=bb_graphics_context.m_ix;
	bb_graphics_context.m_matrixStack[t_sp+1]=bb_graphics_context.m_iy;
	bb_graphics_context.m_matrixStack[t_sp+2]=bb_graphics_context.m_jx;
	bb_graphics_context.m_matrixStack[t_sp+3]=bb_graphics_context.m_jy;
	bb_graphics_context.m_matrixStack[t_sp+4]=bb_graphics_context.m_tx;
	bb_graphics_context.m_matrixStack[t_sp+5]=bb_graphics_context.m_ty;
	bb_graphics_context.m_matrixSp=t_sp+6;
	return 0;
}
function bb_graphics_Rotate(t_angle){
	bb_graphics_Transform(Math.cos((t_angle)*D2R),-Math.sin((t_angle)*D2R),Math.sin((t_angle)*D2R),Math.cos((t_angle)*D2R),0.0,0.0);
	return 0;
}
function bb_graphics_PopMatrix(){
	var t_sp=bb_graphics_context.m_matrixSp-6;
	bb_graphics_SetMatrix(bb_graphics_context.m_matrixStack[t_sp+0],bb_graphics_context.m_matrixStack[t_sp+1],bb_graphics_context.m_matrixStack[t_sp+2],bb_graphics_context.m_matrixStack[t_sp+3],bb_graphics_context.m_matrixStack[t_sp+4],bb_graphics_context.m_matrixStack[t_sp+5]);
	bb_graphics_context.m_matrixSp=t_sp;
	return 0;
}
function bb_graphics_DrawImage2(t_image,t_x,t_y,t_rotation,t_scaleX,t_scaleY,t_frame){
	var t_f=t_image.m_frames[t_frame];
	bb_graphics_PushMatrix();
	bb_graphics_Translate(t_x,t_y);
	bb_graphics_Rotate(t_rotation);
	bb_graphics_Scale(t_scaleX,t_scaleY);
	bb_graphics_Translate(-t_image.m_tx,-t_image.m_ty);
	bb_graphics_context.p_Validate();
	if((t_image.m_flags&65536)!=0){
		bb_graphics_renderDevice.DrawSurface(t_image.m_surface,0.0,0.0);
	}else{
		bb_graphics_renderDevice.DrawSurface2(t_image.m_surface,0.0,0.0,t_f.m_x,t_f.m_y,t_image.m_width,t_image.m_height);
	}
	bb_graphics_PopMatrix();
	return 0;
}
var bb_game_startMouseOver=null;
function bb_game_MouseOver(){
	bb_game_startMouseOver.m_x=bb_collaborate_Collaborate.m_mouse.m_x;
	bb_game_startMouseOver.m_y=bb_collaborate_Collaborate.m_mouse.m_y;
}
function c_classGame_LanguageItem(){
	Object.call(this);
	this.m_item=0;
	this.m_title="";
}
c_classGame_LanguageItem.m_new=function(){
	this.m_item=-1;
	this.m_title="";
	return this;
}
c_classGame_LanguageItem.m_new2=function(t__ref,t__str){
	this.m_item=t__ref;
	this.m_title=t__str;
	return this;
}
function c_XMLParser(){
	Object.call(this);
	this.m_str="";
	this.m_tagsLength=0;
	this.m_quotesLength=0;
	this.m_pisLength=0;
	this.m_tags=[];
	this.m_tagType=[];
	this.m_quotes=[];
	this.m_pis=[];
	this.m_tagCount=0;
	this.m_quoteCount=0;
	this.m_piCount=0;
}
c_XMLParser.m_new=function(){
	return this;
}
c_XMLParser.prototype.p_CacheControlCharacters=function(){
	this.m_tagsLength=128;
	this.m_quotesLength=128;
	this.m_pisLength=128;
	this.m_tags=new_number_array(this.m_tagsLength);
	this.m_tagType=new_number_array(this.m_tagsLength);
	this.m_quotes=new_number_array(this.m_quotesLength);
	this.m_pis=new_number_array(this.m_quotesLength);
	this.m_tagCount=0;
	this.m_quoteCount=0;
	this.m_piCount=0;
	var t_inTag=false;
	var t_inQuote=false;
	var t_inComment=false;
	var t_inCdata=false;
	var t_inDoctype=false;
	var t_inPi=false;
	var t_strlen=this.m_str.length;
	for(var t_i=0;t_i<t_strlen;t_i=t_i+1){
		if(t_inComment){
			if(this.m_str.charCodeAt(t_i)==62 && this.m_str.charCodeAt(t_i-1)==45 && this.m_str.charCodeAt(t_i-2)==45){
				if(this.m_tagCount+1>=this.m_tagsLength){
					this.m_tagsLength*=2;
					this.m_tags=resize_number_array(this.m_tags,this.m_tagsLength);
					this.m_tagType=resize_number_array(this.m_tagType,this.m_tagsLength);
				}
				this.m_tags[this.m_tagCount]=t_i;
				this.m_tagType[this.m_tagCount]=1;
				this.m_tagCount+=1;
				t_inComment=false;
			}
		}else{
			if(t_inCdata){
				if(this.m_str.charCodeAt(t_i)==62 && this.m_str.charCodeAt(t_i-1)==93 && this.m_str.charCodeAt(t_i-2)==93){
					if(this.m_tagCount+1>=this.m_tagsLength){
						this.m_tagsLength*=2;
						this.m_tags=resize_number_array(this.m_tags,this.m_tagsLength);
						this.m_tagType=resize_number_array(this.m_tagType,this.m_tagsLength);
					}
					this.m_tags[this.m_tagCount]=t_i;
					this.m_tagType[this.m_tagCount]=2;
					this.m_tagCount+=1;
					t_inCdata=false;
				}
			}else{
				if(t_inQuote){
					if(this.m_str.charCodeAt(t_i)==34){
						if(this.m_quoteCount+1>=this.m_quotesLength){
							this.m_quotesLength*=2;
							this.m_quotes=resize_number_array(this.m_quotes,this.m_quotesLength);
						}
						this.m_quotes[this.m_quoteCount]=t_i;
						this.m_quoteCount+=1;
						t_inQuote=false;
					}
				}else{
					if(this.m_str.charCodeAt(t_i)==34){
						if(this.m_quoteCount+1>=this.m_quotesLength){
							this.m_quotesLength*=2;
							this.m_quotes=resize_number_array(this.m_quotes,this.m_quotesLength);
						}
						this.m_quotes[this.m_quoteCount]=t_i;
						this.m_quoteCount+=1;
						t_inQuote=true;
					}else{
						if(t_inPi){
							if(this.m_str.charCodeAt(t_i)==62 && this.m_str.charCodeAt(t_i-1)==63){
								if(this.m_piCount+1>=this.m_pisLength){
									this.m_pisLength*=2;
									this.m_pis=resize_number_array(this.m_pis,this.m_pisLength);
								}
								this.m_pis[this.m_piCount]=t_i;
								this.m_piCount+=1;
								t_inPi=false;
							}
						}else{
							if(t_inDoctype){
								if(this.m_str.charCodeAt(t_i)==62){
									if(this.m_tagCount+1>=this.m_tagsLength){
										this.m_tagsLength*=2;
										this.m_tags=resize_number_array(this.m_tags,this.m_tagsLength);
										this.m_tagType=resize_number_array(this.m_tagType,this.m_tagsLength);
									}
									this.m_tags[this.m_tagCount]=t_i;
									this.m_tagType[this.m_tagCount]=3;
									this.m_tagCount+=1;
									t_inDoctype=false;
								}
							}else{
								if(this.m_str.charCodeAt(t_i)==60){
									if(t_inTag){
										throw c_XMLParseException.m_new.call(new c_XMLParseException,"XMLParser.CacheControlCharacters: Invalid less than!",null);
									}
									if(this.m_str.charCodeAt(t_i+1)==33){
										if(this.m_str.charCodeAt(t_i+2)==45 && this.m_str.charCodeAt(t_i+3)==45){
											if(this.m_tagCount+1>=this.m_tagsLength){
												this.m_tagsLength*=2;
												this.m_tags=resize_number_array(this.m_tags,this.m_tagsLength);
												this.m_tagType=resize_number_array(this.m_tagType,this.m_tagsLength);
											}
											this.m_tags[this.m_tagCount]=t_i;
											this.m_tagType[this.m_tagCount]=1;
											this.m_tagCount+=1;
											t_inComment=true;
										}else{
											if(this.m_str.charCodeAt(t_i+2)==91 && (this.m_str.charCodeAt(t_i+3)==67 || this.m_str.charCodeAt(t_i+3)==99) && (this.m_str.charCodeAt(t_i+4)==68 || this.m_str.charCodeAt(t_i+4)==100) && (this.m_str.charCodeAt(t_i+5)==65 || this.m_str.charCodeAt(t_i+5)==97) && (this.m_str.charCodeAt(t_i+6)==84 || this.m_str.charCodeAt(t_i+6)==116) && (this.m_str.charCodeAt(t_i+7)==65 || this.m_str.charCodeAt(t_i+7)==97) && this.m_str.charCodeAt(t_i+8)==91){
												if(this.m_tagCount+1>=this.m_tagsLength){
													this.m_tagsLength*=2;
													this.m_tags=resize_number_array(this.m_tags,this.m_tagsLength);
													this.m_tagType=resize_number_array(this.m_tagType,this.m_tagsLength);
												}
												this.m_tags[this.m_tagCount]=t_i;
												this.m_tagType[this.m_tagCount]=2;
												this.m_tagCount+=1;
												t_inCdata=true;
											}else{
												if((this.m_str.charCodeAt(t_i+2)==68 || this.m_str.charCodeAt(t_i+2)==100) && (this.m_str.charCodeAt(t_i+3)==79 || this.m_str.charCodeAt(t_i+3)==111) && (this.m_str.charCodeAt(t_i+4)==67 || this.m_str.charCodeAt(t_i+4)==99) && (this.m_str.charCodeAt(t_i+5)==84 || this.m_str.charCodeAt(t_i+5)==116) && (this.m_str.charCodeAt(t_i+6)==89 || this.m_str.charCodeAt(t_i+6)==121) && (this.m_str.charCodeAt(t_i+7)==80 || this.m_str.charCodeAt(t_i+7)==112) && (this.m_str.charCodeAt(t_i+8)==69 || this.m_str.charCodeAt(t_i+8)==101)){
													if(this.m_tagCount+1>=this.m_tagsLength){
														this.m_tagsLength*=2;
														this.m_tags=resize_number_array(this.m_tags,this.m_tagsLength);
														this.m_tagType=resize_number_array(this.m_tagType,this.m_tagsLength);
													}
													this.m_tags[this.m_tagCount]=t_i;
													this.m_tagType[this.m_tagCount]=3;
													this.m_tagCount+=1;
													t_inDoctype=true;
												}else{
													throw c_XMLParseException.m_new.call(new c_XMLParseException,"XMLParser.CacheControlCharacters: Invalid prolog.",null);
												}
											}
										}
									}else{
										if(this.m_str.charCodeAt(t_i+1)==63){
											if(this.m_piCount+1>=this.m_pisLength){
												this.m_pisLength*=2;
												this.m_pis=resize_number_array(this.m_pis,this.m_pisLength);
											}
											this.m_pis[this.m_piCount]=t_i;
											this.m_piCount+=1;
											t_inPi=true;
										}else{
											if(this.m_tagCount+1>=this.m_tagsLength){
												this.m_tagsLength*=2;
												this.m_tags=resize_number_array(this.m_tags,this.m_tagsLength);
												this.m_tagType=resize_number_array(this.m_tagType,this.m_tagsLength);
											}
											this.m_tags[this.m_tagCount]=t_i;
											this.m_tagType[this.m_tagCount]=0;
											this.m_tagCount+=1;
											t_inTag=true;
										}
									}
								}else{
									if(this.m_str.charCodeAt(t_i)==62){
										if(!t_inTag){
											throw c_XMLParseException.m_new.call(new c_XMLParseException,"XMLParser.CacheControlCharacters: Invalid greater than!",null);
										}
										if(this.m_tagCount+1==this.m_tagsLength){
											this.m_tagsLength*=2;
											this.m_tags=resize_number_array(this.m_tags,this.m_tagsLength);
											this.m_tagType=resize_number_array(this.m_tagType,this.m_tagsLength);
										}
										this.m_tags[this.m_tagCount]=t_i;
										this.m_tagType[this.m_tagCount]=0;
										this.m_tagCount+=1;
										t_inTag=false;
									}
								}
							}
						}
					}
				}
			}
		}
	}
	if(t_inQuote){
		throw c_XMLParseException.m_new.call(new c_XMLParseException,"XMLParser.CacheControlCharacters: Unclosed quote!",null);
	}
	if(t_inTag){
		throw c_XMLParseException.m_new.call(new c_XMLParseException,"XMLParser.CacheControlCharacters: Unclosed tag!",null);
	}
	if(t_inComment){
		throw c_XMLParseException.m_new.call(new c_XMLParseException,"XMLParser.CacheControlCharacters: Unclosed comment!",null);
	}
	if(t_inCdata){
		throw c_XMLParseException.m_new.call(new c_XMLParseException,"XMLParser.CacheControlCharacters: Unclosed cdata!",null);
	}
	if(t_inPi){
		throw c_XMLParseException.m_new.call(new c_XMLParseException,"XMLParser.CacheControlCharacters: Unclosed processing instruction!",null);
	}
}
c_XMLParser.prototype.p_TrimString=function(t_startIdx,t_endIdx,t_trimmed){
	var t_trimStart=t_startIdx;
	var t_trimEnd=t_endIdx;
	while(t_trimEnd>t_trimStart){
		var t_ch=this.m_str.charCodeAt(t_trimEnd-1);
		if(t_ch==13 || t_ch==10 || t_ch==32 || t_ch==9){
			t_trimEnd-=1;
		}else{
			break;
		}
	}
	while(t_trimStart<t_trimEnd){
		var t_ch2=this.m_str.charCodeAt(t_trimStart);
		if(t_ch2==13 || t_ch2==10 || t_ch2==32 || t_ch2==9){
			t_trimStart+=1;
		}else{
			break;
		}
	}
	t_trimmed[0]=t_trimStart;
	t_trimmed[1]=t_trimEnd;
}
c_XMLParser.prototype.p_GetTagContents=function(t_startIndex,t_endIndex){
	if(t_startIndex==t_endIndex){
		throw c_XMLParseException.m_new.call(new c_XMLParseException,"XMLParser.GetTagContents: Empty tag detected.",null);
	}
	var t_e=c_XMLElement.m_new.call(new c_XMLElement);
	var t_a=0;
	var t_singleQuoted=false;
	var t_doubleQuoted=false;
	var t_key="";
	var t_value="";
	t_a=t_startIndex;
	while(t_a<t_endIndex){
		if(this.m_str.charCodeAt(t_a)==32 || this.m_str.charCodeAt(t_a)==9 || this.m_str.charCodeAt(t_a)==10 || this.m_str.charCodeAt(t_a)==13){
			t_e.m_name=this.m_str.slice(t_startIndex,t_a);
			t_a+=1;
			break;
		}else{
			if(t_a==t_endIndex-1){
				t_e.m_name=this.m_str.slice(t_startIndex,t_endIndex);
			}
		}
		t_a+=1;
	}
	t_startIndex=t_a;
	if(t_e.m_name==""){
		throw c_XMLParseException.m_new.call(new c_XMLParseException,"XMLParser.GetTagContents: Error reading tag name.",null);
	}
	while(t_startIndex<t_endIndex){
		while(t_startIndex<t_endIndex && (this.m_str.charCodeAt(t_startIndex)==32 || this.m_str.charCodeAt(t_startIndex)==9 || this.m_str.charCodeAt(t_startIndex)==10 || this.m_str.charCodeAt(t_startIndex)==13)){
			t_startIndex+=1;
		}
		t_singleQuoted=false;
		t_doubleQuoted=false;
		t_key="";
		t_value="";
		t_a=t_startIndex;
		while(t_a<t_endIndex){
			if(this.m_str.charCodeAt(t_a)==61 || this.m_str.charCodeAt(t_a)==32 || this.m_str.charCodeAt(t_a)==9 || this.m_str.charCodeAt(t_a)==10 || this.m_str.charCodeAt(t_a)==13 || t_a==t_endIndex-1){
				if(t_a==t_endIndex-1){
					t_key=this.m_str.slice(t_startIndex,t_endIndex);
				}else{
					t_key=this.m_str.slice(t_startIndex,t_a);
				}
				t_a+=1;
				break;
			}
			t_a+=1;
		}
		t_startIndex=t_a;
		if(t_key==""){
			if(t_a<t_endIndex){
				throw c_XMLParseException.m_new.call(new c_XMLParseException,"XMLParser.GetTagContents: Error reading attribute key.",null);
			}else{
				break;
			}
		}
		if(this.m_str.charCodeAt(t_a-1)==61){
			t_singleQuoted=false;
			t_doubleQuoted=false;
			while(t_a<t_endIndex){
				if(this.m_str.charCodeAt(t_a)==39 && !t_doubleQuoted){
					if(t_a==t_startIndex){
						t_singleQuoted=true;
					}else{
						if(!t_singleQuoted && !t_doubleQuoted){
							throw c_XMLParseException.m_new.call(new c_XMLParseException,"XMLParser.GetTagContents: Unexpected single quote detected in attribute value.",null);
						}else{
							t_singleQuoted=false;
							t_value=this.m_str.slice(t_startIndex+1,t_a);
							t_a+=1;
							break;
						}
					}
				}else{
					if(this.m_str.charCodeAt(t_a)==34 && !t_singleQuoted){
						if(t_a==t_startIndex){
							t_doubleQuoted=true;
						}else{
							if(!t_singleQuoted && !t_doubleQuoted){
								throw c_XMLParseException.m_new.call(new c_XMLParseException,"XMLParser.GetTagContents: Unexpected double quote detected in attribute value.",null);
							}else{
								t_doubleQuoted=false;
								t_value=this.m_str.slice(t_startIndex+1,t_a);
								t_a+=1;
								break;
							}
						}
					}else{
						if(t_a==t_endIndex-1 || !t_singleQuoted && !t_doubleQuoted && (this.m_str.charCodeAt(t_a)==32 || this.m_str.charCodeAt(t_a)==9 || this.m_str.charCodeAt(t_a)==10 || this.m_str.charCodeAt(t_a)==13)){
							if(t_a==t_endIndex-1){
								t_value=this.m_str.slice(t_startIndex,t_endIndex);
							}else{
								t_value=this.m_str.slice(t_startIndex,t_a);
							}
							t_a+=1;
							break;
						}
					}
				}
				t_a+=1;
			}
			t_startIndex=t_a;
			t_value=bb_xml_UnescapeXMLString(t_value);
			if(t_singleQuoted || t_doubleQuoted){
				throw c_XMLParseException.m_new.call(new c_XMLParseException,"XMLParser.GetTagContents: Unclosed quote detected.",null);
			}
		}
		t_e.p_SetAttribute(t_key,t_value);
		if(t_a>=t_endIndex){
			break;
		}
	}
	return t_e;
}
c_XMLParser.prototype.p_ParseString2=function(t_str){
	this.m_str=t_str;
	var t_doc=c_XMLDocument.m_new.call(new c_XMLDocument,"");
	var t_elements=c_Stack11.m_new.call(new c_Stack11);
	var t_thisE=null;
	var t_newE=null;
	var t_index=0;
	var t_a=0;
	var t_b=0;
	var t_c=0;
	var t_nextIndex=0;
	var t_trimmed=new_number_array(2);
	this.p_CacheControlCharacters();
	if(this.m_tagCount==0){
		throw c_XMLParseException.m_new.call(new c_XMLParseException,"XMLParser.ParseString: Something seriously wrong... no tags!",null);
	}
	t_index=0;
	t_a=this.m_pis[t_index]+2;
	t_b=this.m_pis[t_index+1]-1;
	while(t_index<this.m_piCount){
		this.p_TrimString(t_a,t_b,t_trimmed);
		if(t_trimmed[0]!=t_trimmed[1]){
			t_newE=this.p_GetTagContents(t_trimmed[0],t_trimmed[1]);
			t_newE.m_pi=true;
			t_doc.m_pi.p_Push31(t_newE);
			t_newE=null;
		}else{
			throw c_XMLParseException.m_new.call(new c_XMLParseException,"XMLParser.ParseString: Empty processing instruction.",null);
		}
		t_index+=2;
	}
	t_index=0;
	while(t_index+1<this.m_tagCount){
		if(this.m_tagType[t_index]==1){
		}else{
			if(this.m_tagType[t_index]==2){
				t_a=this.m_tags[t_index]+9;
				t_b=this.m_tags[t_index+1]-2;
				t_newE=c_XMLElement.m_new.call(new c_XMLElement);
				t_newE.m_cdata=true;
				t_newE.m_value=t_str.slice(t_a,t_b);
				t_newE.m_parent=t_thisE;
				t_thisE.p_AddChild(t_newE);
				t_newE=null;
			}else{
				t_a=this.m_tags[t_index]+1;
				t_b=this.m_tags[t_index+1];
				this.p_TrimString(t_a,t_b,t_trimmed);
				if(t_trimmed[0]==t_trimmed[1]){
					throw c_XMLParseException.m_new.call(new c_XMLParseException,"XMLParser.ParseString: Empty tag.",null);
				}
				if(t_str.charCodeAt(t_trimmed[0])==47){
					if(t_thisE==null){
						throw c_XMLParseException.m_new.call(new c_XMLParseException,"XMLParser.ParseString: Closing tag found outside main document tag.",null);
					}
					t_trimmed[0]+=1;
					if(t_trimmed[1]-t_trimmed[0]!=t_thisE.m_name.length){
						throw c_XMLParseException.m_new.call(new c_XMLParseException,"Closing tag \""+t_str.slice(t_trimmed[0],t_trimmed[1])+"\" does not match opening tag \""+t_thisE.m_name+"\"",null);
					}
					for(var t_nameIdx=0;t_nameIdx<t_thisE.m_name.length;t_nameIdx=t_nameIdx+1){
						if(t_str.charCodeAt(t_trimmed[0]+t_nameIdx)!=t_thisE.m_name.charCodeAt(t_nameIdx)){
							throw c_XMLParseException.m_new.call(new c_XMLParseException,"Closing tag \""+t_str.slice(t_trimmed[0],t_trimmed[1])+"\" does not match opening tag \""+t_thisE.m_name+"\"",null);
						}
					}
					if(!t_elements.p_IsEmpty()){
						t_thisE=t_elements.p_Pop();
					}else{
						break;
					}
				}else{
					if(t_str.charCodeAt(t_trimmed[1]-1)==47){
						t_trimmed[1]-=1;
						t_newE=this.p_GetTagContents(t_trimmed[0],t_trimmed[1]);
						if(t_doc.m_root==null){
							t_doc.m_root=t_newE;
						}
						if(t_thisE!=null){
							t_thisE.p_AddChild(t_newE);
						}else{
							break;
						}
						t_newE=null;
					}else{
						t_newE=this.p_GetTagContents(t_trimmed[0],t_trimmed[1]);
						if(t_doc.m_root==null){
							t_doc.m_root=t_newE;
						}
						if(t_thisE!=null){
							t_thisE.p_AddChild(t_newE);
						}
						t_elements.p_Push31(t_thisE);
						t_thisE=t_newE;
						t_newE=null;
					}
				}
			}
		}
		t_index+=1;
		if(t_index<this.m_tagCount){
			t_a=this.m_tags[t_index]+1;
			t_b=this.m_tags[t_index+1];
			this.p_TrimString(t_a,t_b,t_trimmed);
			if(t_trimmed[0]!=t_trimmed[1]){
				if(t_thisE!=null){
					t_thisE.m_value=t_thisE.m_value+bb_xml_UnescapeXMLString(t_str.slice(t_trimmed[0],t_trimmed[1]));
				}
			}
		}
		t_index+=1;
	}
	if(t_doc.m_root==null){
		throw c_XMLParseException.m_new.call(new c_XMLParseException,"XMLParser.ParseString: Error parsing XML: no document tag found.",null);
	}
	return t_doc;
}
function c_XMLDocument(){
	Object.call(this);
	this.m_root=null;
	this.m_pi=c_Stack11.m_new.call(new c_Stack11);
}
c_XMLDocument.m_new=function(t_rootName){
	if(t_rootName!=""){
		this.m_root=c_XMLElement.m_new2.call(new c_XMLElement,t_rootName,null);
	}
	return this;
}
c_XMLDocument.m_new2=function(t_root){
	this.m_root=t_root;
	return this;
}
c_XMLDocument.prototype.p_Root=function(){
	return this.m_root;
}
function c_XMLElement(){
	Object.call(this);
	this.m_parent=null;
	this.m_name="";
	this.m_children=c_Stack11.m_new.call(new c_Stack11);
	this.m_attributes=c_Stack12.m_new.call(new c_Stack12);
	this.m_pi=false;
	this.m_cdata=false;
	this.m_value="";
}
c_XMLElement.m_new=function(){
	return this;
}
c_XMLElement.m_new2=function(t_name,t_parent){
	this.m_parent=t_parent;
	this.m_name=t_name;
	if(t_parent!=null){
		t_parent.m_children.p_Push31(this);
	}
	return this;
}
c_XMLElement.prototype.p_SetAttribute=function(t_name,t_value){
	if(!((t_name).length!=0)){
		throw c_IllegalArgumentException.m_new.call(new c_IllegalArgumentException,"XMLElement.SetAttribute: name must not be empty",null);
	}
	for(var t_i=0;t_i<this.m_attributes.p_Length2();t_i=t_i+1){
		var t_att=this.m_attributes.p_Get6(t_i);
		if(t_att.m_name==t_name){
			var t_old=t_att.m_value;
			t_att.m_value=t_value;
			return t_old;
		}
	}
	this.m_attributes.p_Push34(c_XMLAttribute.m_new.call(new c_XMLAttribute,t_name,t_value));
	return "";
}
c_XMLElement.prototype.p_AddChild=function(t_child){
	if(this.m_children.p_Contains4(t_child)){
		return;
	}
	this.m_children.p_Push31(t_child);
	t_child.m_parent=this;
}
c_XMLElement.prototype.p_MatchesAttribute=function(t_check){
	var t_=this.m_attributes.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_attr=t_.p_NextObject();
		if(t_attr.p_Matches(t_check)){
			return true;
		}
	}
	return false;
}
c_XMLElement.prototype.p_GetFirstChildByName=function(t_findName,t_att1,t_att2,t_att3,t_att4,t_att5,t_att6,t_att7,t_att8,t_att9,t_att10){
	if(!((t_findName).length!=0)){
		throw c_IllegalArgumentException.m_new.call(new c_IllegalArgumentException,"XMLElement.GetFirstChildByName: findName must not be empty",null);
	}
	var t_=this.m_children.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_element=t_.p_NextObject();
		if(t_element.m_name==t_findName){
			if(((t_att1).length!=0) && !t_element.p_MatchesAttribute(t_att1)){
				continue;
			}
			if(((t_att2).length!=0) && !t_element.p_MatchesAttribute(t_att2)){
				continue;
			}
			if(((t_att3).length!=0) && !t_element.p_MatchesAttribute(t_att3)){
				continue;
			}
			if(((t_att4).length!=0) && !t_element.p_MatchesAttribute(t_att4)){
				continue;
			}
			if(((t_att5).length!=0) && !t_element.p_MatchesAttribute(t_att5)){
				continue;
			}
			if(((t_att6).length!=0) && !t_element.p_MatchesAttribute(t_att6)){
				continue;
			}
			if(((t_att7).length!=0) && !t_element.p_MatchesAttribute(t_att7)){
				continue;
			}
			if(((t_att8).length!=0) && !t_element.p_MatchesAttribute(t_att8)){
				continue;
			}
			if(((t_att9).length!=0) && !t_element.p_MatchesAttribute(t_att9)){
				continue;
			}
			if(((t_att10).length!=0) && !t_element.p_MatchesAttribute(t_att10)){
				continue;
			}
			return t_element;
		}
	}
	return null;
}
c_XMLElement.prototype.p_GetChildrenByName=function(t_findName,t_att1,t_att2,t_att3,t_att4,t_att5,t_att6,t_att7,t_att8,t_att9,t_att10){
	if(!((t_findName).length!=0)){
		throw c_IllegalArgumentException.m_new.call(new c_IllegalArgumentException,"XMLElement.GetChildrenByName: findName must not be empty",null);
	}
	var t_rv=c_Stack11.m_new.call(new c_Stack11);
	var t_=this.m_children.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_element=t_.p_NextObject();
		if(t_element.m_name==t_findName){
			if(((t_att1).length!=0) && !t_element.p_MatchesAttribute(t_att1)){
				continue;
			}
			if(((t_att2).length!=0) && !t_element.p_MatchesAttribute(t_att2)){
				continue;
			}
			if(((t_att3).length!=0) && !t_element.p_MatchesAttribute(t_att3)){
				continue;
			}
			if(((t_att4).length!=0) && !t_element.p_MatchesAttribute(t_att4)){
				continue;
			}
			if(((t_att5).length!=0) && !t_element.p_MatchesAttribute(t_att5)){
				continue;
			}
			if(((t_att6).length!=0) && !t_element.p_MatchesAttribute(t_att6)){
				continue;
			}
			if(((t_att7).length!=0) && !t_element.p_MatchesAttribute(t_att7)){
				continue;
			}
			if(((t_att8).length!=0) && !t_element.p_MatchesAttribute(t_att8)){
				continue;
			}
			if(((t_att9).length!=0) && !t_element.p_MatchesAttribute(t_att9)){
				continue;
			}
			if(((t_att10).length!=0) && !t_element.p_MatchesAttribute(t_att10)){
				continue;
			}
			t_rv.p_Push31(t_element);
		}
	}
	return t_rv;
}
c_XMLElement.prototype.p_GetAttribute=function(t_name,t_defaultValue){
	if(!((t_name).length!=0)){
		return "";
	}
	for(var t_i=0;t_i<this.m_attributes.p_Length2();t_i=t_i+1){
		var t_att=this.m_attributes.p_Get6(t_i);
		if(t_att.m_name==t_name){
			return t_att.m_value;
		}
	}
	return t_defaultValue;
}
function c_Stack11(){
	Object.call(this);
	this.m_data=[];
	this.m_length=0;
}
c_Stack11.m_new=function(){
	return this;
}
c_Stack11.m_new2=function(t_data){
	this.m_data=t_data.slice(0);
	this.m_length=t_data.length;
	return this;
}
c_Stack11.prototype.p_Push31=function(t_value){
	if(this.m_length==this.m_data.length){
		this.m_data=resize_object_array(this.m_data,this.m_length*2+10);
	}
	this.m_data[this.m_length]=t_value;
	this.m_length+=1;
}
c_Stack11.prototype.p_Push32=function(t_values,t_offset,t_count){
	for(var t_i=0;t_i<t_count;t_i=t_i+1){
		this.p_Push31(t_values[t_offset+t_i]);
	}
}
c_Stack11.prototype.p_Push33=function(t_values,t_offset){
	this.p_Push32(t_values,t_offset,t_values.length-t_offset);
}
c_Stack11.prototype.p_Equals7=function(t_lhs,t_rhs){
	return t_lhs==t_rhs;
}
c_Stack11.prototype.p_Contains4=function(t_value){
	for(var t_i=0;t_i<this.m_length;t_i=t_i+1){
		if(this.p_Equals7(this.m_data[t_i],t_value)){
			return true;
		}
	}
	return false;
}
c_Stack11.prototype.p_IsEmpty=function(){
	return this.m_length==0;
}
c_Stack11.m_NIL=null;
c_Stack11.prototype.p_Pop=function(){
	this.m_length-=1;
	var t_v=this.m_data[this.m_length];
	this.m_data[this.m_length]=c_Stack11.m_NIL;
	return t_v;
}
c_Stack11.prototype.p_ObjectEnumerator=function(){
	return c_Enumerator3.m_new.call(new c_Enumerator3,this);
}
c_Stack11.prototype.p_Length=function(t_newlength){
	if(t_newlength<this.m_length){
		for(var t_i=t_newlength;t_i<this.m_length;t_i=t_i+1){
			this.m_data[t_i]=c_Stack11.m_NIL;
		}
	}else{
		if(t_newlength>this.m_data.length){
			this.m_data=resize_object_array(this.m_data,bb_math_Max(this.m_length*2+10,t_newlength));
		}
	}
	this.m_length=t_newlength;
}
c_Stack11.prototype.p_Length2=function(){
	return this.m_length;
}
function bb_xml_UnescapeXMLString(t_str){
	if(!((t_str).length!=0)){
		return "";
	}
	t_str=string_replace(t_str,"&quot;","\"");
	t_str=string_replace(t_str,"&apos;","'");
	t_str=string_replace(t_str,"&gt;",">");
	t_str=string_replace(t_str,"&lt;","<");
	t_str=string_replace(t_str,"&amp;","&");
	return t_str;
}
function c_XMLAttribute(){
	Object.call(this);
	this.m_name="";
	this.m_value="";
}
c_XMLAttribute.m_new=function(t_name,t_value){
	this.m_name=t_name;
	this.m_value=t_value;
	return this;
}
c_XMLAttribute.m_new2=function(){
	return this;
}
c_XMLAttribute.prototype.p_Matches=function(t_check){
	return t_check==this.m_name+"="+this.m_value;
}
function c_Stack12(){
	Object.call(this);
	this.m_data=[];
	this.m_length=0;
}
c_Stack12.m_new=function(){
	return this;
}
c_Stack12.m_new2=function(t_data){
	this.m_data=t_data.slice(0);
	this.m_length=t_data.length;
	return this;
}
c_Stack12.m_NIL=null;
c_Stack12.prototype.p_Length=function(t_newlength){
	if(t_newlength<this.m_length){
		for(var t_i=t_newlength;t_i<this.m_length;t_i=t_i+1){
			this.m_data[t_i]=c_Stack12.m_NIL;
		}
	}else{
		if(t_newlength>this.m_data.length){
			this.m_data=resize_object_array(this.m_data,bb_math_Max(this.m_length*2+10,t_newlength));
		}
	}
	this.m_length=t_newlength;
}
c_Stack12.prototype.p_Length2=function(){
	return this.m_length;
}
c_Stack12.prototype.p_Get6=function(t_index){
	return this.m_data[t_index];
}
c_Stack12.prototype.p_Push34=function(t_value){
	if(this.m_length==this.m_data.length){
		this.m_data=resize_object_array(this.m_data,this.m_length*2+10);
	}
	this.m_data[this.m_length]=t_value;
	this.m_length+=1;
}
c_Stack12.prototype.p_Push35=function(t_values,t_offset,t_count){
	for(var t_i=0;t_i<t_count;t_i=t_i+1){
		this.p_Push34(t_values[t_offset+t_i]);
	}
}
c_Stack12.prototype.p_Push36=function(t_values,t_offset){
	this.p_Push35(t_values,t_offset,t_values.length-t_offset);
}
c_Stack12.prototype.p_ObjectEnumerator=function(){
	return c_Enumerator4.m_new.call(new c_Enumerator4,this);
}
function c_Enumerator3(){
	Object.call(this);
	this.m_stack=null;
	this.m_index=0;
}
c_Enumerator3.m_new=function(t_stack){
	this.m_stack=t_stack;
	return this;
}
c_Enumerator3.m_new2=function(){
	return this;
}
c_Enumerator3.prototype.p_HasNext=function(){
	return this.m_index<this.m_stack.p_Length2();
}
c_Enumerator3.prototype.p_NextObject=function(){
	this.m_index+=1;
	return this.m_stack.m_data[this.m_index-1];
}
function c_Enumerator4(){
	Object.call(this);
	this.m_stack=null;
	this.m_index=0;
}
c_Enumerator4.m_new=function(t_stack){
	this.m_stack=t_stack;
	return this;
}
c_Enumerator4.m_new2=function(){
	return this;
}
c_Enumerator4.prototype.p_HasNext=function(){
	return this.m_index<this.m_stack.p_Length2();
}
c_Enumerator4.prototype.p_NextObject=function(){
	this.m_index+=1;
	return this.m_stack.m_data[this.m_index-1];
}
var bb_defaultmedia_ICON_FLAGS=null;
function bb_graphics_DrawCircle(t_x,t_y,t_r){
	bb_graphics_context.p_Validate();
	bb_graphics_renderDevice.DrawOval(t_x-t_r,t_y-t_r,t_r*2.0,t_r*2.0);
	return 0;
}
function bb_graphics_DrawRect(t_x,t_y,t_w,t_h){
	bb_graphics_context.p_Validate();
	bb_graphics_renderDevice.DrawRect(t_x,t_y,t_w,t_h);
	return 0;
}
var bb_defaultmedia_ICON_SCENT=null;
function bb_graphics_DrawImageRect(t_image,t_x,t_y,t_srcX,t_srcY,t_srcWidth,t_srcHeight,t_frame){
	var t_f=t_image.m_frames[t_frame];
	bb_graphics_context.p_Validate();
	bb_graphics_renderDevice.DrawSurface2(t_image.m_surface,-t_image.m_tx+t_x,-t_image.m_ty+t_y,t_srcX+t_f.m_x,t_srcY+t_f.m_y,t_srcWidth,t_srcHeight);
	return 0;
}
function bb_graphics_DrawImageRect2(t_image,t_x,t_y,t_srcX,t_srcY,t_srcWidth,t_srcHeight,t_rotation,t_scaleX,t_scaleY,t_frame){
	var t_f=t_image.m_frames[t_frame];
	bb_graphics_PushMatrix();
	bb_graphics_Translate(t_x,t_y);
	bb_graphics_Rotate(t_rotation);
	bb_graphics_Scale(t_scaleX,t_scaleY);
	bb_graphics_Translate(-t_image.m_tx,-t_image.m_ty);
	bb_graphics_context.p_Validate();
	bb_graphics_renderDevice.DrawSurface2(t_image.m_surface,0.0,0.0,t_srcX+t_f.m_x,t_srcY+t_f.m_y,t_srcWidth,t_srcHeight);
	bb_graphics_PopMatrix();
	return 0;
}
function bb_game_PointInRect(t_x,t_y,t_rx1,t_ry1,t_rx2,t_ry2){
	if(t_x>=t_rx1 && t_x<=t_rx2 && t_y>=t_ry1 && t_y<=t_ry2){
		return 1;
	}
	return 0;
}
var bb_defaultmedia_ICON_LOADER=null;
function c_classRender_Upload(){
	Object.call(this);
}
c_classRender_Upload.m_new=function(){
	return this;
}
c_classRender_Upload.prototype.p_Render2=function(t__mouse){
	var t_x=((bb_collaborate_Collaborate.m_GameWidth/2)|0);
	var t_y=((bb_collaborate_Collaborate.m_GameHeight/2)|0);
	var t_size=1.0;
	var t_angle=bb_math_Abs((bb_app_Millisecs()/15)|0) % 360;
	bb_graphics_SetColor(0.0,0.0,0.0);
	bb_game_fontAngelMini.p_DrawText2(bb_game_cLANGUAGE.p_GetItem(7),t_x,t_y-128,1);
	bb_graphics_SetColor(255.0,255.0,255.0);
	bb_graphics_DrawImage2(bb_defaultmedia_ICON_LOADER,(t_x),(t_y+64),(t_angle),1.0,1.0,0);
	if(bb_game_cSERVER.m_streamIMAGE!=null){
		if(bb_game_cSERVER.m_streamIMAGE.p_IsComplete()==true){
			bb_defaultmedia_IMG_MAIN=bb_game_cSERVER.m_streamIMAGE.p_getImage();
			bb_game_cSERVER.m_streamIMAGE=null;
			bb_game_imageIDSelected=bb_game_cSERVER.m_cSERVER_GETIMAGE.p_getImageID();
			bb_game_originalTAGS.p_FromJson((c_JsonObject.m_new3.call(new c_JsonObject,bb_game_cSERVER.m_cSERVER_GETIMAGE.p_getJSON())),bb_defaultmedia_IMG_MAIN);
			bb_game_originalJsonString=bb_game_cSERVER.m_cSERVER_GETIMAGE.p_getJSON();
			bb_game_selectedTAGS.p_CollaborateFromJson((c_JsonObject.m_new3.call(new c_JsonObject,bb_game_originalJsonString)),bb_defaultmedia_IMG_MAIN);
			bb_session_GameSession.p_SetState(100);
		}
	}
	if(bb_game_cSERVER.m_cSERVER_GETIMAGE.p_isError()==true){
		bb_session_GameSession.p_SetState(109);
	}
	return 0;
}
var bb_game_cRENDER_UPLOAD=null;
function c_Enumerator5(){
	Object.call(this);
	this.m__list=null;
	this.m__curr=null;
}
c_Enumerator5.m_new=function(t_list){
	this.m__list=t_list;
	this.m__curr=t_list.m__head.m__succ;
	return this;
}
c_Enumerator5.m_new2=function(){
	return this;
}
c_Enumerator5.prototype.p_HasNext=function(){
	while(this.m__curr.m__succ.m__pred!=this.m__curr){
		this.m__curr=this.m__curr.m__succ;
	}
	return this.m__curr!=this.m__list.m__head;
}
c_Enumerator5.prototype.p_NextObject=function(){
	var t_data=this.m__curr.m__data;
	this.m__curr=this.m__curr.m__succ;
	return t_data;
}
var bb_defaultmedia_ICON_ROTATE=null;
function bb_graphics_DrawLine(t_x1,t_y1,t_x2,t_y2){
	bb_graphics_context.p_Validate();
	bb_graphics_renderDevice.DrawLine(t_x1,t_y1,t_x2,t_y2);
	return 0;
}
var bb_defaultmedia_ICON_CHECK=null;
function c_AsyncImageLoader(){
	BBAsyncImageLoaderThread.call(this);
	this.m__mpath="";
	this.m__frames=0;
	this.m__flags=0;
	this.m__onComplete=null;
	this.implments={c_IAsyncEventSource:1};
}
c_AsyncImageLoader.prototype=extend_class(BBAsyncImageLoaderThread);
c_AsyncImageLoader.m_new=function(t_path,t_frames,t_flags,t_onComplete){
	this._device=bb_graphics_GetGraphicsDevice();
	this.m__mpath=t_path;
	this._path=bb_data_FixDataPath(t_path);
	this.m__frames=t_frames;
	this.m__flags=t_flags;
	this.m__onComplete=t_onComplete;
	return this;
}
c_AsyncImageLoader.m_new2=function(){
	return this;
}
c_AsyncImageLoader.prototype.Start=function(){
	bb_asyncevent_AddAsyncEventSource(this);
	BBAsyncImageLoaderThread.prototype.Start.call(this);
}
c_AsyncImageLoader.prototype.p_UpdateAsyncEvents=function(){
	if(this.IsRunning()){
		return;
	}
	bb_asyncevent_RemoveAsyncEventSource(this);
	if(this._result){
		this._surface.OnUnsafeLoadComplete();
		var t_image=(c_Image.m_new.call(new c_Image)).p_Init2(this._surface,this.m__frames,this.m__flags);
		this.m__onComplete.p_OnLoadImageComplete(t_image,this.m__mpath,(this));
	}else{
		this.m__onComplete.p_OnLoadImageComplete(null,this.m__mpath,(this));
	}
}
function bb_graphics_GetGraphicsDevice(){
	return bb_graphics_device;
}
function bb_asyncloaders_LoadImageAsync(t_path,t_frames,t_flags,t_onComplete){
	var t_loader=c_AsyncImageLoader.m_new.call(new c_AsyncImageLoader,t_path,t_frames,t_flags,t_onComplete);
	t_loader.Start();
}
function c_Enumerator6(){
	Object.call(this);
	this.m__list=null;
	this.m__curr=null;
}
c_Enumerator6.m_new=function(t_list){
	this.m__list=t_list;
	this.m__curr=t_list.m__head.m__succ;
	return this;
}
c_Enumerator6.m_new2=function(){
	return this;
}
c_Enumerator6.prototype.p_HasNext=function(){
	while(this.m__curr.m__succ.m__pred!=this.m__curr){
		this.m__curr=this.m__curr.m__succ;
	}
	return this.m__curr!=this.m__list.m__head;
}
c_Enumerator6.prototype.p_NextObject=function(){
	var t_data=this.m__curr.m__data;
	this.m__curr=this.m__curr.m__succ;
	return t_data;
}
var bb_defaultmedia_ICON_VERIFY=null;
var bb_defaultmedia_ICON_INFO=null;
var bb_render_collaborate_MENU_START_Y=0;
function bb_audio_StopChannel(t_channel){
	bb_audio_device.StopChannel(t_channel);
	return 0;
}
function bb_audio_PlaySound(t_sound,t_channel,t_flags){
	if(((t_sound)!=null) && ((t_sound.m_sample)!=null)){
		bb_audio_device.PlaySample(t_sound.m_sample,t_channel,t_flags);
	}
	return 0;
}
var bb_defaultmedia_SPRITE_HELPER=null;
var bb_defaultmedia_ICON_SCROLL=null;
function bb_graphics_GetMatrix(){
	return [bb_graphics_context.m_ix,bb_graphics_context.m_iy,bb_graphics_context.m_jx,bb_graphics_context.m_jy,bb_graphics_context.m_tx,bb_graphics_context.m_ty];
}
function bb_graphics_GetMatrix2(t_matrix){
	t_matrix[0]=bb_graphics_context.m_ix;
	t_matrix[1]=bb_graphics_context.m_iy;
	t_matrix[2]=bb_graphics_context.m_jx;
	t_matrix[3]=bb_graphics_context.m_jy;
	t_matrix[4]=bb_graphics_context.m_tx;
	t_matrix[5]=bb_graphics_context.m_ty;
	return 0;
}
function c_structItemsPin(){
	Object.call(this);
	this.m_drag=false;
}
c_structItemsPin.m_new=function(){
	return this;
}
function c_classRender_Send(){
	Object.call(this);
}
c_classRender_Send.m_new=function(){
	return this;
}
c_classRender_Send.prototype.p_Render2=function(t__mouse){
	var t_x=((bb_collaborate_Collaborate.m_GameWidth/2)|0);
	var t_y=((bb_collaborate_Collaborate.m_GameHeight/2)|0);
	var t_size=1.0;
	var t_angle=bb_math_Abs((bb_app_Millisecs()/15)|0) % 360;
	bb_graphics_SetColor(0.0,0.0,0.0);
	bb_game_fontAngelMini.p_DrawText2("Upload informations",t_x,t_y-128,1);
	bb_graphics_SetColor(255.0,255.0,255.0);
	bb_graphics_DrawImage2(bb_defaultmedia_ICON_LOADER,(t_x),(t_y+64),(t_angle),1.0,1.0,0);
	if(bb_math_Abs(bb_app_Millisecs()-bb_game_gStartTimer)>1000){
		bb_session_GameSession.p_SetState(3);
	}
	return 0;
}
var bb_game_cRENDER_SEND=null;
var bb_defaultmedia_ICON_REFRESH=null;
function bb_rendergame_RenderPilot(){
	if(bb_game_defineCampaign!=""){
		bb_graphics_SetColor(0.0,0.0,0.0);
		bb_graphics_SetAlpha(0.75);
		bb_graphics_DrawRect(0.0,0.0,(bb_collaborate_Collaborate.m_GameWidth),32.0);
		bb_graphics_SetAlpha(1.0);
		bb_graphics_SetColor(255.0,255.0,255.0);
		bb_game_fontAngelMini.p_DrawText(bb_game_defineCampaign,32,4);
	}
	return 0;
}
function bb_rendergame_RenderStates(){
	bb_autofit_SetVirtualDisplay(bb_collaborate_Collaborate.m_GameWidth,bb_collaborate_Collaborate.m_GameHeight,1.0);
	bb_autofit_UpdateVirtualDisplay(true,true);
	bb_graphics_Cls(210.0,210.0,210.0);
	if(bb_game_cRENDER_INFO.m_bEnabled==true){
		bb_collaborate_Collaborate.m_mouse.m_x=0;
		bb_collaborate_Collaborate.m_mouse.m_y=0;
	}
	var t_1=c_Session.m_GameState;
	if(t_1==2){
		bb_game_cRENDER_INTRO.p_Render2(bb_collaborate_Collaborate.m_mouse);
		bb_game_cRENDER_HELPER.p_Render(bb_collaborate_Collaborate.m_mouse,2);
	}else{
		if(t_1==10){
			bb_game_cRENDER_LOGIN.p_RenderWait(bb_collaborate_Collaborate.m_mouse);
		}else{
			if(t_1==3){
				bb_game_cRENDER_UPLOAD.p_Render2(bb_collaborate_Collaborate.m_mouse);
			}else{
				if(t_1==101){
					if(c_Session.m_bExpertMode==false){
						bb_game_cRENDER_SCENTVALIDATE.p_Render(bb_collaborate_Collaborate.m_mouse,101);
					}else{
						bb_game_cRENDER_SCENTVALIDATEEXPERT.p_Render(bb_collaborate_Collaborate.m_mouse,101);
					}
					bb_game_cRENDER_PROFILE.p_Render2(bb_collaborate_Collaborate.m_mouse);
					bb_game_cRENDER_PROFILE.p_RenderBB(bb_collaborate_Collaborate.m_mouse,bb_game_originalTAGS,bb_game_selectedTAGS,bb_game_cRENDER_SCENTVALIDATE.m_startX,bb_game_cRENDER_SCENTVALIDATE.m_startY,bb_game_cRENDER_SCENTVALIDATE.m_ratioPhoto);
					bb_game_cRENDER_PROFILE.p_RenderAudio(bb_collaborate_Collaborate.m_mouse);
					bb_game_cRENDER_INFO.p_Render2(bb_collaborate_Collaborate.m_mouse);
					bb_game_cRENDER_HELPER.p_Render(bb_collaborate_Collaborate.m_mouse,101);
					bb_game_cRENDER_LANGUAGE.p_Render2(bb_collaborate_Collaborate.m_mouse);
				}else{
					if(t_1==104){
						bb_game_cRENDER_SCENTVALIDATE.p_Render(bb_collaborate_Collaborate.m_mouse,104);
						bb_game_cRENDER_HELPER.p_Render(bb_collaborate_Collaborate.m_mouse,101);
					}else{
						if(t_1==105){
							bb_game_cRENDER_SCENTVALIDATE.p_Render(bb_collaborate_Collaborate.m_mouse,105);
							bb_game_cRENDER_HELPER.p_Render(bb_collaborate_Collaborate.m_mouse,101);
						}else{
							if(t_1==106){
								bb_game_cRENDER_SCENTVALIDATE.p_Render(bb_collaborate_Collaborate.m_mouse,106);
								bb_game_cRENDER_HELPER.p_Render(bb_collaborate_Collaborate.m_mouse,101);
							}else{
								if(t_1==108){
									bb_game_cRENDER_SCENTVALIDATE.p_Render(bb_collaborate_Collaborate.m_mouse,108);
									bb_game_cRENDER_HELPER.p_Render(bb_collaborate_Collaborate.m_mouse,108);
								}else{
									if(t_1==102){
										bb_game_cRENDER_SCENTVALIDATE.p_Render(bb_collaborate_Collaborate.m_mouse,102);
										bb_game_cRENDER_SCENTVALIDATE.p_RenderOk(bb_collaborate_Collaborate.m_mouse);
									}else{
										if(t_1==103){
											bb_game_cRENDER_SCENTVALIDATE.p_Render(bb_collaborate_Collaborate.m_mouse,103);
											bb_game_cRENDER_SCENTVALIDATE.p_RenderWIP(bb_collaborate_Collaborate.m_mouse);
										}else{
											if(t_1==120){
												bb_game_cRENDER_SCENTTAG.p_Render(bb_collaborate_Collaborate.m_mouse,120);
											}else{
												if(t_1==121){
													bb_game_cRENDER_SCENTTAG.p_Render(bb_collaborate_Collaborate.m_mouse,121);
													bb_game_cRENDER_PROFILE.p_Render2(bb_collaborate_Collaborate.m_mouse);
													bb_game_cRENDER_PROFILE.p_RenderBB(bb_collaborate_Collaborate.m_mouse,bb_game_originalTAGS,bb_game_selectedTAGS,bb_game_cRENDER_SCENTVALIDATE.m_startX,bb_game_cRENDER_SCENTVALIDATE.m_startY,bb_game_cRENDER_SCENTVALIDATE.m_ratioPhoto);
													bb_game_cRENDER_PROFILE.p_RenderAudio(bb_collaborate_Collaborate.m_mouse);
													bb_game_cRENDER_HELPER.p_Render(bb_collaborate_Collaborate.m_mouse,121);
												}else{
													if(t_1==122){
														bb_game_cRENDER_SCENTTAG.p_Render(bb_collaborate_Collaborate.m_mouse,122);
														bb_game_cRENDER_HELPER.p_Render(bb_collaborate_Collaborate.m_mouse,121);
													}else{
														if(t_1==123){
															bb_game_cRENDER_SCENTTAG.p_Render(bb_collaborate_Collaborate.m_mouse,123);
															bb_game_cRENDER_HELPER.p_Render(bb_collaborate_Collaborate.m_mouse,121);
														}else{
															if(t_1==124){
																bb_game_cRENDER_SCENTTAG.p_Render(bb_collaborate_Collaborate.m_mouse,124);
																bb_game_cRENDER_SCENTTAG.p_RenderOk(bb_collaborate_Collaborate.m_mouse);
															}else{
																if(t_1==125){
																	bb_game_cRENDER_SCENTTAG.p_Render(bb_collaborate_Collaborate.m_mouse,125);
																	bb_game_cRENDER_SCENTTAG.p_RenderWIP(bb_collaborate_Collaborate.m_mouse);
																}else{
																	if(t_1==130){
																		bb_game_cRENDER_SCENTTAG.p_Render(bb_collaborate_Collaborate.m_mouse,130);
																		bb_game_cRENDER_SCENTTAG.p_RenderOk(bb_collaborate_Collaborate.m_mouse);
																	}else{
																		if(t_1==300 || t_1==301){
																			bb_game_cRENDER_SCENTFOCUS.p_Render(bb_collaborate_Collaborate.m_mouse,c_Session.m_GameState);
																		}else{
																			if(t_1==200){
																				bb_game_cRENDER_SCENTANNOTATE.p_Render2(bb_collaborate_Collaborate.m_mouse);
																			}else{
																				if(t_1==1000){
																					bb_game_cRENDER_SEND.p_Render2(bb_collaborate_Collaborate.m_mouse);
																				}else{
																					if(t_1==109){
																						bb_game_cRENDER_ERROR.p_Render(bb_collaborate_Collaborate.m_mouse,109);
																					}else{
																						bb_graphics_Cls(1.0,0.0,0.0);
																					}
																				}
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	bb_rendergame_RenderPilot();
	if(bb_game_startMouseOver.m_x>-1 && bb_game_startMouseOver.m_y>-1){
		mousepointer.pointer();
	}else{
		mousepointer.default();
	}
	bb_game_inputHit=0;
	bb_game_inputRelease=0;
	bb_game_charKeyboard=0;
	bb_game_startMouseOver.m_x=-1;
	bb_game_startMouseOver.m_y=-1;
	return 0;
}
var bb_defaultmedia_SPRITE_ICON=[];
var bb_defaultmedia_SPRITE_LOGO=null;
var bb_defaultmedia_ICON_LOGIN=null;
var bb_defaultmedia_ICON_AUDIO=null;
var bb_game_fontAngel=null;
function c_XMLError(){
	Object.call(this);
	this.m_error=false;
	this.m_message="";
	this.m_line=0;
	this.m_column=0;
	this.m_offset=0;
}
c_XMLError.m_new=function(){
	return this;
}
c_XMLError.prototype.p_Reset=function(){
	this.m_error=false;
	this.m_message="";
	this.m_line=-1;
	this.m_column=-1;
	this.m_offset=-1;
}
c_XMLError.prototype.p_Set5=function(t_message,t_line,t_column,t_offset){
	this.m_error=true;
	this.m_message=t_message;
	this.m_line=t_line;
	this.m_column=t_column;
	this.m_offset=t_offset;
}
c_XMLError.prototype.p_ToString=function(){
	if(this.m_error==false){
		return "";
	}
	var t_buffer=c_XMLStringBuffer.m_new.call(new c_XMLStringBuffer,256);
	t_buffer.p_Add7("XMLError: ");
	if((this.m_message.length)!=0){
		t_buffer.p_Add7(this.m_message);
	}else{
		t_buffer.p_Add7("unknown error");
	}
	t_buffer.p_Add7(" [line:");
	if(this.m_line>-1){
		t_buffer.p_Add7(String(this.m_line));
	}else{
		t_buffer.p_Add7("??");
	}
	t_buffer.p_Add7("  column:");
	if(this.m_column>-1){
		t_buffer.p_Add7(String(this.m_column));
	}else{
		t_buffer.p_Add7("??");
	}
	t_buffer.p_Add7("  offset:");
	if(this.m_offset>-1){
		t_buffer.p_Add7(String(this.m_offset)+"]");
	}else{
		t_buffer.p_Add7("??]");
	}
	return t_buffer.p_value();
}
function c_XMLNode(){
	Object.call(this);
	this.m_value="";
	this.m_name="";
	this.m_valid=false;
	this.m_doc=null;
	this.m_path="";
	this.m_pathList=null;
	this.m_pathListNode=null;
	this.m_parent=null;
	this.m_line=0;
	this.m_column=0;
	this.m_offset=0;
	this.m_attributes=c_StringMap6.m_new.call(new c_StringMap6);
	this.m_lastChild=null;
	this.m_nextSibling=null;
	this.m_previousSibling=null;
	this.m_firstChild=null;
	this.m_children=c_List4.m_new.call(new c_List4);
}
c_XMLNode.m_new=function(t_name,t_valid){
	if((t_name.length)!=0){
		this.m_name=t_name.toLowerCase();
	}
	this.m_valid=t_valid;
	return this;
}
c_XMLNode.m_new2=function(){
	return this;
}
c_XMLNode.prototype.p_SetAttribute2=function(t_id){
	if(this.m_valid==false){
		return;
	}
	t_id=t_id.toLowerCase();
	var t_attribute=this.m_attributes.p_Get(t_id);
	if(t_attribute==null){
		this.m_attributes.p_Insert4(t_id,c_XMLAttribute2.m_new.call(new c_XMLAttribute2,t_id,""));
	}else{
		t_attribute.m_value="";
	}
}
c_XMLNode.prototype.p_SetAttribute3=function(t_id,t_value){
	if(this.m_valid==false){
		return;
	}
	t_id=t_id.toLowerCase();
	var t_attribute=this.m_attributes.p_Get(t_id);
	if(t_attribute==null){
		this.m_attributes.p_Insert4(t_id,c_XMLAttribute2.m_new.call(new c_XMLAttribute2,t_id,String((t_value)?1:0)));
	}else{
		t_attribute.m_value=String((t_value)?1:0);
	}
}
c_XMLNode.prototype.p_SetAttribute4=function(t_id,t_value){
	if(this.m_valid==false){
		return;
	}
	t_id=t_id.toLowerCase();
	var t_attribute=this.m_attributes.p_Get(t_id);
	if(t_attribute==null){
		this.m_attributes.p_Insert4(t_id,c_XMLAttribute2.m_new.call(new c_XMLAttribute2,t_id,String(t_value)));
	}else{
		t_attribute.m_value=String(t_value);
	}
}
c_XMLNode.prototype.p_SetAttribute5=function(t_id,t_value){
	if(this.m_valid==false){
		return;
	}
	t_id=t_id.toLowerCase();
	var t_attribute=this.m_attributes.p_Get(t_id);
	if(t_attribute==null){
		this.m_attributes.p_Insert4(t_id,c_XMLAttribute2.m_new.call(new c_XMLAttribute2,t_id,String(t_value)));
	}else{
		t_attribute.m_value=String(t_value);
	}
}
c_XMLNode.prototype.p_SetAttribute=function(t_id,t_value){
	if(this.m_valid==false){
		return;
	}
	t_id=t_id.toLowerCase();
	var t_attribute=this.m_attributes.p_Get(t_id);
	if(t_attribute==null){
		this.m_attributes.p_Insert4(t_id,c_XMLAttribute2.m_new.call(new c_XMLAttribute2,t_id,t_value));
	}else{
		t_attribute.m_value=t_value;
	}
}
c_XMLNode.prototype.p_AddChild2=function(t_name,t_attributes,t_value){
	if(this.m_valid==false){
		return null;
	}
	var t_child=c_XMLNode.m_new.call(new c_XMLNode,t_name,true);
	t_child.m_doc=this.m_doc;
	t_child.m_parent=this;
	t_child.m_value=t_value;
	t_child.m_path=this.m_path+"/"+t_child.m_name;
	t_child.m_pathList=this.m_doc.m_paths.p_Get(t_child.m_path);
	if(t_child.m_pathList==null){
		t_child.m_pathList=c_List4.m_new.call(new c_List4);
		this.m_doc.m_paths.p_Set6(t_child.m_path,t_child.m_pathList);
	}
	t_child.m_pathListNode=t_child.m_pathList.p_AddLast4(t_child);
	if((t_attributes.length)!=0){
		var t_query=c_XMLAttributeQuery.m_new.call(new c_XMLAttributeQuery,t_attributes);
		if(t_query.p_Length2()>0){
			for(var t_index=0;t_index<t_query.p_Length2();t_index=t_index+1){
				t_child.p_SetAttribute(t_query.m_items[t_index].m_id,t_query.m_items[t_index].m_value);
			}
		}
	}
	if((this.m_lastChild)!=null){
		this.m_lastChild.m_nextSibling=t_child;
		t_child.m_previousSibling=this.m_lastChild;
		this.m_lastChild=t_child;
	}else{
		this.m_firstChild=t_child;
		this.m_lastChild=t_child;
	}
	this.m_children.p_AddLast4(t_child);
	return t_child;
}
c_XMLNode.prototype.p_GetChildrenAtPath=function(t_path){
	var t_result=c_List4.m_new.call(new c_List4);
	if(t_path.length==0){
		return t_result;
	}
	var t_pathList=this.m_doc.m_paths.p_Get(this.m_path+"/"+t_path);
	if(t_pathList==null || t_pathList.p_IsEmpty()){
		return t_result;
	}
	var t_=t_pathList.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_node=t_.p_NextObject();
		t_result.p_AddLast4(t_node);
	}
	return t_result;
}
c_XMLNode.prototype.p_GetXMLAttribute=function(t_id){
	return this.m_attributes.p_Get(t_id.toLowerCase());
}
c_XMLNode.prototype.p_GetChildrenAtPath2=function(t_path,t_attributes){
	var t_result=c_List4.m_new.call(new c_List4);
	if(t_path.length==0){
		return t_result;
	}
	var t_query=c_XMLAttributeQuery.m_new.call(new c_XMLAttributeQuery,t_attributes);
	var t_pathList=this.m_doc.m_paths.p_Get(this.m_path+"/"+t_path);
	if(t_pathList==null || t_pathList.p_IsEmpty()){
		return t_result;
	}
	var t_=t_pathList.p_ObjectEnumerator();
	while(t_.p_HasNext()){
		var t_node=t_.p_NextObject();
		if(t_query.p_Test(t_node)){
			t_result.p_AddLast4(t_node);
		}
	}
	return t_result;
}
c_XMLNode.prototype.p_GetAttribute2=function(t_id){
	t_id=t_id.toLowerCase();
	var t_attribute=this.m_attributes.p_Get(t_id);
	if(t_attribute==null){
		return "";
	}
	return t_attribute.m_value;
}
c_XMLNode.prototype.p_GetAttribute3=function(t_id,t_defaultValue){
	t_id=t_id.toLowerCase();
	var t_attribute=this.m_attributes.p_Get(t_id);
	if(t_attribute==null){
		return t_defaultValue;
	}
	return t_attribute.m_value=="true" || parseInt((t_attribute.m_value),10)==1;
}
c_XMLNode.prototype.p_GetAttribute4=function(t_id,t_defaultValue){
	t_id=t_id.toLowerCase();
	var t_attribute=this.m_attributes.p_Get(t_id);
	if(t_attribute==null){
		return t_defaultValue;
	}
	return parseInt((t_attribute.m_value),10);
}
c_XMLNode.prototype.p_GetAttribute5=function(t_id,t_defaultValue){
	t_id=t_id.toLowerCase();
	var t_attribute=this.m_attributes.p_Get(t_id);
	if(t_attribute==null){
		return t_defaultValue;
	}
	return parseFloat(t_attribute.m_value);
}
c_XMLNode.prototype.p_GetAttribute=function(t_id,t_defaultValue){
	t_id=t_id.toLowerCase();
	var t_attribute=this.m_attributes.p_Get(t_id);
	if(t_attribute==null){
		return t_defaultValue;
	}
	return t_attribute.m_value;
}
function c_XMLDoc(){
	c_XMLNode.call(this);
	this.m_nullNode=null;
	this.m_version="";
	this.m_encoding="";
	this.m_paths=c_StringMap5.m_new.call(new c_StringMap5);
}
c_XMLDoc.prototype=extend_class(c_XMLNode);
c_XMLDoc.m_new=function(t_name,t_version,t_encoding){
	c_XMLNode.m_new2.call(this);
	this.m_valid=true;
	this.m_doc=this;
	this.m_nullNode=c_XMLNode.m_new.call(new c_XMLNode,"",false);
	this.m_nullNode.m_doc=this;
	this.m_name=t_name.toLowerCase();
	this.m_version=t_version;
	this.m_encoding=t_encoding;
	this.m_path=t_name;
	this.m_pathList=c_List4.m_new.call(new c_List4);
	this.m_pathListNode=this.m_pathList.p_AddLast4(this);
	this.m_paths.p_Insert3(this.m_path,this.m_pathList);
	return this;
}
c_XMLDoc.m_new2=function(){
	c_XMLNode.m_new2.call(this);
	return this;
}
function c_XMLStringBuffer(){
	Object.call(this);
	this.m_chunk=128;
	this.m_count=0;
	this.m_data=[];
	this.m_dirty=0;
	this.m_cache="";
}
c_XMLStringBuffer.m_new=function(t_chunk){
	this.m_chunk=t_chunk;
	return this;
}
c_XMLStringBuffer.prototype.p_Length2=function(){
	return this.m_count;
}
c_XMLStringBuffer.prototype.p_Last2=function(t_defaultValue){
	if(this.m_count==0){
		return t_defaultValue;
	}
	return this.m_data[this.m_count-1];
}
c_XMLStringBuffer.prototype.p_Add6=function(t_asc){
	if(this.m_count==this.m_data.length){
		this.m_data=resize_number_array(this.m_data,this.m_data.length+this.m_chunk);
	}
	this.m_data[this.m_count]=t_asc;
	this.m_count+=1;
	this.m_dirty=1;
}
c_XMLStringBuffer.prototype.p_Add7=function(t_text){
	if(t_text.length==0){
		return;
	}
	if(this.m_count+t_text.length>=this.m_data.length){
		this.m_data=resize_number_array(this.m_data,(((this.m_data.length)+(this.m_chunk)*Math.ceil((t_text.length)/(this.m_chunk)))|0));
	}
	for(var t_textIndex=0;t_textIndex<t_text.length;t_textIndex=t_textIndex+1){
		this.m_data[this.m_count]=t_text.charCodeAt(t_textIndex);
		this.m_count+=1;
	}
	this.m_dirty=1;
}
c_XMLStringBuffer.prototype.p_Add8=function(t_text,t_offset,t_suggestedLength){
	var t_realLength=t_text.length-t_offset;
	if(t_suggestedLength>0 && t_suggestedLength<t_realLength){
		t_realLength=t_suggestedLength;
	}
	if(t_realLength==0){
		return;
	}
	if(this.m_count+t_realLength>=this.m_data.length){
		this.m_data=resize_number_array(this.m_data,(((this.m_data.length)+(this.m_chunk)*Math.ceil((t_realLength)/(this.m_chunk)))|0));
	}
	for(var t_textIndex=t_offset;t_textIndex<t_offset+t_realLength;t_textIndex=t_textIndex+1){
		this.m_data[this.m_count]=t_text.charCodeAt(t_textIndex);
		this.m_count+=1;
	}
	this.m_dirty=1;
}
c_XMLStringBuffer.prototype.p_value=function(){
	if((this.m_dirty)!=0){
		this.m_dirty=0;
		if(this.m_count==0){
			this.m_cache="";
		}else{
			this.m_cache=string_fromchars(this.m_data.slice(0,this.m_count));
		}
	}
	return this.m_cache;
}
c_XMLStringBuffer.prototype.p_Clear=function(){
	this.m_count=0;
	this.m_cache="";
	this.m_dirty=0;
}
c_XMLStringBuffer.prototype.p_Trim=function(){
	if(this.m_count==0){
		return false;
	}
	if(this.m_count==1 && (this.m_data[0]==32 || this.m_data[0]==9) || this.m_count==2 && (this.m_data[0]==32 || this.m_data[0]==9) && (this.m_data[1]==32 || this.m_data[1]==9)){
		this.p_Clear();
		return true;
	}
	var t_startIndex=0;
	for(t_startIndex=0;t_startIndex<this.m_count;t_startIndex=t_startIndex+1){
		if(this.m_data[t_startIndex]!=32 && this.m_data[t_startIndex]!=9){
			break;
		}
	}
	if(t_startIndex==this.m_count){
		this.p_Clear();
		return true;
	}
	var t_endIndex=0;
	for(t_endIndex=this.m_count-1;t_endIndex>=0;t_endIndex=t_endIndex+-1){
		if(this.m_data[t_endIndex]!=32 && this.m_data[t_endIndex]!=9){
			break;
		}
	}
	if(t_startIndex==0 && t_endIndex==this.m_count-1){
		return false;
	}
	this.m_count=t_endIndex-t_startIndex+1;
	if(t_startIndex>0){
		for(var t_trimIndex=0;t_trimIndex<this.m_count;t_trimIndex=t_trimIndex+1){
			this.m_data[t_trimIndex]=this.m_data[t_trimIndex+t_startIndex];
		}
	}
	return true;
}
function c_List4(){
	Object.call(this);
	this.m__head=(c_HeadNode4.m_new.call(new c_HeadNode4));
}
c_List4.m_new=function(){
	return this;
}
c_List4.prototype.p_AddLast4=function(t_data){
	return c_Node13.m_new.call(new c_Node13,this.m__head,this.m__head.m__pred,t_data);
}
c_List4.m_new2=function(t_data){
	var t_=t_data;
	var t_2=0;
	while(t_2<t_.length){
		var t_t=t_[t_2];
		t_2=t_2+1;
		this.p_AddLast4(t_t);
	}
	return this;
}
c_List4.prototype.p_RemoveLast=function(){
	var t_data=this.m__head.m__pred.m__data;
	this.m__head.m__pred.p_Remove();
	return t_data;
}
c_List4.prototype.p_Equals8=function(t_lhs,t_rhs){
	return t_lhs==t_rhs;
}
c_List4.prototype.p_FindLast=function(t_value,t_start){
	while(t_start!=this.m__head){
		if(this.p_Equals8(t_value,t_start.m__data)){
			return t_start;
		}
		t_start=t_start.m__pred;
	}
	return null;
}
c_List4.prototype.p_FindLast2=function(t_value){
	return this.p_FindLast(t_value,this.m__head.m__pred);
}
c_List4.prototype.p_RemoveLast2=function(t_value){
	var t_node=this.p_FindLast2(t_value);
	if((t_node)!=null){
		t_node.p_Remove();
	}
}
c_List4.prototype.p_IsEmpty=function(){
	return this.m__head.m__succ==this.m__head;
}
c_List4.prototype.p_Last=function(){
	return this.m__head.m__pred.m__data;
}
c_List4.prototype.p_ObjectEnumerator=function(){
	return c_Enumerator7.m_new.call(new c_Enumerator7,this);
}
function c_Node13(){
	Object.call(this);
	this.m__succ=null;
	this.m__pred=null;
	this.m__data=null;
}
c_Node13.m_new=function(t_succ,t_pred,t_data){
	this.m__succ=t_succ;
	this.m__pred=t_pred;
	this.m__succ.m__pred=this;
	this.m__pred.m__succ=this;
	this.m__data=t_data;
	return this;
}
c_Node13.m_new2=function(){
	return this;
}
c_Node13.prototype.p_Remove=function(){
	this.m__succ.m__pred=this.m__pred;
	this.m__pred.m__succ=this.m__succ;
	return 0;
}
function c_HeadNode4(){
	c_Node13.call(this);
}
c_HeadNode4.prototype=extend_class(c_Node13);
c_HeadNode4.m_new=function(){
	c_Node13.m_new2.call(this);
	this.m__succ=(this);
	this.m__pred=(this);
	return this;
}
function bb_xml2_XMLHasStringAtOffset(t_needle,t_haystack,t_offset){
	if(t_offset+t_needle.length>t_haystack.length){
		return false;
	}
	for(var t_index=0;t_index<t_needle.length;t_index=t_index+1){
		if(t_needle.charCodeAt(t_index)!=t_haystack.charCodeAt(t_offset+t_index)){
			return false;
		}
	}
	return true;
}
function c_Map10(){
	Object.call(this);
	this.m_root=null;
}
c_Map10.m_new=function(){
	return this;
}
c_Map10.prototype.p_Compare4=function(t_lhs,t_rhs){
}
c_Map10.prototype.p_RotateLeft10=function(t_node){
	var t_child=t_node.m_right;
	t_node.m_right=t_child.m_left;
	if((t_child.m_left)!=null){
		t_child.m_left.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_left){
			t_node.m_parent.m_left=t_child;
		}else{
			t_node.m_parent.m_right=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_left=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map10.prototype.p_RotateRight10=function(t_node){
	var t_child=t_node.m_left;
	t_node.m_left=t_child.m_right;
	if((t_child.m_right)!=null){
		t_child.m_right.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_right){
			t_node.m_parent.m_right=t_child;
		}else{
			t_node.m_parent.m_left=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_right=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map10.prototype.p_InsertFixup10=function(t_node){
	while(((t_node.m_parent)!=null) && t_node.m_parent.m_color==-1 && ((t_node.m_parent.m_parent)!=null)){
		if(t_node.m_parent==t_node.m_parent.m_parent.m_left){
			var t_uncle=t_node.m_parent.m_parent.m_right;
			if(((t_uncle)!=null) && t_uncle.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle.m_color=1;
				t_uncle.m_parent.m_color=-1;
				t_node=t_uncle.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_right){
					t_node=t_node.m_parent;
					this.p_RotateLeft10(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateRight10(t_node.m_parent.m_parent);
			}
		}else{
			var t_uncle2=t_node.m_parent.m_parent.m_left;
			if(((t_uncle2)!=null) && t_uncle2.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle2.m_color=1;
				t_uncle2.m_parent.m_color=-1;
				t_node=t_uncle2.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_left){
					t_node=t_node.m_parent;
					this.p_RotateRight10(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateLeft10(t_node.m_parent.m_parent);
			}
		}
	}
	this.m_root.m_color=1;
	return 0;
}
c_Map10.prototype.p_Set6=function(t_key,t_value){
	var t_node=this.m_root;
	var t_parent=null;
	var t_cmp=0;
	while((t_node)!=null){
		t_parent=t_node;
		t_cmp=this.p_Compare4(t_key,t_node.m_key);
		if(t_cmp>0){
			t_node=t_node.m_right;
		}else{
			if(t_cmp<0){
				t_node=t_node.m_left;
			}else{
				t_node.m_value=t_value;
				return false;
			}
		}
	}
	t_node=c_Node14.m_new.call(new c_Node14,t_key,t_value,-1,t_parent);
	if((t_parent)!=null){
		if(t_cmp>0){
			t_parent.m_right=t_node;
		}else{
			t_parent.m_left=t_node;
		}
		this.p_InsertFixup10(t_node);
	}else{
		this.m_root=t_node;
	}
	return true;
}
c_Map10.prototype.p_Insert3=function(t_key,t_value){
	return this.p_Set6(t_key,t_value);
}
c_Map10.prototype.p_FindNode=function(t_key){
	var t_node=this.m_root;
	while((t_node)!=null){
		var t_cmp=this.p_Compare4(t_key,t_node.m_key);
		if(t_cmp>0){
			t_node=t_node.m_right;
		}else{
			if(t_cmp<0){
				t_node=t_node.m_left;
			}else{
				return t_node;
			}
		}
	}
	return t_node;
}
c_Map10.prototype.p_Get=function(t_key){
	var t_node=this.p_FindNode(t_key);
	if((t_node)!=null){
		return t_node.m_value;
	}
	return null;
}
function c_StringMap5(){
	c_Map10.call(this);
}
c_StringMap5.prototype=extend_class(c_Map10);
c_StringMap5.m_new=function(){
	c_Map10.m_new.call(this);
	return this;
}
c_StringMap5.prototype.p_Compare4=function(t_lhs,t_rhs){
	return string_compare(t_lhs,t_rhs);
}
function c_Node14(){
	Object.call(this);
	this.m_key="";
	this.m_right=null;
	this.m_left=null;
	this.m_value=null;
	this.m_color=0;
	this.m_parent=null;
}
c_Node14.m_new=function(t_key,t_value,t_color,t_parent){
	this.m_key=t_key;
	this.m_value=t_value;
	this.m_color=t_color;
	this.m_parent=t_parent;
	return this;
}
c_Node14.m_new2=function(){
	return this;
}
function c_XMLAttributeQuery(){
	Object.call(this);
	this.m_count=0;
	this.m_items=[];
	this.m_chunk=32;
}
c_XMLAttributeQuery.m_new=function(t_query){
	var t_queryIndex=0;
	var t_queryAsc=0;
	var t_buffer=c_XMLStringBuffer.m_new.call(new c_XMLStringBuffer,256);
	var t_isEscaped=false;
	var t_processBuffer=false;
	var t_processItem=false;
	var t_hasId=false;
	var t_hasValue=false;
	var t_hasEquals=false;
	var t_hasSepcial=false;
	var t_itemId="";
	var t_itemValue="";
	for(t_queryIndex=0;t_queryIndex<t_query.length;t_queryIndex=t_queryIndex+1){
		t_queryAsc=t_query.charCodeAt(t_queryIndex);
		if(t_isEscaped){
			t_isEscaped=false;
			t_buffer.p_Add6(t_queryAsc);
		}else{
			var t_1=t_queryAsc;
			if(t_1==38){
				t_processBuffer=true;
				t_processItem=true;
			}else{
				if(t_1==61){
					t_processBuffer=true;
					t_hasEquals=true;
				}else{
					if(t_1==64){
						if(t_hasId==false){
							if(t_buffer.p_Length2()==0){
								t_hasSepcial=true;
							}
						}else{
							t_buffer.p_Add6(t_queryAsc);
						}
					}else{
						if(t_1==92){
							t_isEscaped=true;
						}else{
							if(t_hasId || (t_queryAsc==45 || t_queryAsc==95 || t_queryAsc>=48 && t_queryAsc<=57 || t_queryAsc>=65 && t_queryAsc<=90 || t_queryAsc>=97 && t_queryAsc<=122)){
								t_buffer.p_Add6(t_queryAsc);
							}
						}
					}
				}
			}
		}
		if(t_queryIndex==t_query.length-1){
			t_processBuffer=true;
			t_processItem=true;
			if(t_isEscaped && t_hasId){
				t_buffer.p_Add6(92);
			}
			if(t_hasEquals && t_buffer.p_Length2()==0){
				t_hasValue=true;
			}
		}
		if(t_processBuffer){
			t_processBuffer=false;
			if(t_hasId==false){
				t_itemId=t_buffer.p_value();
				t_buffer.p_Clear();
				t_hasId=t_itemId.length>0;
			}else{
				t_itemValue=t_buffer.p_value();
				t_buffer.p_Clear();
				t_hasValue=true;
			}
		}
		if(t_processItem){
			t_processItem=false;
			if(t_hasId){
				if(this.m_count==this.m_items.length){
					this.m_items=resize_object_array(this.m_items,this.m_items.length+this.m_chunk);
				}
				this.m_items[this.m_count]=c_XMLAttributeQueryItem.m_new.call(new c_XMLAttributeQueryItem,t_itemId,t_itemValue,t_hasValue,t_hasSepcial);
				this.m_count+=1;
				t_itemId="";
				t_itemValue="";
				t_hasId=false;
				t_hasValue=false;
				t_hasSepcial=false;
			}
		}
	}
	return this;
}
c_XMLAttributeQuery.m_new2=function(){
	return this;
}
c_XMLAttributeQuery.prototype.p_Length2=function(){
	return this.m_count;
}
c_XMLAttributeQuery.prototype.p_Test=function(t_node){
	var t_attribute=null;
	for(var t_index=0;t_index<this.m_count;t_index=t_index+1){
		if(this.m_items[t_index].m_special==false){
			t_attribute=t_node.p_GetXMLAttribute(this.m_items[t_index].m_id);
			if(t_attribute==null || this.m_items[t_index].m_required && t_attribute.m_value!=this.m_items[t_index].m_value){
				return false;
			}
		}else{
			var t_2=this.m_items[t_index].m_id;
			if(t_2=="value"){
				if(this.m_items[t_index].m_required && t_node.m_value!=this.m_items[t_index].m_value){
					return false;
				}
			}
		}
	}
	return true;
}
function c_XMLAttributeQueryItem(){
	Object.call(this);
	this.m_id="";
	this.m_value="";
	this.m_required=false;
	this.m_special=false;
}
c_XMLAttributeQueryItem.m_new=function(t_id,t_value,t_required,t_special){
	this.m_id=t_id;
	this.m_value=t_value;
	this.m_required=t_required;
	this.m_special=t_special;
	return this;
}
c_XMLAttributeQueryItem.m_new2=function(){
	return this;
}
function c_XMLAttribute2(){
	Object.call(this);
	this.m_id="";
	this.m_value="";
}
c_XMLAttribute2.m_new=function(t_id,t_value){
	this.m_id=t_id;
	this.m_value=t_value;
	return this;
}
c_XMLAttribute2.m_new2=function(){
	return this;
}
function c_Map11(){
	Object.call(this);
	this.m_root=null;
}
c_Map11.m_new=function(){
	return this;
}
c_Map11.prototype.p_Compare4=function(t_lhs,t_rhs){
}
c_Map11.prototype.p_FindNode=function(t_key){
	var t_node=this.m_root;
	while((t_node)!=null){
		var t_cmp=this.p_Compare4(t_key,t_node.m_key);
		if(t_cmp>0){
			t_node=t_node.m_right;
		}else{
			if(t_cmp<0){
				t_node=t_node.m_left;
			}else{
				return t_node;
			}
		}
	}
	return t_node;
}
c_Map11.prototype.p_Get=function(t_key){
	var t_node=this.p_FindNode(t_key);
	if((t_node)!=null){
		return t_node.m_value;
	}
	return null;
}
c_Map11.prototype.p_RotateLeft11=function(t_node){
	var t_child=t_node.m_right;
	t_node.m_right=t_child.m_left;
	if((t_child.m_left)!=null){
		t_child.m_left.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_left){
			t_node.m_parent.m_left=t_child;
		}else{
			t_node.m_parent.m_right=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_left=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map11.prototype.p_RotateRight11=function(t_node){
	var t_child=t_node.m_left;
	t_node.m_left=t_child.m_right;
	if((t_child.m_right)!=null){
		t_child.m_right.m_parent=t_node;
	}
	t_child.m_parent=t_node.m_parent;
	if((t_node.m_parent)!=null){
		if(t_node==t_node.m_parent.m_right){
			t_node.m_parent.m_right=t_child;
		}else{
			t_node.m_parent.m_left=t_child;
		}
	}else{
		this.m_root=t_child;
	}
	t_child.m_right=t_node;
	t_node.m_parent=t_child;
	return 0;
}
c_Map11.prototype.p_InsertFixup11=function(t_node){
	while(((t_node.m_parent)!=null) && t_node.m_parent.m_color==-1 && ((t_node.m_parent.m_parent)!=null)){
		if(t_node.m_parent==t_node.m_parent.m_parent.m_left){
			var t_uncle=t_node.m_parent.m_parent.m_right;
			if(((t_uncle)!=null) && t_uncle.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle.m_color=1;
				t_uncle.m_parent.m_color=-1;
				t_node=t_uncle.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_right){
					t_node=t_node.m_parent;
					this.p_RotateLeft11(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateRight11(t_node.m_parent.m_parent);
			}
		}else{
			var t_uncle2=t_node.m_parent.m_parent.m_left;
			if(((t_uncle2)!=null) && t_uncle2.m_color==-1){
				t_node.m_parent.m_color=1;
				t_uncle2.m_color=1;
				t_uncle2.m_parent.m_color=-1;
				t_node=t_uncle2.m_parent;
			}else{
				if(t_node==t_node.m_parent.m_left){
					t_node=t_node.m_parent;
					this.p_RotateRight11(t_node);
				}
				t_node.m_parent.m_color=1;
				t_node.m_parent.m_parent.m_color=-1;
				this.p_RotateLeft11(t_node.m_parent.m_parent);
			}
		}
	}
	this.m_root.m_color=1;
	return 0;
}
c_Map11.prototype.p_Set7=function(t_key,t_value){
	var t_node=this.m_root;
	var t_parent=null;
	var t_cmp=0;
	while((t_node)!=null){
		t_parent=t_node;
		t_cmp=this.p_Compare4(t_key,t_node.m_key);
		if(t_cmp>0){
			t_node=t_node.m_right;
		}else{
			if(t_cmp<0){
				t_node=t_node.m_left;
			}else{
				t_node.m_value=t_value;
				return false;
			}
		}
	}
	t_node=c_Node15.m_new.call(new c_Node15,t_key,t_value,-1,t_parent);
	if((t_parent)!=null){
		if(t_cmp>0){
			t_parent.m_right=t_node;
		}else{
			t_parent.m_left=t_node;
		}
		this.p_InsertFixup11(t_node);
	}else{
		this.m_root=t_node;
	}
	return true;
}
c_Map11.prototype.p_Insert4=function(t_key,t_value){
	return this.p_Set7(t_key,t_value);
}
function c_StringMap6(){
	c_Map11.call(this);
}
c_StringMap6.prototype=extend_class(c_Map11);
c_StringMap6.m_new=function(){
	c_Map11.m_new.call(this);
	return this;
}
c_StringMap6.prototype.p_Compare4=function(t_lhs,t_rhs){
	return string_compare(t_lhs,t_rhs);
}
function c_Node15(){
	Object.call(this);
	this.m_key="";
	this.m_right=null;
	this.m_left=null;
	this.m_value=null;
	this.m_color=0;
	this.m_parent=null;
}
c_Node15.m_new=function(t_key,t_value,t_color,t_parent){
	this.m_key=t_key;
	this.m_value=t_value;
	this.m_color=t_color;
	this.m_parent=t_parent;
	return this;
}
c_Node15.m_new2=function(){
	return this;
}
function bb_xml2_ParseXML(t_raw,t_error,t_options){
	var t_rawLine=1;
	var t_rawColumn=1;
	var t_rawIndex=0;
	var t_rawAsc=0;
	var t_rawPos=0;
	var t_rawChunkStart=0;
	var t_rawChunkLength=0;
	var t_rawChunkEnd=0;
	var t_rawChunk="";
	var t_rawChunkIndex=0;
	var t_rawChunkAsc=0;
	var t_doc=null;
	var t_parent=null;
	var t_current=null;
	var t_whitespaceBuffer=c_XMLStringBuffer.m_new.call(new c_XMLStringBuffer,1024);
	var t_attributeBuffer=c_XMLStringBuffer.m_new.call(new c_XMLStringBuffer,1024);
	var t_processAttributeBuffer=false;
	var t_processTag=false;
	var t_tagName="";
	var t_formatVersion="";
	var t_formatEncoding="";
	var t_attributeId="";
	var t_attributeValue="";
	var t_inTag=false;
	var t_inQuote=false;
	var t_inFormat=false;
	var t_isCloseSelf=false;
	var t_isSingleAttribute=false;
	var t_hasFormat=false;
	var t_hasTagName=false;
	var t_hasTagClose=false;
	var t_hasAttributeId=false;
	var t_hasAttributeValue=false;
	var t_hasEquals=false;
	var t_waitTagClose=false;
	var t_stack=c_List4.m_new.call(new c_List4);
	var t_quoteAsc=0;
	if((t_error)!=null){
		t_error.p_Reset();
	}
	if(t_raw.length==0){
		if((t_error)!=null){
			t_error.p_Set5("no xml data",-1,-1,-1);
		}
		return null;
	}
	for(t_rawIndex=0;t_rawIndex<t_raw.length;t_rawIndex=t_rawIndex+1){
		t_rawAsc=t_raw.charCodeAt(t_rawIndex);
		if(t_inTag==false){
			var t_3=t_rawAsc;
			if(t_3==9 || t_3==32){
				if(((t_whitespaceBuffer.p_Length2())!=0) || ((t_parent)!=null) && ((t_parent.m_value.length)!=0)){
					var t_lastAsc=t_whitespaceBuffer.p_Last2(-1);
					if((t_options&1)==0 || ((t_whitespaceBuffer.p_Length2())!=0) && t_lastAsc!=9 && t_lastAsc!=32){
						if(t_parent==null){
							if((t_error)!=null){
								t_error.p_Set5("illegal character",t_rawLine,t_rawColumn,t_rawIndex);
							}
							return null;
						}
						t_whitespaceBuffer.p_Add6(t_rawAsc);
					}
				}
				t_rawColumn+=1;
			}else{
				if(t_3==10){
					t_rawLine+=1;
					t_rawColumn=1;
				}else{
					if(t_3==13){
					}else{
						if(t_3==60){
							if(bb_xml2_XMLHasStringAtOffset("<?xml",t_raw,t_rawIndex)){
								if(t_hasFormat){
									if((t_error)!=null){
										t_error.p_Set5("duplicate xml format",t_rawLine,t_rawColumn,t_rawIndex);
									}
									return null;
								}
								t_inTag=true;
								t_inFormat=true;
								t_rawColumn+="<?xml".length;
								t_rawIndex=t_rawPos+"<?xml".length-1;
							}else{
								if(bb_xml2_XMLHasStringAtOffset("<!--",t_raw,t_rawIndex)){
									t_rawPos=t_raw.indexOf("-->",t_rawIndex+"<!--".length);
									if(t_rawPos==-1){
										if((t_error)!=null){
											t_error.p_Set5("comment not closed",t_rawLine,t_rawColumn,t_rawIndex);
										}
										return null;
									}
									t_rawChunkStart=t_rawIndex+"<!--".length;
									t_rawChunkLength=t_rawPos-(t_rawIndex+"<!--".length);
									t_rawChunkEnd=t_rawChunkStart+t_rawChunkLength;
									for(t_rawChunkIndex=t_rawChunkStart;t_rawChunkIndex<t_rawChunkEnd;t_rawChunkIndex=t_rawChunkIndex+1){
										t_rawChunkAsc=t_raw.charCodeAt(t_rawChunkIndex);
										if(t_rawChunkAsc==10){
											t_rawLine+=1;
											t_rawColumn=1;
										}else{
											t_rawColumn+=1;
										}
									}
									t_rawIndex=t_rawPos+"-->".length-1;
								}else{
									if(bb_xml2_XMLHasStringAtOffset("<![CDATA[",t_raw,t_rawIndex)){
										t_rawPos=t_raw.indexOf("]]>",t_rawIndex+"<![CDATA[".length);
										if(t_rawPos==-1){
											if((t_error)!=null){
												t_error.p_Set5("cdata not closed",t_rawLine,t_rawColumn,t_rawIndex);
											}
											return null;
										}
										if(t_parent==null){
											if((t_error)!=null){
												t_error.p_Set5("unexepcted cdata",t_rawLine,t_rawColumn,t_rawIndex);
											}
											return null;
										}
										t_rawChunkStart=t_rawIndex+"<![CDATA[".length;
										t_rawChunkLength=t_rawPos-(t_rawIndex+"<![CDATA[".length);
										t_rawChunkEnd=t_rawChunkStart+t_rawChunkLength;
										for(t_rawChunkIndex=t_rawChunkStart;t_rawChunkIndex<t_rawChunkEnd;t_rawChunkIndex=t_rawChunkIndex+1){
											t_rawChunkAsc=t_raw.charCodeAt(t_rawChunkIndex);
											if(t_rawChunkAsc==10){
												t_rawLine+=1;
												t_rawColumn=1;
											}else{
												t_rawColumn+=1;
											}
										}
										t_whitespaceBuffer.p_Add8(t_raw,t_rawChunkStart,t_rawChunkLength);
										t_rawIndex=t_rawPos+"]]>".length-1;
									}else{
										t_inTag=true;
										if((t_whitespaceBuffer.p_Length2())!=0){
											if((t_options&1)==0){
												t_parent.m_value=t_parent.m_value+t_whitespaceBuffer.p_value();
												t_whitespaceBuffer.p_Clear();
											}else{
												t_whitespaceBuffer.p_Trim();
												if((t_whitespaceBuffer.p_Length2())!=0){
													t_parent.m_value=t_parent.m_value+t_whitespaceBuffer.p_value();
													t_whitespaceBuffer.p_Clear();
												}
											}
										}
										t_rawColumn+=1;
									}
								}
							}
						}else{
							if(t_3==62){
								if((t_error)!=null){
									t_error.p_Set5("unexpected close bracket",t_rawLine,t_rawColumn,t_rawIndex);
								}
								return null;
							}else{
								if(t_parent==null){
									if((t_error)!=null){
										t_error.p_Set5("illegal character",t_rawLine,t_rawColumn,t_rawIndex);
									}
									return null;
								}
								t_whitespaceBuffer.p_Add6(t_rawAsc);
								t_rawColumn+=1;
							}
						}
					}
				}
			}
		}else{
			if(t_waitTagClose){
				var t_4=t_rawAsc;
				if(t_4==9){
					t_rawColumn+=1;
				}else{
					if(t_4==10){
						t_rawLine+=1;
						t_rawColumn=1;
					}else{
						if(t_4==13){
						}else{
							if(t_4==32){
								t_rawColumn+=1;
							}else{
								if(t_4==62){
									t_waitTagClose=false;
									t_processTag=true;
								}else{
									if((t_error)!=null){
										t_error.p_Set5("unexpected character",t_rawLine,t_rawColumn,t_rawIndex);
									}
									return null;
								}
							}
						}
					}
				}
			}else{
				if(t_inQuote==false){
					var t_5=t_rawAsc;
					if(t_5==9){
						t_rawColumn+=1;
						if((t_attributeBuffer.p_Length2())!=0){
							t_processAttributeBuffer=true;
						}
					}else{
						if(t_5==10){
							t_rawLine+=1;
							t_rawColumn=1;
							if((t_attributeBuffer.p_Length2())!=0){
								t_processAttributeBuffer=true;
							}
						}else{
							if(t_5==13){
							}else{
								if(t_5==32){
									t_rawColumn+=1;
									if((t_attributeBuffer.p_Length2())!=0){
										t_processAttributeBuffer=true;
									}
								}else{
									if(t_5==34 || t_5==39){
										t_quoteAsc=t_rawAsc;
										t_inQuote=true;
										if(t_hasTagClose || t_hasTagName==false && t_inFormat==false || t_hasEquals==false || ((t_attributeBuffer.p_Length2())!=0)){
											if((t_error)!=null){
												t_error.p_Set5("unexpected quote",t_rawLine,t_rawColumn,t_rawIndex);
											}
											return null;
										}
										t_rawColumn+=1;
										if((t_attributeBuffer.p_Length2())!=0){
											t_processAttributeBuffer=true;
										}
									}else{
										if(t_5==47){
											if(t_hasTagClose || t_hasEquals){
												if((t_error)!=null){
													t_error.p_Set5("unexpected slash",t_rawLine,t_rawColumn,t_rawIndex);
												}
												return null;
											}
											if(t_hasTagName){
												t_waitTagClose=true;
												t_isCloseSelf=true;
											}
											if((t_attributeBuffer.p_Length2())!=0){
												t_processAttributeBuffer=true;
											}
											t_hasTagClose=true;
											t_rawColumn+=1;
										}else{
											if(t_5==61){
												t_rawColumn+=1;
												if(t_hasTagClose || t_hasTagName==false && t_inFormat==false || t_hasEquals || t_hasAttributeId || t_attributeBuffer.p_Length2()==0){
													if((t_error)!=null){
														t_error.p_Set5("unexpected equals",t_rawLine,t_rawColumn,t_rawIndex);
													}
													return null;
												}
												t_processAttributeBuffer=true;
												t_hasEquals=true;
											}else{
												if(t_5==62){
													if(t_hasEquals || t_hasTagName==false && t_attributeBuffer.p_Length2()==0){
														if((t_error)!=null){
															t_error.p_Set5("unexpected close bracket",t_rawLine,t_rawColumn,t_rawIndex);
														}
														return null;
													}
													if((t_attributeBuffer.p_Length2())!=0){
														t_processAttributeBuffer=true;
													}
													t_processTag=true;
													t_rawColumn+=1;
												}else{
													if(t_5==63){
														if(t_inFormat==false || t_rawIndex==t_raw.length-1 || t_raw.charCodeAt(t_rawIndex+1)!=62){
															if((t_error)!=null){
																t_error.p_Set5("unexpected questionmark",t_rawLine,t_rawColumn,t_rawIndex);
															}
															return null;
														}
														t_processTag=true;
														t_rawIndex+=1;
														t_rawColumn+=1;
													}else{
														if(t_rawAsc==45 || t_rawAsc==95 || t_rawAsc>=48 && t_rawAsc<=57 || t_rawAsc>=65 && t_rawAsc<=90 || t_rawAsc>=97 && t_rawAsc<=122){
															if(t_hasTagClose==true && t_hasTagName==true){
																if((t_error)!=null){
																	t_error.p_Set5("unexpected character",t_rawLine,t_rawColumn,t_rawIndex);
																}
																return null;
															}
															if(t_hasAttributeId && t_hasEquals==false){
																t_isSingleAttribute=true;
																t_processAttributeBuffer=true;
															}else{
																t_attributeBuffer.p_Add6(t_rawAsc);
															}
															t_rawColumn+=1;
														}else{
															if((t_error)!=null){
																t_error.p_Set5("illegal character",t_rawLine,t_rawColumn,t_rawIndex);
															}
															return null;
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}else{
					if(t_rawAsc==t_quoteAsc){
						t_inQuote=false;
						t_processAttributeBuffer=true;
					}else{
						t_attributeBuffer.p_Add6(t_rawAsc);
					}
				}
				if(t_processAttributeBuffer){
					t_processAttributeBuffer=false;
					if(t_hasTagName==false && t_inFormat==false){
						if(t_hasTagClose==false){
							t_tagName=t_attributeBuffer.p_value();
							if(t_parent==null){
								if(t_doc==null){
									t_doc=c_XMLDoc.m_new.call(new c_XMLDoc,t_tagName,t_formatVersion,t_formatEncoding);
									t_doc.m_doc=t_doc;
									t_doc.m_parent=null;
									t_doc.m_line=t_rawLine;
									t_doc.m_column=t_rawColumn;
									t_doc.m_offset=t_rawIndex;
									t_current=(t_doc);
								}else{
									if((t_error)!=null){
										t_error.p_Set5("duplicate root",t_rawLine,t_rawColumn,t_rawIndex);
									}
									return null;
								}
							}else{
								t_current=t_parent.p_AddChild2(t_tagName,"","");
								t_current.m_line=t_rawLine;
								t_current.m_column=t_rawColumn;
								t_current.m_offset=t_rawIndex;
							}
							t_hasTagName=true;
						}else{
							t_tagName=t_attributeBuffer.p_value().toLowerCase();
							if(t_parent==null || t_tagName!=t_parent.m_name){
								if((t_error)!=null){
									t_error.p_Set5("mismatched end tag",t_rawLine,t_rawColumn,t_rawIndex);
								}
								return null;
							}
							t_waitTagClose=true;
							t_hasTagName=true;
						}
					}else{
						if(t_hasAttributeId==false){
							t_attributeId=t_attributeBuffer.p_value().toLowerCase();
							t_hasAttributeId=true;
						}else{
							t_attributeValue=t_attributeBuffer.p_value();
							t_hasAttributeValue=true;
						}
						if(t_processTag && t_hasAttributeId || t_hasAttributeId && t_hasAttributeValue || t_isSingleAttribute || t_hasTagClose){
							if(t_inFormat==false){
								t_current.p_SetAttribute(t_attributeId,t_attributeValue);
							}else{
								var t_6=t_attributeId;
								if(t_6=="version"){
									t_formatVersion=t_attributeValue;
								}else{
									if(t_6=="encoding"){
										t_formatEncoding=t_attributeValue;
									}
								}
							}
							t_attributeId="";
							t_attributeValue="";
							t_hasAttributeId=false;
							t_hasAttributeValue=false;
							t_hasEquals=false;
						}
					}
					t_attributeBuffer.p_Clear();
				}
				if(t_isSingleAttribute){
					t_isSingleAttribute=false;
					t_attributeBuffer.p_Add6(t_rawAsc);
				}
			}
			if(t_processTag){
				t_processTag=false;
				if(t_inFormat==false){
					if(t_hasTagClose==false){
						t_parent=t_current;
						t_current=null;
						t_stack.p_AddLast4(t_parent);
					}else{
						if(t_isCloseSelf==false){
							if((t_whitespaceBuffer.p_Length2())!=0){
								t_parent.m_value=t_parent.m_value+t_whitespaceBuffer.p_value();
								t_whitespaceBuffer.p_Clear();
							}
							t_stack.p_RemoveLast();
							if(t_stack.p_IsEmpty()){
								t_parent=null;
							}else{
								t_parent=t_stack.p_Last();
							}
						}else{
							t_isCloseSelf=false;
						}
					}
				}else{
					t_hasFormat=true;
					t_inFormat=false;
				}
				t_inTag=false;
				t_hasTagClose=false;
				t_hasTagName=false;
				t_waitTagClose=false;
				t_tagName="";
			}
		}
	}
	if(t_inTag || ((t_parent)!=null) || t_doc==null){
		if((t_error)!=null){
			t_error.p_Set5("unexpected end of xml",t_rawLine,t_rawColumn,t_rawIndex);
		}
		return null;
	}
	return t_doc;
}
function c_Enumerator7(){
	Object.call(this);
	this.m__list=null;
	this.m__curr=null;
}
c_Enumerator7.m_new=function(t_list){
	this.m__list=t_list;
	this.m__curr=t_list.m__head.m__succ;
	return this;
}
c_Enumerator7.m_new2=function(){
	return this;
}
c_Enumerator7.prototype.p_HasNext=function(){
	while(this.m__curr.m__succ.m__pred!=this.m__curr){
		this.m__curr=this.m__curr.m__succ;
	}
	return this.m__curr!=this.m__list.m__head;
}
c_Enumerator7.prototype.p_NextObject=function(){
	var t_data=this.m__curr.m__data;
	this.m__curr=this.m__curr.m__succ;
	return t_data;
}
function bb_asyncevent_RemoveAsyncEventSource(t_source){
	if(t_source==bb_asyncevent__current){
		bb_asyncevent__current=null;
	}
	bb_asyncevent__sources.p_RemoveEach(t_source);
}
function c_Stack13(){
	Object.call(this);
	this.m_data=[];
	this.m_length=0;
}
c_Stack13.m_new=function(){
	return this;
}
c_Stack13.m_new2=function(t_data){
	this.m_data=t_data.slice(0);
	this.m_length=t_data.length;
	return this;
}
c_Stack13.m_NIL=0;
c_Stack13.prototype.p_Clear=function(){
	for(var t_i=0;t_i<this.m_length;t_i=t_i+1){
		this.m_data[t_i]=c_Stack13.m_NIL;
	}
	this.m_length=0;
}
c_Stack13.prototype.p_Push37=function(t_value){
	if(this.m_length==this.m_data.length){
		this.m_data=resize_number_array(this.m_data,this.m_length*2+10);
	}
	this.m_data[this.m_length]=t_value;
	this.m_length+=1;
}
c_Stack13.prototype.p_Push38=function(t_values,t_offset,t_count){
	for(var t_i=0;t_i<t_count;t_i=t_i+1){
		this.p_Push37(t_values[t_offset+t_i]);
	}
}
c_Stack13.prototype.p_Push39=function(t_values,t_offset){
	this.p_Push38(t_values,t_offset,t_values.length-t_offset);
}
c_Stack13.prototype.p_ObjectEnumerator=function(){
	return c_Enumerator8.m_new.call(new c_Enumerator8,this);
}
c_Stack13.prototype.p_Length=function(t_newlength){
	if(t_newlength<this.m_length){
		for(var t_i=t_newlength;t_i<this.m_length;t_i=t_i+1){
			this.m_data[t_i]=c_Stack13.m_NIL;
		}
	}else{
		if(t_newlength>this.m_data.length){
			this.m_data=resize_number_array(this.m_data,bb_math_Max(this.m_length*2+10,t_newlength));
		}
	}
	this.m_length=t_newlength;
}
c_Stack13.prototype.p_Length2=function(){
	return this.m_length;
}
function c_Enumerator8(){
	Object.call(this);
	this.m_stack=null;
	this.m_index=0;
}
c_Enumerator8.m_new=function(t_stack){
	this.m_stack=t_stack;
	return this;
}
c_Enumerator8.m_new2=function(){
	return this;
}
c_Enumerator8.prototype.p_HasNext=function(){
	return this.m_index<this.m_stack.p_Length2();
}
c_Enumerator8.prototype.p_NextObject=function(){
	this.m_index+=1;
	return this.m_stack.m_data[this.m_index-1];
}
function c_NodeEnumerator(){
	Object.call(this);
	this.m_node=null;
}
c_NodeEnumerator.m_new=function(t_node){
	this.m_node=t_node;
	return this;
}
c_NodeEnumerator.m_new2=function(){
	return this;
}
c_NodeEnumerator.prototype.p_HasNext=function(){
	return this.m_node!=null;
}
c_NodeEnumerator.prototype.p_NextObject=function(){
	var t_t=this.m_node;
	this.m_node=this.m_node.p_NextNode();
	return t_t;
}
function c_CustomException(){
	ThrowableObject.call(this);
}
c_CustomException.prototype=extend_class(ThrowableObject);
function c_classServerGetImageData(){
	Object.call(this);
	this.m_bAborted=false;
	this.m_bSended=false;
	this.m_bError=false;
	this.m_urlSorg="";
	this.m_urlDest="";
	this.m_post_req=null;
	this.implments={c_IOnHttpRequestComplete:1};
}
c_classServerGetImageData.m_new=function(){
	this.m_bAborted=false;
	this.m_bSended=false;
	this.m_bError=false;
	return this;
}
c_classServerGetImageData.prototype.p_Reset=function(){
	this.m_bAborted=false;
	this.m_bSended=false;
	this.m_bError=false;
	return 0;
}
c_classServerGetImageData.prototype.p_Get2=function(t__sorg,t__dest){
	this.m_bSended=false;
	var t_data=bb_server_kSERVER_NAME+"get_image_data.php?sorg="+t__sorg+"&dest="+t__dest;
	this.m_urlSorg=t__sorg;
	this.m_urlDest=t__dest;
	this.m_post_req=c_HttpRequest.m_new2.call(new c_HttpRequest,"GET",t_data,(this));
	this.m_post_req.p_Send();
	this.p_Reset();
	this.m_bSended=true;
	return 0;
}
c_classServerGetImageData.prototype.p_OnHttpRequestComplete=function(t_req){
	if(t_req.p_ResponseText().length==0){
		return;
	}
	if(t_req.p_ResponseText().indexOf("\"message\":")!=-1){
		this.m_bError=true;
		return;
	}
	bb_game_cSERVER.m_streamIMAGE=c_classStreamedImage.m_new.call(new c_classStreamedImage,"https://www.xteamsoftware.com/scent/functions"+this.m_urlDest,"",bb_defaultmedia_IMG_MAIN,c_Image.m_DefaultFlags);
	this.m_bAborted=true;
	this.m_bError=false;
}
function bbInit(){
	bb_reflection__classesMap=null;
	bb_reflection__classes=[];
	bb_reflection__getClass=null;
	bb_reflection__boolClass=null;
	bb_reflection__intClass=null;
	bb_reflection__floatClass=null;
	bb_reflection__stringClass=null;
	bb_reflection__functions=[];
	bb_reflection__init=bb_reflection___init();
	bb_collaborate_gScreenWidth=1280;
	bb_collaborate_gScreenHeight=720;
	bb_app__app=null;
	bb_app__delegate=null;
	bb_app__game=BBGame.Game();
	bb_random_Seed=1234;
	bb_app__devWidth=0;
	bb_app__devHeight=0;
	bb_collaborate_Collaborate=null;
	bb_reflection__unknownClass=(c_UnknownClass.m_new.call(new c_UnknownClass));
	bb_graphics_device=null;
	bb_graphics_context=c_GraphicsContext.m_new.call(new c_GraphicsContext);
	c_Image.m_DefaultFlags=0;
	bb_audio_device=null;
	bb_input_device=null;
	bb_app__displayModes=[];
	bb_app__desktopMode=null;
	bb_graphics_renderDevice=null;
	bb_game_UPDATE_RATE=60;
	bb_app__updateRate=0;
	bb_game_gPercentLoad=0;
	c_VirtualDisplay.m_Display=null;
	bb_session_GameSession=null;
	c_Session.m_GameState=0;
	bb_defaultmedia_IMG_MAIN=null;
	bb_game_gStartTimer=0;
	bb_game_selectedTAGS=c_structItems.m_new.call(new c_structItems,null,"");
	bb_game_originalTAGS=c_structItems.m_new.call(new c_structItems,null,"");
	bb_game_cSERVER=c_classServer.m_new.call(new c_classServer);
	bb_server_kSERVER_NAME="https://www.xteamsoftware.com/scent/functions/";
	bb_asyncevent__sources=c_Stack7.m_new.call(new c_Stack7);
	bb_game_cRENDER_HELPER=c_classRender_Helper.m_new.call(new c_classRender_Helper);
	bb_game_cRENDER_PROFILE=c_classRender_Profile.m_new.call(new c_classRender_Profile);
	bb_game_cRENDER_LOGIN=c_classRender_Login.m_new.call(new c_classRender_Login);
	bb_game_cRENDER_INTRO=c_classRender_Intro.m_new.call(new c_classRender_Intro);
	bb_game_cRENDER_LANGUAGE=c_classRender_Language.m_new.call(new c_classRender_Language);
	bb_game_cLANGUAGE=c_classGame_Language.m_new.call(new c_classGame_Language);
	bb_game_cTAXONOMYLANG=c_classGame_TaxonomyLang.m_new.call(new c_classGame_TaxonomyLang);
	bb_game_cTAXONOMYHELP=c_classGame_TaxonomyHelp.m_new.call(new c_classGame_TaxonomyHelp);
	bb_game_cRENDER_INFO=c_classRender_Info.m_new.call(new c_classRender_Info);
	c_AngelFont.m_current=null;
	c_AngelFont.m_firstKp=null;
	c_AngelFont.m__list=c_StringMap2.m_new.call(new c_StringMap2);
	bb_game_fontAngelTitle=c_AngelFont.m_new.call(new c_AngelFont,"");
	bb_game_cVOICE=c_classVoice.m_new.call(new c_classVoice);
	bb_game_userPictureUploaded=0;
	bb_game_userPictureTagged=0;
	bb_game_userTag=0;
	bb_game_userValidation=0;
	bb_game_userScore=0;
	bb_game_userLevel=0;
	bb_game_userPois=0;
	bb_game_userCampaign=0;
	bb_game_currPictureUploaded=0;
	bb_game_currPictureTagged=0;
	bb_game_currTag=0;
	bb_game_currValidation=0;
	bb_game_currScore=0;
	bb_game_currLevel=0;
	bb_game_currPois=0;
	bb_game_currCampaign=0;
	bb_game_inputImageIDStr="";
	bb_game_defineCampaign="";
	bb_game_userIDSelected=0;
	bb_game_userNickName="";
	bb_game_angleRotation=0;
	bb_game_cRENDER_SCENTVALIDATEEXPERT=c_classRender_ValidateExpert.m_new.call(new c_classRender_ValidateExpert);
	bb_items_structureTAG=c_structItems.m_new2.call(new c_structItems);
	bb_game_cMANAGEITEMS=c_manageItems.m_new.call(new c_manageItems);
	c_Stack8.m_NIL=null;
	bb_game_fontAngelMini=c_AngelFont.m_new.call(new c_AngelFont,"");
	bb_game_cRENDER_SCENTVALIDATE=c_classRender_Validate.m_new.call(new c_classRender_Validate);
	bb_game_cRENDER_SCENTTAG=c_classRender_Tag.m_new.call(new c_classRender_Tag);
	c_Session.m_bExpertMode=false;
	bb_game_cRENDER_SCENTFOCUS=c_classRender_Focus.m_new.call(new c_classRender_Focus);
	bb_game_cRENDER_SCENTANNOTATE=c_classRender_Annotate.m_new.call(new c_classRender_Annotate);
	bb_game_cRENDER_ERROR=c_classRender_Error.m_new.call(new c_classRender_Error);
	bb_game_cCONVERT=c_classConvert.m_new.call(new c_classConvert);
	bb_game_originalJsonString="";
	c_JsonString.m__null=c_JsonString.m_new.call(new c_JsonString,"");
	c_JsonNumber.m__zero=c_JsonNumber.m_new.call(new c_JsonNumber,"0");
	c_JsonBool.m__true=c_JsonBool.m_new.call(new c_JsonBool,true);
	c_JsonBool.m__false=c_JsonBool.m_new.call(new c_JsonBool,false);
	c_JsonNull.m__instance=c_JsonNull.m_new.call(new c_JsonNull);
	bb_game_imageIDSelected=1;
	bb_game_inputHit=0;
	bb_game_canLongPress=0;
	bb_game_inputLongPress=0;
	bb_game_inputPress=0;
	bb_game_timeHit=0;
	bb_game_timePress=0;
	bb_game_isSuspend=false;
	bb_game_inputRelease=0;
	bb_game_startTouchHit=c_sPoint.m_new3.call(new c_sPoint);
	bb_game_charKeyboard=0;
	bb_game_charKeyboardMini=0;
	bb_game_inputImageID=false;
	bb_game_cRENDER_SCENTCOLLABORATE=c_classRender_Collaborate.m_new.call(new c_classRender_Collaborate);
	bb_asyncevent__current=null;
	c_Stack7.m_NIL=null;
	bb_game_startMouseOver=c_sPoint.m_new3.call(new c_sPoint);
	c_Stack12.m_NIL=null;
	c_Stack11.m_NIL=null;
	bb_defaultmedia_ICON_FLAGS=null;
	bb_defaultmedia_ICON_SCENT=null;
	c_AngelFont.m_secondKp=null;
	bb_defaultmedia_ICON_LOADER=null;
	bb_game_cRENDER_UPLOAD=c_classRender_Upload.m_new.call(new c_classRender_Upload);
	bb_defaultmedia_ICON_ROTATE=null;
	bb_defaultmedia_ICON_CHECK=null;
	bb_defaultmedia_ICON_VERIFY=null;
	bb_defaultmedia_ICON_INFO=null;
	bb_render_collaborate_MENU_START_Y=24;
	bb_defaultmedia_SPRITE_HELPER=null;
	bb_defaultmedia_ICON_SCROLL=null;
	bb_game_cRENDER_SEND=c_classRender_Send.m_new.call(new c_classRender_Send);
	bb_defaultmedia_ICON_REFRESH=null;
	bb_defaultmedia_SPRITE_ICON=new_object_array(5);
	bb_defaultmedia_SPRITE_LOGO=null;
	bb_defaultmedia_ICON_LOGIN=null;
	bb_defaultmedia_ICON_AUDIO=null;
	bb_game_fontAngel=c_AngelFont.m_new.call(new c_AngelFont,"");
	c_Stack13.m_NIL=0;
}
//${TRANSCODE_END}
